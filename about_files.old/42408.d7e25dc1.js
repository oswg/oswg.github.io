!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};e.SENTRY_RELEASE={id:"substack@af5f699"};var t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="c23cf0a6-80b2-4d9e-993c-47ca54e4a2cc",e._sentryDebugIdIdentifier="sentry-dbid-c23cf0a6-80b2-4d9e-993c-47ca54e4a2cc")}catch(e){}}();"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["42408"],{75030:function(e,t,n){n.d(t,{A:()=>i});let i={elevatedTheme:"elevatedTheme-fBklGV"}},84479:function(e,t,n){n.d(t,{A:()=>i});let i={tosCheckbox:"tosCheckbox-XbLWCT"}},97432:function(e,t,n){n.d(t,{A:()=>D});var i=n(99851),a=n(69277),r=n(70408),s=n(79785),l=n(4006),o=n(32485),u=n.n(o),c=n(17402),d=n(34206),h=n(84605),p=n(34835),m=n(86500),f=n(1683),g=n(68349),b=n(35369),y=n(63136),_=n(65842),v=n(21398),E=n(40659),S=n(39318),Y=n(41086),k=n(80856),C=n(82776),w=n(57324),I=n(27569);function A(){let e=(0,s._)(["Confirmation required: we sent an email to ",". Click the link there to finish subscribing."]);return A=function(){return e},e}class D extends c.Component{getSavedEmail(){return this.props.user&&this.props.user.email||null}getPrefilledEmail(){return this.props.email||this.props.freeSignupEmail||this.getSavedEmail()}async componentDidMount(){let{autoFocus:e,disabled:t}=this.props;if(this.getPrefilledEmail())this.emailInput.value=this.getPrefilledEmail();else if(e&&!(this.getPrefilledEmail()||t)&&!(0,g.rr)()){var i;null==(i=this.emailInput)||i.focus()}n.e("40837").then(n.bind(n,24548)).then(e=>{this.setState({fetchSuggestion:e.fetchSuggestion})})}onLoadingState(e){this.setState({loading:e,requires_confirmation:!1})}onError(e){var t;(null==(t=e.response)?void 0:t.status)===425&&this.setState({requires_confirmation:!0}),this.props.onError&&this.props.onError(e)}render(){var e,t,i,r,s,o,c;let{children:h,className:p,disabled:m,allowEmptyInput:A,expectTruncation:D,isWelcomePageColor:x,loginRedirect:F,next:N,onAccentBackground:P,pub:R,referralCode:T,showLogin:O,showTerms:q,source:B,submitButtonText:W,useSubscribeLink:j,useGenericEndpoint:K,additionalPubIds:L,user:V,utm_campaign:H,onPrepareData:U,promptClassName:J,inputWrapperClassName:M,inputClassName:$,subscribeButtonClassName:z,subscribeToSpecificSectionIds:X,endpointOverride:G,separateInputAndSubmitButton:Q,placeholder:Z}=this.props,{loading:ee,requires_confirmation:et,currentEmail:en}=null!=(c=this.state)?c:{},ei="treatment_bold_fade"===B,ea=(null==(i=(0,Y.y)("referring_pub_ids"))||null==(t=i.split)||null==(e=t.call(i,","))?void 0:e[0])||void 0,er=(null==(o=(0,Y.y)("referring_pub_ids"))||null==(s=o.split)||null==(r=s.call(o,","))?void 0:r.slice(1))||void 0,es=this.getPrefilledEmail(),{iString:el,language:eo}=this.context;if(X&&(L||K))throw Error("Specific section subscriptions only supported on /api/v1/free");let eu=!G&&!L;return(0,l.FD)("div",{className:u()(p,I.A.container),children:[(0,l.Y)(E.HM.Consumer,{children:e=>{var t,n,i,r,s,o,c;let{getSessionAttribution:p}=e;return(0,l.FD)(d.Ay,{ref:this.assignForm,className:I.A.form,noInlineErrors:!0,action:G||(L?(0,S.yRP)("/api/v1/bulk_signup"):K?(0,S.yRP)("/api/v1/reader/signup/pub"):(0,S.yRP)("/api/v1/free")),noJsAction:G||(L?(0,S.yRP)("/api/v1/bulk_signup",{nojs:!0}):K?(0,S.yRP)("/api/v1/reader/signup/pub",{nojs:!0}):(0,S.yRP)("/api/v1/free",{nojs:!0})),prepareData:async e=>{if(et&&(e.resend_confirmation=!0),"string"==typeof e.publications&&(e.publications=JSON.parse(e.publications)),"undefined"!=typeof window&&eu){let t=await p();e=(0,a._)({},t,e)}return U&&await U(e),e},onChangeLoadingState:this.onLoadingState.bind(this),onError:e=>this.onError(e),onSuccess:e=>this.onSuccess(e),typoFound:e=>this.setState({emailSuggestion:e}),disableSubmit:j,analyticsName:"Free Email Form",children:[(0,l.Y)("input",{type:"hidden",name:"first_url",value:f.R9}),(0,l.Y)("input",{type:"hidden",name:"first_referrer",value:f.b7}),(0,l.Y)("input",{type:"hidden",name:"current_url",value:f.AT}),(0,l.Y)("input",{type:"hidden",name:"current_referrer",value:f.uC}),(0,l.Y)("input",{type:"hidden",name:"first_session_url",value:f.K0}),(0,l.Y)("input",{type:"hidden",name:"first_session_referrer",value:f.OG}),(0,l.Y)("input",{type:"hidden",name:"referral_code",value:T}),(0,l.Y)("input",{type:"hidden",name:"source",value:B}),(0,l.Y)("input",{type:"hidden",name:"referring_pub_id",value:ea}),(0,l.Y)("input",{type:"hidden",name:"additional_referring_pub_ids",value:null==er?void 0:er.join(",")}),N&&(0,l.Y)("input",{type:"hidden",name:"redirect",value:N}),X&&(0,l.Y)("input",{type:"hidden",name:"specific_section_ids",value:X}),X&&(0,l.Y)("input",{type:"hidden",name:"section_and_root",value:"true"}),!L&&K&&(0,l.Y)("input",{type:"hidden",name:"publication_id",value:R.id}),L&&(0,l.Y)("input",{type:"hidden",name:"publications",value:JSON.stringify(L.concat(R.id))}),(0,l.FD)("div",{className:u()(J,{[I.A.sideBySideWrap]:!Q}),children:[!!es&&(0,g.o7)(),(0,l.Y)("div",{className:u()(M,I.A.emailInputWrapper,{[null!=(i=I.A.emailInputWrapperExpectTruncation)?i:"undefined"]:D}),children:(0,l.Y)(_.ks,{className:u()($,"pencraft",I.A.emailInput,{[null!=(r=I.A.emailInputOnAccentBackground)?r:"undefined"]:P,[null!=(s=I.A.emailInputExpectTruncation)?s:"undefined"]:D,[null!=(o=I.A.emailInputOnWelcomePage)?o:"undefined"]:x}),onChange:this.handleEmailChange,onInput:this.handleEmailChange,ref:this.assignEmailInput,type:"email",name:ei?"email-pop":"email",readOnly:!!(this.getSavedEmail()||ee||m),disabled:!!(ee||m),placeholder:null!=Z?Z:el("Type your email..."),value:en||es||null})}),(0,l.Y)(b.Nm,{resetCss:!0,className:u()(z,"rightButton primary subscribe-btn",I.A.button,{pop:ei,[null!=(c=I.A.buttonOnAccentBackground)?c:"undefined"]:P}),type:"submit",disabled:!!(ee||m||!A&&!(null==(n=this.emailInput)||null==(t=n.value)?void 0:t.trim())),onClick:()=>{j&&(location.href=(0,S.eV6)(R,(0,a._)({addBase:!0,user:V,utm_source:w.VU.substack,utm_medium:w.Jn.web,utm_campaign:H,next:N},(en||es)&&{email:en||es})))},children:(0,l.Y)("span",{className:"button-text ".concat(ei?"pop":""),children:W||(0,C.getSubscribeText)(R,{language:eo})})})]}),et?(0,l.Y)("div",{children:(0,l.FD)(y.EY,{translated:!0,className:"error other-error",children:["This email address is not confirmed yet.",(0,l.Y)("br",{}),(0,l.Y)("a",{href:"javascript:void(0)",onClick:()=>{if(this.form)return this.form.handleSubmit()},children:"Click here"})," ","to resend the confirmation email."]})}):(0,l.Y)("div",{id:"error-container"}),O||q||h?(0,l.FD)("div",{className:u()("subtle-help-text below-input",I.A.links),children:[O&&(this.getSavedEmail()?(0,l.Y)("a",{className:"login-button",href:(0,S.bgT)({for_pub:R.subdomain}),"data-native":!0,children:el("Not you?")}):(0,l.Y)("a",{className:"login-button",href:(0,S.a7q)({for_pub:R.subdomain,redirect:F}),"data-native":!0,children:el("Login")})),q&&[(0,l.Y)("a",{className:"legal",href:(0,k._)({pub:R}),target:"_blank","data-native":!0,children:el("Privacy")}),(0,l.Y)("a",{className:"legal",href:(0,k.Ru)({pub:R}),target:"_blank","data-native":!0,children:el("Terms")}),(0,l.Y)("a",{className:"legal",href:(0,k.iQ)(),target:"_blank","data-native":!0,children:el("Information collection notice")})],h]}):null]})}}),(0,l.Y)(v.Ic,{onRequest:()=>n.e("58911").then(n.bind(n,56130)),resolve:e=>e.EmailTypoHandler,module:"@/frontend/login/typo_handler/EmailTypoHandler",emailSuggestions:this.state.emailSuggestions,currentEmail:this.state.currentEmail,onAccept:this.onAcceptSuggestion})]})}constructor(e){super(e),(0,i._)(this,"emailInput",void 0),(0,i._)(this,"form",void 0),(0,i._)(this,"assignEmailInput",e=>{this.emailInput=e}),(0,i._)(this,"assignForm",e=>{this.form=e}),(0,i._)(this,"handleEmailChange",()=>{var e,t,n;let i=null==(e=this.emailInput)?void 0:e.value;!i||(this.setState({currentEmail:i}),this.state.emailSuggestions&&this.state.emailSuggestions.hasOwnProperty(i)||null==(t=(n=this.state).fetchSuggestion)||t.call(n,i).then(e=>{let[t,n]=e;this.setState({emailSuggestions:(0,r._)((0,a._)({},this.state.emailSuggestions),{[null!=t?t:"undefined"]:null!=n?n:""})})}))}),(0,i._)(this,"_onSuccess",async e=>{let{iTemplate:t}=this.context;(!0===e.body.is_new_subscriber||!1===e.body.prompt_to_login&&!0===e.body.didSignup)&&m.$5(),(Array.isArray(e.body)&&e.body.every(e=>e.requires_confirmation)||e.body.requires_confirmation)&&(this.props.onConfirmationRequired?await this.props.onConfirmationRequired(e):alert(t(A(),e.body.email))),this.props.freeSignupEmail&&this.props.freeSignupEmail!==e.body.email&&(0,p.E)({freeSignupEmail:e.body.email}),this.props.onSuccess&&await this.props.onSuccess(e)}),(0,i._)(this,"onSuccess",async e=>{"undefined"!=typeof window&&window.campaign&&(0,Y.y)("referralCode")?window.campaign.identify({email:e.body.email},()=>this._onSuccess(e)):await this._onSuccess(e)}),(0,i._)(this,"onAcceptSuggestion",e=>{this.emailInput&&(this.emailInput.value=null!=e?e:"",this.form.handleSubmit(null,!0))}),this.state={emailSuggestions:{}}}}(0,i._)(D,"contextType",h.OW)},34762:function(e,t,n){n.d(t,{q:()=>r});var i=n(4006),a=n(89490);let r=()=>(0,i.Y)(a.az,{height:20})},61554:function(e,t,n){n.d(t,{U:()=>m});var i=n(69277),a=n(70408),r=n(4006),s=n(56778),l=n(86500),o=n(60322),u=n(76977),c=n(63136),d=n(18189),h=n(80856),p=n(84479);let m=e=>{let{includeCheckbox:t=!0,onCheckboxChange:n=()=>{},checked:m=!1,addSubscribePreamble:f=!1,addSignupPreamble:g=!1,addPublisherPreamble:b=!1,fontWeight:y="regular",size:_="regular",color:v="primary",textAlign:E="left",style:S,pub:Y}=e,k=null==Y?void 0:Y.has_custom_tos,C=null==Y?void 0:Y.has_custom_privacy,w=null;return k&&C?w=(0,r.FD)(r.FK,{children:["the publisher's"," ",(0,r.Y)(c.EY,{as:"a",href:(0,h.Ru)({pub:Y}),target:"_blank",style:{textDecoration:"underline"},children:"Terms of Service"})," ","and"," ",(0,r.Y)(c.EY,{as:"a",href:(0,h._)({pub:Y}),target:"_blank",style:{textDecoration:"underline"},children:"Privacy Policy"}),","," "]}):k?w=(0,r.FD)(r.FK,{children:["the publisher's"," ",(0,r.Y)(c.EY,{as:"a",href:(0,h.Ru)({pub:Y}),target:"_blank",style:{textDecoration:"underline"},children:"Terms of Service"}),","," "]}):C&&(w=(0,r.FD)(r.FK,{children:["the publisher's"," ",(0,r.Y)(c.EY,{as:"a",href:(0,h._)({pub:Y}),target:"_blank",style:{textDecoration:"underline"},children:"Privacy Policy"}),","," "]})),(0,r.FD)(r.FK,{children:[(0,r.Y)(s.A,{onVisible:()=>{(0,l.u4)(d.q.TERMS_OF_SERVICE_SEEN,{withCheckbox:t,initialCheckboxValue:m})}}),(0,r.FD)(u.Ye,{as:"label",alignItems:"center",justifyContent:"center",gap:12,style:S,className:p.A.tosCheckbox,children:[t&&(0,r.Y)(o.S,{checked:m,onChange:e=>{(0,l.u4)(d.q.TERMS_OF_SERVICE_CHECKBOX_CLICKED,{checkboxValue:e}),n(e)},size:"sm"}),(0,r.FD)(c.EY.B4,(0,a._)((0,i._)({color:v,textAlign:E,fontWeight:y},"small"===_?{size:11,lineHeight:16}:{}),{children:[b?"By creating a publication, ":f?"By subscribing, ":g?"By creating an account, ":"",t?"I":"you"," agree ",w,b?(0,r.FD)(r.FK,{children:["Substack's"," ",(0,r.Y)(c.EY,{as:"a",href:(0,h._4)(),target:"_blank",style:{textDecoration:"underline"},children:"Publisher Agreement"})]}):(0,r.FD)(r.FK,{children:["Substack's"," ",(0,r.Y)(c.EY,{as:"a",href:(0,h.lk)(),target:"_blank",style:{textDecoration:"underline"},children:"Terms of Use"})]}),", and acknowledge its"," ",(0,r.Y)(c.EY,{as:"a",href:(0,h.iQ)(),target:"_blank",style:{textDecoration:"underline"},children:"Information Collection Notice"})," ","and"," ",(0,r.Y)(c.EY,{as:"a",href:(0,h.gB)(),target:"_blank",style:{textDecoration:"underline"},children:"Privacy Policy"}),"."]}))]})]})}},23246:function(e,t,n){n.d(t,{Z5:()=>i});let i=["hate","private_information","plagiarism","impersonation","illegal_activity","spam","pornography","copyright_violation","other"]},92636:function(e,t,n){n.d(t,{$_:()=>d,Bp:()=>u,EW:()=>o,Ew:()=>h,PH:()=>g,Pm:()=>s,Sg:()=>f,c$:()=>m,d5:()=>r,qd:()=>p,sX:()=>l,w4:()=>a,xJ:()=>i,yR:()=>c});let i="substack.com",a="https://substackcdn.com";function r(e){return"https://"+e}a.replace(/https?:\/\//,"").replace(/\/$/,"");let s=r(i),l=new URL(s);function o(e){let{forceSubdomain:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e&&"object"==typeof e&&"custom_domain"in e&&e.custom_domain&&!e.custom_domain_optional&&!t)return e.custom_domain;let n=i;return e&&"www"!==e.subdomain&&(n="".concat(e.subdomain,".").concat(n)),n}function u(e){return Object.keys(e).filter(t=>void 0!==e[t]&&null!==e[t]).map(t=>"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(e[t]))).join("&")}function c(e,t){if(!e)return"";if(!t)return e;let n=u(t),i=n?-1===e.indexOf("?")?"?":"&":"";return"".concat(e).concat(i).concat(n)}function d(e){let{forceSubdomain:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e&&"object"==typeof e&&"base_url"in e&&e.base_url&&!t?e.base_url:r(o(e,{forceSubdomain:t}))}function h(){return d()}function p(){return r("open.".concat(i))}function m(e){let{noBase:t,urlParams:n,pub:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t?"":d(i);return c("".concat(a).concat(e),n)}function f(){var e;if("undefined"==typeof document||!(null==(e=document.location)?void 0:e.hostname))return!0;let t=document.location.hostname;return t.startsWith(i)||t.startsWith("substack.info")}function g(){var e;if("undefined"==typeof document||!(null==(e=document.location)?void 0:e.hostname))return!0;let t=document.location.hostname;return!(t.startsWith(i)||t.startsWith("substack.info"))&&document.location.pathname.startsWith("/publish/")}}}]);