!function(){try{var t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};t.SENTRY_RELEASE={id:"substack@af5f699"};var e=(new t.Error).stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="865df6fd-397c-4a9a-b987-18e900bed088",t._sentryDebugIdIdentifier="sentry-dbid-865df6fd-397c-4a9a-b987-18e900bed088")}catch(t){}}();"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["54279"],{67022:function(t,e,a){a.d(e,{A:()=>n});let n={datePicker:"datePicker-GG3Vly"}},36339:function(t,e,a){a.d(e,{A:()=>h});var n=a(4006),r=a(418),l=a(17402),i=a(34206),o=a(73815),s=a(35369),d=a(60322),c=a(76977),u=a(76171),m=a(16993),p=a(84843),g=a(63136),f=a(65842),b=a(41086);let h=t=>{let{redirect:e,onClose:a,requiresMfa:h,allowAllDay:y,allowClose:v=!0}=t,[w,k]=(0,l.useState)(!1),[_,C]=(0,l.useState)(""),[E,O]=(0,l.useState)(!h),S=(0,l.useRef)(null),T=e||(0,b.y)("redirect")||"/",N=(0,b.y)("for_pub")||"";return(0,l.useEffect)(()=>{S.current&&S.current.focus()},[]),(0,l.useEffect)(()=>{6===_.length&&O(!0)},[_]),(0,n.Y)(o.Z,{children:(0,n.FD)(i.Ay,{className:"form-x2um0M",analyticsName:"Customer Support Mode Form",action:"/api/v1/customer_support_mode",onSuccess:t=>{var e;let a=null==t||null==(e=t.body)?void 0:e.redirect;a?document.location.href=a:document.location.href=T||"/"},autoLock:!0,children:[(0,n.Y)(m.rQ,{title:"Customer support mode",description:"Be absolutely respectful to the writers on whose behalf you are working.",showClose:v,onClose:a,alignItems:"center",icon:(0,n.Y)(p.qx,{bg:"accent-red",icon:(0,n.Y)(r.A,{stroke:"var(--color-semantic-error-fg-primary)"})})}),(0,n.FD)(c.VP,{children:[h||y?(0,n.FD)(c.VP,{gap:20,padding:20,children:[h&&(0,n.FD)(f.A0,{children:[(0,n.Y)(u.JU,{children:"Enter your MFA code"}),(0,n.Y)(f.ks,{ref:S,name:"code",inputMode:"numeric",maxLength:6,placeholder:"Code",value:_,width:300,autoComplete:"off",onChange:t=>C(t.target.value)})]}),y&&(0,n.FD)(c.ov,{gap:8,direction:"row",children:[(0,n.Y)(d.S,{name:"allowAllDay",theme:"error",size:"sm",checked:w,onChange:t=>k(t)}),(0,n.Y)(g.EY.B3,{color:"secondary",children:"Allow access for the day"})]})]}):(0,n.Y)(m.q1,{}),w&&(0,n.Y)("input",{type:"hidden",name:"all_pubs",value:"true"}),(0,n.Y)("input",{type:"hidden",name:"minutes",value:w?600:30}),(0,n.Y)("input",{type:"hidden",name:"for_pub",value:N}),(0,n.Y)("input",{type:"hidden",name:"redirect",value:T}),(0,n.Y)("div",{id:"error-container"})]}),(0,n.Y)(m.jl,{direction:"column",primaryButton:(0,n.Y)(s.$n,{priority:"destructive",type:"submit",disabled:!E,children:"Enter support mode"})})]})})}},8515:function(t,e,a){a.d(e,{V:()=>o});var n=a(4006),r=a(64997),l=a(76977),i=a(66511);function o(t){let{text:e}=t;return(0,n.Y)(i.m_,{text:e,children:(0,n.Y)(l.ov,{cursor:"pointer",width:16,height:16,children:(0,n.Y)(r.A,{size:14,stroke:"var(--color-fg-secondary)"})})})}},86465:function(t,e,a){a.d(e,{I:()=>l});var n=a(4006),r=a(20500);let l=t=>{let{errors:e}=t;return e?(0,n.Y)(n.FK,{children:e.map(t=>(0,n.Y)(r.yn,{children:t},t))}):null}},60141:function(t,e,a){a.d(e,{A:()=>c});var n=a(69277),r=a(70408),l=a(32641),i=a(4006),o=a(17402),s=a(25318),d=a(65842);let c=t=>{var{details:e,disabled:a,errors:c,helpText:u,inputRef:m,label:p,name:g,paddingBottom:f,paddingTop:b,value:h,onChange:y}=t,v=(0,l._)(t,["details","disabled","errors","helpText","inputRef","label","name","paddingBottom","paddingTop","value","onChange"]);let w=(0,o.useCallback)(t=>{y(t.target.value)},[y]);return(0,i.Y)(s.D,{label:p,details:e,errors:c,helpText:u,paddingTop:b,paddingBottom:f,wrapWithLabel:!0,children:(0,i.Y)(d.ks,(0,r._)((0,n._)({},v),{ref:m,error:!!(null==c?void 0:c.length),disabled:a,name:g,value:h,onChange:w}))})}},94874:function(t,e,a){a.d(e,{F:()=>b});var n=a(69277),r=a(70408),l=a(4006),i=a(46271),o=a(94729),s=a(56804),d=a(12501),c=a(36372),u=a(70486),m=a(46453),p=a(29611),g=a(15567),f=a(28700);function b(t){let{source:e}=t,a=function(t){let{source:e}=t,a=(0,u.wA)(),l=(0,d.st)({pathname:"/api/v1/messages/dm/start",method:"POST"}),i=async t=>{let n=await l.refetch({json:{user_ids:t,source:e}});return n instanceof Error||a({type:"conversation-load_more",payload:{edge:"before",cursor:null,page:n}}),n};return(0,r._)((0,n._)({},l),{handleStart:i})}({source:e}),b=(0,p.v)(),h=(0,c.d)(),y=(0,i.Jd)(),{onboardingModal:v,requireLogin:w}=(0,m.eE)(),k=async t=>{var e;if(!y)return w?w():v?v.open():b(Error("Onboarding modal not found"),"Could not start conversation."),!1;let n=await a.handleStart(t);return n instanceof Error?(n instanceof o.fk&&(null==(e=n.body)?void 0:e.type)==="profile_not_set_up"?h.popToast(()=>(0,l.Y)(c.y,{text:"Please set up your profile before sending a message.",cta:"Set up profile",href:(0,f.W$)({utm_source:"substack",utm_campaign:"chat_dm_button",redirect:window.location}),localNavigation:!1})):b(n,"Could not start conversation."),!1):((0,s.z)((0,g.tv)(n.thread.id)),!0)};return(0,r._)((0,n._)({},a),{handleStart:k})}},17460:function(t,e,a){a.d(e,{A:()=>l});var n=a(66067),r=a.n(n);function l(t){let{only_non_ascii:e=!1,useNamedReferences:a=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t?r().encode(t||"",{useNamedReferences:a,decimal:!0,allowUnsafeSymbols:e}):t}},463:function(t,e,a){a.d(e,{P2:()=>l,sG:()=>r});var n=a(52482);function r(t){return t&&l(t).pop()||null}function l(t){return(0,n.find)(t).filter(t=>"url"===t.type&&t.href.startsWith("http"))}},38474:function(t,e,a){a.d(e,{TM:()=>f,bq:()=>m,c:()=>d,q_:()=>p});var n=a(69277),r=a(15734),l=a.n(r),i=a(82776),o=a(91809),s=a(29496);let d={attrs:{url:{default:""},isEpisode:{default:!1},imageUrl:{default:""},title:{default:""},podcastTitle:{default:""},podcastByline:{default:""},duration:{default:""},numEpisodes:{default:""},targetUrl:{default:""},releaseDate:{default:""}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDom:[{tag:"iframe.apple-podcast",getAttrs:a(78495).t}],toDOM:t=>{let{url:e,isEpisode:a}=t.attrs;return["div",{class:"apple-podcast-container","data-component-name":"ApplePodcastToDom"},["iframe",{class:"apple-podcast ".concat(a?"":"episode-list"),"data-attrs":JSON.stringify(t.attrs),src:e,frameborder:"0",allow:"autoplay *; encrypted-media *;",allowfullscreen:"true"}]]},toDOMStatic:t=>{let{imageUrl:e,isEpisode:a,podcastTitle:n,podcastByline:r,duration:l,numEpisodes:s,targetUrl:d}=t.attrs,c=t.attrs.title,u=n,m=(0,i.secondsToHHMMSS)(l/1e3);return a||(c=n,u=r,m=(0,i.pluralize)(s,"episode",{zero_fallback:"No episodes"})),(0,o.e)(e,c,u,m,{targetUrl:d})}},c=/[<iframe]?.*[src="]?(https?:\/\/(embed\.)?podcasts\.apple\.com\/([^/]+)?\/?podcast\/([^/]+)\/?(id\d+)\??(i=(\d+))?)[\S]*/,u=t=>{var e;let a=c.exec(t);return a?{match:a[0],embedLink:a[2],countryCode:a[3],slug:a[4],podcastId:null==(e=a[5])?void 0:e.substr(2),episodeId:a[7]}:{match:!1}},m=(0,s.C)({name:"applePodcast",nodeSpec:d,addCommands(){return{insertApplePodcast:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),p=function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e&&!e.nodes.applePodcast?null:u(t).match||null},g=async t=>{let e=u(t),{slug:a,podcastId:r,episodeId:i,countryCode:o}=e,s=(await l().get("/api/v1/apple_podcast").query({slug:a,podcastId:r,episodeId:i,country:o,appleUrl:t})).body;return(0,n._)({url:b(e),isEpisode:!!e.episodeId},s)},f=async function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(e?{schema:e}:await Promise.resolve().then(a.bind(a,86508))).schema;if(!n.nodes.applePodcast)throw Error("ApplePodcast node not in schema");return n.nodes.applePodcast.create(await g(t))},b=t=>{let{countryCode:e,slug:a,podcastId:n,episodeId:r}=t,l=encodeURIComponent(a||"");return"https://embed.podcasts.apple.com/".concat(e||"us","/podcast/").concat(l,"/id").concat(n).concat(r?"?i=".concat(r):"")}},79589:function(t,e,a){a.d(e,{$:()=>g,c:()=>p});var n=a(69277),r=a(50172),l=a(31583),i=a(93510),o=a(93946),s=a(82776),d=a(82061),c=a(29496),u=a(78495);let m="image-asset-error",p={attrs:{url:{default:""}},group:"block",defining:!0,parseDOM:[{tag:"div.".concat(m),getAttrs:u.t}],toDOM:t=>{if("undefined"!=typeof window)try{t.attrs.isEditor=!0;let e=document.createElement("div");return e.className=m,e.setAttribute("data-attrs",JSON.stringify(t.attrs)),(0,o.Mv)((0,r.h)(i.Q,{node:(0,n._)({},t)}),e),e}catch(e){return console.error("Error rendering ImageAssetError",e),(0,d.D)({msg:null,node:t,err:e,group:"block"})}return["div",{"data-attrs":JSON.stringify((0,n._)({},t.attrs)),"data-component-name":"AssetErrorToDOM"},["picture",["img",{src:s.MISSING_IMAGE_URL,height:s.MISSING_IMAGE_HEIGHT,width:s.MISSING_IMAGE_WIDTH}]]]},toDOMStatic:t=>["div",{"data-attrs":JSON.stringify((0,n._)({},t.attrs)),"data-component-name":"AssetErrorToDOMStatic"}]},g=(0,c.C)({name:"assetError",nodeSpec:p,addNodeView:()=>(0,l.gu)(i.Q)})},26082:function(t,e,a){a.d(e,{c:()=>m,xT:()=>p});var n=a(69277),r=a(70408),l=a(50172),i=a(31583),o=a(38893),s=a(88161),d=a(93946),c=a(82061),u=a(29496);let m={attrs:{label:{default:null},mediaUploadId:{default:null},duration:{default:null},downloadable:{default:!1},isEditorNode:{default:!1}},group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.native-audio-embed",getAttrs:a(78495).t}],toDOM:t=>{if("undefined"!=typeof window&&t.attrs.isEditorNode)try{let e=document.createElement("div");return e.className="native-audio-embed",e.setAttribute("data-attrs",JSON.stringify(t.attrs)),(0,d.Mv)((0,l.h)(o.$g,{label:t.attrs.label,src:"/api/v1/audio/upload/".concat(t.attrs.mediaUploadId,"/src"),duration:t.attrs.duration,downloadable:t.attrs.downloadable}),e),e}catch(e){return console.error("Error rendering AudioEmbedPlayer",e),(0,c.D)({msg:null,node:t,err:e,group:"block"})}return g(t)},toDOMStatic:t=>g(t)},p=(0,u.C)({name:"audio",nodeSpec:m,addNodeView:()=>(0,i.gu)(s.i),addCommands(){return{insertAudio:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:(0,r._)((0,n._)({},t),{isEditorNode:!0})})}}}}),g=t=>["div",{class:"native-audio-embed","data-component-name":"AudioPlaceholder","data-attrs":JSON.stringify(t.attrs)}]},55277:function(t,e,a){a.d(e,{c:()=>r,e4:()=>l});var n=a(29496);let r={attrs:{label:{default:null},url:{default:null},duration:{default:null}},group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.native-audio-url-embed",getAttrs:a(78495).t}],toDOM:t=>["div",{class:"native-audio-url-embed","data-attrs":JSON.stringify(t.attrs),"data-component-name":"AudioUrlPlaceholder"}]},l=(0,n.C)({name:"audioUrl",nodeSpec:r})},58588:function(t,e,a){a.d(e,{O:()=>i,c:()=>l});var n=a(82776),r=a(29496);let l={attrs:{request_id:{default:null},url:{default:null},src:{default:null},type:{default:null}},untrackedAttrs:["src"],inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"a.augmentation-placeholder",getAttrs:a(78495).t}],toDOM:t=>["a",{class:"augmentation-placeholder image-link","data-attrs":JSON.stringify(t.attrs),href:"javascript:void(0)","data-component-name":"AugmentationPlaceholderToDOM"},["img",{src:t.attrs.src||n.TRANSPARENT_IMAGE_URL}]]},i=(0,r.C)({name:"augmentation_placeholder",nodeSpec:l,addCommands(){return{insertLoadingPlaceholder:(t,e)=>a=>{let{commands:n}=a;return e?n.insertContentAt(e,{type:this.name,attrs:t}):n.insertContent({type:this.name,attrs:t})}}}})},26116:function(t,e,a){a.d(e,{c:()=>s,ez:()=>u,lQ:()=>p,pK:()=>d});var n=a(69277),r=a(70408),l=a(9036),i=a(91809),o=a(29496);let s={attrs:{url:{default:""},title:{default:""},description:{default:""},thumbnail_url:{default:""},author:{default:""},embed_url:{default:""},is_album:{default:""}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.bandcamp-wrap",getAttrs:a(78495).t}],toDOM:t=>["div",{class:"bandcamp-wrap".concat(t.attrs.is_album?" album":""),"data-attrs":JSON.stringify(t.attrs),"data-component-name":"BandcampToDOM"},["iframe",{src:t.attrs.embed_url,frameborder:"0",gesture:"media",scrolling:"no",allowfullscreen:"true"}]],toDOMStatic:t=>{let{thumbnail_url:e,author:a,title:n,description:r,url:l}=t.attrs;return(0,i.e)(e,n,(a||"").toString(),r,{targetUrl:l})}},d=(0,o.C)({name:"bandcamp",nodeSpec:s,addCommands(){return{insertBandcamp:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),c=/^.*(https?\:\/\/(\S+)?.bandcamp.com\/(...+)\/[^\/]+(\/[^\/]+)?(\?[\#]*)?(\#.*)?).*$/,u=t=>{var e;let a=c.exec(t);return null!=(e=a&&a[1])?e:null},m=async t=>{let e,i=!!(e=c.exec(t))&&"album"===e[3],o=(await Promise.resolve().then(a.t.bind(a,15734,23))).default,s="dark"===(0,l.m)(t).theme?"dark":"light",d=(await o.get("/api/v1/bandcamp").query({url:t.trim(),is_album:i,theme:s})).body;return(0,r._)((0,n._)({},d),{is_album:i})},p=async function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(e?{schema:e}:await Promise.resolve().then(a.bind(a,86508))).schema.nodes.bandcamp.create(await m(t))}},55029:function(t,e,a){a.d(e,{c:()=>l,u:()=>i});var n=a(88285),r=a(76229);let l={content:"block+",group:"block",parseDOM:[{tag:"blockquote"},{tag:"p",priority:100,getAttrs:t=>!(!t.style.marginLeft||t.style.marginLeft.startsWith("0"))&&{}}],toDOM:()=>["blockquote",0]},i=r.Ay.extend({parseHTML:()=>l.parseDOM,addCommands(){return{setBlockquote:()=>t=>{let{state:e,commands:a}=t;return!(!(0,n.rU)(e,"paragraph")||(0,n.rU)(e,"pullquote")||(0,n.rU)(e,"calloutBlock"))&&a.wrapIn(this.name)},toggleBlockquote:()=>t=>{let{state:e,commands:a}=t;return!(!(0,n.rU)(e,"paragraph")||(0,n.rU)(e,"pullquote")||(0,n.rU)(e,"calloutBlock"))&&a.toggleWrap(this.name)},unsetBlockquote:()=>t=>{let{commands:e}=t;return e.lift(this.name)}}}})},39729:function(t,e,a){a.d(e,{Sy:()=>f,c:()=>c,iK:()=>u,li:()=>p});var n=a(83673),r=a.n(n),l=a(94729),i=a(16291),o=a(29496),s=a(78495),d=a(60639);let c={attrs:{postId:{default:""},authorDid:{default:""},authorName:{default:""},authorHandle:{default:""},authorAvatarUrl:{default:""},text:{default:""},createdAt:{default:""},uri:{default:""},imageUrls:{default:[]}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDom:[{tag:"div.bluesky-wrap",getAttrs:s.t}],toDOM:t=>{var e,a,n,r;let l,i,o,s,d;return e=t,i=String(Math.random()).slice(2),o=(a=e.attrs.authorDid,n=e.attrs.postId,r=i,"https://embed.bsky.app/embed/".concat(a,"/app.bsky.feed.post/").concat(n,"?id=").concat(r)),(s=document.createElement("div")).className="bluesky-wrap outer",s.style.height="auto",s.style.display="flex",s.style.marginBottom="24px",s.dataset.attrs=JSON.stringify(e.attrs),s.setAttribute("data-component-name","BlueskyCreateBlueskyEmbed"),d=document.createElement("iframe"),l=e.attrs.postId,d.id="bluesky-".concat(l),d.setAttribute("data-bluesky-id",i),d.src=o,d.width="100%",d.style.border="none",d.style.display="block",d.style.flexGrow="1",d.frameBorder="0",d.scrolling="no",s.appendChild(d),s},toDOMStatic:t=>(function(t){var e,a,n;let r=t.attrs,l=document.createElement("div");l.className="bluesky-wrap static",l.setAttribute("data-component-name","BlueskyCreateStaticBlueskyEmbed");let o=document.createElement("div"),s=document.createElement("img");s.className="bluesky-avatar",r.authorAvatarUrl&&(s.src=r.authorAvatarUrl),o.appendChild(s);let d=document.createElement("span");d.className="bluesky-author-name",d.textContent="".concat(null!=(e=r.authorName)?e:r.authorHandle," "),o.appendChild(d);let c=document.createElement("span");c.className="bluesky-author-handle",c.textContent="@".concat(r.authorHandle),o.appendChild(c),l.appendChild(o);let u=document.createElement("div");if(u.textContent=r.text,l.appendChild(u),r.imageUrls.length>0&&r.imageUrls[0]){let t=document.createElement("img");t.src=r.imageUrls[0],l.append(t)}let m=document.createElement("div");m.className="bluesky-created-at",m.textContent=(0,i.A)(r.createdAt).toString(),l.appendChild(m);let p=document.createElement("a");return a=r.authorDid,n=r.postId,p.href="https://bsky.app/profile/".concat(a,"/post/").concat(n,"?ref_src=embed"),p.text="View on Bluesky",l.appendChild(p),l})(t)},u=(0,o.C)({name:"bluesky",nodeSpec:c,addCommands(){return{insertBluesky:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),m=/^https:\/\/bsky.app\/profile\/([^\/]+)\/post\/([^\?]+)(\?.+)?$/;function p(t){let e=m.exec(t);return m.lastIndex=0,e&&e[0]}async function g(t){var e,a,n,o,s,d,c,u,p,g,f,b,h,y;let v,w=(v=m.exec(t))&&v[1]&&v[2]?{handle:v[1],postId:v[2]}:null;if(!w)return null;let{handle:k,postId:_}=w,C=await (0,l.x6)((h=k,y=_,"https://public.api.bsky.app/xrpc/app.bsky.feed.getPostThread?uri=at://".concat(h,"/app.bsky.feed.post/").concat(y)));if("blocked"in C.thread||"notFound"in C.thread)return null;let E=null;return(null==(a=C.thread)||null==(e=a.post)?void 0:e.embed)&&((null==(n=C.thread.post.embed)?void 0:n.thumbnail)?E=null==(s=C.thread.post.embed)?void 0:s.thumbnail:(null!=(o=C.thread.post.embed.images)?o:[]).length>0&&(E=C.thread.post.embed.images[0].thumb)),{postId:_,authorDid:null!=(d=C.thread.post.author.did)?d:"",authorName:null!=(c=C.thread.post.author.displayName)?c:"",authorHandle:null!=(u=C.thread.post.author.handle)?u:"",authorAvatarUrl:null!=(p=C.thread.post.author.avatar)?p:"",text:null!=(g=C.thread.post.record.text)?g:"",createdAt:(0,i.A)(null!=(f=C.thread.post.record.createdAt)?f:"").toISOString(),uri:null!=(b=C.thread.post.uri)?b:"",imageUrls:r()([E])}}async function f(t){var e;let{customSchema:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(n?{schema:n}:await Promise.resolve().then(a.bind(a,86508))).schema;if(!(null==(e=r.nodes.bluesky)?void 0:e.create))throw new d.uV("Bluesky node schema is missing");return r.nodes.bluesky.create(await g(t))}},82086:function(t,e,a){a.d(e,{Tf:()=>O,c:()=>C,z_:()=>E});var n=a(69277),r=a(70408),l=a(79785),i=a(86500),o=a(68349),s=a(98111),d=a(39318),c=a(49807),u=a(82776),m=a(57324),p=a(4518),g=a(29496);function f(){let t=(0,l._)(["Thanks for reading ","! Subscribe for free to receive new posts and support my work."]);return f=function(){return t},t}function b(){let t=(0,l._)([""," is a reader-supported publication. To receive new posts and support my work, consider becoming a free or paid subscriber."]);return b=function(){return t},t}function h(){let t=(0,l._)(["","! This post is public so feel free to share it."]);return h=function(){return t},t}function y(){let t=(0,l._)(["Share ",""]);return y=function(){return t},t}function v(){let t=(0,l._)(["Give a gift subscription"]);return v=function(){return t},t}function w(){let t=(0,l._)(["Get ","% off a group subscription"]);return w=function(){return t},t}function k(){let t=(0,l._)(["Get a group subscription"]);return k=function(){return t},t}function _(){let t=(0,l._)(["Start writing today. Use the button below to create a Substack of your own."]);return _=function(){return t},t}let C={attrs:{url:{default:null},text:{default:null},action:{default:null},class:{default:null}},inline:!1,atom:!0,group:"block",draggable:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"p.button-wrapper[data-attrs]",priority:100,getAttrs:a(78495).t}],toDOM:t=>O(t)},E=(0,g.C)({name:"button",nodeSpec:C,addCommands(){var t=this;return{insertSubscribeButton:t=>e=>{let{commands:a}=e,n={url:s.T.CHECKOUT_URL,text:(0,u.getSubscribeText)(t,{now:!0})};return a.insertContent({type:this.name,attrs:n})},insertCustomButtonEditorV2:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})},insertSubscribeButtonWithPreamble:t=>e=>{let{commands:a,editor:n}=e,{iTemplate:r,iString:l}=I18N.i({pub:t}),i=t.author_name===t.name?l("enabled"!==t.payments_state?"Thanks for reading! Subscribe for free to receive new posts and support my work.":"This Substack is reader-supported. To receive new posts and support my work, consider becoming a free or paid subscriber."):"enabled"!==t.payments_state?r(f(),t.name):r(b(),t.name),o={url:s.T.CHECKOUT_URL,text:(0,u.getSubscribeText)(t),language:t.language};return a.insertContent({type:"subscribeWidget",attrs:o,content:[n.schema.nodes.ctaCaption.create(null,[n.schema.text(i)]).toJSON()]})},insertCaptionedShareButton:t=>e=>{let{commands:a,editor:n}=e,{iString:r,iTemplate:l}=I18N.i({pub:t}),i=l(h(),t.author_name===t.name?"Thanks for reading":"Thanks for reading ".concat(t.name)),o={url:s.T.SHARE_URL,text:r("Share")};return a.insertContent({type:"captionedShareButton",attrs:o,content:[n.state.schema.nodes.ctaCaption.create(null,[n.state.schema.text(i)]).toJSON()]})},insertSharePostButton:t=>e=>{let{commands:a}=e,{iString:n}=I18N.i({pub:t}),r={url:s.T.SHARE_URL,text:n("Share")};return a.insertContent({type:this.name,attrs:r})},insertSharePubButton:t=>e=>{let{commands:a}=e,{iTemplate:n}=I18N.i({pub:t}),r={url:s.T.SHARE_PUB_URL,text:n(y(),t.name)};return a.insertContent({type:this.name,attrs:r})},insertCommentsButton:t=>e=>{let{commands:a}=e,{iString:n}=I18N.i({pub:t}),r={url:s.T.HALF_MAGIC_COMMENTS_URL,text:n("Leave a comment")};return a.insertContent({type:this.name,attrs:r})},insertGiftButton:t=>e=>{let{commands:a}=e,{iTemplate:n}=I18N.i({pub:t}),r={url:"".concat(s.T.CHECKOUT_URL,"&gift=true"),text:(0,u.getSubscriptionSentenceWithCustomWords)(t,()=>n(v()),t=>"Give a gift ".concat(t.subscription))};return a.insertContent({type:this.name,attrs:r})},insertDonateButton:t=>e=>{let{commands:a}=e,{iString:n}=I18N.i({pub:t}),r={url:"".concat(s.T.CHECKOUT_URL,"&donate=true"),text:n("Donate Subscriptions")};return a.insertContent({type:this.name,attrs:r})},insertSurveyButton:(t,e,a)=>n=>{let{commands:r}=n;(0,i.u4)(i.qY.READER_SURVEY_LINKED_IN_POST,{editorVersion:"2",surveyId:e.id});let l={url:"".concat((0,c.gAK)(t,e.id)),text:a};return r.insertContent({type:this.name,attrs:l})},insertGroupSubscriptionButton:t=>{let{publication:e}=t;return t=>{let{commands:a}=t,{iTemplate:n}=I18N.i({pub:e}),r=e.default_group_coupon,l={url:"".concat(s.T.CHECKOUT_URL,"group=true").concat(r?"&coupon=".concat(r):""),text:(0,u.getSubscriptionSentenceWithCustomWords)(e,()=>r&&e.default_group_coupon_percent_off?n(w(),e.default_group_coupon_percent_off.split(".")[0]):n(k()),t=>r&&e.default_group_coupon_percent_off?"Get ".concat(e.default_group_coupon_percent_off.split(".")[0],"% off a group ").concat(t.subscription):"Get a group ".concat(t.subscription))};return a.insertContent({type:this.name,attrs:l})}},insertCoupon:function(e,a){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i=>{let{commands:s}=i,c={url:(0,d.yRP)("".concat(e.base_url,"/subscribe"),(0,r._)((0,n._)({coupon:a.id},a.group_only&&{group:!0}),{utm_content:l.postId})),text:"Get ".concat((0,o.zY)(a))};return s.insertContent({type:t.name,attrs:c})}},insertReferralButton:t=>e=>{let{commands:a}=e,{iString:n}=I18N.i({pub:t}),r={url:"".concat(s.T.LEADERBOARD_URL,"&utm_source=").concat(m.VU.post),text:n("Refer a friend")};return a.insertContent({type:this.name,attrs:r})},insertCaptionedWriterReferralButtonV2:t=>{let{writerReferralCode:e,publication:a,postId:n}=t;return t=>{let{commands:r,state:l,dispatch:i}=t;if(!(0,p.c)(l,l.schema.nodes.button))return!1;let{iString:o,iTemplate:s}=I18N.i({pub:a}),c=s(_()),u={url:"".concat((0,d.gWk)(e||""),"?utm_source=").concat(m.VU.substack,"&utm_context=").concat(m.rw.post,"&utm_content=").concat(n,"&utm_campaign=").concat(m._9.writerReferralButton),text:o("Start a Substack")},g=l.schema.nodes.captionedWriterReferralButton.create(u,l.schema.nodes.ctaCaption.create(null,[l.schema.text(c)]));return!i||r.insertContent(g.toJSON())}}}}}),O=t=>{let e=document.createElement("span");e.textContent=t.attrs.text;let a=document.createElement("a");a.className="button primary",t.attrs.class&&(a.className+=" ".concat(t.attrs.class)),a.href=t.attrs.url,a.appendChild(e),a.addEventListener("click",t=>{/^.*%%.*%%/.test(a.href)&&(t.preventDefault(),(0,u.handleDocumentLinkClick)(a.href))});let n=document.createElement("p");return n.className="button-wrapper",n.setAttribute("data-attrs",JSON.stringify(t.attrs)),n.setAttribute("data-component-name","ButtonCreateButton"),n.appendChild(a),n}},32422:function(t,e,a){a.d(e,{c:()=>r,p:()=>l});var n=a(29496);let r={content:"text*",group:"block",selectable:!0,defining:!0,isolating:!0,parseDOM:[{tag:"figcaption"}],toDOM:()=>["figcaption",{class:"image-caption"},0]},l=(0,n.C)({name:"caption",nodeSpec:r})},82311:function(t,e,a){a.d(e,{Pr:()=>c,c:()=>s,k5:()=>u});var n=a(69277),r=a(98111),l=a(82086),i=a(29496),o=a(78495);let s=t=>({content:"ctaCaption",attrs:{url:{default:null},text:{default:null}},inline:!1,group:"block",draggable:!0,atom:!1,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.captioned-button-wrap",getAttrs:o.t}],toDOM:e=>{let a=document.createElement("div");a.className="captioned-button-wrap",a.setAttribute("data-attrs",JSON.stringify(e.attrs)),a.setAttribute("data-component-name","CaptionedButtonToDOM");let r=document.createElement("div");r.className="preamble";let i=(0,l.Tf)({attrs:(0,n._)({},e.attrs,t)});return a.appendChild(r),a.appendChild(i),{dom:a,contentDOM:r}}}),d=t=>{let{substitutionAttrs:e,name:a}=t;return(0,i.C)({name:a,nodeSpec:s(e)})},c=d({name:"captionedShareButton",substitutionAttrs:{url:r.T.SHARE_URL}}),u=d({name:"captionedWriterReferralButton",substitutionAttrs:{hasDynamicSubstitutions:!1}})},34202:function(t,e,a){a.d(e,{c:()=>r,f:()=>l});var n=a(29496);let r={content:"block caption*",atom:!1,selectable:!0,isolating:!1,defining:!0,draggable:!0,group:"block",parseDOM:[{tag:"figure"}],toDOM:()=>["div",{class:"captioned-image-container"},["figure",0]],toDOMStatic:()=>["div",{class:"captioned-image-container-static"},["figure",0]]},l=(0,n.C)({name:"captionedImage",nodeSpec:r})},83485:function(t,e,a){a.d(e,{c:()=>c,g:()=>u});var n=a(69277),r=a(70408),l=a(50172),i=a(98107),o=a(93946),s=a(82061),d=a(29496);let c={attrs:{symbol:{default:""}},atom:!0,editable:!1,selectable:!0,isolating:!1,defining:!0,draggable:!1,inline:!0,group:"inline",parseDOM:[{tag:".cashtag-wrap",getAttrs:t=>{try{return JSON.parse(t.getElementsByTagName("a")[0].getAttribute("data-attrs"))}catch(t){return!1}}}],toDOM:t=>{if("undefined"!=typeof window)try{let e=document.createElement("span");return e.className="cashtag-wrap",(0,o.Mv)((0,l.h)(i.A,{symbol:t.attrs.symbol.trim()}),e),e}catch(e){return console.error("Error rendering Cashtag",e),(0,s.D)({msg:null,node:t,err:e,group:"inline"})}return["span",{class:"cashtag-wrap","data-attrs":JSON.stringify(t.attrs),"data-component-name":"CashtagToDOM"}]},toDOMStatic:t=>["span",{class:"cashtag-wrap","data-component-name":"CashtagToDOMStatic","data-attrs":JSON.stringify((0,r._)((0,n._)({},t.attrs),{prependSymbol:!0,isStatic:!0}))}]},u=(0,d.C)({name:"cashtag",nodeSpec:c})},30909:function(t,e,a){a.d(e,{A:()=>o,G:()=>s});var n=a(65768),r=a(8037),l=a(29496);let i=new n.Ay({actionButtonAttr:"href",substackType:"comic",mimeTypesToSignature:r.Rq,actionButtonText:"Read now"}),o=i,s=(0,l.C)({name:"comic",nodeSpec:i.nodeSpec})},42985:function(t,e,a){a.d(e,{XB:()=>f,_k:()=>p,c:()=>m,w1:()=>h,x7:()=>v});var n=a(69277),r=a(50172),l=a(47970),i=a(93946),o=a(70189),s=a(49807),d=a(57324),c=a(82061),u=a(29496);let m={attrs:{url:{default:""},commentId:{default:null},comment:{default:null}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.comment",getAttrs:t=>{if(t instanceof HTMLElement)try{var e;return JSON.parse(null!=(e=t.getAttribute("data-attrs"))?e:"")}catch(t){}return!1}}],toDOM:t=>{if("undefined"!=typeof window)try{let e=document.createElement("div");return Object.assign(e,{className:"comment","data-attrs":JSON.stringify(t.attrs)}),(0,i.Mv)((0,r.h)(l.H,{commentId:t.attrs.commentId}),e),e}catch(e){return console.error("Error rendering CommentEmbed",e),(0,c.D)({msg:null,node:t,err:e,group:"block"})}return g(t)},toDOMStatic:t=>g(t)},p=(0,u.C)({name:"comment",nodeSpec:m,addCommands(){return{insertComment:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}});function g(t){return["div",{class:"comment","data-attrs":JSON.stringify(t.attrs),"data-component-name":"CommentPlaceholder"}]}function f(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e&&!e.nodes.comment)return null;let a=(0,s.Dlv)(t);return a&&(0,o.EX)(a.pathname)?t:null}async function b(t){let e,r=(await Promise.resolve().then(a.t.bind(a,15734,23))).default,l=(0,s.Dlv)(t),i=l&&(0,o.EX)(l.pathname);if(!i)return console.warn("pathname did not match"),null;try{let{body:{item:{comment:{id:t,date:a,edited_at:n,body:l,body_json:o,restacks:s,reaction_count:d,attachments:c,name:u,user_id:m,photo_url:p,user_bestseller_tier:g,userStatus:f}}}}=await r.get("/api/v1/reader/comment/".concat(i.id));e={comment:{id:t,date:a,edited_at:n,body:l,body_json:o,restacks:s,reaction_count:d,attachments:c,name:u,user_id:m,photo_url:p,user_bestseller_tier:g,userStatus:f}}}catch(t){return console.warn(t),null}let c=(0,s.AF5)(i,{urlParams:{utm_source:d.VU.commentEmbed}});return(0,n._)({url:c,commentId:i.id},e)}async function h(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(e?{schema:e}:await Promise.resolve().then(a.bind(a,86508))).schema,r=await b(t);return r?n.nodes.comment.create(r):null}async function y(){let t,e=(await Promise.resolve().then(a.t.bind(a,15734,23))).default;try{t=(await e.get("/api/v1/reader/feed/last-note")).body;let a=(0,s.Zgx)(t);return b(a)}catch(t){return null}}async function v(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(e?{schema:e}:await Promise.resolve().then(a.bind(a,86508))).schema,r=await y();return r?n.nodes.comment.create(r):null}},17031:function(t,e,a){a.d(e,{D:()=>c});var n=a(69277),r=a(70408),l=a(11993),i=a(95147),o=a(41245);let s={large:{desktop:{charactersTruncateTo:800,charactersTruncateIfOver:860,linesTruncateTo:8,linesTruncateIfOver:9},mobile:{charactersTruncateTo:440,charactersTruncateIfOver:500,linesTruncateTo:8,linesTruncateIfOver:9}},medium:{desktop:{charactersTruncateTo:500,charactersTruncateIfOver:560,linesTruncateTo:6,linesTruncateIfOver:8},mobile:{charactersTruncateTo:320,charactersTruncateIfOver:420,linesTruncateTo:6,linesTruncateIfOver:8}},small:{desktop:{charactersTruncateTo:340,charactersTruncateIfOver:400,linesTruncateTo:4,linesTruncateIfOver:6},mobile:{charactersTruncateTo:210,charactersTruncateIfOver:210,linesTruncateTo:4,linesTruncateIfOver:4}}},d={desktop:{TRUNCATED_LINES:32,TRUNCATED_CHARACTERS:2400},mobile:{TRUNCATED_LINES:20,TRUNCATED_CHARACTERS:1e3}};function c(t,e){var a,c,u,m;let{truncationProfile:p="medium",isMobile:g}=e,{charactersTruncateTo:f,charactersTruncateIfOver:b,linesTruncateTo:h,linesTruncateIfOver:y}=s[c=t,"small"!==(u=p)&&(null==(m=c.attachments)?void 0:m.length)?"small":u][g?"mobile":"desktop"],v=function t(e){let a=null;if(e)if(a=(0,r._)((0,n._)({},e),{content:void 0,text:void 0}),null==e?void 0:e.content)for(let n of(a.content=[],e.content)){let e=t(n);e&&a.content.push(e)}else{var i,o;let t=null==(i=e.marks)?void 0:i.find(t=>"link"===t.type);(null==t||null==(o=t.attrs)?void 0:o.href)?a.text=(0,l.H)(t.attrs.href):a.text=e.text}return a}(null!=(a=null==t?void 0:t.body_json)?a:(null==t?void 0:t.body)?{type:"doc",attrs:{schemaVersion:"v1"},content:t.body.split("\n\n").map(t=>({type:"paragraph",content:[{type:"text",text:t}]}))}:null),w=(0,i.B)(v)>b,k=(0,i.M)(v)>y;if(!v||!(w||k))return{bodyJson:v,truncatedBodyJson:v,isTruncated:!1,shouldExpandInline:!1};let _=v,C=!1,E=0;if(w){let t=(0,o.x)(_,{limit:f});_=t.doc,C=t.isTruncated,E=(0,i.B)(v)-(0,i.B)(_)}let O=!1,S=0;if(k&&_){let t=(0,o.Z)(_,h);_=t.doc,O=t.isTruncated,S=(0,i.M)(v)-(0,i.M)(_)}return{bodyJson:v,truncatedBodyJson:_,isTruncated:C||O,shouldExpandInline:S<d[g?"mobile":"desktop"].TRUNCATED_LINES&&E<d[g?"mobile":"desktop"].TRUNCATED_CHARACTERS}}},79431:function(t,e,a){a.d(e,{Bp:()=>b,c:()=>c,e$:()=>u,so:()=>y});var n=a(50172),r=a(9751),l=a(93946),i=a(49807),o=a(57324),s=a(82061),d=a(29496);let c={attrs:{url:{default:""},subdomain:{default:null},pub:{default:null}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.community-chat",getAttrs:t=>{if(t instanceof HTMLElement)try{var e;return JSON.parse(null!=(e=t.getAttribute("data-attrs"))?e:"")}catch(t){}return!1}}],toDOM:t=>{if("undefined"!=typeof window)try{let e=document.createElement("div");if(Object.assign(e,{className:"community-chat","data-attrs":JSON.stringify(t.attrs)}),!t.attrs.pub||!t.attrs.subdomain){let t=document.createElement("div");return t.innerText="Could not load subscriber chat link",e.appendChild(t),e}return(0,l.Mv)((0,n.h)(r.b,{pub:t.attrs.pub,subdomain:t.attrs.subdomain}),e),e}catch(e){return console.error("Error rendering CommunityChatEmbed",e),(0,s.D)({msg:null,node:t,err:e,group:"block"})}return m(t)},toDOMStatic:t=>m(t)},u=(0,d.C)({name:"communityChat",nodeSpec:c,addCommands(){return{insertCommunityChat:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})},insertCommunityChatEmbed:t=>e=>{var a,n;let{commands:r}=e,l={url:(0,i.xWO)({pubKey:t.subdomain,utm_source:o.VU.chatEmbed}),subdomain:t.subdomain,pub:{id:t.id,name:t.name,author_name:null!=(a=t.primary_profile_name)?a:t.author_name,author_photo_url:null!=(n=t.primary_profile_photo_url)?n:t.author_photo_url}};return r.insertContent({type:this.name,attrs:l})},insertVisitThreadButton:t=>e=>{let{commands:a}=e;return a.insertCommunityChatEmbed(t)}}}});function m(t){return["div",{class:"community-chat","data-attrs":JSON.stringify(t.attrs),"data-component-name":"CommunityChatRenderPlaceholder"}]}let p=/^https?:\/\/open\.substack\.com(?:\.localhost:5000)?\/pub\/([^/]+)\/chat(\?.*)?$/,g=/^https?:\/\/([^.]+)\.substack\.com(?:\.localhost:5000)?\/chat(\?.*)?$/,f=/^https?:\/\/substack\.com(?:\.localhost:5000)?\/chat\/(\d+)/;function b(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e&&!e.nodes.communityChat)return null;let a=(0,i.Dlv)(t);return a&&a.pathname.match(/^(\/pub\/[^/]+)?\/chat($|\/)/)?t:null}async function h(t){var e,n,r;let l,s=(await Promise.resolve().then(a.t.bind(a,15734,23))).default,d=(l=(e=t).match(p))||(l=e.match(g))?null!=(n=l[1])?n:null:null,c=null;try{if(d){let{body:e}=await s.get("/api/v1/publication/chat-embed").query({subdomain:d,url:t});c=e}else{let e,a=(e=t.match(f))&&null!=(r=e[1])?r:null;if(a){let t=await s.get("/api/v1/publication/public/".concat(a));c=t.body.pub,d=t.body.pub.subdomain}}}catch(t){}return c?{url:(0,i.xWO)({pubKey:c.subdomain,utm_source:o.VU.chatEmbed}),subdomain:d,pub:c}:null}async function y(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(e?{schema:e}:await Promise.resolve().then(a.bind(a,86508))).schema,r=await h(t);return r?n.nodes.communityChat.create(r):null}},45595:function(t,e,a){a.d(e,{RD:()=>y,c:()=>g,iH:()=>f,oM:()=>w});var n=a(69277),r=a(70408),l=a(50172),i=a(31583),o=a(73577),s=a(83427),d=a(93946),c=a(49807),u=a(57324),m=a(82061),p=a(29496);let g={attrs:{url:{default:""},postId:{default:null},communityPost:{default:null},author:{default:null}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.community-post",getAttrs:t=>{if(t instanceof HTMLElement)try{var e;return JSON.parse(null!=(e=t.getAttribute("data-attrs"))?e:"")}catch(t){}return!1}}],toDOM:t=>{if("undefined"!=typeof window)try{let e=document.createElement("div");return Object.assign(e,{className:"community-post","data-attrs":JSON.stringify(t.attrs)}),(0,d.Mv)((0,l.h)(s.B,{postId:t.attrs.postId}),e),e}catch(e){return console.error("Error rendering CommunityPostEmbed",e),(0,m.D)({msg:null,node:t,err:e,group:"block"})}return b(t)},toDOMStatic:t=>b(t)},f=(0,p.C)({name:"communityPost",nodeSpec:g,addCommands(){return{insertCommunityPost:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}},addNodeView:()=>(0,i.gu)(o.v)});function b(t){return["div",{class:"community-post","data-attrs":JSON.stringify(t.attrs),"data-component-name":"CommunityPostPlaceholder"}]}let h=/^\/chat(?:\/\d+)?\/posts?\/([-A-Fa-f0-9]+)$/;function y(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e&&!e.nodes.communityPost)return null;let a=(0,c.Dlv)(t);return a&&a.pathname.match(h)?t:null}async function v(t){var e,l;let i,o=(await Promise.resolve().then(a.t.bind(a,15734,23))).default,s=(0,c.Dlv)(t),d=s&&(null==(e=s.pathname.match(h))?void 0:e[1]);if(!d)return null;try{i=(await o.get("/api/v1/community/posts/".concat(d))).body}catch(t){if(!(t instanceof Error))return null;{let e=t.response;if(402!==e.status||null==(l=e.body)||!l.status)return null;i=null==e?void 0:e.body}}let{user:m,communityPost:{id:p,publication_id:g,body:f,audience:b,type:y,media_assets:v,link_url:w,threadMediaUploads:k},status:_}=i,C={author:m},E=(null==k?void 0:k.length)&&k[0]?k[0].mediaUpload:null;"all_subscribers"!==b||_&&"FREE_SUBSCRIPTION_REQUIRED"!==_||(C=(0,r._)((0,n._)({},C),{communityPost:{id:p,publication_id:g,body:f,audience:b,type:y,media_assets:v,threadMediaUploads:E?[{mediaUpload:E}]:[],link_url:w?(0,c.yRP)(w,{utm_source:u.VU.postEmbed}):null}}));let O=(0,c.sWz)({postId:d,utm_source:u.VU.threadEmbed});return(0,n._)({url:O,postId:d},C)}async function w(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(e?{schema:e}:await Promise.resolve().then(a.bind(a,86508))).schema,r=await v(t);return r?n.nodes.communityPost.create(r):null}},60282:function(t,e,a){a.d(e,{c:()=>r,x:()=>l});var n=a(29496);let r={content:"text*",group:"block",draggable:!1,selectable:!0,isolating:!0,defining:!0,atom:!1,parseDOM:[{tag:"p.cta-caption"}],toDOM:()=>["p",{class:"cta-caption"},0]},l=(0,n.C)({name:"ctaCaption",nodeSpec:r})},70679:function(t,e,a){a.d(e,{I8:()=>s,c:()=>o,eZ:()=>p,nV:()=>b,t7:()=>u});var n=a(99851),r=a(39318),l=a(8283),i=a(29496);let o={attrs:{url:{default:""},thumbnail_url:{default:""},thumbnail_url_full:{default:""},height:{default:""},title:{default:""},description:{default:""}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDom:[{tag:"div.datawrapper-wrap",getAttrs:a(78495).t}],toDOM:t=>f(t),toDOMStatic:t=>g(t)},s=(0,i.C)({name:"datawrapper",nodeSpec:o,addCommands(){return{insertDatawrapper:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),d=/^.*https?:\/\/datawrapper\.dwcdn\.net\/.*$/,c=/^.*https?:\/\/(www\.)?datawrapper.de\/_\/.*$/,u=t=>{let e=d.exec(t);if(e)return e[0];let a=c.exec(t);return a&&a[0]},m=async t=>{let e=(await Promise.resolve().then(a.t.bind(a,15734,23))).default;return(await e.get("/api/v1/datawrapper-embed").query({url:t.trim()})).body},p=async function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(e?{schema:e}:await Promise.resolve().then(a.bind(a,86508))).schema;if(!n.nodes.datawrapper)throw Error("Datawrapper node not found in schema");return n.nodes.datawrapper.create(await m(t))},g=function(t){let{}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=document.createElement("div");e.className="datawrapper-wrap static",e.setAttribute("data-component-name","DatawrapperToDOMStatic");let a=document.createElement("a");if(a.href=t.attrs.url.replace(/embed\//,""),a.setAttribute("target","_blank"),t.attrs.title){let a=document.createElement("div");a.className="datawrapper-title",a.innerHTML=t.attrs.title,e.appendChild(a)}if(t.attrs.description){let a=document.createElement("div");a.className="datawrapper-description",a.innerHTML=t.attrs.description,e.appendChild(a)}let n=document.createElement("div"),l=document.createElement("img");return l.className="datawrapper-wrap thumbnail",l.src=(0,r.dJ9)(t.attrs.thumbnail_url,640),l.style.backgroundImage="url(".concat(t.attrs.thumbnail_url,")"),t.attrs.belowTheFold&&l.setAttribute("loading","lazy"),a.append(l),n.append(a),e.appendChild(n),e},f=t=>{let e=document.createElement("div");e.id="datawrapper-iframe",e.className="datawrapper-wrap outer",e.dataset.attrs=JSON.stringify(t.attrs),e.setAttribute("data-component-name","DatawrapperToDOM");let a=document.createElement("iframe");a.id="iframe-datawrapper",a.className="datawrapper-iframe",a.src=t.attrs.url,a.width="730",a.height=t.attrs.height||"455",a.frameBorder="0",a.scrolling="no",t.attrs.belowTheFold&&a.setAttribute("loading","lazy"),e.appendChild(a);let n=document.createElement("script");return n.type="text/javascript",n.text=l.I,e.appendChild(n),e};class b{constructor(t){(0,n._)(this,"dom",void 0);const e=f(t),a=e.querySelector(".datawrapper-iframe"),r=document.createElement("div");r.className="datawrapper-screen",r.addEventListener("dblclick",()=>{var t;r.classList.add("sunken"),null==(t=a.focus)||t.call(a)}),null==a||a.addEventListener("blur",()=>{r.classList.remove("sunken")}),e.appendChild(r),this.dom=e}}},21577:function(t,e,a){a.d(e,{TG:()=>O,c:()=>k,ed:()=>_,lL:()=>E});var n=a(69277),r=a(70408),l=a(32641),i=a(50172),o=a(26469),s=a(31583),d=a(44383),c=a.n(d),u=a(15734),m=a.n(u),p=a(16460),g=a(47074),f=a(68349),b=a(93946),h=a(49807),y=a(82061),v=a(29496);let w="digest-post-embed",k={attrs:{nodeId:{default:null},caption:{default:null},cta:{default:null},showBylines:{default:!0},size:{default:null},isEditorNode:{default:!1},title:{default:null},publishedBylines:{default:null},post_date:{default:null},cover_image:{default:null},cover_image_alt:{default:null},canonical_url:{default:null},section_name:{default:null},video_upload_id:{default:null},id:{default:null},type:{default:null},reaction_count:{default:null},comment_count:{default:null},publication_id:{default:null},publication_name:{default:null},publication_logo_url:{default:null},belowTheFold:{default:!1},youtube_url:{default:null},show_links:{default:null},feed_url:{default:null}},group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,editable:!1,parseDOM:[{tag:".".concat(w),getAttrs:t=>{if("string"==typeof t)return!1;try{var e;let a=JSON.parse(null!=(e=t.getAttribute("data-attrs"))?e:"{}");return(0,r._)((0,n._)({},a),{nodeId:(0,f.QT)()})}catch(t){return!1}}}],toDOM:t=>{if("undefined"!=typeof window&&t.attrs.isEditorNode)try{let e=document.createElement("div");return e.className=w,e.setAttribute("data-attrs",JSON.stringify(t.attrs)),(0,b.Mv)((0,i.h)(p.S,(0,r._)((0,n._)({},t.attrs),{caption:t.attrs.caption,cta:t.attrs.cta,showBylines:t.attrs.showBylines,size:t.attrs.size||void 0,isEditor:!0,pub:window._preloads.pub})),e),e}catch(e){return console.error("Error rendering DigestPostEmbedWeb",e),(0,y.D)({msg:null,node:t,err:e,group:"block"})}return C(t)},toDOMStatic:t=>["div",{class:w,"data-attrs":JSON.stringify((0,n._)({isEmail:!0},t.attrs))}]},_=(0,v.C)({name:"digestPostEmbed",nodeSpec:k,addNodeView:()=>(0,s.gu)(g.m),addCommands:()=>({convertDigestPostEmbedToLinkV2:t=>{let{pos:e,url:a}=t;return t=>{let{dispatch:n,state:r,chain:l}=t;if(n){let t=r.tr,n=e+a.length;return l().setNodeSelection(e).deleteSelection().command(t=>{let{tr:n}=t;return n.insertText(a,e),!0}).command(t=>{let{tr:l}=t;return r.schema.marks.link?(l.addMark(e,n+1,r.schema.marks.link.create({text:a,href:a})),!0):(console.warn("Link mark not in schema, cannot convert digest to v2"),!1)}).setTextSelection(o.U3.create(t.doc,e,n+1)).scrollIntoView().focus(n+2).run()}return!0}},convertDigestPostEmbedToEmbeddedPostV2:t=>{let{pos:e,attrs:a}=t;return t=>{let{dispatch:n,chain:r}=t;if(n){let t={id:a.id,url:a.url,title:a.title,publication_id:a.publication_id,publication_name:a.publication_name,publication_logo_url:a.publication_logo_url,date:a.post_date,comment_count:a.comment_count,bylines:a.publishedBylines};return r().setNodeSelection(e).deleteCurrentNode().insertContent({type:"embeddedPost",attrs:t}).run()}return!0}}})}),C=t=>["div",{class:w,"data-attrs":JSON.stringify(t.attrs)}],E=function(t){var e,a,n,r;let{customSchema:l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(l&&!l.nodes.digestPostEmbed)return null;let i=(0,h.Dlv)(t);if(!i)return null;let o=(0,h.JQq)({url:t,currentSubdomain:null==(a=window._preloads)||null==(e=a.pub)?void 0:e.subdomain,currentCustomDomain:null==(r=window._preloads)||null==(n=r.pub)?void 0:n.custom_domain});return i&&(i.pathname.startsWith("/p/")||(0,h.Sns)(i))&&o?t:null},O=async t=>{let{pub:e,post:a}=(await m().get("/api/v1/posts/digest_embed").query({url:t.trim()})).body,{truncated_body_text:i}=a,o=(0,l._)(a,["truncated_body_text"]),{id:s,name:d,logo_url:u}=e;a.is_draft&&alert("This post has not been published yet. Check that the embed looks correct before publishing.");let p=c()(o,["title","publishedBylines","post_date","cover_image","cover_image_alt","canonical_url","section_name","id","type","reaction_count","comment_count","video_upload_id","youtube_url","show_links","feed_url"]);return(0,r._)((0,n._)({caption:null!=i?i:"",cta:a.video_upload_id?"Watch now":"podcast"===a.type?"Listen now":"Read full story",size:"lg",isEditor:!0},p),{publishedBylines:p.publishedBylines.map(t=>c()(t,["id","name","bio","photo_url","is_guest","bestseller_tier","primaryPublicationSubscribeUrl","primaryPublicationUrl","primaryPublicationName","primaryPublicationId"])),publication_id:s,publication_name:d,publication_logo_url:null!=u?u:""})}},85052:function(t,e,a){a.d(e,{FB:()=>h,c:()=>f,eW:()=>b});var n=a(69277),r=a(70408),l=a(50172),i=a(88285),o=a(31583),s=a(57194),d=a(93946),c=a(65112),u=a(82061),m=a(33333),p=a(29496);let g="directMessage",f={name:g,group:"block",selectable:!0,inline:!1,draggable:!0,atom:!0,attrs:(0,c.lh)({attrs:{userId:{default:null,keepOnSplit:!1},userName:{default:null,keepOnSplit:!1},canDm:{default:null,keepOnSplit:!1},dmUpgradeOptions:{default:null,keepOnSplit:!1},isEditorNode:{default:!1,keepOnSplit:!1}}}),parseDOM:[{tag:"div.directMessage",getAttrs:t=>{try{if(t instanceof HTMLElement){let e=t.getAttribute("data-attrs");if(e)return JSON.parse(e)}}catch(t){}return!1}}],toDOM:t=>{if("undefined"!=typeof window&&t.attrs.isEditorNode)try{t.attrs.isEditor=!0;let e=document.createElement("div");return e.className=g,e.setAttribute("data-attrs",JSON.stringify(t.attrs)),(0,d.Mv)((0,l.h)(s.u,{node:(0,n._)({},t)}),e),e}catch(e){return console.error("Error rendering DirectMessageEditor",e),(0,u.D)({msg:null,node:t,err:e,group:"block"})}return["div",{class:"".concat(g," button"),"data-attrs":JSON.stringify((0,n._)({},t.attrs)),"data-component-name":"DirectMessageToDOM"}]},toDOMStatic:t=>["div",{class:g,"data-attrs":JSON.stringify((0,r._)((0,n._)({},t.attrs),{isEmail:!0})),"data-component-name":"DirectMessageToDOMStatic"}]},b=i.YY.create({name:"directMessageExtension",addCommands:()=>({insertDirectMessage:t=>e=>{let{dispatch:a,state:n}=e,{user:r}=t,l={userName:r.name,userId:r.id,isEditorNode:!0};return a&&a((0,m.DL)(n,n.schema.nodes.directMessage.create(l))),!0}})}),h=(0,p.C)({name:"directMessage",nodeSpec:f,addCommands:b.addCommands,addNodeView:()=>(0,o.gu)(s.u)})},26746:function(t,e,a){a.d(e,{A:()=>o,F:()=>s});var n=a(65768),r=a(8037),l=a(29496);let i=new n.Ay({actionButtonAttr:null,substackType:"ebook",mimeTypesToSignature:r.qy,actionButtonText:null}),o=i,s=(0,l.C)({name:"ebook",nodeSpec:i.nodeSpec})},97966:function(t,e,a){a.d(e,{TG:()=>u,Xs:()=>g,c:()=>c,iO:()=>m});var n=a(69277),r=a(70408),l=a(39318),i=a(49807),o=a(82776),s=a(57324),d=a(29496);let c={attrs:{id:{default:null},url:{default:null},publication_id:{default:null},publication_name:{default:null},publication_logo_url:{default:null},title:{default:null},truncated_body_text:{default:null},date:{default:null},like_count:{default:null},comment_count:{default:null},bylines:{default:null},utm_campaign:{default:null},belowTheFold:{default:!1},type:{default:null},language:{default:"en"}},untrackedAttrs:["truncated_body_text","bylines"],inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.embedded-post-wrap",getAttrs:a(78495).t}],toDOM:t=>{let{publication_logo_url:e,publication_name:a,title:n,truncated_body_text:r,url:i,bylines:d,date:c,like_count:u,comment_count:m,utm_campaign:p,id:g,type:f,language:b}=t.attrs,{iString:h}=I18N.i(b),y=(0,l.yRP)(i,{utm_source:s.VU.substack,utm_campaign:p||s._9.postEmbed,utm_medium:s.Jn.web});""===y&&console.error("Invalid path (".concat(i,") for post: ").concat(g));let v=document.createElement("div");v.classList.add("embedded-post-title-icon"),v.innerHTML='<svg width="19" height="19" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path\n  d="M3 18V12C3 9.61305 3.94821 7.32387 5.63604 5.63604C7.32387 3.94821 9.61305 3 12 3C14.3869 3 16.6761 3.94821 18.364 5.63604C20.0518 7.32387 21 9.61305 21 12V18"\n  stroke-linecap="round"\n  stroke-linejoin="round"\n  />\n  <path\n  d="M21 19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H18C17.4696 21 16.9609 20.7893 16.5858 20.4142C16.2107 20.0391 16 19.5304 16 19V16C16 15.4696 16.2107 14.9609 16.5858 14.5858C16.9609 14.2107 17.4696 14 18 14H21V19ZM3 19C3 19.5304 3.21071 20.0391 3.58579 20.4142C3.96086 20.7893 4.46957 21 5 21H6C6.53043 21 7.03914 20.7893 7.41421 20.4142C7.78929 20.0391 8 19.5304 8 19V16C8 15.4696 7.78929 14.9609 7.41421 14.5858C7.03914 14.2107 6.53043 14 6 14H3V19Z"\n  stroke-linecap="round"\n  stroke-linejoin="round"\n  />\n</svg>';let w=document.createElement("div");return w.classList.add("embedded-post-cta-icon"),w.innerHTML='<svg width="32" height="32" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\n  <path\n  className="inner-triangle"\n  d="M10 8L16 12L10 16V8Z"\n  stroke-width="1.5"\n  stroke-linecap="round"\n  stroke-linejoin="round"\n  />\n</svg>',["div",{class:"embedded-post-wrap","data-attrs":JSON.stringify(t.attrs),"data-component-name":"EmbeddedPostToDOM"},["a",{class:"embedded-post",native:!0,href:y},["div",{class:"embedded-post-header"},e?["img",{class:"embedded-post-publication-logo",src:(0,l.dJ9)(e,56),loading:t.attrs.belowTheFold?"lazy":null}]:["span",{}],["span",{class:"embedded-post-publication-name"},a||h("Failed to embed post")]],["div",{class:"embedded-post-title-wrapper"},..."podcast"===f?[v]:[],["div",{class:"embedded-post-title"},n||h("Failed to embed post")]],...r?[["div",{class:"embedded-post-body"},(0,o.formatEllipsis)(r)]]:[],["div",{class:"embedded-post-cta-wrapper"},..."podcast"===f?[w]:[],["span",{class:"embedded-post-cta"},h("podcast"===f?"Listen now":"Read more")]],["div",{class:"embedded-post-meta"},(0,o.getPostEmbedMeta)({date:c,bylines:d,like_count:u,comment_count:m,language:b})]]]},toDOMStatic:t=>{let{publication_logo_url:e,publication_name:a,title:n,truncated_body_text:r,url:i,bylines:d,date:c,like_count:u,comment_count:m,utm_campaign:p,type:g,language:f}=t.attrs,{iString:b}=I18N.i(f),h=(0,l.yRP)(i,{utm_source:s.VU.substack,utm_campaign:p||s._9.postEmbed,utm_medium:s.Jn.email}),y=(0,l.dJ9)("/img/podcast-headphones.svg",19,{format:"png"}),v=(0,l.dJ9)("/img/audio-player-play.png",12);return["div",{class:"embedded-post-wrap","data-component-name":"EmbeddedPostToDOMStatic"},["div",{class:"embedded-post"},["div",{class:"embedded-post-header"},e?["img",{class:"embedded-post-publication-logo",src:(0,l.dJ9)(e,56),width:28,height:28}]:["span",{}],["span",{class:"embedded-post-publication-name"},a||b("Failed to embed post")]],["div",{class:"embedded-post-title-wrapper"},..."podcast"===g?[["img",{class:"embedded-post-title-icon embedded-post-title-icon-static",src:y}]]:[],["a",{class:"embedded-post-title",href:h||"#"},n||b("Failed to embed post")]],...r?[["div",{class:"embedded-post-body"},(0,o.formatEllipsis)(r)]]:[["br"],["br"]],["div",{class:"embedded-post-cta-wrapper"},..."podcast"===g?[["img",{width:12,height:12,class:"embedded-post-cta-icon-static",src:v}]]:[],["a",{class:"embedded-post-cta",href:h||"#"},b("podcast"===g?"Listen now":"Read more")]],["div",{class:"embedded-post-meta"},(0,o.getPostEmbedMeta)({date:c,bylines:d,like_count:u,comment_count:m,language:f})]]]}},u=(0,d.C)({name:"embeddedPost",nodeSpec:c,addCommands(){return{insertEmbeddedPost:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),m=function(t){var e,a,n,r;let{customSchema:o,forceAllowOwnPub:s=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(o&&!o.nodes.embeddedPost)return null;let d=(0,l.Dlv)(t);if(!d)return null;let c=(0,i.JQq)({url:t,currentSubdomain:null==(a=window._preloads)||null==(e=a.pub)?void 0:e.subdomain,currentCustomDomain:null==(r=window._preloads)||null==(n=r.pub)?void 0:n.custom_domain});return d&&(d.pathname.startsWith("/p/")||(0,i.Sns)(d))&&!(c&&!s)?t:null},p=async t=>{let e=(await Promise.resolve().then(a.t.bind(a,15734,23))).default;try{return(await e.get("/api/v1/posts/embed").query({url:t.trim()})).body}catch(t){return null}},g=async function(t){let{customSchema:e,language:l="en"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=(e?{schema:e}:await Promise.resolve().then(a.bind(a,86508))).schema,o=await p(t);return o?i.nodes.embeddedPost.create((0,r._)((0,n._)({},o),{language:l})):null}},70084:function(t,e,a){a.d(e,{JA:()=>b,c:()=>p,fz:()=>g,oI:()=>f,t2:()=>y});var n=a(69277),r=a(70408),l=a(79785),i=a(39318),o=a(57324),s=a(29496),d=a(78495);function c(){let t=(0,l._)(["By ",""]);return c=function(){return t},t}function u(){let t=(0,l._)(["By ",""]);return u=function(){return t},t}let m=t=>t?{style:"background-color: ".concat(t)}:{},p={attrs:{id:{default:null},name:{default:""},logo_url:{default:null},base_url:{default:null},hero_text:{default:null},author_name:{default:null},show_subscribe:{default:!0},logo_bg_color:{default:null},language:{default:"en"}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.embedded-publication-wrap",getAttrs:d.t}],toDOMWithSubscribe:t=>{let{name:e,logo_url:a,base_url:r,hero_text:l,author_name:s,logo_bg_color:d,language:u}=t.attrs,{iString:p,iTemplate:g}=I18N.i(u);return["div",{class:"embedded-publication-wrap","data-attrs":JSON.stringify(t.attrs),"data-component-name":"EmbeddedPublicationToDOMWithSubscribe"},["div",{class:"embedded-publication show-subscribe"},["a",{class:"embedded-publication-link-part",native:!0,href:(0,i.yRP)(r,{utm_source:o.VU.substack,utm_campaign:o._9.publicationEmbed,utm_medium:o.Jn.web})},...a?[["img",(0,n._)({class:"embedded-publication-logo",src:(0,i.dJ9)(a),width:56,height:56},m(d))]]:[],["span",{class:"embedded-publication-name"},e||p("Failed to embed publication")],...l?[["div",{class:"embedded-publication-hero-text"},l]]:[],...s&&!e.includes(s)?[["div",{class:"embedded-publication-author-name"},g(c(),s)]]:[]],["form",{class:"embedded-publication-subscribe",method:"GET",action:(0,i.eV6)({base_url:r},{addBase:!0})},["input",{type:"hidden",name:"source",value:"publication-embed"}],["input",{type:"hidden",name:"autoSubmit",value:"true"}],["input",{type:"email",class:"email-input",name:"email",placeholder:p("Type your email...")}],["input",{type:"submit",class:"button primary",value:p("Subscribe")}]]]]},toDOMWithoutSubscribe:t=>{let{name:e,logo_url:a,base_url:r,hero_text:l,author_name:s,logo_bg_color:d,language:c}=t.attrs,{iString:p,iTemplate:g}=I18N.i(c);return["div",{class:"embedded-publication-wrap","data-attrs":JSON.stringify(t.attrs)},["a",{class:"embedded-publication embedded-publication-flex",native:!0,href:(0,i.yRP)(r,{utm_source:o.VU.substack,utm_campaign:o._9.publicationEmbed,utm_medium:o.Jn.web})},...a?[["div",{class:"embedded-publication-left"},["img",(0,n._)({class:"embedded-publication-logo",src:(0,i.dJ9)(a),width:40,height:40},m(d))]]]:[],["div",{class:"embedded-publication-right"},["span",{class:"embedded-publication-name"},e||p("Failed to embed publication")],...l?[["div",{class:"embedded-publication-hero-text"},l]]:[],...s&&!e.includes(s)?[["div",{class:"embedded-publication-author-name"},g(u(),s)]]:[]]]]},toDOMStatic:t=>{let{name:e,logo_url:a,base_url:r,hero_text:l,author_name:s,logo_bg_color:d}=t.attrs,c=(0,i.yRP)(r,{utm_source:o.VU.substack,utm_campaign:o._9.publicationEmbed,utm_medium:o.Jn.email});return["div",{class:"embedded-publication-wrap","data-attrs":JSON.stringify(t.attrs),"data-component-name":"EmbeddedPublicationToDOMStatic"},["table",{class:"embedded-publication"},["tr",{},...a?[["td",{class:"embedded-publication-left",valign:"top",width:56},["img",(0,n._)({class:"embedded-publication-logo",src:(0,i.dJ9)(a),width:40,height:40},m(d))]]]:[],["td",{class:"embedded-publication-right"},["span",{class:"embedded-publication-name"},["a",{href:c},e||"Failed to embed publication"]],...l?[["div",{class:"embedded-publication-hero-text"},["a",{href:c},l]]]:[],...s&&!e.includes(s)?[["div",{class:"embedded-publication-author-name"},["a",{href:c},"By ".concat(s)]]]:[]]]]]},toDOM:t=>t.attrs.show_subscribe?p.toDOMWithSubscribe(t):p.toDOMWithoutSubscribe(t)},g=(0,s.C)({name:"embeddedPublication",nodeSpec:p,addCommands(){return{insertEmbeddedPublication:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),f=function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e&&!e.nodes.embeddedPublication)return null;let a=(0,i.Dlv)(t);return a&&(!a.pathname||"/"===a.pathname)?t:null},b=async t=>{let e=(await Promise.resolve().then(a.t.bind(a,15734,23))).default;try{let a=await e.get("/api/v1/publication/embed").query({url:t.trim()});if(!a.body.id)return null;return a.body}catch(t){return null}},h=async t=>{let e=await b(t);return e?(0,r._)((0,n._)({},e),{show_subscribe:!0}):null},y=async function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(e?{schema:e}:await Promise.resolve().then(a.bind(a,86508))).schema,r=await h(t);return r?n.nodes.embeddedPublication.create(r):null}},33967:function(t,e,a){a.d(e,{A:()=>d});var n=a(49089),r=a(26469),l=a(15734),i=a.n(l);let o=async(t,e,a)=>{let{schema:n}=e;if(!n.nodes.cashtag)return console.error("Cashtag node not found in schema"),!0;let r=n.nodes.cashtag.create({symbol:t,prependSymbol:!1}),l=e.tr;return l.replaceSelectionWith(r),a&&a(l),!0},s=async()=>(await i().get("/api/v1/symbols/all")).body.symbols,d=n.P.configure({HTMLAttributes:{class:"mention"},suggestion:{pluginKey:new r.hs("mention"),char:"$",allowSpaces:!1,startOfLine:!1,command:()=>{},items:()=>[],render:()=>({onStart:()=>{s()},onUpdate(){},onKeyDown:t=>"Escape"===t.event.key,async onExit(t){let e=t.text.trim();if(["$",""].includes(e))return;let a=await s();if(!/\$[a-z]+$/i.test(e)||e.length>6||!a.includes(e.toUpperCase().replace("$",""))||["BTC","ETH","SOL","XRP","BNB","LUNA"].includes(e.toUpperCase().replace("$","")))return;let n=t.editor.state.tr;n.setSelection(r.U3.create(n.doc,t.range.from,t.range.to)).deleteSelection(),t.editor.view.dispatch(n),o(e.toUpperCase(),t.editor.view.state,t.editor.view.dispatch),t.editor.commands.insertContent(" "),t.editor.view.dispatch(t.editor.state.tr)}})}})},79493:function(t,e,a){a.d(e,{u:()=>l});var n=a(42080),r=a(35974);let l=n.N_.extend({addKeyboardShortcuts(){return{"Mod-k":()=>this.editor.commands.addLink()}},addCommands:()=>({addLink:()=>t=>{let{state:e,dispatch:a,view:n}=t;return(0,r.c)(e.schema)(e,a,n)}})}).configure({autolink:!1,openOnClick:!1})},95663:function(t,e,a){a.d(e,{w:()=>tO});var n=a(69277),r=a(16571),l=a(34688),i=a(35933),o=a(41002),s=a(71979),d=a(75820),c=a(38474),u=a(79589),m=a(26082),p=a(55277),g=a(58588),f=a(26116),b=a(55029),h=a(39729),y=a(82086),v=a(32422),w=a(82311),k=a(34202),_=a(83485),C=a(30909),E=a(42985),O=a(79431),S=a(45595),T=a(60282),N=a(70679),M=a(21577),D=a(85052),A=a(26746),x=a(97966),P=a(70084),I=a(33967),J=a(79493),L=a(38435),R=a(65768),B=a(67902),U=a(19015),F=a(31933),q=a(19062),V=a(37859);let H=a(58521).A.extend({draggable:!0});var z=a(83733),W=a(36504),G=a(31611),Y=a(8540),$=a(17768),K=a(53680),j=a(82979),Q=a(78598),X=a(58097),Z=a(6905),tt=a(63998),te=a(30131),ta=a(41298),tn=a(76527),tr=a(60440),tl=a(41758),ti=a(14489),to=a(88457),ts=a(88213),td=a(96384),tc=a(48818),tu=a(40282),tm=a(75594),tp=a(66613),tg=a(52910),tf=a(84262),tb=a(51600),th=a(47727),ty=a(14304),tv=a(23491),tw=a(13625),tk=a(47579),t_=a(39248),tC=a(54749),tE=a(60147);let tO=t=>{let{isStatic:e,excludeDropCursor:a=!1}=t,tO={};return a&&(tO.dropcursor=!1),[d.A.configure((0,n._)({history:!1,blockquote:!1,bulletList:!1,orderedList:!1,horizontalRule:!1},tO)),s.Ay,i.A,o.A,J.u,b.u,ts.k.configure({isStatic:e}),r.Ay,l.Ay,W.y7.configure({isStatic:e}),Y.fQ,m.xT.configure({isStatic:e}),c.bq.configure({isStatic:e}),tk.m.configure({isStatic:e}),tv.S.configure({isStatic:e}),tw.eC.configure({isStatic:e}),tC.q.configure({isStatic:e}),tE.id.configure({isStatic:e}),y.z_.configure({isStatic:e}),z.o.configure({isStatic:e}),G.Mi.configure({isStatic:e}),tb.T.configure({isStatic:e}),T.x.configure({isStatic:e}),M.ed.configure({isStatic:e}),x.TG.configure({isStatic:e}),P.fz.configure({isStatic:e}),tg.P.configure({isStatic:e}),tf.hJ.configure({isStatic:e}),td.X.configure({isStatic:e}),_.g.configure({isStatic:e}),R.tO.configure({isStatic:e}),A.F.configure({isStatic:e}),C.G.configure({isStatic:e}),tt.X.configure({isStatic:e}),$.t8.configure({isStatic:e}),tn.m.configure({isStatic:e}),tp.N.configure({isStatic:e}),K.Z.configure({isStatic:e}),f.pK.configure({isStatic:e}),t_.tC.configure({isStatic:e}),ty.zh.configure({isStatic:e}),h.iK.configure({isStatic:e}),te.qT.configure({isStatic:e}),tm.RX.configure({isStatic:e}),O.e$.configure({isStatic:e}),E._k.configure({isStatic:e}),S.iH.configure({isStatic:e}),V.Sh.configure({isStatic:e}),g.O.configure({isStatic:e}),tl.ny.configure({isStatic:e}),tl.Iu.configure({isStatic:e}),tr.LL.configure({isStatic:e}),j.AI.configure({isStatic:e}),N.I8.configure({isStatic:e}),X.kP.configure({isStatic:e}),k.f.configure({isStatic:e}),v.p.configure({isStatic:e}),w.Pr.configure({isStatic:e}),w.k5.configure({isStatic:e}),Q.A.configure({isStatic:e}),B.X.configure({isStatic:e}),U.Q.configure({isStatic:e}),ti.Q.configure({isStatic:e}),Z.U.configure({isStatic:e}),p.e4.configure({isStatic:e}),th.E.configure({isStatic:e}),tc.M.configure({isStatic:e}),tu.Pk.configure({isStatic:e}),to.h.configure({isStatic:e}),q.B.configure({isStatic:e}),u.$.configure({isStatic:e}),ta.FL.configure({isStatic:e}),H,L.S,I.A,D.FB.configure({isStatic:e}),F.ik.configure({isStatic:e})]}},38435:function(t,e,a){a.d(e,{S:()=>b});var n=a(79785),r=a(49089),l=a(26469),i=a(31583),o=a(6411),s=a.n(o),d=a(64504),c=a(95660),u=a(93038),m=a(68349);function p(){let t=(0,n._)(["No results for ",""]);return p=function(){return t},t}let g=r.P.extend({name:"substack_mentions_extension"}),f={char:"@",pluginKey:new l.hs("substack_mentions_extension"),decorationClass:"substack-mention",allowSpaces:!0,startOfLine:!1,command:t=>{var e;let{editor:a,range:n,props:r}=t;if(!r.item)return;let{name:i,id:o,type:s,url:d,photo_url:c}=r.item,u=a.view.state.selection.$to.nodeAfter;(null==u||null==(e=u.text)?void 0:e.startsWith(" "))&&(n.to+=1);let{schema:p}=a.state,g=a.state.tr;if(g.setSelection(l.U3.create(g.doc,n.from,n.to)).deleteSelection(),a.view.dispatch(g),g=a.state.tr,!p.nodes.substack_mentions)return void console.error("substack_mentions node not found in schema");let f=p.nodes.substack_mentions.create({name:i,id:o,type:s,url:d,photo_url:c,uuid:(0,m.QT)()});g.insert(n.from,f),a.view.dispatch(g),a.commands.insertContent(" "),a.view.dispatch(a.state.tr),g.setSelection(l.U3.near(g.doc.resolve(n.from+1)))},items:async t=>{let{query:e}=t;return e.length<1?[]:await (0,u._F)(e)},render:()=>{let t,e,a=s().prototype.stopCallback,n=function(t){var e,a,n;let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],l="undefined"!=typeof window&&null!=(n=null==(a=window._preloads)||null==(e=a.pub)?void 0:e.language)?n:"en",{iString:i,iTemplate:o}=I18N.i(l);return{items:t.items,query:t.query,isLoading:r,selectItem:e=>{e&&t.command({item:e})},placeholderText:i("Search for a person or publication"),noResultsText:o(p(),t.query),minQueryLength:2,language:l}};return{onStart:r=>{t=new i.NV(c.r,{props:n(r),editor:r.editor}),e=(0,d.Ay)("body",{getReferenceClientRect:r.clientRect,appendTo:()=>document.getElementsByClassName("editor-scroll")[0]||document.body,content:t.element,popperOptions:{strategy:"absolute",modifiers:[{options:{altAxis:!0}}]},showOnCreate:!0,interactive:!0,trigger:"manual",placement:"bottom-start"}),s().prototype.stopCallback=function(t,e,n){return"esc"===n||a(t,e,n)}},onBeforeUpdate(a){e&&e[0].show(),t&&t.updateProps(n(a,!0)),a.clientRect&&e&&e[0].setProps({getReferenceClientRect:a.clientRect})},onUpdate(a){t&&t.updateProps(n(a,!1)),e&&e[0].setProps({getReferenceClientRect:a.clientRect})},onKeyDown(n){var r;return"Escape"===n.event.key?(e&&e[0]&&e[0].destroy(),e=null,t&&t.destroy(),t=null,setTimeout(()=>{s().prototype.stopCallback=a},0),!0):null==t||null==(r=t.ref)?void 0:r.onKeyDown(n)},onExit(){s().prototype.stopCallback=a,e&&e[0]&&e[0].destroy(),e=null,t&&t.destroy(),t=null}}}},b=g.configure({HTMLAttributes:{class:"substack-mention"},suggestion:f})},65768:function(t,e,a){a.d(e,{Ay:()=>m,tO:()=>g});var n=a(99851),r=a(15734),l=a.n(r),i=a(98111),o=a(39318),s=a(69706),d=a(8037),c=a(29496);class u{update(t){return t.type.name===this.fileEmbed.substackType}stopEvent(t){return"file-embed-menu-button"===t.target.className}constructor({fileEmbed:t,node:e,view:a,getPos:r}){(0,n._)(this,"dom",void 0),(0,n._)(this,"fileEmbed",void 0),this.fileEmbed=t,this.dom=t.buildNodeView(e,a,r)}}class m{getNodeView(t){let{editor:e,node:a,getPos:n}=t;return new u({fileEmbed:this,node:a,view:e.view,getPos:n})}get nodeSpec(){return{definition:this,attrs:{filename:{default:null},filetype:{default:null},filesize:{default:null},href:{default:null},title:{default:null},description:{default:null},thumbnail:{default:null},fileKey:{default:null},dirty:{default:!0},raw_href:{default:null},error:{default:null},empty:{default:!1}},substackType:this.substackType,inline:!1,atom:!0,group:"block",selectable:!1,draggable:!0,isolating:!0,defining:!0,parseDOM:(0,d.T_)({mimeTypesToSignature:this.mimeTypesToSignature,substackType:this.substackType,actionButtonAttr:this.actionButtonAttr}),toDOM:t=>{let e=["div",{class:"file-embed-wrapper","data-component-name":"FileToDOM"},["div",{class:"file-embed-container-reader"},["div",{class:"file-embed-container-top"},["image",{class:"file-embed-thumbnail".concat(t.attrs.thumbnail?"":"-default"),src:t.attrs.thumbnail||(0,o.dJ9)("/img/attachment_icon.svg")}],["div",{class:"file-embed-details"},["div",{class:"file-embed-details-h1"},t.attrs.title||t.attrs.filename||""],["div",{class:"file-embed-details-h2"},(0,d.iW)({attrs:t.attrs})]],["a",{class:"file-embed-button wide",href:t.attrs[this.actionButtonAttr]},["span",{class:"file-embed-button-text"},this.actionButtonText]]]]];return t.attrs.description&&e[2].push(["div",{class:"file-embed-description"},t.attrs.description]),e[2].push(["a",{class:"file-embed-button narrow",href:t.attrs[this.actionButtonAttr]},["span",{class:"file-embed-button-text"},this.actionButtonText]]),e},toDOMStatic:t=>{var e;let a,n,r=(null==(e=t.attrs)?void 0:e.title)||"";return t.attrs.thumbnail&&-1===t.attrs.thumbnail.indexOf("attachment_icon.svg")?(n=!1,a=(0,o.dJ9)(t.attrs.thumbnail,100,{aspect:s.fo,crop:"fill",gravity:"auto",height:150})):(n=!0,a=(0,o.dJ9)("/img/attachment_icon.svg",32,{aspect:s.Zi,crop:"fill",gravity:"auto",height:32})),r&&r.length>40&&(r="".concat(r.substr(0,40),"...")),["table",{class:"static-file-embed-table",cellspacing:"16","data-component-name":"FileToDOMStatic"},["tr",{},["td",{class:"static-file-embed-thumbnail-container ".concat(n?"default":"")},["img",{class:"static-file-embed-thumbnail ".concat(n?"default":""),src:a}]],["td",{class:"static-file-embed-details ".concat(n?"default":"")},["div",{class:"static-file-embed-details-h1"},r],["div",{class:"static-file-embed-details-h2"},(0,d.iW)({attrs:t.attrs})]]],...t.attrs.description?[["tr",{},["td",{class:"static-file-embed-description",colspan:"2"},["p",{style:"margin: 0;"},t.attrs.description||""]]]]:[],["tr",{},["td",{class:"static-file-embed-button-container",colspan:"2"},["table",{class:"static-file-embed-button",cellspacing:"0"},["tr",{},["td",{align:"center"},["a",{href:"".concat(t.attrs[this.actionButtonAttr],"?token=").concat(i.T.FILE_DOWNLOAD_TOKEN),class:"static-file-embed-anchor"},this.actionButtonText]]]]]]]}}}buildNodeView(t,e,a){var n,r,l,i;let d=document.createElement("div");d.className="file-embed-wrapper-editor";let c=document.createElement("div");c.className="file-embed-container",c.dataset.attrs=JSON.stringify(t.attrs),c.appendChild(this.generateContainerTop(t)),c.appendChild(this.generateDescription(t)),c.appendChild(this.generateButton("narrow"));let u=document.createElement("div");u.className="file-embed-aligner";let{button:m,menu:p}=this.generateDropdown(t,e,a);u.appendChild(c),u.appendChild(p),d.appendChild(u);let g=document.createElement("img");g.src=(0,o.dJ9)("/img/file_drag_default.png");let f=document.createElement("img");f.src=(0,o.dJ9)(null==t||null==(n=t.attrs)?void 0:n.thumbnail,100,{aspect:s.fo,crop:"fill",gravity:"auto",height:150}),d.addEventListener("dragstart",e=>{var a,n,r;(null==t||null==(a=t.attrs)?void 0:a.thumbnail)?null==(n=e.dataTransfer)||n.setDragImage(f,0,0):null==(r=e.dataTransfer)||r.setDragImage(g,0,0)}),(null==(l=e.state)||null==(r=l.doc)?void 0:r.nodeAt(e.state.doc.nodeSize-3))===t&&setTimeout(()=>{e.dispatch(e.state.tr.insertText("\r",e.state.doc.nodeSize-2))},0);let b=document.createElement("div");b.appendChild(this.generateSpinner());let h=this.generateErrorCover(e,t);return(null==(i=t.attrs)?void 0:i.error)&&(m.className="file-embed-menu-button hidden",c.className="file-embed-container covered error",c.appendChild(h)),t.startReplacing=()=>{b.className="file-embed-container cover",c.className="file-embed-container covered",m.className="file-embed-menu-button disabled",c.contains(h)&&c.removeChild(h),c.appendChild(b)},t.stopReplacing=t=>{t?(m.className="file-embed-menu-button hidden",c.className="file-embed-container covered error",c.appendChild(h)):(c.className="file-embed-container",m.className="file-embed-menu-button"),c.removeChild(b)},d}getFileAttrs(t){return{href:t.getAttribute("href"),filename:t.getAttribute("filename"),filetype:t.getAttribute("filetype"),filesize:t.getAttribute("filesize"),title:t.getAttribute("title"),dirty:t.getAttribute("dirty"),description:t.getAttribute("description"),error:t.getAttribute("error")}}generateThumbnail(t){let e=document.createElement("img");return e.className="file-embed-thumbnail".concat(t.attrs.thumbnail?"":"-default"),e.setAttribute("src",t.attrs.thumbnail||(0,o.dJ9)("/img/attachment_icon.svg")),t.updateThumbnail=async function(a){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:400,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{aspect:s.fo,crop:"fill",gravity:"auto",width:400,height:600};if(t.attrs.dirty=!0,!a){t.attrs.thumbnail=null,e.onload=()=>{e.className="file-embed-thumbnail-default"},e.src=(0,o.dJ9)("/img/attachment_icon.svg");return}let i=await new Promise((t,e)=>{if(!window.FileReader)return void e(TypeError("File reader API not found"));let n=new FileReader;n.onerror=e,n.onload=()=>{t(n.result)},n.readAsDataURL(a)}),d=await l().post("/api/v1/image").send({image:i}),c=(0,o.dJ9)(d.body.url,n,r);return t.attrs.thumbnail=c,e.onload=()=>{e.className="file-embed-thumbnail"},e.src=c,c},e}generateDetails(t){let e=document.createElement("div");e.className="file-embed-details";let a=document.createElement("div");a.className="file-embed-details-h1",a.innerText=t.attrs.title||t.attrs.filename;let n=document.createElement("div");return n.className="file-embed-details-h2",n.innerText=(0,d.iW)({attrs:t.attrs}),e.appendChild(a),e.appendChild(n),t.updateTitle=e=>{t.attrs.title=e,t.attrs.dirty=!0,a.innerText=e},e}generateButton(t){let e=document.createElement("button");e.className="file-embed-button primary mock ".concat(t);let a=document.createElement("span");return a.className="file-embed-button-text",a.innerText=this.actionButtonText,e.appendChild(a),e}generateDescription(t){let e=document.createElement("div");return e.className="file-embed-description ",e.innerText=t.attrs.description,t.updateDescription=a=>{t.attrs.dirty=!0,t.attrs.description=a?a.trim():null,e.innerText=a?a.trim():null},e}generateErrorCover(t,e){var a,n;let r=document.createElement("div");r.className="file-embed-container cover error";let l=document.createElement("div");l.className="file-embed-error-inner";let i=document.createElement("img");i.className="file-embed-error-icon",i.setAttribute("src",(0,o.oOP)("/img/alert-circle.svg"));let s=document.createElement("div");s.className="file-embed-error-message",s.innerText=null==(a=e.attrs.error)?void 0:a.message;let d=document.createElement("div");d.className="file-embed-error-button",d.onclick=this.makeReplaceButtonClickHandler(t,e);let c=document.createElement("span");return c.className="file-embed-error-button-text",c.innerText=(null==(n=e.attrs.error)?void 0:n.button)||"Try again",d.appendChild(c),l.appendChild(i),l.appendChild(s),l.appendChild(d),r.appendChild(l),r}generateSpinner(){let t=document.createElement("div");t.className="embed-loader-container";let e=document.createElement("div");e.className="embed-loader";let a=document.createElement("div");return a.innerText="Replacing...",a.className="embed-loader-text",t.appendChild(e),t.appendChild(a),t}makeReplaceButtonClickHandler(t,e){return()=>{let a=document.createElement("input");a.className="sidebar-item-hidden-file-input",a.type="file",a.oninput=a=>{var n,r;let l=null==(r=a.target)||null==(n=r.files)?void 0:n[0];t.dispatchEvent({type:"file_replace",node:e,file:l})},document.body.appendChild(a),a.click(),document.body.removeChild(a)}}generateDropdown(t,e,a){let n=document.createElement("div");n.className="post-editor-file-embed-dropdown-container dropdown-container";let r=document.createElement("div");r.className="dropdown-content";let l=document.createElement("div");l.className="dropdown-list",[{label:"Edit",icon:"edit",onclick:()=>{e.dispatchEvent(new CustomEvent("file_edit",{detail:{node:t}}))}},{label:"Replace",icon:"swap",onclick:this.makeReplaceButtonClickHandler(e,t)},{label:"Download",icon:"download",onclick:()=>{let e=document.createElement("a");e.href=t.attrs.raw_href,e.download=t.attrs.filename,document.body.appendChild(e);let a=window.onbeforeunload;window.onbeforeunload=null,e.click(),window.onbeforeunload=a,document.body.removeChild(e)}},{label:"Delete",icon:"trash",onclick:()=>{if("function"!=typeof a)return;let t=a();e.dispatch(e.state.tr.delete(t,t+1))}}].map(t=>{let e=document.createElement("div");e.className="dropdown-list-item",e.onclick=t.onclick;let a=document.createElement("div");a.className="dropdown-list-item-icon icon-".concat(t.icon);let n=document.createElement("span");return n.className="dropdown-list-item-text",n.innerText=t.label,e.appendChild(a),e.appendChild(n),e}).forEach(t=>{l.appendChild(t)}),r.appendChild(l);let i=document.createElement("div");i.className="file-embed-menu-button";let o=document.createElement("div");return o.className="dropdown-icon",o.appendChild(document.createElement("span")),o.appendChild(document.createElement("span")),o.appendChild(document.createElement("span")),o.appendChild(document.createElement("span")),i.appendChild(o),n.appendChild(i),n.appendChild(r),i.onclick=()=>{if("dropdown-content open"===r.className)return;r.className="dropdown-content open",o.className="dropdown-icon open",i.className="file-embed-menu-button open";let t=()=>{r.className="dropdown-content",o.className="dropdown-icon",i.className="file-embed-menu-button",document.removeEventListener("click",t)};setTimeout(()=>{document.addEventListener("click",t)},0)},{button:i,menu:n}}generateContainerTop(t){let e=document.createElement("div");return e.className="file-embed-container-top",e.appendChild(this.generateThumbnail(t)),e.appendChild(this.generateDetails(t)),e.appendChild(this.generateButton("wide")),e}constructor({substackType:t,actionButtonText:e,actionButtonAttr:a,mimeTypesToSignature:r}){(0,n._)(this,"substackType","file"),(0,n._)(this,"actionButtonText","Download"),(0,n._)(this,"actionButtonAttr","raw_href"),(0,n._)(this,"mimeTypesToSignature",void 0),t&&(this.substackType=t),e&&(this.actionButtonText=e),a&&(this.actionButtonAttr=a),this.mimeTypesToSignature=r}}let p=new m({actionButtonText:null,substackType:null,actionButtonAttr:null,mimeTypesToSignature:{}}),g=(0,c.C)({name:"file",nodeSpec:p.nodeSpec})},67902:function(t,e,a){a.d(e,{X:()=>s,c:()=>o});var n=a(26469),r=a(75371),l=a(29496),i=a(8221);let o={attrs:{number:{default:1}},content:"block+",atom:!1,selectable:!1,isolating:!1,defining:!0,draggable:!1,group:"block",parseDOM:[{tag:".footnote"}],toDOM:t=>{let{number:e}=t.attrs;return["div",{class:"footnote","data-component-name":"FootnoteToDOM"},["a",{id:"footnote-".concat(e),href:"#footnote-anchor-".concat(e),class:"footnote-number",contenteditable:!1,target:"_self"},"".concat(e)],["div",{class:"footnote-content"},0]]},toDOMStatic:t=>{let{number:e}=t.attrs;return["div",{class:"footnote","data-component-name":"FootnoteToDOMStatic"},["span",{class:"footnote-number"},"".concat(e)],["div",{class:"footnote-content"},0]]}},s=(0,l.C)({name:"footnote",nodeSpec:o,addCommands:()=>({insertFootnote:()=>t=>{let{state:e,editor:a,dispatch:l}=t;if(!(0,r.o)(e))return!1;let{schema:o}=a;if(!o.nodes.footnote)return console.warn("Footnote node type is not defined in the schema."),!1;if(!o.nodes.footnoteAnchor)return console.warn("FootnoteAnchor node type is not defined in the schema."),!1;if(!o.nodes.paragraph)return console.warn("Paragraph node type is not defined in the schema."),!1;let s=o.nodes.footnote.create({number:1},o.nodes.paragraph.create()),d=o.nodes.footnoteAnchor.create({number:1}),c=e.tr,u=(0,i.Di)({schema:o,tr:c});if(null===u)return console.warn("Could not determine position to insert footnote."),!1;if(c.replaceWith(u,u,s),c.replaceSelectionWith(d),(0,i.TD)({schema:o,tr:c}),l){try{c.setSelection(n.U3.create(c.doc,u+2,u+2)).scrollIntoView()}catch(t){return console.error("could not set footnote text selection"),!1}l(c)}return!0}})})},19015:function(t,e,a){a.d(e,{Q:()=>i,c:()=>l});var n=a(82776),r=a(29496);let l={attrs:{number:{default:1}},atom:!0,selectable:!0,isolating:!1,defining:!0,draggable:!0,inline:!0,group:"inline",parseDOM:[{tag:".footnote-anchor"}],toDOM:t=>{let{number:e}=t.attrs;return["a",{class:"footnote-anchor","data-component-name":"FootnoteAnchorToDOM",id:"footnote-anchor-".concat(e),href:"#footnote-".concat(e),target:"_self"},"".concat(e)]},toDOMStatic:t=>{let{number:e}=t.attrs;return["span",{class:"footnote-anchor-email","data-component-name":"FootnoteAnchorToDOMStatic"},"".concat((0,n.getSuperscriptNumberString)(e))]}},i=(0,r.C)({name:"footnoteAnchor",nodeSpec:l})},31933:function(t,e,a){a.d(e,{c:()=>p,ik:()=>g,tZ:()=>h});var n=a(69277),r=a(32641),l=a(31583),i=a(15734),o=a.n(i),s=a(64399),d=a(68349),c=a(29496),u=a(78495);let m="fp-recirc-block",p={attrs:{nodeId:{default:null},title:{default:"Featured Stories"},postIds:{default:[]},showCount:{default:4},posts:{default:null},isEditorNode:{default:!1},align:{default:null}},group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,editable:!1,parseDOM:[{tag:".".concat(m),getAttrs:u.t}],toDOM:t=>f(t),toDOMStatic:t=>{let e=t.attrs,{align:a}=e,l=(0,r._)(e,["align"]);return["div",{class:m,"data-attrs":JSON.stringify((0,n._)({isEmail:!0},l))}]}},g=(0,c.C)({name:"fpRecircBlock",nodeSpec:p,addNodeView:()=>(0,l.gu)(s.n),addCommands:()=>({insertFpRecircBlock:t=>e=>{let{commands:a}=e,n={nodeId:(0,d.QT)(),title:t.title||"Featured Stories",postIds:t.postIds||[],showCount:t.showCount||4,posts:t.posts||void 0,isEditorNode:!0,align:t.align||null};return a.insertContent({type:"fpRecircBlock",attrs:n})},updateFpRecircBlock:t=>{let{pos:e,attrs:a}=t;return t=>{let{state:r,dispatch:l}=t;if(l){let t=r.doc.nodeAt(e);if(t&&"fpRecircBlock"===t.type.name){let i=r.tr;return i.setNodeMarkup(e,void 0,(0,n._)({},t.attrs,a)),l(i),!0}}return!1}}})}),f=t=>["div",{class:m,"data-attrs":JSON.stringify(t.attrs)}],b=t=>{var e,a,n;return{id:t.id,title:t.title,author_name:(null==(a=t.publishedBylines)||null==(e=a[0])?void 0:e.name)||t.author_name,author_names:null==(n=t.publishedBylines)?void 0:n.map(t=>t.name),cover_image:t.cover_image,canonical_url:t.canonical_url,post_date:t.post_date}},h=async(t,e)=>{try{if(t&&t.length>0)return((await o().get("/api/v1/posts/by_ids").query({ids:t.join(",")})).body.posts||[]).map(b);return((await o().get("/api/v1/archive").query({sort:"new",limit:4})).body||[]).map(b)}catch(t){return console.error("Error fetching fp recirc block posts:",t),[]}}},19062:function(t,e,a){a.d(e,{B:()=>l,c:()=>r});var n=a(29496);let r={content:"block+",group:"block",toDOM:()=>["div",{"data-component-name":"FragmentNodeToDOM"},0]},l=(0,n.C)({name:"fragmentNode",nodeSpec:r})},37859:function(t,e,a){a.d(e,{SU:()=>d,Sh:()=>o,Z7:()=>u,c:()=>i});var n=a(74728),r=a.n(n),l=a(29496);let i={attrs:{innerHTML:{default:""},stylesheet:{default:""}},untrackedAttrs:["innerHTML","stylesheet"],inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.github-gist",getAttrs:a(78495).t}],toDOMStatic:t=>m(t,!0),toDOM:t=>m(t,!1)},o=(0,l.C)({name:"gitgist",nodeSpec:i,addCommands(){return{insertGithubGist:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),s=/(https?:\/\/gist.github.com\/([^\s]*\/[^\s\.#]*)([\.#][^\s]*)?)/,d=function(t){var e;let{customSchema:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(a&&!a.nodes.gitgist)return null;let n=s.exec(t);return null!=(e=n&&n[1])?e:null},c=async t=>{let e,n=(e=t.match(s))&&e[2]?e[2]:null,r=(await Promise.resolve().then(a.t.bind(a,15734,23))).default;return(await r.get("/api/v1/github/gist").query({id:n})).body},u=async function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(e?{schema:e}:await Promise.resolve().then(a.bind(a,86508))).schema.nodes.gitgist.create(await c(t))};function m(t,e){let a=document.createElement("div");a.classList.add("github-gist"),e?a.setAttribute("data-component-name","GitgistToDOMStatic"):(a.dataset.attrs=JSON.stringify(t.attrs),a.setAttribute("data-component-name","GitgistToDOM")),a.innerHTML=r()(t.attrs.innerHTML,{allowedTags:r().defaults.allowedTags,allowedAttributes:Object.assign({},r().defaults.allowedAttributes,{"*":["href","style","id","data-*","itemprop","class"]})});let n=document.createElement("link");if(n.rel="stylesheet",n.href=t.attrs.stylesheet,a.prepend(n),e){a.classList.add("static");let t=a.getElementsByTagName("td");for(let e=0;e<t.length;e++){let a=t[e];a&&(a.dataset.lineNumber?(a.innerHTML=a.dataset.lineNumber,a.align="right"):(a.align="left",a.innerHTML="<pre>".concat(a.innerHTML,"</pre>")),a.classList.add("content"),a.height="20px")}}return a}},83733:function(t,e,a){a.d(e,{c:()=>l,o:()=>i});var n=a(39318),r=a(29496);let l={attrs:{src:{default:""},height:{default:null},width:{default:null},alt:{default:null},title:{default:null}},inline:!0,group:"inline",draggable:!0,toDOM:t=>{let e=(0,n.dJ9)(t.attrs.src,1100);return["img",{style:t.attrs.height&&t.attrs.width?"max-width:".concat(t.attrs.width,"px;max-height:").concat(t.attrs.height,"px"):"",src:e,alt:t.attrs.alt,title:t.attrs.title,"data-component-name":"ImageToDOM"}]},toDOMStatic:t=>{if(t.attrs.height&&t.attrs.width){let e=Math.min(t.attrs.width,550),a=(0,n.dJ9)(t.attrs.src,e);return["table",{class:"image-wrapper",width:"100%",border:"0",cellSpacing:"0",cellPadding:"0","data-component-name":"ImageToDOMStatic"},["tr",{},["td"],["td",{class:"content",width:e}],["td"]],["tr",{},["td"],["td",{align:"left",class:"content",width:e},["img",{src:a,alt:t.attrs.alt,title:t.attrs.title}]],["td"]]]}return["img",{src:(0,n.dJ9)(t.attrs.src,550),alt:t.attrs.alt,title:t.attrs.title}]}},i=(0,r.C)({name:"image",nodeSpec:l})},8540:function(t,e,a){a.d(e,{c:()=>f,fQ:()=>h});var n=a(69277),r=a(70408),l=a(88285),i=a(579),o=a(31583),s=a(44383),d=a.n(s),c=a(42455),u=a(31611),m=a(65112);let p=()=>({src:{default:null,keepOnSplit:!1},alt:{default:null,keepOnSplit:!1},title:{default:null,keepOnSplit:!1},href:{default:null,keepOnSplit:!1},width:{default:"100%",keepOnSplit:!1},height:{default:"auto",keepOnSplit:!1},size:{default:"normal",keepOnSplit:!1},align:{default:"center",keepOnSplit:!1}}),g="image3",f={name:g,group:"block",atom:!1,selectable:!0,content:"inline*",draggable:!0,attrs:(0,m.lh)({attrs:p()}),parseDOM:[{tag:"image3",getAttrs:t=>{try{if(t instanceof HTMLElement){let e=t.getAttribute("data-attrs");if(e)return JSON.parse(e)}}catch(t){}return!1}}],toDOM:t=>{var e;let a=!!(null==(e=t.content)?void 0:e.size),r={class:"image3","data-attrs":JSON.stringify((0,n._)({},t.attrs))};return a?["div",["div",r,0]]:["div",r]},toDOMStatic:t=>{var e;let a=!!(null==(e=t.content)?void 0:e.size),l={class:"image3","data-attrs":JSON.stringify((0,r._)((0,n._)({},t.attrs),{isEmail:!0}))};return a?["div",["div",l,0]]:["div",l]}},b=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,h=l.bP.create({name:g,inline:!1,group:"block",content:"inline*",draggable:!0,selectable:!0,isolating:!0,defining:!0,addOptions:()=>({HTMLAttributes:{}}),addAttributes:()=>p(),parseHTML:()=>[{tag:'img[src]:not([src^="data:"])',getAttrs:t=>({src:t.getAttribute("src")})},{tag:"image3"},{tag:"p",priority:100,getAttrs:t=>{var e;if(null==t||null==(e=t.textContent)?void 0:e.trim())return!1;let[a]=Array.from(t.getElementsByTagName("img"));return!!a&&d()((0,u.CW)(a,null),["src","alt","height","width"])}}],renderHTML(t){let{HTMLAttributes:e}=t;return["image3",(0,l.KV)(this.options.HTMLAttributes,e),0]},addCommands(){return{setImage:t=>e=>{let{commands:a}=e,n=t.title?[{type:"text",text:t.title}]:[];try{return a.insertContent({type:this.name,attrs:t,content:n})}catch(t){return!1}},setUnsplashImage:t=>{let{url:e,width:a,height:n,description:r,userName:l,userHref:o}=t;return t=>{let{commands:s,editor:d}=t,c=d.schema.text("Photo by "),u=d.schema.text(l,[d.schema.marks.link.create({title:l,href:o})]),m=d.schema.text(" on "),p=d.schema.text("Unsplash",[d.schema.marks.link.create({title:"Unsplash",href:"https://unsplash.com"})]);return s.insertContent({type:this.name,attrs:{alt:r,src:e,height:n,width:a,type:"image/jpg"},content:i.FK.fromArray([c,u,m,p]).toJSON()})}}}},addNodeView:()=>(0,o.gu)(c._),addInputRules(){return[(0,l.jT)({find:b,type:this.type,getAttributes:t=>{let[,,e,a,n,r,l]=t;return{src:a,type:n,alt:e,title:r,href:l}}})]}})},36504:function(t,e,a){a.d(e,{c:()=>p,y7:()=>f});var n=a(69277),r=a(50172),l=a(88285),i=a(31583),o=a(21805),s=a(36202),d=a(93946),c=a(82061),u=a(78495);let m="image-gallery-embed",p={attrs:{gallery:{default:{}},isEditorNode:{default:!1}},group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:m,getAttrs:u.t}],toDOM:t=>{if("undefined"!=typeof window&&t.attrs.isEditorNode)try{t.attrs.isEditor=!0;let e=document.createElement("div");return e.className=m,e.setAttribute("data-attrs",JSON.stringify(t.attrs)),(0,d.Mv)((0,r.h)(o.i_,{node:(0,n._)({},t)}),e),e}catch(e){return console.error("Error rendering ImageGallery",e),(0,c.D)({msg:null,node:t,err:e,group:"block"})}return g(t)},toDOMStatic:t=>["div",{class:m,"data-attrs":JSON.stringify((0,n._)({isEmail:!0},t.attrs))}]},g=t=>["div",{class:m,"data-attrs":JSON.stringify(t.attrs)}],f=l.bP.create({name:"imageGallery",group:p.group,draggable:!0,addAttributes:()=>({gallery:{default:{}},isEditorNode:{default:!0}}),parseHTML:()=>[{tag:m}],renderHTML(t){let{HTMLAttributes:e,node:a}=t;return this.options.isStatic&&p.toDOMStatic?p.toDOMStatic(a):["div",(0,n._)({class:m},(0,l.KV)(e))]},addNodeView:()=>(0,i.gu)(s.F),addCommands(){return{insertImageGallery:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})},updateImageGallery:t=>e=>{let{commands:a}=e;return a.updateAttributes(this.name,t)}}}})},17768:function(t,e,a){a.d(e,{VM:()=>f,Ys:()=>c,c:()=>s,t8:()=>d});var n=a(16291),r=a(49807),l=a(29496),i=a(78495);let o=/[@#][\w.]+|\n/g,s={attrs:{instagram_id:{default:""},title:{default:""},author_name:{default:""},thumbnail_url:{default:""},timestamp:{default:""},belowTheFold:{default:!1}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.instagram",getAttrs:i.t}],toDOM:t=>{let e=document.createElement("div");e.className="instagram",e.setAttribute("data-attrs",JSON.stringify(t.attrs)),e.setAttribute("data-component-name","InstagramToDOM");let a=document.createElement("div");a.className="instagram-top-bar",e.appendChild(a);let l=document.createElement("a");l.className="instagram-author-name",l.href=m(t.attrs.author_name),l.target="_blank",l.textContent=t.attrs.author_name,a.appendChild(l);let i=document.createElement("a");i.className="instagram-image",i.href=u(t.attrs.instagram_id),i.target="_blank",e.appendChild(i);let s=document.createElement("img");s.src=(0,r.dJ9)(t.attrs.thumbnail_url,640),t.attrs.belowTheFold&&s.setAttribute("loading","lazy"),i.appendChild(s);let d=document.createElement("div");d.className="instagram-bottom-bar",e.appendChild(d);let c=document.createElement("div");if(c.className="instagram-title",function(t,e){let a,n;if(!t)return;let r=0;for(;a=o.exec(t);)switch(r<a.index&&e.appendChild(document.createTextNode(t.substring(r,a.index))),r=a.index+a[0].length,a[0][0]){case"\n":e.appendChild(document.createElement("br"));break;case"@":(n=document.createElement("a")).href=m(a[0].substr(1)),n.target="_blank",n.textContent=a[0],e.appendChild(n);break;case"#":(n=document.createElement("a")).href=p(a[0]),n.target="_blank",n.textContent=a[0],e.appendChild(n);break;default:e.appendChild(document.createTextNode(a[0]))}r<t.length&&e.appendChild(document.createTextNode(t.substr(r)))}(t.attrs.title,c),d.appendChild(c),t.attrs.timestamp){let e=document.createElement("div");e.className="instagram-timestamp",e.textContent=(0,n.A)(t.attrs.timestamp).format("MMMM D, YYYY"),d.appendChild(e)}return e}},d=(0,l.C)({name:"instagram",nodeSpec:s,addCommands(){return{insertInstagram:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),c=function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e&&!e.nodes.instagram?null:b(t)[1]},u=t=>"https://instagram.com/p/".concat(t),m=t=>"https://instagram.com/".concat(t),p=t=>"https://instagram.com/explore/tags/".concat(t.substr(1),"/"),g=async t=>{let e=(await Promise.resolve().then(a.t.bind(a,15734,23))).default;return(await e.get("/api/v1/instagram/post/".concat(b(t)[0]))).body},f=async function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(e?{schema:e}:await Promise.resolve().then(a.bind(a,86508))).schema.nodes.instagram.create(await g(t))},b=t=>{let e=/(https?:\/\/(?:www\.)?(?:instagram\.com|instagr\.am)\/(?:p|reel|reels)\/([^\/\b\s\?\#]+)[^\s]*)/.exec(t);if(e){var a,n;return[null!=(a=e[2])?a:null,null!=(n=e[1])?n:null]}return[null,null]}},53680:function(t,e,a){a.d(e,{Z:()=>p,c:()=>m});var n=a(79785),r=a(39318),l=a(57324),i=a(29496);function o(){let t=(0,n._)(["Get more from "," in the Substack app"]);return o=function(){return t},t}function s(){let t=(0,n._)(["Read "," in the Substack app"]);return s=function(){return t},t}function d(){let t=(0,n._)(["Get more from "," in the Substack app"]);return d=function(){return t},t}function c(){let t=(0,n._)(["Read "," in the Substack app"]);return c=function(){return t},t}let u=t=>(0,r.wHz)({utm_campaign:l._9.appMarketing,utm_content:l.fL.authorPostInsert,utm_source:t}),m={attrs:{logo_url:{default:null},publication_name:{default:null},publication_subdomain:{default:null},author_name:{default:null},language:{default:"en"}},inline:!1,atom:!0,group:"block",draggable:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.install-substack-app-embed"}],toDOM:t=>{let{logo_url:e,publication_name:a,publication_subdomain:n,author_name:l,language:i}=t.attrs,{iString:d,iTemplate:c}=I18N.i(i);return["div",{class:"install-substack-app-embed install-substack-app-embed-web","data-component-name":"InstallSubstackAppToDOM"},["img",{class:"install-substack-app-embed-img",src:(0,r.dJ9)(e)}],["div",{class:"install-substack-app-embed-text"},["div",{class:"install-substack-app-header"},l?c(o(),l):c(s(),a)],["div",{class:"install-substack-app-text"},d("Available for iOS and Android")]],["a",{href:u(n),target:"_blank",class:"install-substack-app-embed-link"},["button",{class:"install-substack-app-embed-btn button primary"},d("Get the app")]]]},toDOMStatic:t=>{let{logo_url:e,publication_name:a,publication_subdomain:n,author_name:l,language:i}=t.attrs,{iString:o,iTemplate:s}=I18N.i(i);return["div",{class:"install-substack-app-embed","data-component-name":"InstallSubstackAppToDOMStatic"},["table",{class:"install-substack-embed-table"},["tr",{},["td",{rowspan:2},["img",{class:"install-substack-app-embed-img",src:(0,r.dJ9)(e),width:64,height:64}]],["td",{class:"install-substack-app-header"},l?s(d(),l):s(c(),a)]],["tr",{},["td",{class:"install-substack-app-text"},o("Available for iOS and Android")]],["tr",{},["td",{colspan:2},["a",{href:u(n),target:"_blank",class:"install-substack-app-embed-link"},["button",{class:"install-substack-app-embed-btn button primary"},o("Get the app")]]]]]]}},p=(0,i.C)({name:"install_substack_app",nodeSpec:m,addCommands(){return{insertInstallSubstackAppEmbed:t=>e=>{let{commands:a}=e,n=(0,r.$_T)(t),l={logo_url:t.logo_url||"".concat(n,"/img/substack.png"),publication_name:t.name,language:t.language,author_name:t.author_name,publication_subdomain:t.subdomain};return a.insertContent({type:this.name,attrs:l})}}}})},82979:function(t,e,a){a.d(e,{AI:()=>d,Rj:()=>c,c:()=>s,gE:()=>m});var n=a(39318),r=a(29496),l=a(78495);let i=/https?:\/\/read\.amazon(?:\.co)?\.[a-z]+\/kp\/(?:embed|card)\?asin=([^&#\s\b'"]+)[^\b\s'"]*/i,o=[RegExp('<iframe[^>]+src="'.concat(i.source,'"[^>]*><\\/iframe>'),"i"),i],s={attrs:{kindleId:{default:""},imageUrl:{default:""}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDom:[{tag:"div.kindle-wrap",getAttrs:l.t}],toDOM:t=>{let e=p(t.attrs.kindleId);return["div",{class:"kindle-wrap","data-attrs":JSON.stringify(t.attrs),"data-component-name":"KindleToDOM"},["iframe",{src:e,frameborder:"0",gesture:"media",allow:"autoplay; fullscreen",allowautoplay:"true",allowfullscreen:"true"}]]},toDOMStatic:t=>["table",{class:"kindle-wrapper",width:"100%",border:"0",cellSpacing:"0",cellPadding:"0","data-component-name":"KindleToDOMStatic"},["tr",{},["td"],["td",{align:"left",class:"content",width:200},["a",{class:"image-link",target:"_blank",href:g(t.attrs.kindleId)},["img",{"data-attrs":JSON.stringify(t.attrs),alt:"",width:"".concat(200),class:"wide-image",src:(0,n.dJ9)(t.attrs.imageUrl,400)}]]],["td"]]]},d=(0,r.C)({name:"kindle",nodeSpec:s,addCommands(){return{insertKindle:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),c=t=>{for(let e of o){let a=e.exec(t);if(a)return a[0]}return null},u=async t=>{let e=(await Promise.resolve().then(a.t.bind(a,15734,23))).default;return(await e.get("/api/v1/kindle").query({embedText:t})).body},m=async function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(e?{schema:e}:await Promise.resolve().then(a.bind(a,86508))).schema.nodes.kindle.create(await u(t))},p=t=>(0,n.yRP)("https://read.amazon.com/kp/card",{asin:t,preview:"inline",linkCode:"kpe",hideShare:"true"}),g=t=>"https://www.amazon.com/gp/product/".concat(t,"/")},78598:function(t,e,a){a.d(e,{$C:()=>m,A:()=>g,c:()=>p,uP:()=>f});var n=a(99851),r=a(69277),l=a(70408),i=a(50172),o=a(31583),s=a(38692),d=a(82061),c=a(29496),u=a(78495);let m=()=>{let t="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZ",a=e.length;for(let n=0;n<10;n++)t+=e.charAt(Math.floor(Math.random()*a));return t},p={content:"text*",group:"block",code:!0,defining:!0,isolating:!0,attrs:{persistentExpression:{default:""},id:{default:""}},parseDOM:[{tag:"pre.text",preserveWhitespace:"full",priority:60},{tag:"div.latexWrapper",getAttrs:u.t}],toDOM:t=>["div",{class:"latex-rendered","data-attrs":JSON.stringify((0,r._)({},t.attrs)),"data-component-name":"LatexBlockToDOM"}],toDOMStatic:t=>["div",{class:"latex-rendered","data-attrs":JSON.stringify((0,l._)((0,r._)({},t.attrs),{isEmail:!0})),"data-component-name":"LatexBlockToDOMStatic"}]},g=(0,c.C)({name:"latex_block",nodeSpec:p,addCommands(){return{insertLatex:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}},addNodeView:()=>(0,o.gu)(s._)});class f{constructor(t){(0,n._)(this,"dom",void 0),t.updateExpression=e=>{t.attrs=(0,l._)((0,r._)({},t.attrs),{persistentExpression:e}),t.attrs.dirty=!0},this.dom=(t=>{try{let e=document.createElement("span");e.className="latex-rendered";let a=m(),n=null==t?void 0:t.attrs.persistentExpression;return(0,i.render)((0,i.h)(s._,{persistentExpression:n,node:t,id:a}),e),e}catch(e){return console.error("Error rendering LatexComponent",e),(0,d.D)({msg:null,node:t,err:e,group:"block"})}})(t)}}},58097:function(t,e,a){a.d(e,{Hh:()=>d,Hk:()=>g,Wc:()=>u,c:()=>i,kP:()=>o});var n=a(99851),r=a(39318),l=a(29496);let i={attrs:{url:{default:""},thumbnail_url:{default:""}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDom:[{tag:"div.lichess-wrap",getAttrs:a(78495).t}],toDOM:t=>p(t),toDOMStatic:t=>m(t)},o=(0,l.C)({name:"lichess",nodeSpec:i,addCommands(){return{insertLichess:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),s=/^.*(https?\:\/\/(\S+)?(?:(.?lichess.org\/.*).*)).*$/,d=t=>{let e=s.exec(t);return e&&e[0]},c=async t=>{let e=(await Promise.resolve().then(a.t.bind(a,15734,23))).default;return(await e.get("/api/v1/lichess-embed").query({url:t.trim()})).body},u=async function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(e?{schema:e}:await Promise.resolve().then(a.bind(a,86508))).schema.nodes.lichess.create(await c(t))},m=function(t){let{}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=document.createElement("div");e.className="lichess-wrap static",e.setAttribute("data-component-name","LichessToDOMStatic");let a=document.createElement("a");a.href=t.attrs.url.replace(/embed\//,""),a.setAttribute("target","_blank");let n=document.createElement("img");return n.className="lichess-wrap thumbnail",n.src=(0,r.dJ9)(t.attrs.thumbnail_url,640),n.style.backgroundImage="url(".concat(t.attrs.thumbnail_url,")"),t.attrs.belowTheFold&&n.setAttribute("loading","lazy"),a.append(n),e.appendChild(a),e},p=t=>{let e=document.createElement("div");e.id="lichess-iframe",e.className="lichess-wrap outer",e.dataset.attrs=JSON.stringify(t.attrs),e.setAttribute("data-component-name","LichessToDOM");let a=document.createElement("iframe");return a.id="iframe-lichess",a.className="lichess-iframe",a.src=t.attrs.url,a.width="560",a.height="405px",a.frameBorder="0",t.attrs.belowTheFold&&a.setAttribute("loading","lazy"),e.appendChild(a),e};class g{constructor(t){(0,n._)(this,"dom",void 0);const e=p(t),a=e.querySelector(".lichess-iframe"),r=document.createElement("div");r.className="lichess-screen",r.addEventListener("dblclick",()=>{r.classList.add("sunken"),a.focus()}),a.addEventListener("blur",()=>{r.classList.remove("sunken")}),e.appendChild(r),this.dom=e}}},6905:function(t,e,a){a.d(e,{U:()=>u,c:()=>c});var n=a(50172),r=a(93946),l=a(51131),i=a(39318),o=a(49807),s=a(82061),d=a(29496);let c={attrs:{name:{default:""},avatarUrl:{default:""},url:{default:""},isEditorNode:{default:!1}},group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.meeting-embed",getAttrs:a(78495).t}],toDOM:t=>{if("undefined"!=typeof window&&t.attrs.isEditorNode)try{let e=document.createElement("div");return e.className="meeting-embed",e.setAttribute("data-attrs",JSON.stringify(t.attrs)),(0,r.Mv)((0,n.h)(l.l,{name:t.attrs.name,avatarUrl:t.attrs.avatarUrl,url:t.attrs.url}),e),e}catch(e){return console.error("Error rendering MeetingEmbed",e),(0,s.D)({msg:null,node:t,err:e,group:"block"})}return m(t)},toDOMStatic:t=>m(t)},u=(0,d.C)({name:"meeting",nodeSpec:c,addCommands:()=>({insertMeeting:t=>e=>{let{commands:a,dispatch:n}=e,{publication:r,meetingsConfig:l,usePublicationName:s}=t,d=(0,i.pIF)({id:l.user_id,photo_url:l.user_profile_photo_url});return s&&r.logo_url&&(d=(0,o.dJ9)(r.logo_url,112)),!n||a.insertContent({type:"meeting",attrs:{name:s?r.name:l.user_name,avatarUrl:d,url:(0,o.SJN)(r,{addBase:!0,params:{source:"embed"}}),isEditorNode:!0}})}})}),m=t=>["div",{class:"meeting-embed","data-attrs":JSON.stringify(t.attrs),"data-component-name":"MeetingPlaceholder"}]},63998:function(t,e,a){a.d(e,{X:()=>u,c:()=>c});var n=a(69277),r=a(70408),l=a(50172),i=a(93038),o=a(93946),s=a(82061),d=a(29496);let c={attrs:{name:{default:""},id:{default:null},type:{default:null},url:{default:null},photo_url:{default:null},uuid:{default:null}},atom:!0,editable:!1,selectable:!0,isolating:!1,defining:!0,draggable:!1,inline:!0,group:"inline",parseDOM:[{tag:".mention-wrap",getAttrs:t=>{try{return JSON.parse(t.getElementsByTagName("a")[0].getAttribute("data-attrs"))}catch(t){return!1}}}],toDOM:t=>{if("undefined"!=typeof window)try{var e;let a=document.createElement("span");return a.className="mention-wrap",a.setAttribute("data-attrs",JSON.stringify(t.attrs)),(0,o.Mv)((0,l.h)(i.Ay,{name:(null==(e=t.attrs.name)?void 0:e.trim())||"",id:t.attrs.id||null,type:t.attrs.type||null,url:t.attrs.url||null,photo_url:t.attrs.photo_url||null,uuid:t.attrs.uuid||null,isEditorContext:!0}),a),a}catch(e){return console.error("Error rendering Mention",e),(0,s.D)({msg:null,node:t,err:e,group:"inline"})}return["span",{class:"mention-wrap","data-attrs":JSON.stringify(t.attrs),"data-component-name":"MentionToDOM"}]},toDOMStatic:t=>["span",{class:"mention-wrap","data-attrs":JSON.stringify((0,r._)((0,n._)({},t.attrs),{isStatic:!0})),"data-component-name":"MentionToDOMStatic"}]},u=(0,d.C)({name:"substack_mentions",nodeSpec:c})},30131:function(t,e,a){a.d(e,{FR:()=>p,c:()=>s,qT:()=>d,yJ:()=>u,zN:()=>g});var n=a(15734),r=a.n(n),l=a(39318),i=a(82776),o=a(29496);let s={attrs:{collection:{default:""},collection_slug:{default:""},creator:{default:""},description:{default:""},image_url:{default:""},name:{default:""},animation_url:{default:""},nft_logo_url:{default:""},permalink:{default:""},youtube_url:{default:null},belowTheFold:{default:!1}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.opensea",getAttrs:a(78495).t}],toDOMStatic:function(t){let e=document.createElement("div");e.className="opensea static",e.setAttribute("data-component-name","OpenseaToDOMStatic");let a=document.createElement("table");a.className="opensea-header-table";let n=document.createElement("tr");n.className="opensea-header-row";let r=document.createElement("tr"),o=document.createElement("td"),s=document.createElement("a");s.className="opensea-title",t.attrs.permalink&&s.setAttribute("href",t.attrs.permalink),s.textContent=t.attrs.name,o.appendChild(s),r.appendChild(s);let d=document.createElement("tr"),c=document.createElement("td"),u=document.createElement("a");u.className="opensea-collection",t.attrs.collection_slug&&u.setAttribute("href","https://opensea.io/collection/".concat(t.attrs.collection_slug)),u.textContent=(0,i.truncateText)(t.attrs.collection,50),c.appendChild(u),d.appendChild(c);let m=document.createElement("td"),p=document.createElement("table");m.className="opensea-masthead",p.appendChild(r),p.appendChild(d),m.appendChild(p);let g=document.createElement("td");g.className="nft-logo";let f=document.createElement("a"),b=document.createElement("img");t.attrs.nft_logo_url&&b.setAttribute("src",(0,l.dJ9)(t.attrs.nft_logo_url)),t.attrs.permalink&&f.setAttribute("href",t.attrs.permalink),t.attrs.belowTheFold&&f.setAttribute("loading","lazy"),f.appendChild(b),g.appendChild(f),n.appendChild(m),n.appendChild(g),a.appendChild(n);let h=document.createElement("a");t.attrs.permalink&&h.setAttribute("href",t.attrs.permalink);let y=document.createElement("img");y.className="opensea-image",t.attrs.image_url&&y.setAttribute("src",(0,l.dJ9)(t.attrs.image_url,600,{crop:"fill"})),y.setAttribute("alt",t.attrs.name),y.setAttribute("width","500"),t.attrs.belowTheFold&&y.setAttribute("loading","lazy"),h.appendChild(y);let v=document.createElement("table");v.className="opensea-footer-table";let w=document.createElement("tr"),k=document.createElement("td");k.className="opensea-description",k.textContent=(0,i.truncateText)(t.attrs.description,200),w.appendChild(k);let _=document.createElement("tr"),C=document.createElement("td"),E=document.createElement("a");C.className="opensea-creator",t.attrs.creator&&E.setAttribute("href","https://opensea.io/".concat(t.attrs.creator,"?tab=created")),E.textContent="Created by ".concat((0,i.truncateText)(t.attrs.creator,50)),C.appendChild(E),_.appendChild(C);let O=document.createElement("tr"),S=document.createElement("td"),T=document.createElement("a"),N=document.createElement("table"),M=document.createElement("tr"),D=document.createElement("td");return T.className="opensea-cta-link",t.attrs.permalink&&T.setAttribute("href",t.attrs.permalink),N.setAttribute("cellspacing","16"),N.className="opensea-cta-table",D.className="opensea-cta",D.textContent="View on OpenSea",M.appendChild(D),N.appendChild(M),T.appendChild(N),S.appendChild(T),O.appendChild(S),t.attrs.description&&v.appendChild(w),v.appendChild(_),v.appendChild(O),e.appendChild(a),e.appendChild(h),e.appendChild(v),e.querySelectorAll&&Array.prototype.forEach.call(e.querySelectorAll("a"),t=>{t.target="_blank"}),e},toDOM:function(t){let e,a,n=document.createElement("div");n.className="opensea",n.setAttribute("data-component-name","OpenseaToDOM");let r=document.createElement("a");r.className="opensea-title",t.attrs.permalink&&r.setAttribute("href",t.attrs.permalink),r.textContent=t.attrs.name;let o=document.createElement("a");o.className="opensea-collection",t.attrs.collection_slug&&o.setAttribute("href","https://opensea.io/collection/".concat(t.attrs.collection_slug)),o.textContent=(0,i.truncateText)(t.attrs.collection,50);let s=document.createElement("div");s.className="opensea-masthead",s.appendChild(r),s.appendChild(o);let d=document.createElement("a");t.attrs.permalink&&d.setAttribute("href",t.attrs.permalink);let c=document.createElement("img");t.attrs.nft_logo_url&&c.setAttribute("src",(0,l.dJ9)(t.attrs.nft_logo_url)),t.attrs.belowTheFold&&c.setAttribute("loading","lazy"),d.appendChild(c);let u=document.createElement("div");u.className="opensea-header",u.appendChild(s),u.appendChild(d);let m=document.createElement("a");t.attrs.permalink&&m.setAttribute("href",t.attrs.permalink),m.className="opensea-media-link";let p=["mp3","wav","oga"].some(e=>{var a;return null==(a=t.attrs.animation_url)?void 0:a.endsWith(e)}),g=["gltf","glb","webm","mp4","m4v","ogv","ogg"].some(e=>{var a;return null==(a=t.attrs.animation_url)?void 0:a.endsWith(e)}),f=!t.attrs.animation_url,b=t.attrs.animation_url&&!p&&!g;(f||p||b||t.attrs.youtube_url)&&((a=document.createElement("img")).className="opensea-image",t.attrs.image_url&&a.setAttribute("src",(0,l.dJ9)(t.attrs.image_url,600,{crop:"fill"})),t.attrs.belowTheFold&&a.setAttribute("loading","lazy"),a.setAttribute("alt",t.attrs.name),m.appendChild(a)),(p||g)&&((e=document.createElement(p?"audio":"video")).className="opensea-player",e.setAttribute("controls",!0),e.setAttribute("loop",!0),e.setAttribute("src",t.attrs.animation_url),e.setAttribute("alt","OpenSea NFT media"),t.attrs.belowTheFold&&e.setAttribute("loading","lazy")),a&&m.appendChild(a),e&&m.appendChild(e);let h=document.createElement("div");h.className="opensea-description",h.textContent=(0,i.truncateText)(t.attrs.description,200);let y=document.createElement("a");y.className="opensea-creator",t.attrs.creator&&y.setAttribute("href","https://opensea.io/".concat(t.attrs.creator,"?tab=created")),y.textContent="Created by ".concat((0,i.truncateText)(t.attrs.creator,50));let v=document.createElement("a");v.className="opensea-cta",t.attrs.permalink&&v.setAttribute("href",t.attrs.permalink),v.textContent="View on OpenSea";let w=document.createElement("div");return w.className="opensea-footer",t.attrs.description&&w.appendChild(h),w.appendChild(y),w.appendChild(v),n.appendChild(u),n.appendChild(m),n.appendChild(w),n.querySelectorAll&&Array.prototype.forEach.call(n.querySelectorAll("a"),t=>{t.target="_blank"}),n}},d=(0,o.C)({name:"opensea",nodeSpec:s,addCommands(){return{insertOpensea:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),c=async t=>{var e,a,n,i,o,s;return(await r().get("/api/v1/opensea").query({contract:null==(n=(0,l.Dlv)(t))||null==(a=n.pathname.match(/assets\/(ethereum\/)?(.+)/))||null==(e=a[2])?void 0:e.split("/")[0],token_id:null==(s=(0,l.Dlv)(t))||null==(o=s.pathname.match(/assets\/(ethereum\/)?(.+)/))||null==(i=o[2])?void 0:i.split("/")[1]})).body},u=async(t,e)=>{let{customSchema:a}=e;return a.nodes.opensea.create(await c(t))},m=/^https:\/\/opensea.io\/assets\/.+/,p=t=>{let e=m.exec(t);return e&&e[0]},g=t=>null!==p(t)},41298:function(t,e,a){a.d(e,{DI:()=>b,FL:()=>m,c:()=>u,sF:()=>g});var n=a(50172),r=a(73653),l=a(93946),i=a(39318),o=a(82061),s=a(29496),d=a(78495);let c="pinterest-embed",u={attrs:{url:{default:""},thumbnail_url:{default:""},title:{default:""},author_name:{default:""},author_url:{default:""},belowTheFold:{default:!1}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDom:[{tag:"div.pinterest-embed-wrap",getAttrs:d.t}],toDOM:t=>y(t),toDOMStatic:t=>h(t)},m=(0,s.C)({name:"pinterest",nodeSpec:u,addCommands(){return{insertPinterest:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),p=/^https?:\/\/(?:(?:www\.)?pinterest\.com\/(?:pin\/[^/]+|[^/]+\/[^/]+)|pin\.it\/[^/]+)\/?.*$/,g=t=>{let e=p.exec(t);return e&&e[0]},f=async t=>{let e=(await Promise.resolve().then(a.t.bind(a,15734,23))).default;return(await e.get("/api/v1/pinterest-embed").query({url:t.trim()})).body},b=async function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(e?{schema:e}:await Promise.resolve().then(a.bind(a,86508))).schema;if(!n.nodes.pinterest)throw Error("Pinterest node type not found in schema");return n.nodes.pinterest.create(await f(t))},h=t=>{let e=t.attrs.url||"",a=350,n=350,r=350,l=350;return t.attrs.thumbnail_url?t.attrs.width&&t.attrs.height?(a=t.attrs.width,l=Math.round((n=t.attrs.height)*(r=Math.min(a,i.oSl))/a),["table",{className:"image-wrapper",width:"100%",border:"0",cellSpacing:"0",cellPadding:"0","data-component-name":"PinterestToDOMStatic"},["tr",{},["td",{}],["td",{align:"left",className:"content",width:String(r)},["a",{className:"image-link",target:"_blank",href:e},["img",{"data-attrs":JSON.stringify(t.attrs),alt:t.attrs.title||"Pinterest Pin",title:t.attrs.title||"Pinterest Pin",width:String(r),height:String(l),className:a>i.oSl?"wide-image":"",src:(0,i.dJ9)(t.attrs.thumbnail_url,2*Math.min(a,i.oSl)),loading:t.attrs.belowTheFold?"lazy":null}]]],["td",{}]],["tr",{},["td",{}],["td",{align:"center"},["figcaption",{className:"image-caption",style:"box-sizing: content-box;color: #777777;font-size: 14px;line-height: 20px;font-weight: 400;letter-spacing: -.15px;margin-top: 8px;width: 70%;padding-left: 15%;padding-right: 15%;text-align: center;"},["a",{href:t.attrs.url||"#",target:"_blank",style:"color: inherit; text-decoration: none;"},t.attrs.title||"View on Pinterest"]]],["td",{}]]]):["table",{className:"image-wrapper",width:"100%",border:"0",cellSpacing:"0",cellPadding:"0","data-component-name":"PinterestToDOMStatic"},["tr",{},["td",{}],["td",{align:"left",className:"content",width:String(350)},["a",{className:"image-link",target:"_blank",href:e},["img",{"data-attrs":JSON.stringify(t.attrs),alt:t.attrs.title||"Pinterest Pin",title:t.attrs.title||"Pinterest Pin",src:(0,i.dJ9)(t.attrs.thumbnail_url,2*i.oSl),loading:t.attrs.belowTheFold?"lazy":null}]]],["td",{}]],["tr",{},["td",{}],["td",{align:"center"},["figcaption",{class:"image-caption",style:"box-sizing: content-box;color: #777777;font-size: 14px;line-height: 20px;font-weight: 400;letter-spacing: -.15px;margin-top: 8px;width: 70%;padding-left: 15%;padding-right: 15%;text-align: center;"},["a",{href:t.attrs.url||"#",target:"_blank",style:"color: inherit; text-decoration: none;"},t.attrs.title||"View on Pinterest"]]],["td",{}]]]:["table",{className:"image-wrapper pinterest-text-wrapper",width:"100%",border:"0",cellSpacing:"0",cellPadding:"0","data-component-name":"PinterestToDOMStatic"},["tr",{},["td",{}],["td",{align:"left",className:"content",width:String(350)},["a",{className:"image-link pinterest-text-link",target:"_blank",href:e},["div",{className:"pinterest-fallback-text",style:"padding: 10px; border: 1px solid #e8e8e8; border-radius: 4px; text-align: center;"},["div",{className:"pinterest-identifier",style:"font-weight: bold; margin-bottom: 5px;"},"Pinterest"],["span",{style:"display: block;"},["a",{href:t.attrs.url||"#",target:"_blank",style:"color: inherit; text-decoration: none;"},t.attrs.title||"View on Pinterest"]],t.attrs.author_name?["span",{className:"pinterest-author",style:"display: block; margin-top: 8px; font-size: 0.9em; color: #666;"},"By ".concat(t.attrs.author_name)]:null]]],["td",{}]]]},y=t=>{if("undefined"!=typeof window)try{let e=document.createElement("div");return e.setAttribute("data-attrs",JSON.stringify(t.attrs)),e.className=c,e.setAttribute("data-component-name","PinterestNodeWrapper"),(0,l.Mv)((0,n.h)(r.L,{attrs:t.attrs}),e),e}catch(e){return console.error("Error rendering PinterestNode:",e),(0,o.D)({msg:"Error rendering Pinterest embed",node:t,err:e,group:"block"})}let e=document.createElement("div");e.className="".concat(c," pinterest-ssr-fallback"),e.setAttribute("data-attrs",JSON.stringify(t.attrs)),e.setAttribute("data-component-name","PinterestToDOMPreact");let a=document.createElement("p");return a.textContent="Loading Pinterest Pin...",e.appendChild(a),e}},76527:function(t,e,a){a.d(e,{c:()=>u,m:()=>m});var n=a(69277),r=a(50172),l=a(64998),i=a(93946),o=a(82061),s=a(29496),d=a(78495);let c="poll-embed",u={attrs:{id:{default:null}},group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:c,getAttrs:d.t}],toDOM:t=>{if("undefined"!=typeof window)try{let e=document.createElement("div");return e.setAttribute("data-attrs",JSON.stringify(t.attrs)),e.className=c,(0,i.Mv)((0,r.h)(l.sP,{id:t.attrs.id,isEditor:!0}),e),e}catch(e){return console.error("Error rendering Poll",e),(0,o.D)({msg:null,node:t,err:e,group:"block"})}return["div",{class:c,"data-attrs":JSON.stringify(t.attrs),"data-component-name":"PollToDOM"}]},toDOMStatic:t=>["div",{class:c,"data-attrs":JSON.stringify((0,n._)({isEmail:!0},t.attrs)),"data-component-name":"PollToDOMStatic"}]},m=(0,s.C)({name:"poll",nodeSpec:u,addCommands(){return{insertPoll:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}})},60440:function(t,e,a){a.d(e,{LL:()=>p,c:()=>m,hI:()=>f});var n=a(50172),r=a(65113),l=a(93946),i=a(46754),o=a(39318),s=a(82061),d=a(29496),c=a(78495);let u="polymarket-embed",m={attrs:{eventSlug:{default:""},marketSlug:{default:""},profileName:{default:""},belowTheFold:{default:!1},fullEmbedUrl:{default:""},isGraphMode:{default:!1}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDom:[{tag:"div.".concat(u),getAttrs:c.t}],toDOM:t=>{if("undefined"!=typeof window)try{let e=document.createElement("div");return e.setAttribute("data-attrs",JSON.stringify(t.attrs)),e.className=u,e.setAttribute("data-component-name","PolymarketNodeWrapper"),(0,l.Mv)((0,n.h)(r.t,{attrs:t.attrs}),e),e}catch(e){return console.error("Error rendering PolymarketNode:",e),(0,s.D)({msg:"Error rendering Polymarket embed",node:t,err:e,group:"block"})}return["div",{class:u,"data-attrs":JSON.stringify(t.attrs),"data-component-name":"PolymarketToDOM"}]},toDOMStatic:t=>b(t)},p=(0,d.C)({name:"polymarket",nodeSpec:m,addCommands(){return{insertPolymarket:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),g=async t=>{let e=(0,i.RP)(t);if(!e)throw Error("Invalid Polymarket URL");return e},f=async function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(e?{schema:e}:await Promise.resolve().then(a.bind(a,86508))).schema.nodes.polymarket.create(await g(t))},b=function(t){let e,a,n,{}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=document.createElement("div");if(r.className="polymarket-wrap static",r.setAttribute("data-component-name","PolymarketToDOMStatic"),t.attrs.profileName){let r=Math.floor(new Date().getTime()/6e4);e="".concat((0,o.$_T)(),"/api/v1/polymarket-embed-image/profile/").concat(t.attrs.profileName,"?timestamp=").concat(r),a="".concat((0,o.$_T)(),"/polymarket/link/profile/").concat(t.attrs.profileName,"?click_target=email"),n="Polymarket profile"}else{let r=Math.floor(new Date().getTime()/6e4);e="".concat((0,o.$_T)(),"/api/v1/polymarket-embed-image/").concat(t.attrs.eventSlug).concat(t.attrs.marketSlug?"/".concat(t.attrs.marketSlug):"","?timestamp=").concat(r).concat(t.attrs.isGraphMode?"&graphMode=true":""),a="".concat((0,o.$_T)(),"/polymarket/link/").concat(t.attrs.eventSlug).concat(t.attrs.marketSlug?"/".concat(t.attrs.marketSlug):"","?click_target=email"),n="Polymarket prediction market"}let l=document.createElement("p"),i=document.createElement("a");i.href=a,i.target="_blank";let s=document.createElement("img");return s.className="polymarket-image",s.src=(0,o.dJ9)(e,800),s.width=400,s.height=120,s.alt=n,i.appendChild(s),l.appendChild(i),r.appendChild(l),r}},41758:function(t,e,a){a.d(e,{Iu:()=>o,J7:()=>c,c:()=>i,hG:()=>f,i1:()=>m,ny:()=>s});var n=a(99851),r=a(39318),l=a(29496);let i={attrs:{url:{default:""},thumbnail_url:{default:""}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDom:[{tag:"div.prediction-market-wrap",getAttrs:a(78495).t}],toDOM:t=>g(t),toDOMStatic:t=>p(t)},o=(0,l.C)({name:"prediction_market",nodeSpec:i,addCommands(){return{insertPredictionMarket:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),s=(0,l.C)({name:"manifold",nodeSpec:i}),d=/^.*(https?:\/\/(\S+)?(?:(.?manifold\.markets|metaculus\.com\/questions\/.*\/|polymarket\.com\/event\/[^\/]+(\/[^\/]+)?))).*$/,c=t=>{let e=d.exec(t);return e&&e[0]},u=async t=>{let e=(await Promise.resolve().then(a.t.bind(a,15734,23))).default;return(await e.get("/api/v1/prediction-embed").query({url:t.trim()})).body},m=async function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(e?{schema:e}:await Promise.resolve().then(a.bind(a,86508))).schema.nodes.prediction_market.create(await u(t))},p=function(t){let{}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=document.createElement("div");e.className="prediction-market-wrap static",e.setAttribute("data-component-name","PredictionMarketToDOMStatic");let a=document.createElement("a");a.href=t.attrs.url.replace(/embed\//,""),a.setAttribute("target","_blank");let n=document.createElement("img");return n.className="prediction-market thumbnail",n.src=(0,r.dJ9)(t.attrs.thumbnail_url,640),n.style.backgroundImage="url(".concat(t.attrs.thumbnail_url,")"),t.attrs.belowTheFold&&n.setAttribute("loading","lazy"),a.append(n),e.appendChild(a),e},g=t=>{let e=document.createElement("div"),a=t.attrs.url.includes("polymarket");e.id="prediction-market-iframe",e.className="prediction-market-wrap outer",e.dataset.attrs=JSON.stringify(t.attrs),e.setAttribute("data-component-name","PredictionMarketToDOM");let n=document.createElement("iframe");return n.id="iframe-prediction-market",n.className="prediction-market-iframe",n.src=t.attrs.url,n.width=a?"400px":"560px",n.height=a?"180px":"405px",n.frameBorder="0",t.attrs.belowTheFold&&n.setAttribute("loading","lazy"),e.appendChild(n),e};class f{constructor(t){(0,n._)(this,"dom",void 0);const e=g(t),a=e.querySelector(".prediction-market-iframe"),r=document.createElement("div");r.className="prediction-market-screen",r.addEventListener("dblclick",()=>{r.classList.add("sunken"),a.focus()}),a.addEventListener("blur",()=>{r.classList.remove("sunken")}),e.appendChild(r),this.dom=e}}},14489:function(t,e,a){a.d(e,{Q:()=>l,c:()=>r});var n=a(29496);let r={content:"text*",group:"block",code:!0,defining:!0,isolating:!0,attrs:{params:{default:""},language:{default:"en"}},parseDOM:[{tag:"pre.text",preserveWhitespace:"full",priority:60}],toDOM:()=>{var t,e,a;let{iString:n}=I18N.i("undefined"!=typeof window&&null!=(a=null==(e=window._preloads)||null==(t=e.pub)?void 0:t.language)?a:"en");return["div",{class:"preformatted-block","data-component-name":"PreformattedTextBlockToDOM"},["label",{class:"hide-text",contenteditable:!1},n("Text within this block will maintain its original spacing when published")],["pre",{class:"text"},0]]},toDOMStatic:()=>["pre",{class:"text","data-component-name":"PreformattedTextBlockToDOMStatic"},0]},l=(0,n.C)({name:"preformatted_text_block",nodeSpec:r})},88457:function(t,e,a){a.d(e,{c:()=>l,h:()=>i});var n=a(39318),r=a(29496);let l={attrs:{pub:{default:null},uuid:{default:null}},inline:!1,atom:!0,group:"block",draggable:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.install-substack-app-embed.preview-inapp"}],toDOM:t=>{let{pub:e,uuid:a}=t.attrs,{iString:r}=I18N.i({pub:e}),l="object"==typeof e?(0,n.$_T)(e):(0,n.$_T)({id:e}),i=e.logo_url||"".concat(l,"/img/substack.png");return["div",{class:"install-substack-app-embed preview-inapp","data-component-name":"PreviewInSubstackAppToDOM"},["img",{class:"install-substack-app-embed-img",src:(0,n.dJ9)(i)}],["div",{class:"install-substack-app-embed-text"},["div",{class:"install-substack-app-header"},r("Test in the Substack app")],["div",{class:"install-substack-app-text"},r("This section is only visible to you")]],["a",{href:(0,n.UuW)(e,a),target:"_blank",class:"install-substack-app-embed-link"},["button",{class:"install-substack-app-embed-btn button primary"},r("Open in app")]]]},toDOMStatic:t=>{let{pub:e,uuid:a}=t.attrs,{iString:r}=I18N.i({pub:e}),l="object"==typeof e?(0,n.$_T)(e):(0,n.$_T)({id:e}),i=e.logo_url||"".concat(l,"/img/substack.png");return["div",{class:"install-substack-app-embed preview-inapp","data-component-name":"PreviewInSubstackAppToDOMStatic"},["table",{class:"install-substack-embed-table"},["tr",{},["td",{rowspan:2},["img",{class:"install-substack-app-embed-img",src:(0,n.dJ9)(i),width:64,height:64}]],["td",{class:"install-substack-app-header"},r("Test in the Substack app")]],["tr",{},["td",{class:"install-substack-app-text"},r("This section is only visible to you")]],["tr",{},["td",{colspan:2},["a",{href:(0,n.UuW)(e,a),target:"_blank",class:"install-substack-app-embed-link"},["button",{class:"install-substack-app-embed-btn button primary"},r("Open in app")]]]]]]}},i=(0,r.C)({name:"preview_in_substack_app",nodeSpec:l})},88213:function(t,e,a){a.d(e,{c:()=>o,k:()=>s});var n=a(69277),r=a(70408),l=a(88285),i=a(31583);let o={attrs:{align:{default:null},color:{default:null}},content:"block+",group:"block",defining:!0,parseDOM:[{tag:"q"},{tag:"div.pullquote"}],toDOM:t=>{let e=["pullquote"];return"wide"===t.attrs.align&&e.push("pullquote-align-wide"),"left"===t.attrs.align&&e.push("pullquote-align-left"),"right"===t.attrs.align&&e.push("pullquote-align-right"),"center"===t.attrs.align&&e.push("pullquote-align-center"),t.attrs.color&&e.push("pullquote-color-".concat(t.attrs.color)),["div",{class:e.join(" ")},0]},toDOMStatic:t=>["div",{class:"pullquote"},0]},s=l.bP.create({name:"pullquote",defining:!0,content:o.content,group:o.group,addAttributes:()=>({align:{default:null},color:{default:null}}),renderHTML:t=>o.toDOM(t.node),parseHTML:()=>o.parseDOM,addNodeView(){let{PullquoteEditor:t}=a(15275);return(0,i.gu)(t)},addCommands(){let t=(t,e)=>a=>{let{state:l,dispatch:i}=a,{from:o,to:s}=l.selection,{pullquote:d}=l.schema.nodes,c=null,u=null;if(l.doc.nodesBetween(o,s,(t,e)=>{if(t.type===d)return c=t,u=e,!1}),!c||null===u)return!1;if(i){let a=l.tr,o=c.attrs;a.setNodeMarkup(u,void 0,(0,r._)((0,n._)({},o),{[t]:e})),i(a)}return!0};return{setPullquote:()=>t=>{let{state:e,commands:a}=t;return!(!(0,l.rU)(e,"paragraph")||(0,l.rU)(e,"blockquote")||(0,l.rU)(e,"calloutBlock"))&&a.wrapIn(this.name)},togglePullquote:()=>t=>{let{state:e,commands:a}=t;return!(!(0,l.rU)(e,"paragraph")||(0,l.rU)(e,"blockquote")||(0,l.rU)(e,"calloutBlock"))&&a.toggleWrap(this.name)},unsetPullquote:()=>t=>{let{commands:e}=t;return e.lift(this.name)},setPullquoteAlign:e=>t("align",e),setPullquoteColor:e=>t("color",e)}}})},96384:function(t,e,a){a.d(e,{X:()=>f,c:()=>g});var n=a(69277),r=a(50172),l=a(88285),i=a(31583),o=a(93946),s=a(8321),d=a(13086),c=a(82061),u=a(29496),m=a(78495);let p="recipe-embed",g={attrs:{id:{default:null}},group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!1,defining:!1,parseDOM:[{tag:p,getAttrs:m.t}],toDOM:t=>{if("undefined"!=typeof window)try{let e=document.createElement("div");return e.setAttribute("data-attrs",JSON.stringify(t.attrs)),e.setAttribute("data-component-name","RecipeToDOM"),e.className=p,(0,o.Mv)((0,r.h)(d.R,{node:{attrs:{id:t.attrs.id}}}),e),e}catch(e){return console.error("Error rendering RecipeNode",e),(0,c.D)({msg:null,node:t,err:e,group:"block"})}return["div",{class:p,"data-attrs":JSON.stringify(t.attrs),"data-component-name":"RecipeToDOM"}]},toDOMStatic:t=>["div",{class:p,"data-attrs":JSON.stringify((0,n._)({isEmail:!0},t.attrs)),"data-component-name":"RecipeToDomStatic"}],renderHTML(t){let{HTMLAttributes:e}=t;return["recipe",(0,l.KV)(this.options.HTMLAttributes,e)]},parseHTML:()=>[{tag:"recipe"}],addNodeView:()=>(0,i.gu)(s.Y)},f=(0,u.C)({name:"recipe",nodeSpec:g,addCommands(){return{insertRecipe:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}})},48818:function(t,e,a){a.d(e,{M:()=>i,c:()=>l});var n=a(98111),r=a(29496);let l={attrs:{name:{default:null},subdomain:{default:""}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.referral-link",getAttrs:a(78495).t}],toDOM:t=>{let e=t.attrs.name||"".concat(t.attrs.subdomain,".substack.com"),a=document.createElement("div");a.className="referral-link",a.setAttribute("data-attrs",JSON.stringify(t.attrs)),a.setAttribute("data-component-name","ReferralLinkToDOM");let r=document.createElement("h4");a.appendChild(r);let l=document.createElement("a");l.textContent=n.T.PRINTED_REFERRAL_URL,l.href="http://".concat(n.T.REFERRAL_URL),r.appendChild(l),l.addEventListener("click",t=>{if(l.href.endsWith("%%")){t.preventDefault();let e=window.open("/?referral_code=test&showWelcome=true","_blank");e&&e.focus&&e.focus()}});let i=document.createElement("a");return i.className="button primary",i.textContent="Share your referral link",i.href="mailto:?subject=".concat(encodeURIComponent("Check out ".concat(e)),"&body=").concat(encodeURIComponent("Subscribe using my link: "),"http://").concat(n.T.REFERRAL_URL),a.appendChild(i),a}},i=(0,r.C)({name:"referral_link",nodeSpec:l})},40282:function(t,e,a){a.d(e,{Pk:()=>c,c:()=>d});var n=a(69277),r=a(50172),l=a(21471),i=a(93946),o=a(82061),s=a(29496);let d={attrs:{isEditorNode:{default:!1},numReferralsRequired:{default:null},rewardDescription:{default:null},pub:{default:{}},tierNumber:{default:null}},atom:!0,content:"",isolating:!1,defining:!1,group:"block",parseDOM:[{getAttrs:a(78495).t,tag:".referrals-tier-card"}],toDOM:t=>{if("undefined"!=typeof window)try{let e=document.createElement("div");return e.className="referrals-tier-card",e.setAttribute("data-attrs",JSON.stringify(t.attrs)),(0,i.Mv)((0,r.h)(l.P,{numReferralsRequired:t.attrs.numReferralsRequired,rewardDescription:t.attrs.rewardDescription,pub:m(t.attrs.pub),tierNumber:t.attrs.tierNumber}),e),e}catch(e){return console.error("Error rendering ReferralsTierCardComponent",e),(0,o.D)({msg:null,node:t,err:e,group:"block"})}return u(t)},toDOMStatic:t=>u(t)},c=(0,s.C)({name:"referralTier",nodeSpec:d}),u=t=>["div",{class:"referrals-tier-card","data-attrs":JSON.stringify(t.attrs),"data-component-name":"ReferralsTierCardPlaceholder"}],m=t=>{let e=(0,n._)({},t);return delete e.email_render_elements,e}},75594:function(t,e,a){a.d(e,{AF:()=>d,RX:()=>s,c:()=>o,d1:()=>u});var n=a(69277),r=a(39318),l=a(91809),i=a(29496);let o={attrs:{url:{default:""},title:{default:""},description:{default:""},thumbnail_url:{default:""},author_name:{default:""},author_url:{default:""},targetUrl:{default:""}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.soundcloud-wrap",getAttrs:a(78495).t}],toDOM:t=>["div",{class:"soundcloud-wrap","data-attrs":JSON.stringify(t.attrs),"data-component-name":"SoundcloudToDOM"},["iframe",{src:(0,r.oRR)("https://w.soundcloud.com/player/?auto_play=false&buying=false&liking=false&download=false&sharing=false&show_artwork=true&show_comments=false&show_playcount=false&show_user=true&hide_related=true&visual=false&start_track=0",{url:t.attrs.url}),frameborder:"0",gesture:"media",scrolling:"no",allowfullscreen:"true"}]],toDOMStatic:t=>{let{thumbnail_url:e,author_name:a,title:n,targetUrl:r}=t.attrs;return(0,l.e)(e,n,a,null,{targetUrl:r})}},s=(0,i.C)({name:"soundcloud",nodeSpec:o,addCommands(){return{insertSoundcloud:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),d=function(t){var e;let{customSchema:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(a&&!a.nodes.soundcloud)return null;let n=/^.*(https?\:\/\/(www\.)?soundcloud.com\/[^\/]+\/[^\/]+(\/[^\/]+)?(\?[\#]*)?(\#.*)?).*$/.exec(t);return null!=(e=n&&n[1])?e:null},c=async t=>{let e=(await Promise.resolve().then(a.t.bind(a,15734,23))).default,r=(await e.get("/api/v1/soundcloud").query({url:t.trim()})).body;return(0,n._)({targetUrl:t.trim()},r)},u=async function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(e?{schema:e}:await Promise.resolve().then(a.bind(a,86508))).schema.nodes.soundcloud.create(await c(t))}},66613:function(t,e,a){a.d(e,{N:()=>m,c:()=>u});var n=a(69277),r=a(50172),l=a(54515),i=a(93946),o=a(82061),s=a(29496),d=a(78495);let c="sponsorship-campaign-embed",u={attrs:{id:{default:null},pub:{default:null}},group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:c,getAttrs:d.t}],toDOM:t=>{if("undefined"!=typeof window){var e;let a=null==(e=window._preloads)?void 0:e.pub,n=null==a?void 0:a.sponsorshipCampaigns;if(!n)return["div",{class:c,"data-attrs":JSON.stringify(t.attrs),"data-component-name":"SponsorshipCampaignToDOM",text:"Sponsorship campaign not found"}];let s=n[t.attrs.id];if(!s)return["div",{class:c,"data-attrs":JSON.stringify(t.attrs),"data-component-name":"SponsorshipCampaignToDOM",text:"Sponsorship campaign not found"}];try{let e=document.createElement("div");return e.setAttribute("data-attrs",JSON.stringify(t.attrs)),e.className=c,(0,i.Mv)((0,r.h)(l.eF,{campaign:s,isEditor:!0,pub:a}),e),e}catch(e){return console.error("Error rendering SponsorshipCampaign",e),(0,o.D)({msg:null,node:t,err:e,group:"block"})}}return["div",{class:c,"data-attrs":JSON.stringify(t.attrs),"data-component-name":"SponsorshipCampaignToDOM"}]},toDOMStatic:t=>["div",{class:c,"data-attrs":JSON.stringify((0,n._)({isEmail:!0},t.attrs)),"data-component-name":"SponsorshipCampaignToDOMStatic"}]},m=(0,s.C)({name:"sponsorshipCampaign",nodeSpec:u,addCommands(){return{insertSponsorshipCampaign:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}})},52910:function(t,e,a){a.d(e,{P:()=>i,c:()=>l});var n=a(39318),r=a(29496);let l={attrs:{image:{default:""},title:{default:""},subtitle:{default:""},description:{default:""},url:{default:""}},inline:!0,group:"inline",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,toDOM:t=>["iframe",{class:"spotify-wrap","data-attrs":JSON.stringify(t.attrs),src:"https://open.spotify.com/embed?uri=".concat(encodeURIComponent(t.attrs.url),"&view=coverart&theme=white"),frameborder:"0",gesture:"media",allowfullscreen:"true","data-component-name":"SpotifyToDOM"}],toDOMStatic:t=>["a",{class:"spotify-wrap",href:t.attrs.url,"data-component-name":"SpotifyToDOMStatic"},["img",{class:"cover",src:(0,n.dJ9)("/img/spotify_play.png?v=1",156),style:"background-image:url(".concat(t.attrs.image,")")}],["span",{class:"content"},["img",{class:"logo",src:(0,n.dJ9)("/img/spotify_logo.png",40)}],["span",{class:"title"},t.attrs.title],["span",{class:"subtitle"},t.attrs.subtitle],["span",{class:"description"},t.attrs.description]]]},i=(0,r.C)({name:"spotify",nodeSpec:l})},84262:function(t,e,a){a.d(e,{Xs:()=>d,c:()=>l,hJ:()=>i,mc:()=>o});var n=a(91809),r=a(29496);let l={attrs:{image:{default:""},title:{default:""},subtitle:{default:""},description:{default:""},url:{default:""},belowTheFold:{default:!1},noScroll:{default:!1}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"iframe.spotify-wrap",getAttrs:a(78495).t}],toDOM:t=>{let e="spotify-wrap",a=c(t.attrs.url).params;return(null==a?void 0:a.show)||(null==a?void 0:a.episode)?e+=" podcast":(null==a?void 0:a.playlist)?e+=" playlist":(null==a?void 0:a.album)?e+=" album":(null==a?void 0:a.artist)&&(e+=" artist"),["iframe",{class:e,"data-attrs":JSON.stringify(t.attrs),src:u(t.attrs.url),frameborder:"0",gesture:"media",allowfullscreen:"true",allow:"encrypted-media",loading:t.attrs.belowTheFold?"lazy":null,"data-component-name":"Spotify2ToDOM",scrolling:t.attrs.noScroll?"no":null}]},toDOMStatic:t=>{let{image:e,title:a,subtitle:r,description:l,url:i}=t.attrs;return(0,n.e)(e,a,r,l,{targetUrl:i})}},i=(0,r.C)({name:"spotify2",nodeSpec:l,addCommands(){return{insertSpotify:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),o=function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e&&!e.nodes.spotify2?null:c(t).url},s=async t=>{let e=(await Promise.resolve().then(a.t.bind(a,15734,23))).default;return(await e.get("/api/v1/spotify").query({url:t})).body},d=async(t,e)=>{let{customSchema:a}=e;return a.nodes.spotify2.create(await s(t))},c=t=>{var e,a,n,r;if(null==t?void 0:t.includes("anchor.fm")){let n=/((?:https?:\/\/(?:www\.)?anchor\.fm\/(?:embed\/)?|anchor:)([^"'\s\b?#()]*))/.exec(t);if(n)return{params:{show:"podcast"},url:null!=(e=n[1])?e:null,base:null!=(a=n[2])?a:null,platform:"anchor"}}let l=/((?:https?:\/\/(open|podcasters)\.spotify\.com\/(?:embed\/)?|spotify:)([^"'\s\b?#()]*)(?:[?#][\S]*)?)/.exec(t);if(!l)return{params:null,url:null,base:null,platform:null};let i=l[3].split(/[/:]/),o={};for(let t=1;t<i.length;t+=2)o[i[t-1]]=i[t];return{params:o,url:null!=(n=l[1])?n:null,base:null!=(r=l[2])?r:null,platform:"spotify"}},u=t=>{let{params:e,base:a,platform:n}=c(t),r=[];if(e){if("anchor"===n)return"https://anchor.fm/".concat(a);if("open"===a)e.user&&e.playlist?r.push("user",e.user,"playlist",e.playlist):e.playlist?r.push("playlist",e.playlist):e.album?r.push("album",e.album):e.track?r.push("track",e.track):e.artist?r.push("artist",e.artist):e.show?r.push("show",e.show):e.pod?r.push("pod",e.pod):(e.episode||e.episodes)&&r.push("episode",e.episode||e.episodes);else for(let[t,a]of Object.entries(e))a&&(r.push(t),r.push(a));return"https://".concat(a,".spotify.com/").concat("open"===a?"embed":"","/").concat(r.join("/"))}}},51600:function(t,e,a){a.d(e,{T:()=>i,c:()=>l});var n=a(82086),r=a(29496);let l={content:"ctaCaption",attrs:{url:{default:null},text:{default:null},language:{default:"en"}},inline:!1,group:"block",draggable:!0,atom:!1,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.subscription-widget-wrap",getAttrs:a(78495).t}],toDOM:t=>{let{text:e,language:a}=t.attrs,{iString:n}=I18N.i(a);return["div",{class:"subscription-widget-wrap-editor","data-attrs":JSON.stringify(t.attrs),"data-component-name":"SubscribeWidgetToDOM"},["div",{class:"subscription-widget show-subscribe"},["div",{class:"preamble"},0],["form",{class:"subscription-widget-subscribe"},["input",{type:"email",class:"email-input",name:"email",placeholder:n("Type your email"),tabindex:-1}],["input",{type:"submit",class:"button primary",value:e}],["div",{class:"fake-input-wrapper"},["div",{class:"fake-input"}],["div",{class:"fake-button"}]]]]]},toDOMStatic:t=>["div",{class:"subscription-widget-wrap","data-component-name":"SubscribeWidgetToDOMStatic"},["div",{class:"subscription-widget show-subscribe"},["div",{class:"preamble"},0],(0,n.Tf)(t)]]},i=(0,r.C)({name:"subscribeWidget",nodeSpec:l,addCommands(){return{insertSubscribeWidget:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}})},47727:function(t,e,a){a.d(e,{E:()=>l,c:()=>r});var n=a(29496);let r={content:"block+",group:"block",defining:!1,isolating:!1,attrs:{params:{default:""}},parseDOM:[{tag:"pre.template-comment"}],toDOM:()=>["pre",{class:"template-comment","data-component-name":"TemplateCommentToDOM"},["code",0]]},l=(0,n.C)({name:"templateComment",nodeSpec:r})},14304:function(t,e,a){a.d(e,{S$:()=>c,c:()=>o,e1:()=>b,z7:()=>m,zh:()=>s});var n=a(99851),r=a(98111),l=a(39318),i=a(29496);let o={attrs:{url:{default:""},title:{default:""},thumbnail_url:{default:""},author:{default:""},embed_url:{default:""},author_url:{default:""},belowTheFold:{default:!1}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDom:[{tag:"div.tiktok-wrap",getAttrs:a(78495).t}],toDOM:t=>f(t),toDOMStatic:t=>g(t)},s=(0,i.C)({name:"tiktok",nodeSpec:o,addCommands(){return{insertTiktok:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),d=/^.*(https?\:\/\/(\S+)?(?:vt.tiktok.com\/|(.?tiktok.com\/.*\/video\/).*)).*$/,c=t=>{let e=d.exec(t);return e&&e[0]},u=async t=>{let e=(await Promise.resolve().then(a.t.bind(a,15734,23))).default;return(await e.get("/api/v1/tiktok").query({url:t.trim()})).body},m=async function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(e?{schema:e}:await Promise.resolve().then(a.bind(a,86508))).schema.nodes.tiktok.create(await u(t))},p=t=>"tiktok-".concat(null==t?void 0:t.split("/").slice(-1)[0]),g=function(t){var e,a,n,i;let{useTikTokUrl:o=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=document.createElement("div");s.className="tiktok-wrap static",s.setAttribute("data-component-name","TikTokCreateStaticTikTokEmbed");let d="".concat(o?t.attrs.url:"".concat(r.T.POST_URL,"/#tiktok-").concat(null==(e=t.attrs.embed_url)?void 0:e.split("/").slice(-1)[0])),c=document.createElement("a");c.href=d,c.setAttribute("target","_blank");let u=document.createElement("img");u.className="tiktok thumbnail",u.src=(0,l.dJ9)(t.attrs.thumbnail_url,640),u.style.backgroundImage="url(".concat((0,l.dJ9)(t.attrs.thumbnail_url),")"),t.attrs.belowTheFold&&u.setAttribute("loading","lazy"),c.append(u);let m=document.createElement("div");m.classList.add("content");let p=document.createElement("a");p.classList.add("author"),p.href=t.attrs.author_url,p.setAttribute("target","_blank"),p.appendChild(document.createTextNode((null==(i=t.attrs.author_url)||null==(n=i.split)||null==(a=n.call(i,"/").slice(-1))?void 0:a[0])||t.attrs.author));let g=document.createElement("a");return g.classList.add("title"),g.href=d,g.setAttribute("target","_blank"),g.appendChild(document.createTextNode(t.attrs.title)),m.appendChild(p),m.appendChild(g),s.appendChild(c),s.appendChild(m),s},f=t=>{var e;let a=t.attrs.embed_url,n=document.createElement("div");n.id=p(a),n.className="tiktok-wrap outer",n.dataset.attrs=JSON.stringify(t.attrs),n.setAttribute("data-component-name","TikTokCreateTikTokEmbed");let r=document.createElement("iframe");r.id="iframe-".concat(p(a)),r.className="tiktok-iframe",r.src=a,r.frameBorder="0",null==(e=r.setAttribute)||e.call(r,"allow","autoplay; fullscreen; encrypted-media"),r.allowFullscreen="true",r.allowautoplay="true",r.allowfullscreen="true",r.scrolling="no",t.attrs.belowTheFold&&r.setAttribute("loading","lazy"),n.appendChild(r);let i=document.createElement("iframe");i.src="https://team-hosted-public.s3.amazonaws.com/set-then-check-cookie.html",i.id="third-party-iframe-".concat(p(a)),i.className="third-party-cookie-check-iframe",i.style.display="none",t.attrs.belowTheFold&&i.setAttribute("loading","lazy"),n.append(i);let o=g(t,{useTikTokUrl:!0});n.appendChild(o);let s=document.createElement("div");s.classList.add("fallback-failure"),s.id="fallback-failure-".concat(p(a));let d=document.createElement("div");d.classList.add("error-content");let c=document.createElement("img");return c.classList.add("error-icon"),c.src=(0,l.oOP)("/img/alert-circle.svg"),t.attrs.belowTheFold&&c.setAttribute("loading","lazy"),d.appendChild(c),d.appendChild(document.createTextNode("Tiktok failed to load.")),d.appendChild(document.createElement("br")),d.appendChild(document.createElement("br")),d.appendChild(document.createTextNode("Enable 3rd party cookies or use another browser")),s.appendChild(d),n.appendChild(s),n};class b{constructor(t){(0,n._)(this,"dom",void 0);const e=f(t),a=e.querySelector(".tiktok-iframe"),r=document.createElement("div");r.className="tiktok-screen";const l=document.createElement("h1");l.className="instructions",l.innerText="Double click to interact",r.appendChild(l),r.addEventListener("dblclick",()=>{r.classList.add("sunken"),a.focus()}),a.addEventListener("blur",()=>{r.classList.remove("sunken")}),e.appendChild(r),this.dom=e}}},23491:function(t,e,a){a.d(e,{S:()=>d,c:()=>s});var n=a(74728),r=a.n(n),l=a(21076),i=a(49807),o=a(29496);let s={attrs:{url:{default:""},html:{default:""},author:{default:""},author_name:{default:""},date:{default:""}},untrackedAttrs:["html"],inline:!0,group:"inline",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.tweet",getAttrs:function(t){try{let e=JSON.parse(t.getAttribute("data-attrs"));if("url"in e&&"html"in e&&"author"in e&&"author_name"in e&&"date"in e)return e;return!1}catch(t){return!1}}}],toDOM:t=>{let e=document.createElement("div");e.className="tweet",e.setAttribute("data-component-name","TwitterToDOM"),e.setAttribute("data-attrs",JSON.stringify(t.attrs)),e.innerHTML=r()(t.attrs.html,{allowedTags:r().defaults.allowedTags.concat(["img"]),allowedAttributes:Object.assign({},r().defaults.allowedAttributes,{"*":["href","style","id","data-*","itemprop","class","align","alt","center","bgcolor"]})});let a=document.createElement("a");a.className="tweet-header",a.href="https://twitter.com/".concat(t.attrs.author),e.insertBefore(a,e.childNodes[0]);let n=document.createElement("img");n.src="".concat(i.w4p,"/image/twitter_name/w_").concat(l.Bh,"/").concat(t.attrs.author,".jpg"),a.appendChild(n);let o=document.createElement("span");o.className="tweet-author-name",o.textContent=t.attrs.author_name,a.appendChild(o);let s=document.createElement("span");s.className="tweet-author",s.textContent="@".concat(t.attrs.author),a.appendChild(s);let d=document.createElement("a");return d.className="tweet-date",d.textContent=t.attrs.date,d.href=t.attrs.url,e.appendChild(d),e.querySelectorAll&&Array.prototype.forEach.call(e.querySelectorAll("a"),t=>{t.target="_blank"}),e}},d=(0,o.C)({name:"twitter",nodeSpec:s})},13625:function(t,e,a){a.d(e,{GW:()=>h,c:()=>p,eC:()=>g,hq:()=>f});var n=a(69277),r=a(50172),l=a(31583),i=a(93946),o=a(50395),s=a(78622),d=a(82061),c=a(29496),u=a(78495);let m="twitter-embed",p={attrs:{url:{default:""},full_text:{default:""},username:{default:""},name:{default:""},profile_image_url:{default:""},date:{default:""},photos:{default:[]},quoted_tweet:{default:{}},reply_count:{default:0},retweet_count:{default:0},like_count:{default:0},impression_count:{default:0},expanded_url:{default:null},video_url:{default:null},belowTheFold:{default:!1}},untrackedAttrs:["full_text","photos","quoted_tweet","expanded_url","reply_count","retweet_count","like_count","impression_count","video_url"],inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.twitter-embed",getAttrs:u.t}],toDOM:t=>{if("undefined"!=typeof window)try{let e=document.createElement("div");return e.setAttribute("data-attrs",JSON.stringify(t.attrs)),e.setAttribute("data-component-name","Twitter2ToDOM"),e.className=m,(0,i.Mv)((0,r.h)(s.K,{attrs:t.attrs}),e),e}catch(e){return console.error("Error rendering TweetNode",e),(0,d.D)({msg:null,node:t,err:e,group:"block"})}return["div",{class:m,"data-attrs":JSON.stringify(t.attrs),"data-component-name":"Twitter2ToDOM"}]},toDOMStatic:t=>["table",{class:"".concat(m," static"),"data-attrs":JSON.stringify((0,n._)({isEmail:!0},t.attrs)),"data-component-name":"TweetToDOMStatic"}],addNodeView:()=>(0,l.gu)(o.V)},g=(0,c.C)({name:"twitter2",nodeSpec:p,addCommands(){return{insertTwitter:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),f=function(t){var e;let{customSchema:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(a&&!a.nodes.twitter2)return null;let n=/(https?:\/\/(mobile\.twitter\.com|twitter\.com|t\.co|x\.com)\/.*\/status\/[^\/\s]*)/.exec(t);return null!=(e=n&&n[1])?e:null},b=async t=>{let e=(await Promise.resolve().then(a.t.bind(a,15734,23))).default;return(await e.get("/api/v1/tweet").query({url:t})).body},h=async function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(e?{schema:e}:await Promise.resolve().then(a.bind(a,86508))).schema.nodes.twitter2.create(await b(t))}},79207:function(t,e,a){a.d(e,{Rv:()=>r,Vw:()=>o,jE:()=>l});var n=a(60597);function r(t,e){let{nodeTypes:a,reverse:n=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i(t,e,{nodeTypes:a,reverse:n})}function l(t,e){let{nodeTypes:a,reverse:n=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i(t,e,{nodeTypes:a,reverse:n})}function i(t,e){var a;let{nodeTypes:r,reverse:l=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3?arguments[3]:void 0;if(!t)return;r&&!Array.isArray(r)&&(r=[r]);let d=!1;if("type"in t&&t.type&&(r?"string"==typeof t.type&&r.includes(t.type)?d=!0:"string"!=typeof t.type&&"name"in t.type&&r.includes(t.type.name)&&(d=!0):d=!0),"type"in t&&d){let a=e(t,s);if(!1===a||a===o)return a}let c=[];if((0,n.M5)(t))Array.isArray(t.content)&&(c=t.content);else if((null==(a=t.content)?void 0:a.childCount)&&t.content.childCount>0)for(let e=0;e<t.content.childCount;e++)c.push(t.content.child(e));for(let a of(l&&(c=c.reverse()),c))if(i(a,e,{nodeTypes:r,reverse:l},t)===o)return o}let o=Symbol("done")},47579:function(t,e,a){a.d(e,{c:()=>c,m:()=>u});var n=a(50172),r=a(31583),l=a(21533),i=a(42114),o=a(93946),s=a(82061),d=a(29496);let c={attrs:{mediaUploadId:{default:null},duration:{default:null}},group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,toDOM:t=>{if("undefined"!=typeof window)try{let e=document.createElement("div");e.className="native-video-embed",e.setAttribute("data-attrs",JSON.stringify(t.attrs));let a={mediaUploadId:t.attrs.mediaUploadId,pub:null,post:null,isEditor:!0};return(0,o.Mv)((0,n.h)(i.i,a),e),e}catch(e){return console.error("Error rendering VideoEmbedPlayer",e),(0,s.D)({msg:null,node:t,err:e,group:"block"})}return m(t)},toDOMStatic:t=>m(t)},u=(0,d.C)({name:"video",nodeSpec:c,addNodeView:()=>(0,r.gu)(l.L),addCommands(){return{insertVideo:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),m=t=>["div",{class:"native-video-embed","data-component-name":"VideoPlaceholder","data-attrs":JSON.stringify(t.attrs)}]},39248:function(t,e,a){a.d(e,{VG:()=>c,c:()=>l,ou:()=>s,tC:()=>i,zd:()=>d});var n=a(49807),r=a(29496);let l={attrs:{videoId:{default:""},videoKey:{default:""},belowTheFold:{default:!1}},untrackedAttrs:["videoKey"],inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.vimeo-wrap",getAttrs:a(78495).t}],toDOM:t=>{var e;let a=o(t.attrs.videoId,t.attrs.videoKey);return["div",{id:(e=t.attrs.videoId,"vimeo-".concat(e)),class:"vimeo-wrap","data-attrs":JSON.stringify(t.attrs),"data-component-name":"VimeoToDOM"},["div",{class:"vimeo-inner"},["iframe",{src:a,frameborder:"0",gesture:"media",allow:"autoplay; fullscreen",allowautoplay:"true",allowfullscreen:"true",loading:t.attrs.belowTheFold?"lazy":null}]]]},toDOMStatic:t=>["a",{href:u(t.attrs.videoId,t.attrs.videoKey),target:"_blank",class:"vimeo-wrap","data-component-name":"VimeoToDOMStatic"},["img",{src:c(t.attrs.videoId,{maxWidth:550})}]]},i=(0,r.C)({name:"vimeo",nodeSpec:l,addCommands(){return{insertVimeo:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),o=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return"https://player.vimeo.com/video/".concat(t,"?autoplay=0").concat(e?"&h=".concat(e):"")},s=function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e&&!e.nodes.vimeo?null:m(t)[2]},d=async(t,e)=>{let{customSchema:a}=e,n=(t=>{let[e,a]=m(t);return e?{videoId:e,videoKey:a}:null})(t);return n?a.nodes.vimeo.create(n):null},c=function(t){let{maxWidth:e=728,playButton:a=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"".concat(n.w4p,"/image/vimeo/w_").concat(e,",c_limit,d_video_placeholder.png").concat(a?"/l_youtube_play_qyqt8q,w_170":"","/").concat(t)},u=(t,e)=>"https://vimeo.com/".concat(t).concat(e?"/".concat(e):"");function m(t){let e=/(https?:\/\/[^\s]*vimeo.com\/(?:channels\/[^/]+\/|video\/)?(\d+)(\/([0-9a-f]+))?[^\s\"\'"]*)/.exec(t);return e?[e[2],e[4],e[1]]:[null,null,null]}},54749:function(t,e,a){a.d(e,{c:()=>l,q:()=>i});var n=a(29496),r=a(60147);let l={attrs:{videoId:{default:""}},inline:!0,group:"inline",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,toDOM:t=>{let e="https://www.youtube.com/embed/".concat(t.attrs.videoId);return["div",{class:"youtube-wrap","data-component-name":"YoutubeToDOM","data-attrs":JSON.stringify(t.attrs)},["iframe",{src:e,frameborder:"0",gesture:"media",allowfullscreen:"true"}]]},toDOMStatic:t=>["a",{href:"https://www.youtube.com/watch?v=".concat(t.attrs.videoId),target:"_blank",class:"youtube-wrap","data-component-name":"YoutubeToDOMStatic"},["img",{src:(0,r.VG)(t.attrs.videoId,{maxWidth:550})}]]},i=(0,n.C)({name:"youtube",nodeSpec:l})},60147:function(t,e,a){a.d(e,{NO:()=>d,Sw:()=>c,VG:()=>m,c:()=>o,fe:()=>h,id:()=>s});var n=a(99851),r=a(9036),l=a(49807),i=a(29496);let o={attrs:{videoId:{default:""},startTime:{default:null},endTime:{default:null}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.youtube-wrap",getAttrs:a(78495).t},{tag:"iframe",getAttrs:t=>{try{let e=t.src&&f(t.src)[0];if(e)return{videoId:e};return!1}catch(t){return!1}}},{tag:"object",getAttrs:t=>{try{let e=t.data&&f(t.data)[0];if(e)return{videoId:e};for(let e of t.querySelectorAll("param")){let t=e.value&&f(e.value)[0];if(t)return{videoId:t}}for(let e of t.querySelectorAll("embed")){let t=e.src&&f(e.src)[0];if(t)return{videoId:t}}return!1}catch(t){return!1}}}],toDOM:t=>{let e=g(t.attrs.videoId,{start:t.attrs.startTime,end:t.attrs.endTime});return["div",{id:b(t.attrs.videoId),class:"youtube-wrap","data-attrs":JSON.stringify(t.attrs),"data-component-name":"Youtube2ToDOM"},["div",{class:"youtube-inner"},["iframe",{src:e,frameborder:"0",loading:"lazy",gesture:"media",allow:"autoplay; fullscreen",allowautoplay:"true",allowfullscreen:"true",width:"728",height:"409"}]]]},toDOMStatic:t=>["a",{href:p(t.attrs),target:"_blank",class:"youtube-wrap","data-component-name":"Youtube2ToDOMStatic"},["img",{src:m(t.attrs.videoId,{maxWidth:728})}]]},s=(0,i.C)({name:"youtube2",nodeSpec:o,addCommands(){return{insertYoutube:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),d=function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e&&!e.nodes.youtube2?null:f(t)[1]},c=async function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(e?{schema:e}:await Promise.resolve().then(a.bind(a,86508))).schema,r=u(t);return r?n.nodes.youtube2?n.nodes.youtube2.create(r):(console.error("Schema does not have a youtube2 node"),null):null},u=t=>{var e;let a,n=f(t)[0];if(!n)return null;let l=(e=t,{start:(a=(0,r.m)(e)).start||a.t,end:a.end});return{videoId:n,startTime:l.start,endTime:l.end}},m=function(t){let{maxWidth:e=728,playButton:a=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"".concat(l.w4p,"/image/youtube/w_").concat(e,",c_limit").concat(a?"/l_youtube_play_qyqt8q,w_120":"","/").concat(t)},p=t=>"https://www.youtube.com/watch?".concat((0,l.BpC)({v:t.videoId,start:t.startTime,end:t.endTime})),g=function(t){let{start:e,end:a,enableJsApi:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"https://www.youtube-nocookie.com/embed/".concat(t,"?").concat((0,l.BpC)({start:e,end:a,rel:0,autoplay:0,showinfo:0,enablejsapi:+!!n}))},f=t=>{var e,a,n;let l=/(https?\:\/\/(www\.|m\.)?youtube\.com\/(v\/)?watch\?[^\s]+)/.exec(t);if(l){let t=(0,r.m)(l[1]).v||null;if(t)return[t,null!=(e=l[1])?e:null]}let i=/(https?:\/\/(?:youtu\.be|www\.youtube\.com\/embed|www\.youtube-nocookie\.com\/embed|www\.youtube\.com\/v|www\.youtube\.com\/shorts|www\.youtube\.com\/live)\/([A-z0-9\-_]+)[^\s]*)/.exec(t);return i?[null!=(a=i[2])?a:null,null!=(n=i[1])?n:null]:[null,null]};function b(t){return"youtube2-".concat(t)}class h{constructor(t){(0,n._)(this,"dom",void 0);const e=g(t.attrs.videoId,{start:t.attrs.startTime,end:t.attrs.endTime,enableJsApi:!0}),a=document.createElement("div");a.id=b(t.attrs.videoId),a.className="youtube-wrap",a.dataset.attrs=JSON.stringify(t.attrs);const r=document.createElement("div");r.className="youtube-inner",a.appendChild(r);const l=document.createElement("iframe");l.src=e,l.frameBorder="0",l.gesture="media",l.allow="autoplay; fullscreen",l.allowautoplay="true",l.allowFullscreen=!0,l.style.backgroundImage="url(".concat(m(t.attrs.videoId,{maxWidth:728}),")"),r.appendChild(l);const i=document.createElement("div");i.className="youtube-overlay";const o=document.createElement("div");o.className="youtube-instructions",o.innerText="Double click to interact with video",i.appendChild(o),i.addEventListener("dblclick",()=>{i.classList.add("disabled"),l.classList.remove("disabled"),l.focus()}),l.addEventListener("blur",()=>{var t;i.classList.remove("hidden"),i.classList.remove("disabled"),l.classList.add("disabled"),null==(t=l.contentWindow)||t.postMessage(JSON.stringify({event:"command",func:"pauseVideo",args:""}),"*")}),r.appendChild(i),this.dom=a}}}}]);