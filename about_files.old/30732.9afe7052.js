!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};e.SENTRY_RELEASE={id:"substack@af5f699"};var t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="f6b2007d-0a30-4c5e-976d-42374afd7d05",e._sentryDebugIdIdentifier="sentry-dbid-f6b2007d-0a30-4c5e-976d-42374afd7d05")}catch(e){}}();"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["30732"],{3898:function(e,t,n){n.d(t,{A:()=>i});let i={reactionsHoverZone:"reactionsHoverZone-nHxYxG",reactionsContainer:"reactionsContainer-uNTS8E",outgoing:"outgoing-xjlZZA",emojiGrid:"emojiGrid-yGGf1S",reaction:"reaction-BmRJjL",selected:"selected-T0p6AZ",emojiBox:"emojiBox-hGb2ir",addReactButton:"addReactButton-j8HliB",emojiPopover:"emojiPopover-UcQl9N",show:"show-rCpI7T"}},84759:function(e,t,n){n.d(t,{A:()=>i});let i={imageContainer:"imageContainer-ZCdWLc",imageContainerFullHeight:"imageContainerFullHeight-hF_KGu",overlay:"overlay-SefqcL",image:"image-MSZo7W",downloadButton:"downloadButton-lyp4Aa",loading:"loading-BBOJtl",link:"link-D8bzcd"}},36083:function(e,t,n){n.d(t,{A:()=>i});let i={messageBubbleGroup:"messageBubbleGroup-R4lEWb",bubble:"bubble-JnQPTp",isFirst:"isFirst-cID827",isLast:"isLast-YVpa0l",quote:"quote-NJ4bEy",paywallReplyTag:"paywallReplyTag-_3sIGO",outgoing:"outgoing-hqKZeu",forceIncomingTheme:"forceIncomingTheme-fBbXPp",body:"body-obaIpu",author:"author-M_vI8F","reactions-1":"reactions-1-O8o884",reactions1:"reactions-1-O8o884","reactions-2":"reactions-2-NrnldS",reactions2:"reactions-2-NrnldS","reactions-3":"reactions-3-iPVLb0",reactions3:"reactions-3-iPVLb0",youtubeIframe:"youtubeIframe-rlkjkW",highlight:"highlight-u2yyKp","highlight-animation":"highlight-animation-rBjpTz",highlightAnimation:"highlight-animation-rBjpTz",imageGroup:"imageGroup-KAnMHU bubble-JnQPTp",incoming:"incoming-jCFnDy",postImage:"postImage-eO7gd7",b4:"b4-xXB4IY",bubbs:"bubbs-qLKn32",bubb:"bubb-yci1Gp",isLink:"isLink-NGEdg6",linkImage:"linkImage-FDEYzZ",small:"small-PzwGAf",actions:"actions-utvBvN",actionsWrapper:"actionsWrapper-CEt9E2",dots:"dots-_BmXB7",dot:"dot-XjG0Z6",typing:"typing-vNx1zN",flip:"flip-OUTl4B"}},73040:function(e,t,n){n.d(t,{A:()=>s});var i=n(69277),r=n(70408),o=n(4006),l=n(822),a=n(97731);let s=e=>(0,o.Y)(a.A,(0,r._)((0,i._)({},e),{name:"LucideCornerDownRight",svgParams:{height:24,width:24,fill:"#000000",strokeWidth:0},children:(0,o.Y)(l.A,{height:24,stroke:e.stroke,fill:e.fill,strokeWidth:e.strokeWidth})}))},91461:function(e,t,n){n.d(t,{A:()=>s});var i=n(69277),r=n(70408),o=n(32641),l=n(4006),a=n(97731);let s=e=>{var{size:t=24,color:n="var(--color-fg-primary)",className:s}=e,c=(0,o._)(e,["size","color","className"]);return(0,l.Y)(a.A,(0,r._)((0,i._)({},c),{name:"SkinnyLockIcon",svgParams:{viewBox:"0 0 24 24"},stroke:"none",width:t,height:t,fill:n,className:s,children:(0,l.Y)("path",{d:"M6.63672 23.4922H17.3594C19.082 23.4922 19.9961 22.5547 19.9961 20.7031V12.6289C19.9961 10.7773 19.082 9.85156 17.3594 9.85156H6.63672C4.91406 9.85156 4 10.7773 4 12.6289V20.7031C4 22.5547 4.91406 23.4922 6.63672 23.4922ZM6.05078 10.7539H7.91406V6.79297C7.91406 3.83984 9.80078 2.26953 11.9922 2.26953C14.1836 2.26953 16.0938 3.83984 16.0938 6.79297V10.7539H17.9453V7.05078C17.9453 2.64453 15.0625 0.5 11.9922 0.5C8.93359 0.5 6.05078 2.64453 6.05078 7.05078V10.7539Z",stroke:"none"})}))}},86404:function(e,t,n){n.d(t,{A:()=>s});var i=n(69277),r=n(70408),o=n(32641),l=n(4006),a=n(97731);let s=e=>{var{size:t=24,color:n="var(--color-fg-primary)",className:s}=e,c=(0,o._)(e,["size","color","className"]);return(0,l.Y)(a.A,(0,r._)((0,i._)({},c),{name:"SkinnyUnlockIcon",svgParams:{viewBox:"0 0 24 24"},stroke:"none",width:t,height:t,fill:n,className:s,children:(0,l.Y)("path",{d:"M2.5862 23.8914H13.1034C14.793 23.8914 15.6896 22.9366 15.6896 21.051V12.8282C15.6896 10.9545 14.793 9.99975 13.1034 9.99975H2.5862C0.896549 9.99975 0 10.9545 0 12.8282V21.051C0 22.9366 0.896549 23.8914 2.5862 23.8914ZM11.9885 10.9306H13.8046V6.90875C13.8046 3.88935 15.6667 2.30209 17.8161 2.30209C19.9655 2.30209 21.8275 3.88935 21.8275 6.90875V9.55818C21.8275 10.2623 22.2299 10.6203 22.7471 10.6203C23.2413 10.6203 23.6551 10.2981 23.6551 9.55818V7.15937C23.6551 2.67205 20.8161 0.5 17.8161 0.5C14.8046 0.5 11.9885 2.67205 11.9885 7.15937V10.9306Z"})}))}},67616:function(e,t,n){n.d(t,{Cv:()=>x});var i=n(69277),r=n(79785),o=n(4006),l=n(32485),a=n.n(l),s=n(12215),c=n(17402),d=n(58398),u=n(84605),m=n(85478),h=n(86500),p=n(1459),g=n(68349),f=n(35369),b=n(76977),y=n(16993),Y=n(63136),_=n(16291),v=n(28194),C=n(91392),w=n(49807),S=n(82776),k=n(57324);let A={container:"container-u4XWUV",label:"label-gARrM9",input:"input-rLnHxk",selectedInput:"selectedInput-RGkQnW"};function I(){let e=(0,r._)(["Support ",""]);return I=function(){return e},e}function N(){let e=(0,r._)(["Since you liked this post, why not support "," with a subscription?"]);return N=function(){return e},e}let D=C.FI.LIKE_UPSELL_LAST_SHOWN_AT,E=e=>{var t,n;let{pub:r}=e,{iString:l,iTemplate:s}=(0,u.GO)(),d=(0,m.mJ)(),[p,y]=(0,c.useState)(null==r||null==(t=r.plans)?void 0:t[0]),_=d.getConfigFor("disable_monthly_subscriptions"),C=d.getConfigFor("disable_annual_subscriptions");return(0,o.FD)(b.I1,{gap:20,children:[(0,o.FD)(b.I1,{gap:4,children:[(0,o.Y)(Y.EY.H4,{weight:"semibold",children:s(I(),r.name)}),(0,o.Y)(Y.EY.B4,{color:"secondary",children:s(N(),r.name)})]}),(0,o.Y)("form",{className:A.form,children:(0,o.Y)(b.I1,{gap:12,children:null==r||null==(n=r.plans)?void 0:n.map(e=>{if(("month"!==e.interval||!_)&&("year"!==e.interval||!C))return(0,o.Y)("label",{className:A.label,children:(0,o.FD)(b.Ye,{gap:12,alignItems:"center",children:[(0,o.Y)("input",{name:"plan",type:"radio",value:e.id,onInput:()=>y(e),checked:p&&p.id===e.id,className:a()({[A.selectedInput]:p&&p.id===e.id},A.input)}),(0,o.FD)(b.Ye,{gap:8,children:[(0,o.Y)(Y.EY.B4,{as:"span",weight:"semibold",color:p&&p.id===e.id?"primary":"secondary",children:(0,S.getPlanTitle)(e,r.language)}),(0,o.Y)(Y.EY.B4,{as:"span",color:"secondary",children:(0,v.xB)(e)})]})]})},e.id)})})}),(0,o.Y)(f.$n,{onClick:()=>{(0,h.u4)(h.qY.LIKE_UPSELL_PLAN_SELECTED),(0,g.V2)((0,w.eV6)(r,{params:(0,i._)({utm_source:k.VU.likeButtonUpsell},p&&{selectedPlanId:p.id})}),{local_navigation:!1})},flex:"grow",priority:"primary",children:l("Select")})]})},R=e=>{let{onClose:t,onShareClick:n}=e,{iString:i}=(0,u.GO)();return(0,o.FD)(b.I1,{gap:20,children:[(0,o.FD)(b.I1,{gap:4,children:[(0,o.Y)(Y.EY.H4,{weight:"semibold",children:i("Share this post with a friend")}),(0,o.Y)(Y.EY.B4,{color:"secondary",children:i("Since you liked this post, why not share it to help spread the word?")})]}),(0,o.Y)(f.$n,{onClick:()=>{(0,h.u4)(h.qY.LIKE_UPSELL_SHARE_CLICKED),n(),null==t||t()},priority:"primary",children:i("Share")})]})},x=e=>{let{user:t,pub:n,post:r}=e,[l,a]=(0,c.useState)(!1),u=(()=>{let e=s.get(D);if(e){let t=(0,_.A)(e),n=(0,_.A)().subtract(30,"days");if(t.isAfter(n))return!1}return!0})(),[m,f]=(0,c.useState)(u),[b,Y]=(0,c.useState)(u);(0,c.useEffect)(()=>{(!u||(null==t?void 0:t.is_contributor)||(null==t?void 0:t.is_admin))&&(0,g.qm)("show_reaction_upsell")},[u,t]),(0,c.useEffect)(()=>{b&&m&&t&&((0,h.u4)(h.qY.LIKE_UPSELL_MODAL_SEEN,{source:"email",type:(0,p.e)(t,n)?"share":"paid"}),s.set(D,(0,_.A)().format(),(0,i._)({expires:3650},!n.custom_domain&&{domain:".".concat(new URL((0,w.$_T)()).hostname)})))},[b,m,n,t]);let v=()=>{f(!m),Y(!1),(0,g.qm)("show_reaction_upsell")};return t&&!t.is_contributor&&!t.is_admin&&b?(0,o.FD)(o.FK,{children:[(0,o.Y)(y.aF,{isOpen:m,onClose:v,children:(0,o.Y)(y.cw,{children:(0,p.e)(t,n)?(0,o.Y)(R,{pub:n,onClose:v,onShareClick:()=>a(!0)}):(0,o.Y)(E,{pub:n})})}),(0,o.Y)(d.Z,{isOpen:l,medium:"web",pub:n,user:t,post:r,onClose:()=>a(!1)})]}):null}},61193:function(e,t,n){n.d(t,{W:()=>c});var i=n(4006),r=n(13950),o=n(15894),l=n(84605),a=n(47570),s=n(17028);let c=e=>{let{comments:t,post:n,commentId:a,notAllowedToFetchComments:c,handleSort:u,publication:m,sort:h,disableMobileBottomSheet:p}=e,{iString:g}=(0,l.GO)();return(0,i.FD)(r.DH,{children:[(0,i.FD)(s.Ye,{alignItems:"baseline",flex:"grow",gap:8,position:"relative",children:[(0,i.Y)(o.T,{preset:"st4",children:g("Comments")}),(0,i.Y)("div",{className:"mediumRule-B78a2B"}),(null==t?void 0:t.length)&&(null==t?void 0:t.length)>0?(0,i.Y)(o.T,{color:"accent",preset:"st4",children:n.comment_count}):null]}),(0,i.FD)(s.az,{className:"sortOptionsContainer-bIIUcJ",children:[!c&&(0,i.Y)(o.T,{align:"left",as:"a",color:"tertiary",href:"/p/community-guidelines",preset:"detail-small",style:{textDecoration:"underline"},children:g("Community Guidelines")}),t&&(null==t?void 0:t.length)>1&&!c&&!a&&(0,i.Y)(d,{comments:t,disableMobileBottomSheet:p,handleSort:u,publication:m,sort:h})]})]})},d=e=>{let{publication:t,handleSort:n,sort:r,comments:o,disableMobileBottomSheet:l}=e;return t&&n&&r?(0,i.Y)(a.D,{currentSort:r,disableMobileBottomSheet:l,handleSort:n,isLoading:!o,pub:t}):null}},77481:function(e,t,n){n.d(t,{n:()=>h});var i=n(4006),r=n(34746),o=n(63446),l=n(61193),a=n(15894),s=n(84605),c=n(89490),d=n(76977),u=n(39318),m=n(57324);let h=e=>{let{post:t,publication:n,user:h,freeSignupEmail:p=null,showHeader:g=!1}=e,{iString:f}=(0,s.GO)(),b=h&&h.email||p||null,y=(0,u.my9)(n,{simple:!0,next:document.location.href,utm_source:m.VU.paywall,utm_medium:m.Jn.web,utm_content:t?t.id:null,just_signed_up:!1}),Y=async()=>{window.location.href=y};return(0,i.FD)(d.I1,{className:"container-u0f9W_",children:[g&&(0,i.Y)(l.W,{notAllowedToFetchComments:!0,post:t,publication:n}),(0,i.Y)(c.az,{className:"commentsPaywall-ASd8iy",children:(0,i.FD)(d.I1,{alignItems:"center",gap:24,paddingX:24,paddingY:40,children:[(0,i.Y)(a.T,{color:"white",preset:"h4-sans-condensed",children:f("Join the conversation")}),(0,i.Y)(a.T,{color:"white",preset:"d3-serif",children:f("Share your thoughts and connect with other readers by becoming a paid subscriber!")}),(0,i.Y)(o.v,{variant:"inverse",onClick:Y,children:f("Upgrade today")}),(0,i.FD)(a.T,{as:"a",color:"white","data-native":!0,href:(0,u.eV6)(n,{isSignInAttempt:!0,next:(0,u.wu9)(n,t)}),preset:"caption",children:[(0,r.Qy)({post:t,publication:n})," ",(0,i.Y)("u",{children:f(b?"Switch accounts":"Sign in")})]})]})})]})}},58997:function(e,t,n){n.d(t,{D:()=>D,X:()=>N});var i=n(99851),r=n(79785),o=n(4006),l=n(17402),a=n(15734),s=n.n(a),c=n(6212),d=n(41935),u=n(37494),m=n(90847),h=n(46196),p=n(56778),g=n(84605),f=n(8609),b=n(6049),y=n(86500),Y=n(68349),_=n(98111),v=n(4016),C=n(56262),w=n(39318),S=n(82776),k=n(57324);function A(){let e=(0,r._)(["This thread is only visible to "," subscribers of ",""]);return A=function(){return e},e}class I extends l.Component{onTopReached(){this.state.topReached||(this.setState({topReached:!0}),(0,y.u4)(y.qY.POST_SEEN,{post_id:this.props.post.id,post_audience:this.props.post.audience,post_type:this.props.post.type}))}onBottomReached(){this.state.bottomReached||(this.setState({bottomReached:!0}),(0,y.u4)(y.qY.POST_BOTTOM_SEEN,{post_id:this.props.post.id,post_audience:this.props.post.audience,post_type:this.props.post.type}))}async enableEmailNotifications(){try{await s().post("/api/v1/post/".concat(this.props.post.id,"/subscribe")),window.location.reload()}catch(e){console.error("Failed to subscribe to email notifications:",e),alert((0,Y.uX)(e))}}render(){let e,t,{className:n,pub:i,post:r,user:a,freeSignup:s,freeSignupEmail:g,isStatic:f,truncated:y,invisible:Y,post_reaction_token:I,onChange:N,showCta:D=y,showUnsubscribeNotice:E,dataForEmailRender:R={},showReactions:x=!0,gap:F=16,iString:T,iTemplate:P,iPlural:L,language:B,showShare:O}=this.props,{hidden:G}=this.props;"boolean"!=typeof G&&(G=r.hidden),G?(e=T("Subscribe to view"),t=(0,w.yRP)("/subscribe",{simple:!0,next:document.location.href,utm_source:k.VU.thread,utm_medium:k.Jn.web,utm_content:r.id})):(t=(0,w.wu9)(i,r,{noBase:!0}),e="thread"!==r.type||y?(0,S.getPostCtaText)(r,B):r.comment_count?L("View 1 comment","View %1 comments",r.comment_count):T("Reply"));let M=f&&!this.context.isAmp,H=(0,v.lu)({pub:i}),U=H?m.Z:l.Fragment;return(0,o.Y)(b.h2,{className:"thread-head typography ".concat(n||""),children:(0,o.Y)("tr",{children:(0,o.Y)("td",{children:(0,o.FD)(b.jJ,{width:"100%",children:[!Y&&!G&&(0,o.Y)(p.A,{onVisible:()=>this.onTopReached()}),(0,o.FD)(b.jJ,{gap:F,width:"100%",children:[D&&H&&(0,o.Y)(h.$,{post:r,ctaUrl:t,ctaText:e,hidden:G}),(0,o.Y)(c.I0,{pub:i,post:r,user:a,isStatic:f,reaction_token:I,allowEdit:!0,allowTruncate:y,showReactions:!!D||x,showShare:O,showComments:!!r.comment_count,inThreadHead:!0,onChange:N,showLabel:!0}),(0,o.Y)(U,{inThreadHead:!0,children:(0,o.Y)(u.A,{user:a,freeSignup:s,freeSignupEmail:g,pub:i,post:r,html:G||y||!r.body_html?null:r.body_html,isStatic:f,dataForEmailRender:R,children:G?(0,o.Y)("p",{children:(0,o.Y)("i",{children:P(A(),(0,C.isFoundingAudience)(r.audience)?"founding":"paid",i.name)})}):y?(0,o.Y)("p",{children:r.description}):null})}),D?!H&&(0,o.FD)("a",{className:"thread-head-cta",href:t,"data-native":!0,children:[e," →"]}):G&&(0,o.FD)("p",{className:"thread-head-cta",children:[(0,o.Y)("a",{href:(0,w.eV6)(i,{simple:!0,next:document.location.href,utm_source:k.VU.thread,utm_medium:k.Jn.web,utm_content:r.id}),className:"button primary subscribe-btn","data-native":f?void 0:"",children:(0,S.getSubscribeText)(i)}),(0,o.Y)("a",{href:(0,w.a7q)({for_pub:i.subdomain}),className:"button","data-native":!0,children:T("Sign in")})]})]}),M&&(0,o.FD)(b.jJ,{gap:F,style:{width:"100%"},children:[(0,o.Y)(b.jJ,{style:{width:"100%",textAlign:"center"},children:(0,o.Y)("a",{role:"button",className:"button primary",style:{margin:"0 auto"},href:_.T.HALF_MAGIC_COMMENTS_URL,children:T("See the discussion")})}),(0,o.Y)(d.fz,{isFooter:!0,customization:{showShare:!0,showComments:!0,showReactions:{showReactions:x},showRestack:!1,showLabels:!0,showCommentRestack:!i.hide_post_restacks}})]}),E&&r.unsubscribed&&(0,o.FD)("div",{className:"notifications-alert",children:[T("Email notifications are disabled for this thread.")," ",(0,o.Y)("a",{href:"javascript:void(0)",onClick:()=>this.enableEmailNotifications(),children:T("Re-enable")})]}),!Y&&!G&&(0,o.Y)(p.A,{onVisible:()=>this.onBottomReached()})]})})})})}}(0,i._)(I,"contextType",f.a);let N=(0,g.wr)(I);class D extends l.Component{render(){return(0,o.FD)("div",{className:"thread-head-silhouette",children:[(0,o.Y)("div",{className:"thread-head-silhouette-head"}),(0,o.FD)("div",{className:"thread-head-silhouette-content",children:[(0,o.Y)("div",{className:"thread-head-silhouette-title"}),(0,o.Y)("div",{className:"thread-head-silhouette-meta"}),(0,o.FD)("div",{className:"thread-head-silhouette-body",children:[(0,o.Y)("div",{className:"thread-head-silhouette-body-line"}),(0,o.Y)("div",{className:"thread-head-silhouette-body-line"}),(0,o.Y)("div",{className:"thread-head-silhouette-body-line"})]})]})]})}}},73684:function(e,t,n){n.d(t,{j:()=>p});var i=n(4006),r=n(17159),o=n.n(r),l=n(79909),a=n(45947),s=n(73957),c=n(51683),d=n(39318),u=n(70189),m=n(49807),h=n(82776);function p(e){var t,n,r,o;let a,p,f,b,{comment:y,post:Y,publication:_}=e,v="Substack | Notes";_&&y.name?v="".concat(y.name," on ").concat(_.name):y.name&&y.handle?v="".concat(y.name," (@").concat(y.handle,")"):y.name?v=y.name:_&&(v="".concat(_.name));let C=Y&&_?(0,s.getPageTitleAndMeta)(Y,_,{isCommentPage:!0}).title:"".concat(v,': "').concat((0,h.truncateText)(y.body,280),'"'),w=(null!=(t=y.attachments)?t:[]).flatMap(e=>"image"===e.type?[e.imageUrl]:"post"===e.type&&e.postImageSelection?[e.postImageSelection.img_src]:[]),S=1===w.length?w[0]:null;S?(a=(0,m.dJ9)(S),b=!0):(0,c.lp)(y)?(p=680,f=680,a=(0,m.dJ9)((0,u.Hr)(y.id,{isSmall:!0,attachmentsOnly:!0}),f,{height:p}),b=!0):y.photo_url?(a=(0,m.dJ9)(y.photo_url,40),p=40,f=40):y.user_id&&(a=(0,m.dJ9)((0,d.Ji1)(y.user_id),40),p=40,f=40);let k=null!=(n=y.body)?n:"";return(0,i.FD)(i.FK,{children:[(0,i.Y)(l.Metadata,{title:C,socialTitle:v,description:k,image:a,isLargeImage:b,imageHeight:p,imageWidth:f,siteName:_?_.name:"Substack",publishedTime:y.date.toString(),meta:[{name:"twitter:label1",content:"Likes"},{name:"twitter:data1",content:String(null!=(r=y.reaction_count)?r:0)},{name:"twitter:label2",content:"Replies"},{name:"twitter:data2",content:String(null!=(o=y.children_count)?o:0)}]}),(0,i.Y)(g,{comment:y,includeBody:!0})]})}function g(e){let{comment:t,includeBody:n}=e;return t?(0,i.Y)("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:o()((0,a.Q)(t,{includeViews:!1,includeBody:n}),{json:!0,isScriptContext:!0})}}):null}},25714:function(e,t,n){n.d(t,{P:()=>u});var i=n(4006),r=n(32485),o=n.n(r),l=n(27437),a=n(84777),s=n(46271),c=n(28700),d=n(8895);function u(e){let{id:t,label:n,type:r,url:o,unstyled:l}=e;return(0,i.Y)("span",{className:"node-substack_mention",children:"pub"===r?(0,i.Y)(h,{id:t,url:o,label:n,unstyled:l}):(0,i.Y)(m,{id:t,label:n,unstyled:l})})}function m(e){let{id:t,label:n,unstyled:r}=e,a=(0,s.Jd)(),u=a&&a.id===t;return(0,i.Y)(l.ProfileHoverCard,{subject:{id:t,name:n},trigger:(0,i.Y)("a",{className:o()(d.A.mention,u&&d.A.self,r&&d.A.unstyled),href:(0,c.rf)(t,n),children:n})})}function h(e){let{id:t,url:n,label:r,unstyled:l}=e,c=(0,s.Jd)(),u=c&&c.id===t;return(0,i.Y)(a.m,{pubId:t,trigger:(0,i.Y)("a",{className:o()(d.A.mention,u&&d.A.self,l&&d.A.unstyled),href:n,children:r})})}},95641:function(e,t,n){n.d(t,{E:()=>s});var i=n(69277),r=n(32641),o=n(15734),l=n.n(o),a=n(12501);function s(e){var{auto:t,initialResult:n,deps:o}=e,s=(0,r._)(e,["auto","initialResult","deps"]);return(0,a.qK)(async e=>{var{signal:t}=e,n=(0,r._)(e,["signal"]);let{pathname:o="",query:a,body:c,method:d="get"}=(0,i._)({},s,n),u=l()(d.toUpperCase(),o);a&&u.query(a),c&&u.send(c),t.addEventListener("abort",()=>{u.abort()});let m=await u;if(t.aborted)return;let h=m.error;if(h)throw h;return m.body},o||[],{auto:t,initialResult:n})}},23294:function(e,t,n){n.d(t,{f:()=>P});var i=n(69277),r=n(70408),o=n(4006),l=n(54718),a=n(99084),s=n(29665),c=n(82853),d=n(84934),u=n(27786),m=n(21767),h=n(68397),p=n(1839),g=n(50180),f=n(37946),b=n(16079),y=n(15977),Y=n(32641),_=n(97731);let v=e=>{var{size:t=24,fill:n="var(--color-fg-primary)"}=e,l=(0,Y._)(e,["size","fill"]);return(0,o.Y)(_.A,(0,r._)((0,i._)({},l),{name:"LinearIcon",svgParams:{viewBox:"0 0 24 24"},width:t,height:t,fill:n,children:(0,o.Y)("path",{stroke:"none",fillRule:"evenodd",clipRule:"evenodd",d:"M19.0619 4.92341C15.1689 1.03032 8.8663 1.01517 4.95447 4.87797L19.1074 19.0309C22.9702 15.119 22.955 8.81651 19.0619 4.92341ZM2.95746 7.67367L16.3108 21.027C17.0035 20.6951 17.6661 20.2789 18.2829 19.7783L4.2062 5.70169C3.70565 6.31846 3.2894 6.98092 2.95746 7.67367ZM12.5482 21.9918L1.99316 11.4369C2.04331 10.5412 2.21326 9.65092 2.50301 8.79221L15.1928 21.4819C14.334 21.7717 13.4439 21.9416 12.5482 21.9918ZM4.90872 19.077C3.22167 17.3899 2.26284 15.2503 2.03226 13.049L10.9367 21.9534C8.73529 21.7228 6.59577 20.7639 4.90872 19.077Z"})}))};var C=n(84605),w=n(66729),S=n(7684),k=n(87087),A=n(35369),I=n(76977),N=n(88774),D=n(78526),E=n(2481),R=n(58278),x=n(39318),F=n(82776),T=n(70515);function P(e){let{comment:t,pub:n,post:i,user:r,onChange:a,startEdit:s,startReport:c,openBan:d,isCollapsed:u,toggleCollapse:m}=e;return!function(e){let{menuEnabled:t}=Z(e);return t}({comment:t,user:r})?null:(0,o.Y)(I.fI,{className:"triggerContainer-eX588u",children:(0,o.Y)(N.W1,{trigger:(0,o.Y)(A.K0,{priority:"quaternary",size:"sm",className:"trigger-j08Uop",children:(0,o.Y)(l.A,{size:16})}),children:(0,o.Y)(B,{comment:t,pub:n,post:i,user:r,onChange:a,startEdit:s,startReport:c,openBan:d,isCollapsed:u,toggleCollapse:m})})})}function L(e){let{sections:t}=e,n=t.map(e=>(0,r._)((0,i._)({},e),{items:e.items.filter(e=>{var t;return null!==e&&(null==e||null==(t=e.props)?void 0:t.enabled)!==!1})})).filter(e=>e.items.length>0);return(0,o.Y)(o.FK,{children:n.map((e,t)=>(0,o.Y)(N.H9,{isFirst:0===t,children:e.items},e.key))})}function B(e){var t;let{comment:n,pub:i,post:r,user:l,onChange:a,startEdit:s,startReport:c,openBan:d,isCollapsed:u,toggleCollapse:m}=e,h=Z({comment:n,user:l}),p=[{key:"editing",items:[(0,o.Y)(M,{enabled:h.editCommentEnabled,onClick:s})]},{key:"sharing",items:[(0,o.Y)(G,{enabled:!0}),(0,o.Y)(J,{enabled:h.restackCommentEnabled})]},{key:"actions",items:[(0,o.Y)(H,{enabled:h.pinCommentEnabled}),(0,o.Y)(O,{enabled:!0,isCollapsed:u,toggleCollapse:m}),(0,o.Y)(U,{enabled:h.giftSubscriptionEnabled}),(0,o.Y)(q,{enabled:null!=(t=null==l?void 0:l.is_global_admin)&&t}),(0,o.Y)(V,{enabled:h.subscriberDetailsEnabled})]},{key:"admin",items:[(0,o.Y)(j,{enabled:h.deleteCommentEnabled}),(0,o.Y)(W,{enabled:h.removeCommentEnabled}),(0,o.Y)(z,{enabled:h.reportCommentEnabled,onClick:c}),(0,o.Y)(X,{enabled:h.banUserEnabled,onClick:d})]}];return(0,o.Y)(w.g,{value:{comment:n,pub:i,post:r,onChange:a,toggleCollapse:m},children:(0,o.Y)(L,{sections:p})})}function O(e){let{enabled:t,isCollapsed:n,toggleCollapse:i}=e,{iString:r}=(0,C.GO)();return t?(0,o.Y)(N.Dr,{leading:n?(0,o.Y)(a.A,{}):(0,o.Y)(s.A,{}),onClick:i,children:r(n?"Expand":"Collapse")}):null}function G(e){let{enabled:t}=e,{iString:n}=(0,C.GO)(),{comment:i,post:r,pub:l}=(0,S.c4)(),a=(0,D.L)();return t?(0,o.Y)(N.Dr,{leading:(0,o.Y)(c.A,{}),onClick:()=>{a((0,k.XB)(r,i,l))},children:n("Copy link")}):null}function M(e){let{enabled:t,onClick:n}=e,{iString:i}=(0,C.GO)();return t?(0,o.Y)(N.Dr,{leading:(0,o.Y)(d.A,{}),onClick:n,children:i("Edit")}):null}function H(e){let{enabled:t}=e,{iString:n}=(0,C.GO)(),{comment:i,onChange:r}=(0,S.c4)(),{pinned:l,togglingPin:a,togglePinned:s}=(0,S.Mr)({comment:i,onChange:r});return t?(0,o.Y)(N.Dr,{leading:(0,o.Y)(u.A,{}),onClick:s,children:n(a?l?"Unpinning...":"Pinning...":l?"Unpin":"Pin")}):null}function U(e){let{enabled:t}=e,{iString:n}=(0,C.GO)(),{comment:i,pub:r}=(0,S.c4)();if(!t)return null;let l="".concat(r.base_url,"/subscribe?gift=true&recipient=").concat(i.user_id,"-").concat((0,R.JG)(i.name,{hashIfEmpty:!0}),"&comment_id=").concat(i.id,"}");return(0,o.Y)(N.Dr,{leading:(0,o.Y)(m.A,{}),href:l,children:n("Gift a subscription")})}function V(e){let{enabled:t}=e,{iString:n}=(0,C.GO)(),{comment:i,pub:r}=(0,S.c4)();return t?(0,o.Y)(N.Dr,{leading:(0,o.Y)(h.A,{}),onClick:()=>{if(i.email)return window.open((0,x.w8b)(r,i.email),"_blank")},children:n("Subscriber details")}):null}function j(e){let{enabled:t}=e,{iString:n}=(0,C.GO)(),{comment:i,onChange:r}=(0,S.c4)(),{isDeleting:l,deleteComment:a}=(0,S.yy)({comment:i,onChange:r});return t?(0,o.Y)(N.Dr,{leading:(0,o.Y)(p.A,{}),onClick:a,priority:"destructive",children:n(l?"Deleting...":"Delete")}):null}function W(e){let{enabled:t}=e,{iString:n}=(0,C.GO)(),{comment:i,onChange:r}=(0,S.c4)(),{isRemoving:l,removeComment:a}=(0,S.d4)({comment:i,onChange:r});return t?(0,o.Y)(N.Dr,{leading:(0,o.Y)(g.A,{}),onClick:a,priority:"destructive",children:n(l?"Removing...":"Remove")}):null}function z(e){let{enabled:t,onClick:n}=e,{iString:i}=(0,C.GO)();return t?(0,o.Y)(N.Dr,{leading:(0,o.Y)(f.A,{}),onClick:n,priority:"destructive",children:i("Report")}):null}function X(e){let{enabled:t,onClick:n}=e,{iString:i}=(0,C.GO)();return t?(0,o.Y)(N.Dr,{leading:(0,o.Y)(b.A,{}),onClick:n,priority:"destructive",children:i("Ban or suspend user")}):null}function J(e){let{enabled:t}=e,n=(0,E.NP)(),{comment:i,pub:r,post:l}=(0,S.c4)(),{iString:a}=(0,C.GO)();return t?(0,o.Y)(N.Dr,{leading:(0,o.Y)(y.A,{}),onClick:()=>{n.open({restackUrl:(0,k.XB)(l,i,r)})},children:a("Restack")}):null}function q(e){let{enabled:t}=e,{iString:n}=(0,C.GO)(),{comment:i,post:r,pub:l}=(0,S.c4)(),{addCommentToLinear:a}=(0,S.eu)({comment:i,post:r,pub:l});return t?(0,o.Y)(N.Dr,{leading:(0,o.Y)(v,{}),onClick:a,children:n("Add to Linear")}):null}function Z(e){let{comment:t,user:n}=e,i=!!(n&&n.id===t.user_id),r=!!(null==n?void 0:n.is_contributor)&&(0,T.Pp)(t)||!!(null==n?void 0:n.is_community_moderator)&&(0,T.Pp)(t),o=(0,F.canEditComment)(n,t),l=!!(null==n?void 0:n.is_contributor)&&(0,T.Pp)(t)&&""===t.ancestor_path,a=!i&&!!t.metadata.eligibleForGift&&!t.metadata.is_author,s=!i&&!t.reported_by_user&&!t.hidden&&!t.suppressed,c=r&&!i,d=r&&!t.user_banned&&!i,u=!!r&&!!t.email&&!i,m=(0,T.Pp)(t)&&!(null==n?void 0:n.is_oauth),h=o||l||a||s||c||d||u||m;return{editCommentEnabled:o,pinCommentEnabled:l,giftSubscriptionEnabled:a,reportCommentEnabled:s,deleteCommentEnabled:i,removeCommentEnabled:c,banUserEnabled:d,subscriberDetailsEnabled:u,restackCommentEnabled:m,menuEnabled:h}}},66729:function(e,t,n){n.d(t,{I:()=>r,g:()=>o});var i=n(4006);let r=(0,n(17402).createContext)(null);function o(e){let{children:t,value:n}=e;return(0,i.Y)(r.Provider,{value:n,children:t})}},47570:function(e,t,n){n.d(t,{D:()=>u});var i=n(4006),r=n(98645),o=n(45773),l=n(84605),a=n(13022),s=n(35369),c=n(88774),d=n(70515);let u=e=>{let{currentSort:t,isLoading:n,pub:o,handleSort:a,disableMobileBottomSheet:u}=e,{iString:h}=(0,l.GO)();return(0,i.Y)(c.W1,{trigger:(0,i.Y)(s.$n,{size:"sm",priority:"secondary",disabled:n,leading:(0,i.Y)(r.A,{size:18}),children:(0,d.rX)(t,o.language)}),"aria-label":h("Sort comments"),disableMobileBottomSheet:u,children:(0,i.Y)(m,{currentSort:t,pub:o,handleSort:a})})},m=e=>{let{currentSort:t,pub:n,handleSort:r}=e,l=!!(0,a.Ay)("like_comments_enabled");return(0,i.Y)(i.FK,{children:(0,d.Qz)({likesEnabled:l,language:n.language}).map(e=>{let{key:n,text:l}=e;return(0,i.Y)(c.Dr,{onClick:()=>r(n),trailing:n===t?(0,i.Y)(o.A,{}):void 0,children:l},n)})})}},42774:function(e,t,n){n.d(t,{Ud:()=>_,GL:()=>k,FS:()=>A,Q0:()=>S});var i=n(69277),r=n(79785),o=n(4006),l=n(48635),a=n(70408),s=n(32641),c=n(97731);let d=e=>{var{size:t=24,fill:n="var(--color-fg-primary)"}=e,r=(0,s._)(e,["size","fill"]);return(0,o.Y)(c.A,(0,a._)((0,i._)({},r),{name:"CommentBadgeHeartIcon",svgParams:{viewBox:"0 0 20 20"},width:t,height:t,fill:n,children:(0,o.Y)("path",{stroke:"none",d:"M9.99915 16.7256C9.90515 16.7256 9.79102 16.692 9.65674 16.6249C9.52246 16.5622 9.3949 16.4906 9.27405 16.41C8.02974 15.6044 6.94657 14.7584 6.02454 13.8722C5.10697 12.9815 4.3953 12.0662 3.88953 11.1262C3.38375 10.1818 3.13086 9.23067 3.13086 8.27283C3.13086 7.63725 3.23157 7.05762 3.43298 6.53394C3.63888 6.01025 3.92086 5.55819 4.27893 5.17773C4.64148 4.79728 5.05774 4.50635 5.52771 4.30493C6.00216 4.09904 6.51241 3.99609 7.05847 3.99609C7.73433 3.99609 8.31844 4.16618 8.81079 4.50635C9.30762 4.84652 9.70374 5.28963 9.99915 5.83569C10.299 5.28516 10.6951 4.84204 11.1875 4.50635C11.6843 4.16618 12.2707 3.99609 12.9465 3.99609C13.4836 3.99609 13.9894 4.09904 14.4639 4.30493C14.9428 4.50635 15.3613 4.79728 15.7194 5.17773C16.0774 5.55819 16.3572 6.01025 16.5586 6.53394C16.7645 7.05762 16.8674 7.63725 16.8674 8.27283C16.8674 9.23067 16.6145 10.1818 16.1088 11.1262C15.603 12.0662 14.8891 12.9815 13.967 13.8722C13.0495 14.7584 11.9708 15.6044 10.731 16.41C10.6056 16.4906 10.4758 16.5622 10.3416 16.6249C10.2118 16.692 10.0976 16.7256 9.99915 16.7256Z"})}))};var u=n(76438),m=n(84605),h=n(7684),p=n(76977),g=n(75303),f=n(81929),b=n(66511);function y(){let e=(0,r._)(["Pinned by ",""]);return y=function(){return e},e}function Y(){let e=(0,r._)(["Liked by ",""]);return Y=function(){return e},e}let _=e=>{let{comment:t}=e;return t.pinned_by_user_id?(0,o.Y)(v,{name:t.pinned_by_name}):t.metadata.is_author?(0,o.Y)(C,{}):t.reactor_names.length>0?(0,o.Y)(w,{names:t.reactor_names}):null},v=e=>{let{name:t}=e,{iString:n,iTemplate:r}=(0,m.GO)();return t?(0,o.Y)(b.m_,{text:r(y(),t),children:(0,o.Y)(f.vw,{priority:"secondary",cursor:"pointer",fillIcon:!0,leading:(0,o.Y)(u.A,(0,i._)({},f.Oi)),children:n("Pinned")})}):(0,o.Y)(f.vw,{priority:"secondary-outline",fillIcon:!0,leading:(0,o.Y)(u.A,(0,i._)({},f.Oi)),children:n("Pinned")})},C=()=>{let{iString:e}=(0,m.GO)();return(0,o.Y)(f.vw,{priority:"secondary-outline",theme:"accent",children:e("Author")})},w=e=>{let{names:t}=e,{iTemplate:n}=(0,m.GO)();return(0,o.Y)(f.vw,{theme:"accent",priority:"secondary-outline",fillIcon:!0,leading:(0,o.Y)(d,(0,i._)({},f.Oi)),children:n(Y(),t.join(", "))})},S=e=>{let{comment:t,userBanned:n}=e,{banText:i,shouldShowBanText:r}=(0,h.d3)(t);return!r||n?null:(0,o.Y)(f.vw,{priority:"secondary",children:i})},k=e=>{let{comment:t,userPendingApproval:n}=e,{iString:r}=(0,m.GO)();return n?(0,o.Y)(g.AE,{href:"/publish/moderation/new-commenters?user=".concat(t.user_id),target:"_blank",rel:"noopener",children:(0,o.Y)(f.vw,{priority:"secondary",cursor:"pointer",trailing:(0,o.Y)(l.A,(0,i._)({},f.Oi)),children:r("Awaiting approval")})}):null},A=e=>{let{children:t}=e;return(0,o.Y)(p.fI,{gap:4,children:t})}},17096:function(e,t,n){n.d(t,{Wh:()=>eS,ko:()=>ef,WR:()=>ey,cQ:()=>eg,yQ:()=>eb,Gs:()=>eY});var i=n(99851),r=n(69277),o=n(70408),l=n(79785),a=n(4006),s=n(32485),c=n.n(s),d=n(78659),u=n.n(d),m=n(69843),h=n.n(m),p=n(6498),g=n.n(p),f=n(17402),b=n(15734),y=n.n(b),Y=n(94090),_=n(58398),v=n(52820),C=n(84605),w=n(70145),S=n(45611),k=n(86500),A=n(55376),I=n(54687),N=n(72170),D=n(58299),E=n(55136),R=n(25859),x=n(13022),F=n(76977),T=n(88774),P=n(63136),L=n(28916);let B="link-_X6et2";function O(e){let{pub:t,post:n,comment:i,onChange:r}=e,{iString:o}=(0,C.GO)(),{canRestack:l,isRestacked:s,restacks:d,menuItems:u,nuxModal:m}=(0,L.I)({pub:t,post:n,comment:i,onRestack:e=>{r({restacked:e,restacks:d+(e?1:-1)})}});return l?(0,a.FD)("span",{children:[m,(0,a.Y)(T.W1,{trigger:(0,a.FD)("a",{className:c()("restack-button",s&&"restacked"),href:"javascript:void(0)",children:[(0,a.Y)(D.A,{}),o("Restack"),d>0&&" (".concat(d,")")]}),children:u})]}):null}let G=e=>{var t;let{comment:n,pub:i,user:r,post:o,reaction_token:l,commentsEnabledForPost:s,noRestack:d,onChange:u,startReply:m,shareComment:h,updateCommentReacted:p,hideShare:g,commentActionsOverride:f}=e,{iString:b}=(0,C.GO)(),y=(0,x.Ay)("like_comments_enabled");return(0,a.Y)(F.pT,{gap:16,alignItems:"center",justifyContent:"start",paddingTop:8,className:c()("comment-actions",{"withShareButton-hQzuEn":!!h}),children:!n.deleted&&[y&&(0,a.Y)(E.cy,{user:r,pub:i,post:o,comment:n,height:16,countInParenthesesStyle:!0,token:l,onChange:e=>{let{comment:t}=e;return u(t)},onReactedChange:e=>{p&&p(n.id,e)},noSelfUpdate:!!p,commentActionsOverride:f}),s&&(0,a.Y)(R.Yq,{onClick:f||(()=>m()),className:B,children:(0,a.FD)(F.pT,{gap:6,alignItems:"center",children:[(0,a.Y)(I.A,{stroke:"var(--color-fg-secondary-themed)",size:16}),(0,a.FD)(P.EY.Meta,{color:"pub-secondary-text",children:[b("Reply"),(null==(t=n.children)?void 0:t.length)>0&&" (".concat(n.children.length,")")]})]})}),!g&&!!h&&(0,a.Y)(R.Yq,{onClick:f||(()=>h(n.id)),className:B,children:(0,a.FD)(F.pT,{gap:6,alignItems:"center",children:[(0,a.Y)(N.A,{stroke:"var(--color-fg-secondary-themed)",size:16}),(0,a.Y)(P.EY.Meta,{color:"pub-secondary-text",children:b("Share")})]})}),!d&&(0,a.Y)(O,{pub:i,post:o,comment:n,onChange:u})]})};var M=n(43262),H=n(87087),U=n(35369),V=n(16291),j=n(83873),W=n(39318),z=n(82776),X=n(57324),J=n(70515);let q=e=>{var t;let{comment:n,showHiddenComment:i,setShowHiddenComment:r}=e,{iString:o}=(0,C.GO)(),l=null==(t=n.bans)?void 0:t.find(e=>e.publication_id===n.publication_id),s=l&&(0,V.A)(l.expiry).diff((0,V.A)(),"years")>=1,c=(0,J.Pp)(n)&&(n.user_banned_for_comment||n.reported_by_user),d=o(s?"User was indefinitely suspended for this comment. ":"User was temporarily suspended for this comment. "),u=n.user_banned_for_comment?d:o("You reported this comment. ");return c&&(0,a.Y)("div",{className:"comment_notice",children:(0,a.FD)("i",{children:[u,(0,a.Y)("a",{href:"javascript:void(0)",onClick:()=>r(!i),children:i?"Hide":"Show"})]})})},Z=e=>{let{comment:t}=e,{iString:n}=(0,C.GO)(),{title:i,truncated_body_text:r,date:o,bylines:l,like_count:s,comment_count:c,url:d}=t.reply;return(0,a.FD)("a",{className:"reply-comment",href:(0,W.yRP)(d,{utm_source:X.VU.substack,utm_campaign:X._9.postReplyComment,utm_medium:X.Jn.web}),"data-native":!0,children:[(0,a.Y)("div",{className:"reply-comment-title",children:i}),r&&(0,a.Y)("div",{className:"reply-comment-body",children:(0,z.formatEllipsis)(r)}),(0,a.Y)(P.EY.B4,{weight:"semibold",as:"div",className:"reply-comment-read-more",role:"button",children:n("Read more")}),(0,a.Y)("div",{className:"reply-comment-meta",children:(0,z.getPostEmbedMeta)({date:o,bylines:l,like_count:s,comment_count:c})})]})},K=e=>{let{comment:t,bodyRef:n,expandToggleClicked:i,isLong:r,isExpanded:o}=e;o=o||!r;let[l,s]=(0,f.useState)(!1),d=(t.user_banned_for_comment||t.reported_by_user)&&!l,{iString:u}=(0,C.GO)(),m=t.age_verification&&t.age_verification.status!==j.Y.CompletedAdult;return(0,a.FD)(a.FK,{children:[(0,a.FD)("div",{className:c()("comment-body",{long:r,expanded:o}),ref:n,children:[(0,a.Y)(q,{comment:t,showHiddenComment:l,setShowHiddenComment:s}),m?(0,a.Y)(M.T,{content:t,description:t.body,source:"comment"}):t.hidden?(0,a.Y)("i",{children:u("Comment hidden")}):t.deleted?(0,a.Y)("i",{children:u("Comment deleted")}):d?(0,a.Y)("i",{}):t.suppressed&&!l?(0,a.Y)("i",{children:u("Comment removed")}):"reply"===t.type?(0,a.Y)(Z,{comment:t}):(0,H.yY)(t.body)]}),r&&!o&&(0,a.Y)(U.$n,{size:"sm",priority:"secondary-outline",onClick:()=>i(),children:u("See more")})]})};var Q=n(56878),$=n(57023),ee=n(40972),et=n(24078),en=n(75303),ei=n(49807);function er(e){let{comment:t,onClick:n,utm_content:i,noHover:r}=e,o=(0,H.DH)(t),l=(0,ei.gYq)(o,{utm_source:"comment",utm_content:i}),s=null!=n?n:()=>{};return t.user_banned?(0,a.Y)(en.AE,{href:l,onClick:s,children:(0,a.Y)(et.V0,{size:32,icon:(0,a.Y)(ee.A,{stroke:"var(--color-fg-tertiary)"})})}):eo(o,r,l,s)}let eo=(e,t,n,i)=>t?(0,a.Y)(et.dm,{user:e,size:32,linkProps:{href:n,onClick:i}}):(0,a.Y)(et.tp,{user:e,size:32,linkProps:{href:n,onClick:i}});var el=n(89490);function ea(e){let{onCollapse:t}=e;return(0,a.Y)(F.VP,{className:"collapser-Xs0O6C",onClick:t,children:(0,a.Y)(el.az,{className:"threadLine-BvF1wF",animate:!0})})}var es=n(8149),ec=n(50129);function ed(){let e=(0,l._)(["Comment by ",""]);return ed=function(){return e},e}let eu=Math.min(Math.ceil((u()(document.body.clientWidth,400,728)-140)/50),10);class em extends f.Component{componentDidMount(){this.setSelectedHighlight(),this.setReplyStateFromHash(),this.updateIsLong()}componentDidUpdate(e){var t,n;(null==(t=e.comment)?void 0:t.id)!==(null==(n=this.props.comment)?void 0:n.id)&&this.setSelectedHighlight(),e.replying!==this.props.replying&&this.props.replying&&this.startReply()}setReplyStateFromHash(){if(this.props.comment.deleted||"undefined"==typeof window||!window.location.hash)return;let e=/^#comment-(\d+)-reply$/.exec(window.location.hash);e&&Number(e[1])===this.props.comment.id&&(window.location.hash=window.location.hash.replace(/-reply$/,""),this.startReply())}async startReply(){this.props.onStartReply?this.props.onStartReply(this.props.comment):await new Promise(e=>this.setState({replying:!0},e))}onDateClick(e){var t;let[n,i]=e.target.href.split("?")[0].split("#");n===(null==(t=window.location.href.split("?")[0])?void 0:t.split("#")[0])&&i&&(e.preventDefault(),this.setState({hideAnchors:!0},()=>{window.location.hash="#".concat(i),this.setState({hideAnchors:!1})}))}render(){var e,t,n,i,l;let{user:s,comment:d,freeSignup:u,freeSignupEmail:m,pub:p,post:g,reaction_token:f,depth:b,collapseAtDepth:y,onChange:Y,scrollRef:_,retainUserCollapseState:v,onStartReply:C,noHoverProfile:w,onProfileClick:S,onShareComment:k,hideContextMenu:A,noRestack:I,updateCommentReacted:N,iString:D,iTemplate:E,hideShare:R,commentActionsOverride:x}=this.props,{isSelected:T,replying:P,editing:L,hideAnchors:B,isCollapsed:O}=null!=(i=this.state)?i:{},M=p.community_enabled&&g&&"none"!==g.write_comment_permissions,{user_banned:V}=d;if(L&&s)return(0,a.Y)(Q.g,{autoFocus:!0,user:s,freeSignup:u,freeSignupEmail:m,pub:p,post:g,commentBeingEdited:d,saveEdit:this.saveEdit,token:f,onCancel:()=>this.setState({editing:!1}),onSuccess:Y?this.onSaveEditSuccess:null});let j=null==(e=(0,H.DH)(d))?void 0:e.name,W=j?E(ed(),j):D("Comment"),z=this.state.isLong&&!this.state.isExpanded;return(0,a.FD)("div",{className:c()("comment",{selected:T,"post-reply":"reply"===d.type,collapsed:O}),children:[!B&&[(0,a.Y)("div",{id:"comment-".concat(d.id),className:"comment-anchor"}),(0,a.Y)("div",{id:"comment-".concat(d.id,"-reply"),className:"comment-anchor"})],(0,a.FD)(F.fI,{gap:12,paddingBottom:12,className:"comment-content",role:"article","aria-label":W,children:[(0,a.Y)(F.VP,{ref:this.headContainerRef,children:(0,a.Y)(er,{comment:d,noHover:w,onClick:S?()=>S(d):void 0})}),(0,a.FD)(F.VP,{flex:"grow",children:[(0,a.Y)($.P,{post:g,pub:p,comment:d,isCollapsed:O,toggleCollapse:()=>this.setCollapsed(!this.state.isCollapsed),onProfileClick:S,userBanned:null!=V&&V,userPendingApproval:d.status===ec.nJ.new_commenter_approval_required&&!!(null==s?void 0:s.is_admin),onChange:this.onChange,startEdit:()=>this.startEdit(),startReport:this.showReportModal,openBan:this.openBan,hideContextMenu:A}),(0,a.Y)(K,{comment:d,bodyRef:this.bodyRef,expandToggleClicked:this.expandToggleClicked,isLong:z,isExpanded:this.state.isExpanded}),(0,a.Y)(G,{comment:d,pub:p,user:s,post:g,reaction_token:f,commentsEnabledForPost:M,noRestack:I,onChange:this.onChange,startReply:()=>this.startReply(),updateCommentReacted:N,shareComment:k,hideShare:R,commentActionsOverride:x}),(0,a.Y)(es.N,{open:P&&M,children:(0,a.Y)(eh,{children:(0,a.Y)(Q.g,{autoFocus:!0,user:s,freeSignup:u,freeSignupEmail:m,pub:p,post:g,parent:d,token:f,onCancel:()=>this.setState({replying:!1}),onSuccess:Y?e=>{this.setState({replying:!1}),Y((0,o._)((0,r._)({},d),{children:[e].concat(d.children)}))}:null,alwaysShowButtons:!0})})})]})]}),d.childrenSummary&&(0,a.Y)("div",{className:"more-replies-container",children:(0,a.Y)("a",{className:"more-replies",href:(0,H.XB)(g,d,p),children:d.childrenSummary})}),!d.childrenSummary&&!h()(b)&&b>=eu&&!!(null==(t=d.children)?void 0:t.length)&&(0,a.Y)(F.fI,{className:"more-replies-container",children:(0,a.Y)(U.vx,{size:"sm",priority:"secondary-outline",href:(0,H.XB)(g,d,p),children:D("Continue thread →")})}),!d.childrenSummary&&!h()(b)&&b<eu&&(0,a.Y)(ew,{user:s,freeSignup:u,freeSignupEmail:m,pub:p,post:g,comments:null!=(l=d.children)?l:[],parent:d,reaction_token:f,depth:(b||0)+1,collapseAtDepth:y,onChange:Y,isChild:!0,scrollRef:_,retainUserCollapseState:v,onStartReply:C,noHoverProfile:w,onProfileClick:S,hideContextMenu:A,updateCommentReacted:N,noRestack:!0,hideShare:R},d.id),!O&&(null==(n=d.children)?void 0:n.length)>0&&(0,a.Y)(ea,{onCollapse:()=>this.setCollapsed(!0)})]},d.id)}constructor(e,t){super(e,t),(0,i._)(this,"bodyRef",(0,f.createRef)()),(0,i._)(this,"headContainerRef",(0,f.createRef)()),(0,i._)(this,"openBan",()=>{this.props.commentActions.openBanDialog({comment:this.props.comment,onReply:()=>{this.startReply()}})}),(0,i._)(this,"updateIsLong",()=>{let e=this.bodyRef.current;if(!e)return;let t=e.scrollHeight>e.clientHeight+200;t!==this.state.isLong&&this.setState({isLong:t})}),(0,i._)(this,"setSelectedHighlight",()=>{let e=(0,H.jv)()===this.props.comment.id;this.setState({isSelected:e})}),(0,i._)(this,"startEdit",()=>{this.setState({editing:!0})}),(0,i._)(this,"saveEdit",async e=>{if(this.state.editing)return{res:await this.props.maybeOAuthRequest.patch("/api/v1/comment/".concat(this.props.comment.id)).send({body:e})}}),(0,i._)(this,"onSaveEditSuccess",e=>{var t,n;let{edited:i}=e;this.setState({editing:!1}),null==(t=(n=this.props).onChange)||t.call(n,(0,r._)({},this.props.comment,i))}),(0,i._)(this,"showReportModal",()=>{var e;let{pub:t,comment:n}=this.props;this.props.onReport({pub:t,canReportToAdmins:!!(null==t?void 0:t.moderation_enabled)&&!(null==(e=n.metadata)?void 0:e.is_author),onSubmit:async e=>{var i,l;let{reportCategory:a,reportedToSubstack:s,details:c}=e;await y().post("/api/v1/comment/".concat(n.id,"/report")).send({publication_id:null==t?void 0:t.id,details:c,reportCategory:a,reportedToSubstack:s}),null==(i=(l=this.props).onChange)||i.call(l,(0,o._)((0,r._)({},this.props.comment),{reported_by_user:!0}))}})}),(0,i._)(this,"expandToggleClicked",()=>{let e=this.bodyRef.current;if(!e)return;let t=e.scrollHeight-e.clientHeight;(0,k.u4)(k.qY.COMMENT_EXPAND_TOGGLE_CLICKED,{hiddenHeight:t>0?t.toString():null}),this.setState({isExpanded:!0})}),(0,i._)(this,"onChange",e=>{this.props.onChange?this.props.onChange((0,r._)({},this.props.comment,e)):document.location.href=(0,H.PG)(this.props.post,this.props.pub)}),(0,i._)(this,"setComment",e=>{this.setState({comment:e})}),(0,i._)(this,"setCollapsed",e=>{var t,n;if(this.setState({isCollapsed:e}),e&&(null==(n=this.headContainerRef)||null==(t=n.current)?void 0:t.scrollIntoView)){let e=this.headContainerRef.current.getBoundingClientRect();e.top<0&&(document.documentElement.scrollTop+=e.top-80)}this.props.retainUserCollapseState&&(0,H.Pm)(this.props.comment.id,e)}),this.state={editing:!1,replying:!1,hideAnchors:!1,isSelected:!1,isCollapsed:this.props.retainUserCollapseState&&(0,H.pz)(this.props.comment.id),isExpanded:!1,isLong:!1}}}(0,i._)(em,"contextType",v.qL);let eh=(0,el.I4)({display:"flex",flex:"grow",paddingTop:16}),ep=(0,f.memo)((0,C.wr)(function(e){let t=(0,f.useContext)(ek),n=(0,Y.uc)(),i=(0,w.jN)();return(0,a.Y)(em,(0,o._)((0,r._)({},e),{commentActions:t,onReport:n,maybeOAuthRequest:i}))}));em.displayName="Comment_Internal";let eg=5,ef=1,eb=16,ey=50,eY=200;function e_(e){return e.reduce((e,t)=>e+1+e_(t.children||[]),0)}let ev=e=>{let{user:t,freeSignup:n,freeSignupEmail:i,pub:r,post:o,comments:l,reaction_token:s,depth:d,collapseAtDepth:u,onChange:m,pageSize:h,retainUserCollapseState:p,updateCommentReacted:b,parent:y,scrollRef:Y,className:v,onStartReply:w,noHoverProfile:k,onProfileClick:A,hideContextMenu:I,noRestack:N,hideShare:D,commentActionsOverride:E}=e,R=h||eb,[x,F]=(0,f.useState)(!1),[T,P]=(0,f.useState)(!1),[L,B]=(0,f.useState)(R),[O,G]=(0,f.useState)(-1),[M,H]=(0,f.useState)(new Set(l.map(e=>{let{id:t}=e;return t}))),[V,j]=(0,f.useState)(!1),[W,z]=(0,f.useState)(void 0),{iString:J,iPlural:q}=(0,C.GO)();(0,f.useEffect)(()=>{O>=0&&window.scrollTo(window.scrollX,O)},[O]);let Z=(0,S._)(e=>{z(e),j(!0)});if(0===(l||[]).length)return null;let[K,Q]=g()(null!=l?l:[],e=>{let{id:n,user_id:i}=e;return M.has(n)||i===(null==t?void 0:t.id)}),$=K.slice(0,L);return(0,a.FD)(a.FK,{children:[(0,a.FD)("div",{className:c()("comment-list",v,{"has-new-comments":Q.length>0}),children:[Q.length>0&&(0,a.Y)(U.$n,{size:"sm",priority:"secondary-outline",onClick:()=>{setTimeout(()=>{H(new Set(l.map(e=>{let{id:t}=e;return t}))),P(!1)},0),P(!0)},children:T?q("loading 1 new reply","loading %1 new replies",e_(Q)):q("1 new reply","%1 new replies",e_(Q))}),(0,a.Y)("div",{className:"comment-list-items",children:$.map(e=>(0,a.Y)(ep,{user:t,freeSignup:n,freeSignupEmail:i,pub:r,post:o,comment:e,parent:y,reaction_token:s,collapseAtDepth:u,depth:d||0,onChange:m,scrollRef:Y,retainUserCollapseState:p,onStartReply:w,noHoverProfile:k,onShareComment:Z,onProfileClick:A,hideContextMenu:I,noRestack:N,updateCommentReacted:b,hideShare:D,commentActionsOverride:E},e.id))}),K.length>$.length&&(0,a.Y)(U.$n,{size:"sm",priority:"secondary-outline",loading:x,onClick:()=>{G(window.scrollY),setTimeout(()=>{B(L+R),F(!1)},0),F(!0)},children:J("Load More")})]}),(0,a.Y)(_.Z,{isOpen:V,onClose:()=>j(!1),pub:r,post:o,commentId:W,comments:l,user:null!=t?t:void 0,utm_campaign:X._9.commentListShareCta,medium:"web"})]})};ev.displayName="CommentList";let eC=(0,f.memo)(ev);eC.displayName="CommentList";let ew=eC;function eS(e){let[t,n]=(0,f.useState)(null),i=(0,f.useMemo)(()=>({openBanDialog:n}),[]);return(0,a.FD)(ek.Provider,{value:i,children:[(0,a.Y)(ew,(0,r._)({},e)),(0,a.Y)(A.wI,(0,o._)((0,r._)({},t),{onClose:()=>n(null),onBan:(t,n)=>{let{onChange:i}=e;i?i((0,o._)((0,r._)({},t),{user_banned:!0,bans:n.concat(t.bans)})):document.location.href=(0,H.PG)(e.post,e.pub)}}))]})}let ek=(0,f.createContext)({openBanDialog:()=>void 0})},12010:function(e,t,n){n.d(t,{U:()=>r});var i=n(4006);let r=()=>(0,i.FD)("div",{className:"comment-silhouette",children:[(0,i.Y)("div",{className:"comment-silhouette-head"}),(0,i.FD)("div",{className:"comment-silhouette-content",children:[(0,i.Y)("div",{className:"comment-silhouette-meta"}),(0,i.Y)("div",{className:"comment-silhouette-body"}),(0,i.Y)("div",{className:"comment-silhouette-actions"})]})]})},7684:function(e,t,n){n.d(t,{Mr:()=>y,c4:()=>f,d3:()=>b,d4:()=>Y,eu:()=>v,yy:()=>_});var i=n(79785),r=n(17402),o=n(15734),l=n.n(o),a=n(84605),s=n(70145),c=n(68349),d=n(66729),u=n(87087),m=n(16291),h=n(50129);function p(){let e=(0,i._)(["Are you sure you want to unpin this comment?"]);return p=function(){return e},e}function g(){let e=(0,i._)(["Are you sure you want to pin this comment?"]);return g=function(){return e},e}function f(){let e=(0,r.useContext)(d.I);if(!e)throw Error("useCommentMenu must be used within a CommentMenuProvider");return e}let b=e=>{var t;let{iString:n}=(0,a.GO)(),i=null==(t=e.bans)?void 0:t.find(t=>t.publication_id===e.publication_id),r=i&&(0,m.A)(i.expiry).diff((0,m.A)(),"years")>=1,o=["moderator_removed","deleted"].includes(e.status),l=e.user_banned_for_comment;return{banText:r?n("Banned"):o?"":n("Suspended"),shouldShowBanText:l}};function y(e){let{comment:t,onChange:n}=e,{iTemplate:i}=(0,a.GO)(),[o,s]=(0,r.useState)(!1),d=!!t.pinned_by_user_id,u=async()=>{if(!o&&window.confirm(d?i(p()):i(g()))&&!o){s(!0);try{await l().patch("/api/v1/comment/".concat(t.id,"/pin")).send({pinned:!d}),n({pinned:!d}),document.location.reload()}catch(e){alert((0,c.uX)(e)),s(!1)}}};return{pinned:d,togglingPin:o,togglePinned:u}}function Y(e){let{comment:t,onChange:n}=e,[i,o]=(0,r.useState)(!1),a=C("remove"),s=async()=>{if(!i&&a()){o(!0);try{await l().patch("/api/v1/comment/".concat(t.id,"/status")).send({status:h.nJ.moderator_removed}),n({suppressed:!0,status:h.nJ.moderator_removed,body:null})}catch(e){alert((0,c.uX)(e))}o(!1)}};return{isRemoving:i,removeComment:s}}function _(e){let{comment:t,onChange:n}=e,[i,o]=(0,r.useState)(!1),l=C("delete"),a=(0,s.jN)(),d=async()=>{if(!i&&l()){o(!0);try{await a.delete("/api/v1/comment/".concat(t.id)).send(),n({status:h.nJ.deleted,deleted:!0,user_id:null,name:null,body:null})}catch(e){alert((0,c.uX)(e))}o(!1)}};return{isDeleting:i,deleteComment:d}}function v(e){let{comment:t,post:n,pub:i}=e;return{addCommentToLinear:()=>{let e,r;window.open((e=(0,u.XB)(n,t,i),r=encodeURIComponent("".concat(t.body,"\n\nComment author: [").concat(t.name,"](https://admin.substack.com/users/").concat(t.user_id,")\n\nLink: ").concat(e)),"https://linear.app/substackinc/team/TPT/new?description=".concat(r,"&status=Triage")),"_blank")}}}function C(e){let{iString:t}=(0,a.GO)(),{isOAuthProvider:n}=(0,s.ey)();return()=>!!n||window.confirm("".concat(t("Are you sure you want to ".concat(e," this comment? This action cannot be reversed."))))}},93354:function(e,t,n){n.d(t,{t:()=>function e(t,n){let o=[],l=!1,a=new Map(t.map(e=>[e.id,e]));for(let t of n){let n=a.get(t.id);if(n){var s,c;(n.children&&t.children?e(n.children,t.children):t.children)!==n.children||r.some(e=>n[e]!==t[e])||!(0,i.bN)(null!=(s=n.reactions)?s:{},null!=(c=t.reactions)?c:{})?(o.push(t),l=!0):o.push(n)}else o.push(t),l=!0}return l?o:t}});var i=n(38123);let r=["edited_at","deleted","status"]},36757:function(e,t,n){n.d(t,{f:()=>o});var i=n(69277),r=n(70408);function o(e,t){var n,o;return function e(t,n,o){let l=n[0];if(!l){let e=t.findIndex(e=>e.id===o.id);return e>=0?t.with(e,o):[...t,o]}let a=t.findIndex(e=>e.id===l);if(a>=0){let l=t[a];if(l.id===o.id)return t.with(a,o);if(l.children)return t.with(a,(0,r._)((0,i._)({},l),{children:e(l.children,n.slice(1),o)}))}return t}(e,null!=(o=null==(n=t.ancestor_path)?void 0:n.split(".").map(Number))?o:[],t)}},87087:function(e,t,n){n.d(t,{DH:()=>Y,EQ:()=>b,PG:()=>f,Pm:()=>_,Wn:()=>g,XB:()=>d.XB,cx:()=>function e(t,n){for(let[o,l]of t.entries())if(l.id===n.id)return t.with(o,n);else if(l.children){let a=e(l.children,n);if(a!==l.children)return t.with(o,(0,r._)((0,i._)({},l),{children:a}))}return t},jv:()=>p,pU:()=>function e(t,n){if(!t||!n||!n.length)return null;for(let i of n)if(i.id===t)return i;else if(i.children&&i.children.length){let n=e(t,i.children);if(n)return n}return null},pz:()=>v,yY:()=>y});var i=n(69277),r=n(70408),o=n(4006),l=n(95201),a=n.n(l),s=n(17186),c=n(39318),d=n(18947),u=n(82776);let m="comment-collapse-state",h=function(){try{return(0,s.xm)(m,[])}catch(e){return console.error("Failed to load comment collapse state:",e),[]}}(),p=()=>{if("undefined"!=typeof window&&window.location.hash){let e=/^#comment-(\d+)/.exec(window.location.hash);if(e)return Number(e[1])}return null},g=()=>"undefined"!=typeof window&&"#input"===window.location.hash;function f(e,t,n){return(0,c.yRP)((0,c.wu9)(t,e,{comments:!(0,u.shouldUseInlineComments)(t,e)}),n)}function b(e,t,n){return(0,c.yRP)("".concat((0,c.$_T)(t),"/embed/comments/").concat(e.id),{access_token:n})}function y(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"p";return(e||"").split("\n").filter(e=>e.trim()).map(e=>(0,o.Y)(t,{children:(0,o.Y)(a(),{options:{validate:{url:e=>!!e&&!e.startsWith("/")},attributes:{rel:"nofollow ugc noopener"}},children:e})}))}let Y=e=>{var t,n,i,r,o,l;return{id:e.user_id,slug:"user_slug"in e?e.user_slug:void 0,photo_url:e.photo_url,name:null!=(o=e.name)?o:null,bestseller_tier:e.user_bestseller_tier,status:e.userStatus,primary_publication:e.user_primary_publication,is_free_subscribed:["free_signup, subscribed"].includes(null!=(l=null==(t=e.metadata)?void 0:t.membership_state)?l:""),is_subscribed:(null==(n=e.metadata)?void 0:n.membership_state)==="subscribed",is_founding:null==(i=e.metadata)?void 0:i.founding,is_author:null==(r=e.metadata)?void 0:r.is_author}};function _(e,t){let n=!1;if(t)!h.includes(e)&&(n=!0,h.push(e),h.length>250&&h.splice(0,h.length-250));else{let t=h.indexOf(e);t>=0&&(n=!0,h.splice(t,1))}if(n)try{(0,s.X3)(m,h)}catch(e){console.error("Failed to store comment collapse state:",e)}}function v(e){return h.includes(e)}},82286:function(e,t,n){n.d(t,{Xn:()=>l});var i=n(4006);n(32485),n(84605),n(35369),n(33727),n(97515);var r=n(76977);n(57820);var o=n(75303);function l(e){let{children:t,flex:n}=e;return(0,i.Y)(r.fI,{gap:8,alignItems:"center",flex:n,children:t})}n(63136),n(65259),(0,o.I4)({display:"flex",direction:"column",gap:16}),(0,o.I4)({display:"flex",direction:{desktop:"row",mobile:"column"},gap:12,alignItems:{desktop:"center",mobile:"stretch"},justifyContent:{desktop:"space-between",mobile:void 0}}),(0,o.I4)({display:"flex",direction:"column",minHeight:280}),(0,o.I4)({display:"flex",direction:"column",gap:32}),(0,o.I4)({display:"flex",direction:"row",gap:12,alignItems:"center",justifyContent:"space-between",wrap:"wrap"}),(0,o.I4)({display:"flex",wrap:"wrap",direction:"row",gap:12,alignItems:"center"})},3046:function(e,t,n){n.d(t,{Ac:()=>D,Nf:()=>S,T_:()=>F,XK:()=>B,Xx:()=>A,YX:()=>L,ZT:()=>N,Zh:()=>I,b5:()=>E,dU:()=>k});var i=n(69277),r=n(70408),o=n(32641),l=n(4006),a=n(32485),s=n.n(a),c=n(14792),d=n.n(c);n(83673);var u=n(82853);n(18993);var m=n(8853),h=n(38685);n(66443),n(94090);var p=n(72880);n(82936),n(84605);var g=n(46275);n(10398),n(94729),n(24078),n(15040);var f=n(17028),b=n(97515);n(88774);var y=n(22602),Y=n(81203),_=n(75303);n(92028),n(36372),n(89955),n(46647),n(87782),n(80351),n(69089),n(70486),n(42831),n(20437),n(16291),n(39318);var v=n(49807);n(82776);var C=n(69706),w=n(36083);function S(e){var t;let{user:n}=e,i=(0,g.BR)().isOnDestination;return(0,l.Y)(f.az,{paddingX:12,children:(0,l.Y)(f.EY.B4,{as:"a",color:"secondary",decoration:"hover-underline",href:(0,v.gYq)(n,{noBase:i}),target:"_blank",children:null!=(t=n.name)?t:"Substack user"})})}let k=(0,f.I4)({className:w.A.messageBubbleGroup,position:"relative",gap:2},_.VP);function A(e){let{direction:t,isLink:n,backgroundColor:i,isAuthorContributor:r}=e,o="incoming"===t&&r,a="".concat(i,"1A");return(0,l.FD)("svg",{viewBox:"0 0 16 13",className:s()(w.A.bubbs,w.A[t],n&&w.A.isLink,r&&w.A.author),style:o?{fill:a}:{},children:[(0,l.Y)("circle",{cx:"5",cy:"5",r:"5",className:w.A.bubb}),(0,l.Y)("circle",{cx:"13.5",cy:"10.5",r:"2.5",className:w.A.bubb}),o&&(0,l.FD)(l.FK,{children:[(0,l.Y)("circle",{cx:"5",cy:"5",r:"5",fill:a}),(0,l.Y)("circle",{cx:"13.5",cy:"10.5",r:"2.5",fill:a})]})]})}function I(e){var{messageDirection:t,isFirst:n=!1,isLast:a=!1,forceTheme:c,pubThemeAccentColor:u,isAuthorContributor:m,className:h}=e,p=(0,o._)(e,["messageDirection","isFirst","isLast","forceTheme","pubThemeAccentColor","isAuthorContributor","className"]);let g="incoming"===t&&m,b=g&&u;return(0,l.Y)(f.fI,(0,r._)((0,i._)({},p),{className:s()(w.A.bubble,w.A[t],n&&w.A.isFirst,a&&w.A.isLast,c&&w.A["force".concat(d()(c),"Theme")],g&&w.A.author,h),style:{"--color-chat-author-bg-overlay":b?"".concat(u,"1A"):"oklch(from var(--color-bg-accent-themed) l c h / 0.1)"}}))}function N(e){let{metadata:t,publication:n,direction:i,isFirst:r,isLast:o}=e,a=D(t.url);return a?(0,l.Y)(I,{messageDirection:i,isFirst:r,isLast:o,maxWidth:400,forceTheme:"incoming",outline:"detail",children:(0,l.Y)(R,{videoId:a})}):(0,l.Y)(I,{as:"a",href:t.url,target:"_blank",rel:"nofollow noopener ugc",messageDirection:i,isFirst:r,isLast:o,maxWidth:400,forceTheme:"incoming",outline:"detail",children:!function(e){let{metadata:t}=e;if(!t.image)return!1;let n=(0,v.d4Y)(t.image);return!!n&&(n.width<401||n.height<401)}({metadata:t})?(0,l.Y)(T,{publication:n,metadata:t}):(0,l.Y)(F,{metadata:t})})}function D(e){try{let n=new URL(e);if("youtube.com"===n.hostname||"www.youtube.com"===n.hostname){let e=n.searchParams.get("v");if("/watch"===n.pathname&&e)return e;let i=n.pathname.match(/\/(?:embed|v|shorts|live)\/([^\s\/]+)/);if(i){var t;return null!=(t=i[1])?t:null}}else if("youtu.be"===n.hostname){let e=n.pathname.slice(1);if(e)return e}}catch(e){console.error("Error parsing URL:",e)}return null}function E(e){try{var t,n;let i=new URL(e);if(i.pathname.startsWith("/player/v1/"))return null!=(t=i.pathname.split("/").pop())?t:null;if(i.pathname.includes("/video/")){let e=i.pathname.split("/"),t=e.indexOf("video")+1;if(t<e.length)return null!=(n=e[t])?n:null}}catch(e){console.error("Error parsing TikTok URL:",e)}return null}function R(e){let{videoId:t}=e;return(0,l.Y)(x,{src:"https://www.youtube.com/embed/".concat(t),frameBorder:0})}let x=(0,f.I4)({className:w.A.youtubeIframe,border:"unset",bg:"black",flex:"grow"},"iframe");function F(e){let{metadata:t}=e;return(0,l.FD)(f.fI,{flex:"grow",gap:12,padding:12,minWidth:0,children:[(0,l.Y)(P,{metadata:t}),t.image?(0,l.Y)(f.VP,{radius:"md",overflow:"hidden",bg:"tertiary",minWidth:0,children:(0,l.Y)(p.o,{className:s()(w.A.linkImage,w.A.small),src:t.image,maxWidth:64,useRetinaSizing:!0,imageIsFixedWidth:!0,imageProps:{smartCrop:!0,aspect:C.Zi}})}):null]})}function T(e){let{metadata:t,publication:n}=e;return(0,l.FD)(f.VP,{flex:"grow",maxWidth:400,minWidth:400,children:[t.image&&(0,l.Y)(m.c,{className:w.A.linkImage,src:t.image,width:400,aspectRatio:"thumb",options:{smartCrop:!0}}),(0,l.Y)(f.fI,{flex:"grow",padding:12,borderTop:t.image?"detail":void 0,children:(0,l.Y)(P,{metadata:t,publication:n})})]})}function P(e){let{metadata:t,publication:n}=e;return(0,l.FD)(f.fI,{flex:"grow",gap:12,minWidth:0,children:[(0,l.FD)(f.VP,{minWidth:0,flex:"grow",gap:2,children:[t.host&&(0,l.FD)(f.fI,{alignItems:"center",gap:8,minWidth:0,paddingBottom:n?4:void 0,children:[n&&(0,l.Y)(Y.Nq,{pub:n,size:20,radius:"xs"}),(0,l.Y)(f.EY.B4,{color:"secondary",ellipsis:!0,children:t.host})]}),t.title&&(0,l.Y)(f.EY.B3,{color:"primary",weight:"medium",clamp:2,children:t.title})]}),!t.image&&(0,l.Y)(f.fI,{width:64,height:64,bg:"tertiary",radius:"md",alignItems:"center",justifyContent:"center",children:"twitter.com"===t.host||"x.com"===t.host?(0,l.Y)(h.A,{fill:"var(--color-fg-secondary)"}):(0,l.Y)(u.A,{stroke:"var(--color-fg-secondary)"})})]})}function L(){return(0,l.FD)(f.fI,{gap:12,padding:12,alignItems:"center",bg:"secondary",flex:"grow",children:[(0,l.FD)(f.VP,{minWidth:0,flex:"grow",gap:8,children:[(0,l.Y)(y.O,{height:16,width:"".concat(30*Math.random()+60,"%")}),(0,l.Y)(y.O,{height:16,width:"".concat(20*Math.random()+20,"%")})]}),(0,l.Y)(y.O,{width:64,height:64,radius:"md"})]})}function B(){return(0,l.Y)(f.fI,{gap:12,alignItems:"start",bg:"secondary",flex:"grow",children:(0,l.Y)(b.p,{title:"Error loading link",description:"Please try again"})})}},52145:function(e,t,n){n.d(t,{DE:()=>c,MI:()=>d});var i=n(4006),r=n(38376),o=n(49436),l=n(84605);n(94729),n(35369);var a=n(88774);n(36372),n(36319),n(70486),n(16291);var s=n(35407);function c(e){let{onMute:t,customLabel:n}=e,{iString:o}=(0,l.GO)();return(0,i.Y)(a.Dr,{leading:(0,i.Y)(r.A,{className:s.A.muteIcon}),onClick:e=>{e.preventDefault(),e.stopPropagation(),t("indefinitely")},children:n||o("Mute")})}function d(e){let{onClick:t,customLabel:n}=e,{iString:r}=(0,l.GO)();return(0,i.Y)(a.Dr,{leading:(0,i.Y)(o.A,{className:s.A.muteIcon}),onClick:e=>{e.preventDefault(),t()},children:n||r("Unmute")})}},56689:function(e,t,n){n.d(t,{c:()=>i});function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise(t=>{setTimeout(t,e)})}},54542:function(e,t,n){n.d(t,{y1:()=>i});function*i(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;for(let i=e;i<t;i+=n)yield i}}}]);