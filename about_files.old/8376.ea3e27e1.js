!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};e.SENTRY_RELEASE={id:"substack@af5f699"};var t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="42f5f961-fb6c-4fab-a168-ddc1300228b9",e._sentryDebugIdIdentifier="sentry-dbid-42f5f961-fb6c-4fab-a168-ddc1300228b9")}catch(e){}}();"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["8376"],{38476:function(e,t,n){n.d(t,{A:()=>r});let r={shimmer:"shimmer-DF054A",shimmerAnimation:"shimmerAnimation-dmgPXN",transition:"transition-Na2iYv",from:"from-LIO3hL",to:"to-rGgfVf",icon:"icon-kVFYHC",errorIcon:"errorIcon-yltUsD",toastContainer:"toastContainer-s9kdmI"}},72285:function(e,t,n){n.d(t,{A:()=>r});let r={avatarButton:"avatarButton-lZBlGB",dropdownBadge:"dropdownBadge-CARUw5"}},26620:function(e,t,n){n.d(t,{A:()=>r});let r={container:"container-KbMeLj",themed:"themed-EbT4uD",saveButton:"saveButton-bEqkhJ",text:"text-RPsawq",short:"short-ZM5yW_","lineClamp-4":"lineClamp-4-JbwbHY",lineClamp4:"lineClamp-4-JbwbHY",imageText:"imageText-mhB5o2",backdrop:"backdrop-Xjlnco",imageBackdrop:"imageBackdrop-mwjQFt",tinted:"tinted-Vm3IqP",blurred:"blurred-UbnY7U",tint:"tint-HtqWIV",header:"header-ndGPw6",restack:"restack-YSzWKs",permalink:"permalink-bijGJH",footer:"footer-0EQTsv",swatchesContainer:"swatchesContainer-TDgd_R",swatchContainer:"swatchContainer-IIrOXq",selected:"selected-how610",alignmentSwatchContainer:"alignmentSwatchContainer-_cyt17",swatch:"swatch-otVp71"}},8174:function(e,t,n){n.d(t,{A:()=>r});let r={signInAppUpsell:"signInAppUpsell-u9SVL0",isDesktop:"isDesktop-_mI6rc",appDownloadButton:"appDownloadButton-Lbsixg",qrContainer:"qrContainer-ApUIIX",qrCode:"qrCode-f8T8_u"}},6986:function(e,t,n){n.d(t,{A:()=>r});let r={badge:"badge-jGMz0j",dot:"dot-dFwIaI",singleElement:"singleElement-ve4D6v",fillIcon:"fillIcon-hub55b",empty:"empty-w6FjPW",shape_circle:"shape_circle-Q9w9_R",shapeCircle:"shape_circle-Q9w9_R",shape_square:"shape_square-O2PxpD",shapeSquare:"shape_square-O2PxpD","placement_top-left":"placement_top-left-dsosXN",placementTopLeft:"placement_top-left-dsosXN","placement_top-right":"placement_top-right-CTrC80",placementTopRight:"placement_top-right-CTrC80","placement_bottom-left":"placement_bottom-left-JFLMtf",placementBottomLeft:"placement_bottom-left-JFLMtf","placement_bottom-right":"placement_bottom-right-hoG7Xz",placementBottomRight:"placement_bottom-right-hoG7Xz"}},40719:function(e,t,n){n.d(t,{A:()=>r});let r={overscrollTransition:"overscrollTransition-QBV35u"}},60938:function(e,t,n){n.d(t,{A:()=>r});let r={tab:"tab-eCtYfd"}},90017:function(e,t,n){n.d(t,{A:()=>r});let r={root:"root-IyF5Yz",list:"list-UVnyqE",highlight:"highlight-rZ7aQJ"}},79804:function(e,t,n){n.d(t,{A:()=>r});let r={avatarLink:"avatarLink-M6ZJnW",inlineComposer:"inlineComposer-v8PLSi",disabled:"disabled-YAsoUi",mobileInlineComposer:"mobileInlineComposer-jKgh_1",isDragging:"isDragging-TcoucF",floatingComposer:"floatingComposer-np5rUF",inputSpacer:"inputSpacer-x19EDg",wordCountIndicator:"wordCountIndicator-KkYqEv",exceded:"exceded-x1z6ce",composerModal:"composerModal-q2ZgZt",setupProfileModalContent:"setupProfileModalContent-IhiQBI",editorContainer:"editorContainer-Lfneza",dropdownIcon:"dropdownIcon-HzL2Jt",dropdownMenu:"dropdownMenu-RAjGgB",pubRow:"pubRow-ZqkbZG",pubName:"pubName-DndaDy",linkImage:"linkImage-VNRJEM",imageContainer:"imageContainer-sSgwnk",imageActions:"imageActions-J_pVYc",removeAttachment:"removeAttachment-lybT5W",shareImageButton:"shareImageButton-O3Fvsx",notifyConformModalPubRow:"notifyConformModalPubRow-929y7D"}},95755:function(e,t,n){n.d(t,{A:()=>r});let r={modalBody:"modalBody-yrSvJm",captcha:"captcha-awCBm5"}},76199:function(e,t,n){n.d(t,{ZD:()=>A,lY:()=>I});var r=n(4006),i=n(35426),o=n(32485),a=n.n(o),l=n(45773),d=n(48697),c=n(94796),s=n(17402),u=n(89333),p=n(72880),h=n(84605),m=n(86500),g=n(74049),f=n(35369),Y=n(76977),_=n(63136),v=n(2481),b=n(39318),C=n(53168),w=n(38476);let S=()=>(0,r.Y)(Y.Ye,{radius:"full",className:w.A.shimmer,style:{height:"var(--size-6)",width:"100%"}}),E=(0,s.createContext)({addMediaUpload:e=>{let{}=e;throw Error("Adding a download requires a DownloadProvider.")},markAsDownloaded:()=>{throw Error("Marking as downloaded requires a DownloadProvider.")},hasBeenDownloaded:()=>{throw Error("Checking download status requires a DownloadProvider.")}}),y=e=>{var t;let{context:n,download:{mediaUpload:i,title:o,thumbnailUrl:C,source:E},pub:y,onRemoveItem:A}=e,{markAsDownloaded:D,hasBeenDownloaded:k}=I(),{iString:R}=(0,h.GO)(),{mediaUpload:T,downloadUrl:O}=(0,u.Dw)(i.id),P=(0,v.NP)(),N=(null==T?void 0:T.state)==="error",B="downloads";(0,s.useEffect)(()=>{O&&T&&!k(i.id)&&((0,g.P)(T,o),D(i.id),(0,m.u4)(m.qY.MEDIA_CLIP_DOWNLOAD_COMPLETED,{video_upload_id:i.id,is_post_editor:!1,type:E,surface:B}))},[i.id,O,T,k,D,E,o]);let F=(0,s.useCallback)(e=>{e.preventDefault(),(0,m.u4)(m.qY.MEDIA_CLIP_BUTTON_CLICKED,{button:"share_to_notes",source:"download_toast",surface:B});let t="publisher"===n?"".concat(R("Subscribe to get the full video when it's released."),"\n"):"";P.open({initialText:"".concat(t),videoUploadId:i.id,onCompose:e=>{(0,m.u4)(m.qY.MEDIA_CLIP_SHARED,{destination:"notes",note_id:e.id,video_upload_id:i.id,is_post_editor:"publisher"===n,surface:B})}})},[P,n,R,i.id,y]);return(0,r.FD)(Y.Ye,{gap:16,children:[(0,r.Y)("div",{children:(0,r.FD)(Y.Ye,{position:"relative",children:[(0,r.Y)(p.o,{src:null!=(t=null!=C?C:(0,b.Pzx)(i))?t:"",maxWidth:40,radius:"xs",imageProps:{height:Math.round(40),smartCrop:!0}}),O&&(0,r.Y)(Y.pT,{bg:"white",radius:"full",width:20,height:20,position:"absolute",alignItems:"center",justifyContent:"center",className:w.A.icon,children:(0,r.Y)(l.A,{stroke:"black",strokeWidth:2,size:14})}),N&&(0,r.Y)(Y.pT,{radius:"full",width:20,height:20,position:"absolute",alignItems:"center",justifyContent:"center",className:a()(w.A.icon,w.A.errorIcon),children:(0,r.Y)(d.A,{stroke:"white",strokeWidth:2,size:14})})]})}),(0,r.FD)(Y.I1,{gap:8,children:[(0,r.FD)(Y.Ye,{gap:12,children:[(0,r.FD)(Y.Ye,{style:{width:"250px"},alignItems:"center",gap:8,children:[(0,r.FD)(Y.I1,{flex:"grow",children:[(0,r.Y)(_.EY.B4,{color:"white",weight:"semibold",style:{overflowWrap:"anywhere"},children:o}),O?(0,r.Y)(_.EY.B4,{color:"white",children:R("Complete")}):(0,r.FD)(_.EY.B4,{color:"white",children:[R("Downloading clip"),"â€¦"]}),N&&(0,r.Y)(_.EY.B4,{color:"error",weight:"semibold",style:{overflowWrap:"anywhere"},children:R("Download failed")})]}),O&&(0,r.Y)(f.$n,{leading:(0,r.Y)(c.A,{size:16}),priority:"primary",size:"sm",onClick:F,children:R("Share")})]}),(0,r.Y)(Y.Ye,{cursor:"pointer",onClick:e=>{e.stopPropagation(),A()},children:(0,r.Y)(d.A,{stroke:"gray"})})]}),O||N?null:(0,r.Y)(S,{})]})]})};function A(e){let{children:t,pub:n,context:o}=e,[a,l]=(0,s.useState)([]),[d,c]=(0,s.useState)(new Set);return(0,r.FD)(E.Provider,{value:{addMediaUpload:e=>{l(t=>[...t,e])},markAsDownloaded:e=>{c(t=>{let n=new Set(t);return n.add(e),n})},hasBeenDownloaded:e=>d.has(e)},children:[t,!!a.length&&(0,r.Y)("div",{className:w.A.toastContainer,style:{zIndex:C.GJ},children:(0,r.Y)(i.e,{show:!0,appear:!0,enter:w.A.transition,enterFrom:w.A.from,enterTo:w.A.to,leave:w.A.transition,leaveFrom:w.A.to,leaveTo:w.A.from,children:(0,r.Y)(Y.I1,{style:{backgroundColor:"#232525"},radius:"md",padding:16,gap:8,children:a.map((e,t)=>(0,r.Y)(y,{context:o,download:e,pub:n,onRemoveItem:()=>l(a.filter(t=>{let{mediaUpload:n}=t;return n.id!==e.mediaUpload.id}))},"".concat(t,"_").concat(e.mediaUpload.id)))})})})]})}function I(){return(0,s.useContext)(E)}},31452:function(e,t,n){n.d(t,{N:()=>a});var r=n(99851),i=n(69277),o=n(41873);class a extends o.A{trackMedia(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={content_type:"livestream",entity_type:"livestream",primary_entity_type:"livestream",entity_key:String(this.props.liveStreamId),primary_entity_key:String(this.props.liveStreamId)};super.trackMedia(e,(0,i._)({},t,n))}constructor(...e){super(...e),(0,r._)(this,"getBaseVideoSrc",e=>{let t="/api/v1/live_stream/".concat(this.props.liveStreamId),n=new URLSearchParams;return e&&n.append("type",e),n.append("src","true"),this.props.noJoin&&n.append("noJoin","true"),this.props.portrait&&n.append("portrait","true"),"".concat(t,"?").concat(n.toString())}),(0,r._)(this,"onPreviewClick",e=>{var t;this.player&&this.player.duration&&this.player.duration>1&&!isNaN(this.player.duration)&&(null==(t=this.player)?void 0:t.paused)&&(this.player.currentTime=this.player.duration-1),this.player&&this.player.paused&&(this.player.playbackRate=1),super.onPreviewClick(e)}),(0,r._)(this,"refreshVideoSrc",()=>{var e;this.setState({autoPlay:!(null==(e=this.player)?void 0:e.paused)}),n.e("9234").then(n.bind(n,40137)).then(e=>{this._initHlsjsWrapped(e.default)})})}}o.A},58475:function(e,t,n){n.d(t,{G:()=>a,Z:()=>l});var r=n(4006),i=n(17402);let o=(0,i.createContext)(null);function a(e){let{root:t,children:n}=e,a=(0,i.useRef)(t);return(0,r.FD)(o.Provider,{value:a,children:[n,!t&&(0,r.Y)("div",{ref:a})]})}function l(e){let{children:t}=e,n=(0,i.useContext)(o).current;return n?(0,i.createPortal)(t,n):null}},110:function(e,t,n){n.d(t,{A:()=>O});var r=n(4006);n(1683);var i=n(76199),o=n(58475),a=n(51419),l=n(52820),d=n(84565),c=n(69324),s=n(84605),u=n(46275),p=n(51440),h=n(40691),m=n(97640),g=n(13505),f=n(95899),Y=n(25006),_=n(99145),v=n(53989),b=n(3084),C=n(85478),w=n(98747),S=n(46271),E=n(57446),y=n(56007),A=n(3011),I=n(87370),D=n(2481),k=n(32848),R=n(14984),T=n(40659);function O(e){let{user:t=null,pub:n=null,children:O,siteConfigs:P={},hasThemedBackground:N=!1,language:B="en",preferredLanguage:F=null,locale:L,country:x,experimentInfo:M={variantOverrides:{},experimentFeatures:{},experimentExposures:{}},portalRoot:G,shouldLoad:q,shouldPollNotifications:U=!1,publicationSettings:V={},userSettings:W,publicationUserSettings:j={},activityToken:z,loadPubClientSearch:H,enablePubClientSearchShortcuts:J=!0,loadGlobalSearch:X,includePodcasts:Z=!1,context:K="reader",isMarketingPage:Q=!1,browser:$,webviewPlatform:ee=null}=e;void 0===q&&(q=!!t);let et=(0,k.Of)({isLoggedIn:!!t,includePodcasts:Z});return(0,r.Y)(a.WJ,{browser:$,webviewPlatform:ee,children:(0,r.Y)(p.PC,{country:x||"US",children:(0,r.Y)(s.Pz,{language:B||"en",preferredLanguage:F,locale:L,children:(0,r.Y)(w.wX,{value:{hasThemedBackground:N},children:(0,r.Y)(C.eE,{siteConfigs:P,children:(0,r.Y)(l.S$,{siteConfigs:P,experimentInfo:M,children:(0,r.Y)(d.sV,{siteConfigs:P,experimentInfo:M,children:(0,r.Y)(v.Fm,{settings:V,children:(0,r.Y)(b.iB,{preloadPubUserSettings:j,children:(0,r.Y)(m._b,{shouldLoad:q,shouldPoll:U,activityToken:z,children:(0,r.Y)(o.G,{root:G,children:(0,r.Y)(S.vu,{defaultValue:t,userSettings:W,children:(0,r.Y)(E.Q,{children:(0,r.Y)(f.HW,{children:(0,r.Y)(u.Sn,{children:(0,r.Y)(y.tE,{children:(0,r.Y)(A.B,{children:(0,r.Y)(h.Zn,{children:(0,r.Y)(D.wG,{children:(0,r.Y)(i.ZD,{context:K,pub:n,children:(0,r.Y)(k.C8.Provider,{value:et,children:(0,r.Y)(I.b,{children:(0,r.Y)(Y.pP.Provider,{value:n,children:(0,r.Y)(R.tB,{user:t,children:(0,r.Y)(c.yl,{load:X,useLocalNavigation:!Q,children:(0,r.Y)(_.BR,{load:H,pub:n,enableShortcuts:J,children:(0,r.Y)(g.kL,{children:(0,r.Y)(T.Fg,{children:O})})})})})})})})})})})})})})})})})})})})})})})})})})})})}},40691:function(e,t,n){n.d(t,{Zn:()=>l,hS:()=>d});var r=n(4006),i=n(17402),o=n(16993);let a=(0,i.createContext)({openModal:()=>{},closeModal:()=>{}});function l(e){let{children:t}=e,[n,l]=(0,i.useState)(!1),[d,c]=(0,i.useState)({width:540,children:null}),s=()=>{l(!1)};return(0,r.FD)(a.Provider,{value:{openModal:e=>{c(e),l(!0)},closeModal:s},children:[(0,r.Y)(o.aF,{isOpen:n,onClose:s,width:d.width,children:d?d.children:null}),t]})}function d(){return(0,i.useContext)(a)}a.displayName="ModalContext"},59922:function(e,t,n){n.d(t,{A:()=>i});var r=n(17402);let i=(e,t)=>{let n=(0,r.useRef)();(0,r.useEffect)(()=>{n.current=e},[e]),(0,r.useEffect)(()=>{if(null!==t){let e=setInterval(function(){var e;null==(e=n.current)||e.call(n)},t);return()=>clearInterval(e)}},[t])}},62076:function(e,t,n){n.d(t,{k:()=>i});var r=n(39891);function i(e,t){let{width:n,height:i}=t,l=o.flatMap(t=>a.map(o=>"'".concat((0,r.dJ)(e,n*o,{format:t,height:i?i*o:void 0,crop:"fill"}),"' ").concat(o,"x type('image/").concat(t,"')")));return"image-set(".concat(l.join(", "),")")}let o=["avif","jpeg"],a=[1,2,3]},80103:function(e,t,n){n.d(t,{a7:()=>Y});var r=n(4006),i=n(32485),o=n.n(i);n(99862);var a=n(47963);n(78895),n(20201),n(79909),n(52820),n(85478);var l=n(86500),d=n(56804);n(3479),n(35840),n(49660);var c=n(76977),s=n(63136);n(4016);var u=n(39318),p=n(98949),h=n(57324),m=n(8174);let g=h._9.appMarketing,f=h.fL.signInPage;function Y(e){let{abTestingId:t}=e,n=(0,p.aR)()?"ios":(0,p.m0)()?"android":"desktop",i="desktop"===n?180:120;return(0,r.Y)(c.pT,{padding:20,paddingTop:32,alignItems:"center",justifyContent:"center",children:(0,r.FD)(c.Ye,{radius:"lg",border:"detail",className:o()(m.A.signInAppUpsell,{[m.A.isDesktop]:"desktop"===n}),paddingX:20,paddingTop:20,gap:20,shadow:"lg",cursor:"pointer",onClick:e=>{(0,l.u4)(l.qY.SIGN_IN_APP_UPSELL_CLICKED,{position:"sign-in-page"}),(0,d.o)(e,(0,u.wHz)({utm_campaign:g,utm_content:f,utm_source:h.VU.upsell}),{native:!0,newTab:!0})},children:[(0,r.FD)(c.I1,{justifyContent:"space-between",flex:"grow",paddingBottom:20,gap:8,children:[(0,r.FD)(c.I1,{gap:8,children:[(0,r.Y)(s.EY.H3,{weight:"heavy",children:"Stay signed in"}),(0,r.Y)(s.EY.B4,{color:"secondary",children:"Download the Substack app for ".concat("ios"===n?"iOS":"android"===n?"Android":"Android or iOS")})]}),"desktop"===n?(0,r.Y)(_,{abTestingId:t}):(0,r.Y)(b,{type:n})]}),(0,r.Y)(c.pT,{alignItems:"end",children:(0,r.Y)("img",{style:{maxWidth:i},src:(0,u.dJ9)("/img/app_page/highlight-6-ios-v2.png",2*i)})})]})})}function _(e){let{abTestingId:t}=e;return(0,r.FD)(c.I1,{gap:16,alignItems:"center",children:[(0,r.Y)(v,{abTestingId:t}),(0,r.FD)(c.Ye,{gap:8,children:[(0,r.Y)(b,{type:"ios"}),(0,r.Y)(b,{type:"android"})]})]})}function v(e){let{abTestingId:t}=e;return(0,r.Y)(c.pT,{border:"detail",radius:"lg",className:m.A.qrContainer,children:(0,r.Y)(c.pT,{className:m.A.qrCode,padding:8,children:(0,r.Y)(a.hj,{abTestingId:t,width:160,height:160,utm_campaign:g,utm_content:f,utm_source:h.VU.qr})})})}function b(e){let{type:t}=e;return(0,r.Y)(c.pT,{style:{minWidth:135},radius:"sm",overflowX:"hidden",overflowY:"hidden",className:m.A.appDownloadButton,as:"a",href:(0,u.wHz)({utm_campaign:g,utm_content:f,utm_source:h.VU.badge,force:"android"===t?"android":"ios"}),onClick:e=>e.stopPropagation(),children:(0,r.Y)("img",{className:"app-upsell",src:(0,u.dJ9)("android"===t?"/img/app_page/google-play.png":"/img/app_page/app-store.png",320),height:40})})}},22057:function(e,t,n){n.d(t,{Z:()=>u});var r=n(69277),i=n(4006),o=n(32485),a=n.n(o),l=n(24078),d=n(89490),c=n(82776),s=n(72458);function u(e){let{users:t,renderAvatar:n=e=>(0,i.Y)(l.eu,(0,r._)({},e)),max:o=5,total:d,size:c=32,direction:u="ltr",className:g,renderCount:f,loading:Y}=e,_=o?t.slice(0,o):t,v=d?d-_.length:o?t.length-o:0,b="rtl"===u?[..._].reverse():_,C=(0,i.Y)(p,{size:c,remainingCount:v}),w=null==f?void 0:f(v),S=.25*c,E=Math.max(.125*c,3);return(0,i.FD)(h,{children:[(0,i.FD)(m,{className:a()(s.A[u],g),style:{"--scale":"".concat(c,"px"),"--offset":"".concat(S,"px"),"--border-width":"".concat(E,"px")},children:[Y?function(e){let{size:t,max:n}=e;return Array(n).fill(null).map((e,r)=>(0,i.Y)(l.mM,{size:t,className:a()(s.A.avatar,0!==r&&s.A.overlap,r===n-1&&s.A.last)},r))}({size:c,max:o}):b.map((e,t)=>n({user:e,size:c,className:a()(s.A.avatar,0!==t&&s.A.overlap,t===b.length-1&&s.A.last)})),v>0&&!f&&C]}),v>0&&f&&w]})}function p(e){let{size:t,remainingCount:n}=e;return(0,i.Y)(l.j0,{className:a()(s.A.avatar,s.A.overlap,s.A.last),size:t,children:(0,i.Y)(l.NV,{size:t,text:"+".concat((0,c.numberToRoughShortString)(Math.max(n,1),{plusSignifier:""}))})})}let h=(0,d.I4)({display:"flex",direction:"row",gap:8,alignItems:"center",justifyContent:"start"}),m=(0,d.I4)({display:"flex",direction:"row",alignItems:"center",justifyContent:"start"})},39841:function(e,t,n){n.d(t,{s:()=>d});var r=n(4006),i=n(51290),o=n(35369),a=n(17028),l=n(60938);function d(e){let{tab:t,children:n,value:a}=e;return(0,r.Y)(i.l9,{asChild:!0,value:a,children:(0,r.FD)(o.Nm,{className:l.A.tab,display:"flex",flex:"grow",alignItems:"center",justifyContent:"center",position:"relative",sizing:"border-box",radius:"xs",resetCss:!0,minHeight:40,paddingTop:2,paddingX:16,gap:6,showFocus:!0,animate:!0,userSelect:"none",children:[t.leading,(0,r.Y)(c,{children:n}),t.trailing]})})}let c=e=>{let{children:t}=e;return(0,r.Y)(a.EY.B4,{as:"span",weight:"semibold",size:14,ellipsis:!0,animate:!0,children:t})}},414:function(e,t,n){n.d(t,{r:()=>u});var r=n(4006),i=n(51290),o=n(17402),a=n(84605),l=n(17028),d=n(39841),c=n(71518),s=n(90017);function u(e){let{tabs:t,value:n,onChange:l,ariaLabel:u}=e,{iString:h}=(0,a.GO)(),m=(0,o.useRef)(null),g=(0,o.useRef)(null);return(0,o.useEffect)(()=>(0,c.x)({parentRef:m,highlightRef:g}),[n,t]),(0,r.Y)(i.bL,{value:n,onValueChange:e=>{l(e)},className:s.A.root,children:(0,r.FD)(i.B8,{ref:m,"aria-label":null!=u?u:"".concat(h("Tabs")),className:s.A.list,children:[t.map(e=>(0,r.Y)(d.s,{tab:e,value:e.value,children:e.label},e.value)),(0,r.Y)(p,{ref:g})]})})}let p=(0,l.I4)({position:"absolute",className:s.A.highlight})},2824:function(e,t,n){n.d(t,{a:()=>h});var r=n(4006),i=n(67078),o=n(84605),a=n(46271),l=n(12501),d=n(35369),c=n(16993),s=n(84843),u=n(49807),p=n(57324);function h(e){let{isOpen:t,onClose:n,requirement:h,writerId:m}=e,g=(0,a.Jd)(),{iString:f}=(0,o.GO)(),{result:Y}=(0,l.st)({pathname:"/api/v1/user/".concat(m,"/primary-publication"),deps:[m],auto:!0}),_=f("free_subscriber"===h?"Subscribers only":"Paid subscribers only"),v=f("free_subscriber"===h?"To join the conversation, become a subscriber.":"To join the conversation, become a paying subscriber.");return(0,r.FD)(c.aF,{isOpen:t,onClose:n,children:[(0,r.Y)(c.rQ,{alignItems:"center",title:_,description:v,icon:(0,r.Y)(s.qx,{icon:(0,r.Y)(i.A,{})}),showClose:!1}),(0,r.Y)(c.q1,{}),(0,r.Y)(c.jl,{direction:"column",primaryButton:Y?(0,r.Y)(d.$n,{priority:"primary",rounded:!0,href:(0,u.eV6)(Y,{user:g,addBase:!0,params:{utm_source:p.VU.feedCommentReplyRestriction}}),children:f("free_subscriber"===h?"Subscribe":"Upgrade")}):void 0,secondaryButton:(0,r.Y)(d.$n,{priority:"secondary",rounded:!0,onClick:n,children:f(Y?"Cancel":"Ok")})})]})}},81870:function(e,t,n){n.d(t,{C:()=>c});var r=n(4006),i=n(43954),o=n(84605),a=n(35369),l=n(16993),d=n(84843);function c(e){let{isOpen:t,onClose:n}=e,{iString:c}=(0,o.GO)();return(0,r.FD)(l.aF,{isOpen:t,onClose:n,children:[(0,r.Y)(l.rQ,{alignItems:"center",title:c("Confirm your email address"),description:c("Please confirm your email address before posting a note."),icon:(0,r.Y)(d.qx,{icon:(0,r.Y)(i.A,{})}),showClose:!1}),(0,r.Y)(l.q1,{}),(0,r.Y)(l.jl,{direction:"column",primaryButton:(0,r.Y)(a.$n,{priority:"primary",rounded:!0,onClick:n,children:c("Ok")}),secondaryButton:(0,r.Y)(a.$n,{priority:"secondary",href:"/settings",children:c("Resend confirmation email")})})]})}},50630:function(e,t,n){n.d(t,{W:()=>a,r:()=>l});var r=n(4006),i=n(17402);let o=(0,i.createContext)(null);function a(e){let{children:t}=e,[n,a]=(0,i.useState)("email"),[l,d]=(0,i.useState)(""),[c,s]=(0,i.useState)(!1),[u,p]=(0,i.useState)(null);return(0,r.Y)(o.Provider,{value:{mode:n,email:l,verificationCodeEnabled:c,onboardingRedirect:u,setMode:e=>{"magic-link"!==e&&s(!1),a(e)},setEmail:d,setVerificationCodeEnabled:s,setOnboardingRedirect:p},children:t})}function l(){let e=(0,i.useContext)(o);if(!e)throw Error("useSignIn must be used within an SignInProvider");return e}},83842:function(e,t,n){n.d(t,{j:()=>f});var r=n(79785),i=n(4006),o=n(43954),a=n(84605),l=n(59922),d=n(38093),c=n(17028),s=n(16993),u=n(84843),p=n(50630),h=n(62088);function m(){let e=(0,r._)(["We've sent an email to ",". Click the magic link or enter the code below:"]);return m=function(){return e},e}function g(){let e=(0,r._)(["We've sent an email to ",". Click the magic link inside to continue."]);return g=function(){return e},e}let f=e=>{let{noCloseButton:t,noExit:n,onCancel:r,onSuccess:o}=e;return(0,i.FD)(i.FK,{children:[(0,i.Y)(Y,{noCloseButton:!t||n,onCancel:r}),(0,i.Y)(_,{onSuccess:o}),(0,i.Y)(v,{})]})},Y=e=>{let{noCloseButton:t,onCancel:n}=e,{iString:r,iTemplate:l}=(0,a.GO)(),{verificationCodeEnabled:d,email:c}=(0,p.r)();return(0,i.Y)(u.rQ,{title:r("Check your email to continue"),showClose:!t,onClose:n,icon:(0,i.Y)(u.qx,{icon:(0,i.Y)(o.A,{size:20})}),alignItems:"center",description:l(d?m():g(),null!=c?c:"your email address")})};function _(e){let{onSuccess:t}=e,{verificationCodeEnabled:n,email:r,onboardingRedirect:o}=(0,p.r)();return(0,l.A)(()=>{fetch("/api/v1/am_i_logged_in").then(async e=>{(await e.json()).loggedIn&&t()})},5e3),n?(0,i.Y)(s.cw,{children:(0,i.Y)(d.Z,{email:r,redirect:o||document.location.href})}):(0,i.Y)(s.q1,{})}let v=()=>{let{iString:e}=(0,a.GO)(),{setMode:t}=(0,p.r)();return(0,i.Y)(h.dt,{children:(0,i.FD)(i.FK,{children:[e("Didn't get the email? "),(0,i.Y)(c.Yq,{color:"substack",decoration:"hover-underline",onClick:()=>t("email"),cursor:"pointer",children:e("Try again")})]})})}},23358:function(e,t,n){n.d(t,{_:()=>f});var r=n(4006),i=n(84605),o=n(43294),a=n(94729),l=n(12501),d=n(68349),c=n(17028),s=n(20500),u=n(16993),p=n(65842),h=n(50630),m=n(62088),g=n(95755);let f=e=>{let{overrideTitle:t,noCloseButton:n,onCancel:i,onSignup:o,onUserCreated:a,redirectOverride:l}=e;return(0,r.FD)(r.FK,{children:[(0,r.Y)(m.$P,{overrideTitle:t,noCloseButton:n,onCancel:i,onSignup:o}),(0,r.Y)(Y,{onUserCreated:a,redirectOverride:l})]})};function Y(e){let{onUserCreated:t,redirectOverride:n}=e,{iString:m}=(0,i.GO)(),{setMode:f,setEmail:Y,setVerificationCodeEnabled:_,setOnboardingRedirect:v,email:b}=(0,h.r)(),C=(0,o.X)(),w=(0,l.st)({pathname:"/api/v1/email-login",method:"POST"});return(0,r.FD)("form",{onSubmit:e=>{if(e.preventDefault(),w.isLoading)return;let r=e.currentTarget.email.value;w.refetch({json:{email:r,redirect:n||location.pathname,can_create_user:!0}}).then(e=>{if(!(e instanceof a.fk)){if(!(e instanceof Error)&&"optional"===e.verification_code){_(!0),Y(r),v(e.onboarding_redirect||null),f("magic-link");return}if(!(e instanceof Error)&&e.user){if(t)return void t(e.user);window.location.reload()}Y(r),f("magic-link")}})},children:[(0,r.Y)(u.cw,{className:g.A.modalBody,children:(0,r.FD)(c.VP,{gap:16,children:[(0,r.Y)(p.ks,{type:"email",name:"email",placeholder:m("Your email"),autoComplete:"email",ref:C,autoFocus:!0,defaultValue:b}),w.error&&(0,r.Y)(s.yn,{children:(0,d.uX)(w.error)})]})}),(0,r.Y)(u.jl,{direction:"column",primaryButton:(0,r.Y)(c.$n,{priority:"primary",type:"submit",loading:w.isLoading,children:m("Continue")}),secondaryButton:(0,r.Y)(c.$n,{priority:"secondary-outline",onClick:()=>{var e;Y((null==(e=C.current)?void 0:e.value)||""),f("password")},children:m("Sign in with password")}),buttonDivider:(0,r.Y)(c.vj,{})})]})}},82804:function(e,t,n){n.d(t,{Q:()=>m});var r=n(4006),i=n(67078),o=n(84605),a=n(94729),l=n(12501),d=n(38093),c=n(17028),s=n(16993),u=n(84843),p=n(50630),h=n(62088);let m=e=>{let{onSuccess:t}=e;return(0,r.FD)(r.FK,{children:[(0,r.Y)(g,{}),(0,r.Y)(f,{onSuccess:t}),(0,r.Y)(Y,{})]})},g=()=>{let{iString:e}=(0,o.GO)();return(0,r.Y)(u.rQ,{title:e("Enter the code from your authenticator app"),description:e("This helps us make sure it's really you."),showClose:!1,icon:(0,r.Y)(u.qx,{icon:(0,r.Y)(i.A,{size:20})}),alignItems:"center"})};function f(e){let{onSuccess:t}=e,n=(0,l.st)({pathname:"/api/v1/mfa-login",method:"Post"});return(0,r.Y)(s.cw,{children:(0,r.Y)(c.VP,{gap:16,children:(0,r.Y)(d.Q,{onComplete:e=>{n.isLoading||n.refetch({json:{code:e}}).then(e=>{e instanceof a.fk||t()})},error:n.error,isLoading:n.isLoading})})})}let Y=()=>{let{iString:e}=(0,o.GO)(),{setMode:t}=(0,p.r)();return(0,r.Y)(h.dt,{children:(0,r.FD)(r.FK,{children:[e("Made a mistake? "),(0,r.Y)(c.Yq,{color:"substack",decoration:"hover-underline",onClick:()=>t("email"),cursor:"pointer",children:e("Start over")})]})})}},23191:function(e,t,n){n.d(t,{d:()=>_});var r=n(4006),i=n(17402),o=n(42250),a=n(84605),l=n(43294),d=n(94729),c=n(12501),s=n(68349),u=n(17028),p=n(20500),h=n(16993),m=n(65842),g=n(50630),f=n(62088),Y=n(95755);let _=e=>{let{overrideTitle:t,noCloseButton:n,noExit:i,onCancel:o,onSignup:a,onSuccess:l}=e;return(0,r.FD)(r.FK,{children:[(0,r.Y)(f.$P,{overrideTitle:t,noCloseButton:n||i,onCancel:o,onSignup:a}),(0,r.Y)(v,{onSuccess:l})]})};function v(e){let{onSuccess:t}=e,{iString:n}=(0,a.GO)(),{email:f,setEmail:_,setMode:v}=(0,g.r)(),b=(0,c.st)({pathname:"/api/v1/login",method:"post"}),C=(0,i.useRef)(),w=(0,l.X)(),S=(0,l.X)(),E=async e=>{if(e.preventDefault(),b.isLoading)return;let n=Object.fromEntries(Array.from(e.currentTarget.elements).filter(e=>e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement).map(e=>[e.name,e.value]));C.current&&(n.captcha_response=C.current.getResponse());let r=await b.refetch({json:n});r instanceof Error||(r.mfa_required?v("mfa"):t())};return(0,r.FD)(r.FK,{children:[b.error instanceof d.fk&&401===b.error.response.status&&(0,r.Y)(o.A,{ref:C}),(0,r.FD)("form",{onSubmit:E,children:[(0,r.Y)(h.cw,{className:Y.A.modalBody,children:(0,r.FD)(u.VP,{gap:8,children:[(0,r.Y)(m.ks,{type:"email",name:"email",placeholder:n("Your email"),autoComplete:"email",ref:S,defaultValue:f,autoFocus:!0}),(0,r.Y)(m.ks,{type:"password",name:"password",placeholder:n("Your password"),ref:w}),b.error&&(0,r.Y)(p.yn,{children:(0,s.uX)(b.error)})]})}),(0,r.Y)(h.jl,{direction:"column",primaryButton:(0,r.Y)(u.$n,{priority:"primary",type:"submit",loading:b.isLoading,children:n("Continue")}),secondaryButton:(0,r.Y)(u.$n,{priority:"secondary-outline",onClick:()=>{var e;_((null==(e=S.current)?void 0:e.value)||""),v("email")},children:n("Sign in with email")}),buttonDivider:(0,r.Y)(u.vj,{})})]})]})}},48239:function(e,t,n){n.d(t,{Gg:()=>l,Ur:()=>a,Xf:()=>c,zz:()=>s});var r=n(69277),i=n(70408),o=n(17402);function a(e){return{step:e,previousStepData:{}}}function l(e,t){switch(t.type){case"GO_TO_STEP":return(0,i._)((0,r._)({},e),{step:t.step});case"SET_STEP_DATA":return(0,i._)((0,r._)({},e),{previousStepData:(0,i._)((0,r._)({},e.previousStepData),{[t.key]:t.data})});case"RESET":return a(t.initialStep);default:return e}}let d=(0,o.createContext)(null),c=d.Provider;function s(){let e=(0,o.useContext)(d);if(!e)throw Error("useOnboarding must be used within an OnboardingProvider");return e}},51721:function(e,t,n){n.d(t,{B:()=>b});var r=n(4006),i=n(86500),o=n(42535),a=n(7196),l=n(99039),d=n(78856),c=n(65253),s=n(59849),u=n(31623),p=n(78394),h=n(52943),m=n(23576),g=n(55556),f=n(67749),Y=n(44407),_=n(78979);let v={[_.dn.SIGNUP]:{render:()=>(0,r.Y)(f.n,{}),trackScreenShown:i.qY.READER_ONBOARDING_SIGNUP_STEP_SHOWN},[_.dn.PUB_SIGNUP]:{render:()=>(0,r.Y)(g.U,{}),trackScreenShown:i.qY.READER_ONBOARDING_PUB_SIGNUP_STEP_SHOWN},[_.dn.CATEGORIES]:{render:()=>(0,r.Y)(a.Z,{}),trackScreenShown:i.qY.READER_ONBOARDING_CATEGORIES_SCREEN_SHOWN},[_.dn.CATEGORIES_SUGGESTIONS]:{render:()=>(0,r.Y)(Y._,{}),trackScreenShown:i.qY.READER_ONBOARDING_SUGGESTIONS_SCREEN_SHOWN},[_.dn.PROFILE]:{render:()=>(0,r.Y)(p.e,{}),trackScreenShown:i.qY.READER_ONBOARDING_PROFILE_SETUP_STARTED},[_.dn.CREATOR_CHOICE]:{render:()=>(0,r.Y)(d.E,{}),trackScreenShown:i.qY.READER_ONBOARDING_INTENT_STEP_SHOWN},[_.dn.CREATOR_WELCOME]:{render:()=>(0,r.Y)(c.J,{}),trackScreenShown:i.qY.READER_ONBOARDING_CREATOR_WELCOME_STEP_SHOWN},[_.dn.START_WRITING]:{render:()=>(0,r.Y)(m.a,{}),trackScreenShown:i.qY.READER_ONBOARDING_START_WRITING_STEP_STARTED},[_.dn.CREATE_PUBLICATION]:{render:()=>(0,r.Y)(l.V,{}),trackScreenShown:i.qY.READER_ONBOARDING_CREATE_PUBLICATION_STEP_STARTED},[_.dn.CREATE_PUBLICATION_SUCCESS]:{render:()=>(0,r.Y)(h.V,{}),trackScreenShown:i.qY.READER_ONBOARDING_CREATE_PUBLICATION_SUCCESS_STEP_STARTED},[_.dn.ERROR]:{render:()=>(0,r.Y)(u.z,{}),trackScreenShown:i.qY.READER_ONBOARDING_ERROR_STEP_SHOWN},[_.dn.APP_UPSELL]:{render:()=>(0,r.Y)(o.v,{}),trackScreenShown:i.qY.READER_ONBOARDING_APP_UPSELL_SHOWN},[_.dn.WELCOME]:{render:()=>(0,r.Y)(s.n,{}),trackScreenShown:i.qY.READER_ONBOARDING_WELCOME_STEP_STARTED}};function b(e){let t=v[e];if(t)return t;console.error("Unknown onboarding step: ".concat(e,", falling back to WELCOME"));let n=v[_.dn.WELCOME];if(!n)throw Error("WELCOME step config is missing");return n}},72104:function(e,t,n){n.d(t,{k:()=>d,D:()=>l});var r,i=n(95951),o=((r=o||{})[r.Vibrant=0]="Vibrant",r[r.DarkVibrant=1]="DarkVibrant",r[r.LightVibrant=2]="LightVibrant",r[r.Muted=3]="Muted",r[r.DarkMuted=4]="DarkMuted",r[r.LightMuted=5]="LightMuted",r);let a=Object.keys(o),l={custom:{green:"var(--color-bg-marketing-green)",orange:"var(--color-accent-fg-orange)"},basic:{primary:"var(--color-bg-secondary)"},image:{tintedImageMuted:"cover_image_tinted_muted",tintedImageVibrant:"cover_image_tinted_vibrant",fadedImage:"cover_image_faded",blurredImage:"cover_image_blurred"}};function d(e){let{coverImage:t,palette:n}=e;return i.PK.filter(e=>e in l.basic||e in l.custom||e in l.image&&!!t||!!a.includes(e)&&!!(null==n?void 0:n[e]))}},95951:function(e,t,n){n.d(t,{PK:()=>r,Rt:()=>o,zr:()=>a});let r=["DarkMuted","Vibrant","green","orange","primary","blurredImage","fadedImage","tintedImageMuted","tintedImageVibrant"];var i,o=((i={}).Left="left",i.Center="center",i);let a=Object.values(o)}}]);