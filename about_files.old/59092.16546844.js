!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};e.SENTRY_RELEASE={id:"substack@af5f699"};var i=(new e.Error).stack;i&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[i]="2df7c913-6a40-49c1-93cd-b935e8d8f29d",e._sentryDebugIdIdentifier="sentry-dbid-2df7c913-6a40-49c1-93cd-b935e8d8f29d")}catch(e){}}();"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["59092"],{86972:function(e,i,n){n.d(i,{A:()=>t});let t={referralsTierCard:"referralsTierCard-XI8dRc"}},65259:function(){},8636:function(e,i,n){n.d(i,{A:()=>t});let t={activeLike:"activeLike-n4wXdc",activeSave:"activeSave-UgcaYI",actionMenu:"actionMenu-PHX5iz",relative:"relative-IkyQqe",playIcon:"playIcon-NgDoDU"}},64339:function(e,i,n){n.d(i,{A:()=>t});let t={sidebar:"sidebar-y6xw9g"}},5059:function(e,i,n){n.d(i,{A:()=>t});let t={container:"container-mkVCmy",publicationNav:"publicationNav-oP8uLE",tabs:"tabs-ITZoHF"}},46120:function(e,i,n){n.d(i,{A:()=>t});let t={liveStreamContainer:"liveStreamContainer-FcukCX",fillIcon:"fillIcon-CcS0fl",twitterVerifiedIcon:"twitterVerifiedIcon-v59YgL",profileRow:"profileRow-pxzPMX",profileImage:"profileImage-HkuUYh",socialLinkIcon:"socialLinkIcon-yTx6z2",stat:"stat-fGDQWV",readsRow:"readsRow-sdX9cR",page:"page-tdumDw",grid:"grid-bCt58x",pubMain:"pubMain-P7p9KT",pub:"pub-WKvJgt","reader2-mobile-nav-icon":"reader2-mobile-nav-icon-B_bswu",reader2MobileNavIcon:"reader2-mobile-nav-icon-B_bswu"}},96583:function(e,i,n){n.d(i,{A:()=>t});let t={modalContainer:"modalContainer-mJcb4X",fullWidth:"fullWidth-G75cMo"}},43327:function(e,i,n){n.d(i,{hx:()=>P,vV:()=>A});var t=n(69277),r=n(70408),l=n(4006),o=n(32485),a=n.n(o),s=n(45773),u=n(17402),c=n(12018),d=n(86938),p=n(74019),h=n(72880),m=n(41873),f=n(84605),v=n(85478),b=n(15113),g=n(6049),Y=n(12501),_=n(68349),y=n(89490),C=n(76977),S=n(57820),w=n(81203),k=n(63136),I=n(39318),E=n(20004);function D(e){let{postId:i,fallbackSizeLgProps:n}=e,{iString:o}=(0,f.GO)(),[c,d]=(0,u.useState)(!1),{result:p,isLoading:h}=(0,Y.st)({pathname:"/api/v1/posts/by-id/".concat(i),deps:[i],auto:!0});if(h)return(0,l.Y)(C.pT,{alignItems:"center",bg:"tertiary",className:E.A.videoEmbedPlaceholder,justifyContent:"center",radius:"md",children:(0,l.Y)(S.y$,{flex:"grow"})});let v=null==p?void 0:p.post,g=null==p?void 0:p.publication,D=null==v?void 0:v.videoUpload;if(!v||!g||!D)return console.warn("VideoPostEmbed: missing data, falling back to legacy render"),(0,l.Y)(A,(0,r._)((0,t._)({},n),{forceLegacyRender:!0}));let P=v.canonical_url,F=e=>{e.stopPropagation(),e.preventDefault(),(0,_.lW)(P),d(!0),setTimeout(()=>d(!1),3e3)};return(0,l.Y)(y.az,{className:E.A.videoEmbed,position:"relative",children:(0,l.Y)(m.A,{mediaUpload:D,post:v,pub:g,renderOverlay:e=>{var i;let{isPlaying:n,getCurrentTimeInSeconds:t}=e;return(0,l.FD)(C.Ye,{className:a()(E.A.videoOverlay,{[null!=(i=E.A.alwaysVisible)?i:""]:!n}),justifyContent:"space-between",padding:16,pointerEvents:"auto",position:"absolute",top:0,children:[(0,l.FD)(C.Ye,{alignItems:"center",flex:"grow",gap:12,paddingRight:12,children:[(0,l.Y)(w.Nq,{pub:g,radius:"full",size:32}),(0,l.Y)("a",{className:E.A.titleLink,href:P,rel:"noopener",target:"_blank",onClick:()=>{let e=t(),i=(0,I.oRR)(P,{t:e});(0,_.V2)(i,{newTab:!0})},children:(0,l.Y)(k.EY,{clamp:2,color:"white",decoration:"hover-underline",weight:"medium",children:v.title})})]}),(0,l.FD)(C.I1,{alignItems:"end",gap:0,hover:!0,position:"relative",onClick:F,children:[(0,l.Y)(y.az,{paddingRight:16,children:c?(0,l.Y)(s.A,{stroke:"white"}):(0,l.Y)(b.qY,{stroke:"white"})}),(0,l.Y)(k.EY,{color:"white",size:14,wrap:"nowrap",children:c?o("Copied to clipboard"):o("Copy link")})]})]})},stopPropagation:!0})})}let A=e=>{var i,n,t;let{disableLinks:r,isEditingCaption:o,post:s,caption:u,onEditCaption:m,onSaveCaption:f,onCancelCaption:b,forceLegacyRender:g}=e,{publishedBylines:Y,title:_,canonical_url:S,post_date:w,section_name:I,cover_image:A,cover_image_alt:P}=s,{getConfigFor:F}=(0,v.mJ)();return!g&&F("use_enhanced_video_embed_player")?(0,l.Y)(D,{fallbackSizeLgProps:e,postId:s.id}):(0,l.FD)(C.I1,{children:[I&&(0,l.Y)("a",{className:a()({[null!=(i=E.A.disableLink)?i:""]:r}),href:S,rel:"noopener",target:"_blank",children:(0,l.Y)(k.EY.Meta,{color:"pub-primary-text",paddingBottom:8,children:I})}),(0,l.Y)("a",{className:a()({[null!=(n=E.A.disableLink)?n:""]:r}),href:S,rel:"noopener",target:"_blank",children:(0,l.Y)(k.EY.H2,{color:"pub-primary-text",children:_})}),(0,l.Y)(p.W,{bylines:Y,date:w,disableLinks:r}),A&&(0,l.Y)(y.az,{paddingTop:24,children:(0,l.Y)("a",{className:a()({[null!=(t=E.A.disableLink)?t:""]:r}),href:S,rel:"noopener",target:"_blank",children:(0,l.Y)(h.o,{alt:null!=P?P:_,className:E.A.fullWidth,imageProps:{height:Math.round(650),smartCrop:!0},maxWidth:1300,src:A})})}),(0,l.Y)(C.pT,{flex:"grow",paddingTop:16,children:o&&f&&b?(0,l.Y)(c.y,{initialCaption:u,onCancel:b,onSave:f}):(0,l.Y)("p",{className:E.A.caption,dangerouslySetInnerHTML:{__html:u},onClick:m||void 0})}),(0,l.Y)(d.w,{disableLinks:r,href:S,includeUfi:!1,post:s})]})},P=e=>{let{post:i,children:n}=e,{publishedBylines:t,title:r,canonical_url:o,post_date:a,section_name:s,cover_image:u,cover_image_alt:c}=i;return(0,l.FD)(g.jJ,{children:[s&&(0,l.Y)("a",{href:o,children:(0,l.Y)(k.EY.Meta,{color:"pub-primary-text",paddingBottom:8,children:s})}),(0,l.Y)("a",{href:o,children:(0,l.Y)(k.EY.H2,{color:"pub-primary-text",children:r})}),(0,l.Y)(p._,{bylines:t,date:a}),u&&(0,l.Y)(y.az,{paddingTop:24,children:(0,l.Y)("a",{href:o,children:(0,l.Y)(h.o,{alt:null!=c?c:r,className:E.A.fullWidth,imageProps:{height:Math.round(650),smartCrop:!0},maxWidth:1300,src:u})})}),(0,l.Y)("a",{href:o,children:(0,l.Y)(y.az,{as:"p",children:n})}),(0,l.Y)(d.s,{href:o})]})}},21441:function(e,i,n){n.d(i,{A:()=>s});var t=n(69277),r=n(70408),l=n(32641),o=n(4006),a=n(97731);let s=e=>{var{size:i=24,className:n}=e,s=(0,l._)(e,["size","className"]);return(0,o.Y)(a.A,(0,r._)((0,t._)({},s),{name:"ChevronRightCircleIcon",svgParams:{viewBox:"0 0 24 24"},stroke:"none",width:i,height:i,className:n,children:(0,o.Y)("path",{d:"M24 12C24 18.553 18.5648 24 12 24C5.44707 24 0 18.553 0 12C0 5.4353 5.4353 0 11.9883 0C18.553 0 24 5.4353 24 12ZM9.22355 6.02354C8.84708 6.37648 8.83531 6.97649 9.21178 7.32943L14.2 12.0117L9.21178 16.7059C8.84708 17.0471 8.84708 17.6353 9.21178 18.0118C9.5412 18.3177 10.1765 18.2942 10.5177 17.9647L15.5647 13.2118C16.2471 12.5765 16.2588 11.4589 15.5647 10.8118L10.5177 6.07061C10.1412 5.71766 9.57649 5.68237 9.22355 6.02354Z"})}))}},898:function(e,i,n){n.d(i,{o:()=>r});var t=n(4006);function r(e){let{className:i}=e;return(0,t.Y)("svg",{className:i,width:"48",height:"48",viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,t.FD)("g",{children:[(0,t.Y)("path",{style:{backdropFilter:"blur(5px)"},d:"M24 44C35.0457 44 44 35.0457 44 24C44 12.9543 35.0457 4 24 4C12.9543 4 4 12.9543 4 24C4 35.0457 12.9543 44 24 44Z",fill:"white","fill-opacity":"0.9"}),(0,t.Y)("path",{opacity:"0.7",d:"M20 17.8685C20 17.0698 20.8901 16.5934 21.5547 17.0365L30.7519 23.168C31.3457 23.5638 31.3457 24.4362 30.7519 24.8321L21.5547 30.9635C20.8901 31.4066 20 30.9302 20 30.1315V17.8685Z",fill:"black",stroke:"black","stroke-linecap":"round","stroke-linejoin":"round"})]})})}},95701:function(e,i,n){n.d(i,{A:()=>s});var t=n(69277),r=n(70408),l=n(32641),o=n(4006),a=n(97731);let s=function(e){var{size:i=24,fill:n="var(--color-fg-primary)"}=e,s=(0,l._)(e,["size","fill"]);return(0,o.Y)(a.A,(0,r._)((0,t._)({},s),{name:"BandcampIcon",svgParams:{viewBox:"0 0 24 24"},width:i,height:i,fill:n,stroke:"none",children:(0,o.Y)("path",{stroke:"none",d:"M0 18.75l7.437-13.5H24l-7.438 13.5H0z"})}))}},9184:function(e,i,n){n.d(i,{A:()=>s});var t=n(69277),r=n(70408),l=n(32641),o=n(4006),a=n(97731);let s=e=>{var{size:i=24,fill:n="var(--color-fg-primary)"}=e,s=(0,l._)(e,["size","fill"]);return(0,o.Y)(a.A,(0,r._)((0,t._)({},s),{name:"BookIcon",svgParams:{viewBox:"0 0 20 20"},width:i,height:i,fill:n,stroke:"none",children:(0,o.Y)("path",{stroke:"none",d:"M4.89796 2C2.98742 2 0.998702 2.88986 0.104212 4.43402C0.00868433 4.6085 0 4.72192 0 5.0447V17.3544C0 17.7557 0.251846 18 0.686062 18C0.894487 18 1.09423 17.9389 1.25054 17.7906C2.34477 16.8484 3.79506 16.3598 5.24534 16.3598C6.6001 16.3598 7.85933 16.8396 8.77987 17.6335C8.87539 17.7121 8.98827 17.7557 9.08378 17.7557C9.27488 17.7557 9.43122 17.6161 9.43122 17.3893V4.48636C9.43122 4.25954 9.41379 4.20719 9.24883 3.97164C8.39776 2.74155 6.73036 2 4.89796 2ZM15.102 2C13.2697 2 11.6023 2.74155 10.7512 3.97164C10.5862 4.20719 10.5689 4.25954 10.5689 4.48636V17.3893C10.5689 17.6161 10.7251 17.7557 10.9162 17.7557C11.0117 17.7557 11.1333 17.7121 11.2202 17.6335C12.1407 16.8396 13.4 16.3598 14.7547 16.3598C16.205 16.3598 17.6552 16.8484 18.7495 17.7906C18.9058 17.9389 19.1056 18 19.314 18C19.7482 18 20 17.7557 20 17.3544V5.0447C20 4.72192 19.9914 4.59978 19.8958 4.43402C19.0013 2.88986 17.0127 2 15.102 2Z"})}))}},76891:function(e,i,n){n.d(i,{A:()=>s});var t=n(69277),r=n(70408),l=n(32641),o=n(4006),a=n(97731);let s=function(e){var{size:i=24,fill:n="var(--color-fg-primary)"}=e,s=(0,l._)(e,["size","fill"]);return(0,o.Y)(a.A,(0,r._)((0,t._)({},s),{name:"SoundcloudIcon",svgParams:{viewBox:"0 0 24 24"},width:i,height:i,fill:n,stroke:"none",children:(0,o.Y)("path",{stroke:"none",d:"M23.999 14.165c-.052 1.796-1.612 3.169-3.4 3.169h-8.18a.68.68 0 0 1-.675-.683V7.862a.747.747 0 0 1 .452-.724s.75-.513 2.333-.513a5.364 5.364 0 0 1 2.763.755 5.433 5.433 0 0 1 2.57 3.54c.282-.08.574-.121.868-.12.884 0 1.73.358 2.347.992s.948 1.49.922 2.373ZM10.721 8.421c.247 2.98.427 5.697 0 8.672a.264.264 0 0 1-.53 0c-.395-2.946-.22-5.718 0-8.672a.264.264 0 0 1 .53 0ZM9.072 9.448c.285 2.659.37 4.986-.006 7.655a.277.277 0 0 1-.55 0c-.331-2.63-.256-5.02 0-7.655a.277.277 0 0 1 .556 0Zm-1.663-.257c.27 2.726.39 5.171 0 7.904a.266.266 0 0 1-.532 0c-.38-2.69-.257-5.21 0-7.904a.266.266 0 0 1 .532 0Zm-1.647.77a26.108 26.108 0 0 1-.008 7.147.272.272 0 0 1-.542 0 27.955 27.955 0 0 1 0-7.147.275.275 0 0 1 .55 0Zm-1.67 1.769c.421 1.865.228 3.5-.029 5.388a.257.257 0 0 1-.514 0c-.21-1.858-.398-3.549 0-5.389a.272.272 0 0 1 .543 0Zm-1.655-.273c.388 1.897.26 3.508-.01 5.412-.026.28-.514.283-.54 0-.244-1.878-.347-3.54-.01-5.412a.283.283 0 0 1 .56 0Zm-1.668.911c.4 1.268.257 2.292-.026 3.572a.257.257 0 0 1-.514 0c-.241-1.262-.354-2.312-.023-3.572a.283.283 0 0 1 .563 0Z"})}))}},51782:function(e,i,n){n.d(i,{A:()=>s});var t=n(69277),r=n(70408),l=n(32641),o=n(4006),a=n(97731);let s=e=>{var{size:i=20,fill:n="var(--color-fg-primary)"}=e,s=(0,l._)(e,["size","fill"]);return(0,o.FD)(a.A,(0,r._)((0,t._)({},s),{name:"UnmuteIconFilled",svgParams:{viewBox:"0 0 20 20"},width:i,height:i,fill:n,children:[(0,o.Y)("path",{d:"M15.6392 17.817C15.4994 18.3172 15.0563 18.6519 14.476 18.6519C13.9832 18.6519 13.5654 18.451 13.0726 17.9858L8.50884 13.714C8.43385 13.6506 8.34814 13.6188 8.24102 13.6188H5.16636C3.72009 13.6188 2.92733 12.8364 2.92733 11.3032V7.36982C2.92733 6.68171 3.08924 6.14262 3.40172 5.75997L15.6392 17.817ZM15.6866 1.24768V12.0678L8.49264 4.97165C8.49818 4.96785 8.50353 4.96352 8.50884 4.95903L13.0726 0.729582C13.619 0.21147 13.9618 0 14.4546 0C15.183 0 15.6866 0.560404 15.6866 1.24768Z",stroke:"none"}),(0,o.Y)("path",{d:"M19.3824 19.7621C19.7037 20.0793 20.2286 20.0793 20.5501 19.7621C20.8607 19.4343 20.8715 18.9267 20.5501 18.6096L2.19856 0.50751C1.87716 0.1903 1.34151 0.1903 1.02012 0.50751C0.70944 0.814142 0.70944 1.3534 1.02012 1.66003L19.3824 19.7621Z",stroke:"none"})]}))}},90226:function(e,i,n){n.d(i,{O:()=>r});var t=n(4006);function r(e){let{className:i}=e;return(0,t.Y)("svg",{className:i,width:"24",height:"24",viewBox:"0 0 24 24",children:(0,t.Y)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.5 20.1456C2.33682 19.7895 2.25 19.3992 2.25 19V18V14V12C2.25 9.41414 3.27723 6.93419 5.10571 5.10571C6.93419 3.27723 9.41414 2.25 12 2.25C14.5859 2.25 17.0658 3.27723 18.8943 5.10571C20.7228 6.93419 21.75 9.41414 21.75 12V14V18V19C21.75 19.3992 21.6632 19.7895 21.5 20.1456V20.3889C21.4583 20.3889 21.4169 20.3875 21.3759 20.3848C21.2578 20.5874 21.1133 20.7758 20.9445 20.9445C20.4288 21.4603 19.7293 21.75 19 21.75H18C17.2707 21.75 16.5712 21.4603 16.0555 20.9445C15.5397 20.4288 15.25 19.7293 15.25 19V16C15.25 15.2707 15.5397 14.5712 16.0555 14.0555C16.5712 13.5397 17.2707 13.25 18 13.25H19.6528V12.2083C19.6528 10.1787 18.8465 8.23218 17.4113 6.797C15.9762 5.36183 14.0296 4.55556 12 4.55556C9.97036 4.55556 8.02384 5.36183 6.58867 6.797C5.15349 8.23218 4.34722 10.1787 4.34722 12.2083V13.25H6C6.72935 13.25 7.42882 13.5397 7.94454 14.0555C8.46027 14.5712 8.75 15.2707 8.75 16V19C8.75 19.7293 8.46027 20.4288 7.94454 20.9445C7.42882 21.4603 6.72935 21.75 6 21.75H5C4.27065 21.75 3.57118 21.4603 3.05546 20.9445C2.88674 20.7758 2.74221 20.5874 2.6241 20.3848C2.58309 20.3875 2.5417 20.3889 2.5 20.3889V20.1456Z"})})}},10256:function(e,i,n){n.d(i,{y:()=>r});var t=n(4006);function r(e){let{className:i}=e;return(0,t.Y)("svg",{className:i,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,t.Y)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.7848 3.78723C4.2873 3.28318 4.96884 3 5.67949 3H18.3205C19.0312 3 19.7127 3.28318 20.2152 3.78723C20.7177 4.29129 21 4.97494 21 5.68778V14.4027C21 15.1155 20.7177 15.7992 20.2152 16.3032C19.7127 16.8073 19.0312 17.0905 18.3205 17.0905H7.9309L4.2475 20.7853C4.0385 20.9949 3.72419 21.0576 3.45112 20.9442C3.17805 20.8307 3 20.5634 3 20.2669V5.68778C3 4.97494 3.2823 4.29129 3.7848 3.78723Z"})})}},91513:function(e,i,n){n.d(i,{n:()=>r});var t=n(4006);function r(e){let{className:i}=e;return(0,t.Y)("svg",{className:i,width:"24",height:"24",viewBox:"0 0 24 24",children:(0,t.Y)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.83333 5C1.26853 5 0 6.11207 0 7.48387V16.5161C0 17.8879 1.26853 19 2.83333 19H14.1667C15.7315 19 17 17.8879 17 16.5161V7.48387C17 6.11207 15.7315 5 14.1667 5H2.83333ZM18 14.7264L21.6962 17.5549C22.0546 17.8238 22.4334 18 22.8123 18C23.529 18 24 17.527 24 16.8037V7.19629C24 6.47295 23.529 6 22.8123 6C22.4334 6 22.0546 6.1762 21.6962 6.44513L18 9.25502V14.7264Z"})})}},95387:function(e,i,n){n.d(i,{A:()=>l});var t=n(4006),r=n(97731);let l=e=>{let{size:i=24,color:n="var(--color-fg-primary)",className:l}=e;return(0,t.Y)(r.A,{name:"ActivityTabActiveIcon",svgParams:{viewBox:"0 0 24 24"},stroke:"none",width:i,height:i,fill:n,className:l,children:(0,t.Y)("path",{d:"M13.7031 21.0672C14.197 20.8203 14.7978 21.0208 15.0449 21.5145C15.2919 22.0085 15.0916 22.6093 14.5977 22.8563C12.9623 23.6739 11.0377 23.6739 9.40234 22.8563C8.90836 22.6093 8.70809 22.0085 8.95507 21.5145C9.20219 21.0208 9.80303 20.8203 10.2969 21.0672C11.3692 21.6033 12.6308 21.6033 13.7031 21.0672ZM9.15722 0.949086C10.8954 0.424878 12.7424 0.392652 14.4941 0.85143L14.8428 0.949086L14.8447 0.950063C15.8459 1.25441 18.0718 2.36176 19.2617 4.53209C20.0047 5.88745 20.2444 7.47298 20.3603 8.78795C20.4179 9.44093 20.4495 10.0969 20.4844 10.5995C20.5222 11.1441 20.5638 11.5093 20.626 11.7362C20.7727 12.2713 21.0324 12.7556 21.3838 13.3612C21.7238 13.9471 22.1511 14.6485 22.5019 15.5018C22.6638 15.8954 22.791 16.2502 22.8896 16.576C23.1771 17.526 22.8785 18.4183 22.3057 19.034C21.7485 19.6328 20.9269 19.9881 20.0654 19.9881H3.93457C3.07304 19.9881 2.25152 19.6328 1.69433 19.034C1.12154 18.4183 0.822942 17.526 1.11035 16.576C1.20895 16.2502 1.33619 15.8954 1.49804 15.5018C1.84892 14.6485 2.27624 13.9471 2.61621 13.3612C2.9676 12.7556 3.22729 12.2713 3.37402 11.7362C3.43622 11.5093 3.47781 11.1441 3.51562 10.5995C3.55051 10.0969 3.58205 9.44093 3.63965 8.78795C3.75562 7.47298 3.99526 5.88745 4.73828 4.53209C5.92818 2.36176 8.1541 1.25441 9.15527 0.950063L9.15722 0.949086Z"})})}},31052:function(e,i,n){n.d(i,{A:()=>l});var t=n(4006),r=n(97731);let l=e=>{let{size:i=24,color:n="var(--color-fg-primary)",className:l}=e;return(0,t.Y)(r.A,{name:"ChatTabActiveIcon",svgParams:{viewBox:"0 0 24 24"},stroke:"none",width:i,height:i,fill:n,className:l,children:(0,t.Y)("path",{d:"M1 14.9869V5.81501C1.00001 4.24832 1.89466 2.70621 3.5 2.15388C7.29614 0.847876 13.8513 -0.234306 20.4746 2.13533C22.0773 2.70881 23 4.25955 23 5.85505V15.0269C23 16.5942 22.104 18.1369 20.499 18.689C18.0418 19.5342 14.4547 20.2754 10.4473 20.0679C9.01165 22.2374 6.19312 23.2632 3.5791 23.2633C3.17472 23.2633 2.8101 23.0196 2.65527 22.6461C2.50049 22.2724 2.58607 21.8422 2.87207 21.5562C3.20792 21.2203 3.4993 20.5973 3.6543 19.8804C3.72855 19.5369 3.7627 19.2074 3.7627 18.9322C3.76269 18.8818 3.75985 18.8354 3.75781 18.7926C3.72034 18.7784 3.68436 18.7655 3.65234 18.7535C3.61791 18.7405 3.58772 18.7299 3.56445 18.7213C3.55292 18.717 3.54353 18.7133 3.53613 18.7105C3.53242 18.7092 3.52955 18.7074 3.52734 18.7066C3.52517 18.7058 3.52441 18.7056 3.52441 18.7056C1.92119 18.1319 1 16.5819 1 14.9869Z"})})}},56796:function(e,i,n){n.d(i,{A:()=>l});var t=n(4006),r=n(97731);let l=e=>{let{size:i=24,color:n="var(--color-fg-primary)",className:l}=e;return(0,t.Y)(r.A,{name:"DashboardTabActiveIcon",svgParams:{viewBox:"0 0 24 24"},stroke:"none",width:i,height:i,fill:n,className:l,children:(0,t.Y)("path",{d:"M19 1C21.2091 1 23 2.79086 23 5V19C23 21.2091 21.2091 23 19 23H5C2.79086 23 1 21.2091 1 19V5C1 2.79086 2.79086 1 5 1H19ZM8 13C7.44772 13 7 13.4477 7 14V16C7 16.5523 7.44772 17 8 17C8.55228 17 9 16.5523 9 16V14C9 13.4477 8.55228 13 8 13ZM12 10C11.4477 10 11 10.4477 11 11V16C11 16.5523 11.4477 17 12 17C12.5523 17 13 16.5523 13 16V11C13 10.4477 12.5523 10 12 10ZM16 7C15.4477 7 15 7.44772 15 8V16C15 16.5523 15.4477 17 16 17C16.5523 17 17 16.5523 17 16V8C17 7.44772 16.5523 7 16 7Z",fillRule:"evenodd",clipRule:"evenodd"})})}},63626:function(e,i,n){n.d(i,{A:()=>l});var t=n(4006),r=n(97731);let l=e=>{let{size:i=24,color:n="var(--color-fg-primary)",className:l}=e;return(0,t.Y)(r.A,{name:"DashboardTabIcon",svgParams:{viewBox:"0 0 24 24"},stroke:n,strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",width:i,height:i,fill:"none",className:l,children:(0,t.Y)("path",{d:"M16 16V8M8 16V14M12 16V11M5 22H19C20.6569 22 22 20.6569 22 19V5C22 3.34315 20.6569 2 19 2H5C3.34315 2 2 3.34315 2 5V19C2 20.6569 3.34315 22 5 22Z"})})}},22005:function(e,i,n){n.d(i,{A:()=>l});var t=n(4006),r=n(97731);let l=e=>{let{size:i=24,color:n="var(--color-fg-primary)",className:l}=e;return(0,t.Y)(r.A,{name:"HomeTabActiveIcon",svgParams:{viewBox:"0 0 24 24"},stroke:"none",width:i,height:i,fill:n,className:l,children:(0,t.Y)("path",{d:"M13.315 1.4785C12.5616 0.840501 11.4384 0.840501 10.685 1.4785L2.02743 8.80973C1.37462 9.36254 1 10.1622 1 11.003L1 19.1187C1 21.2623 2.79086 23 5 23L19 23C21.2091 23 23 21.2623 23 19.1187V11.003C23 10.1622 22.6254 9.36254 21.9726 8.80973L13.315 1.4785ZM10.4472 17.2804C9.95321 17.0408 9.35254 17.2351 9.10555 17.7144C8.85856 18.1937 9.05878 18.7765 9.55276 19.0162C11.0933 19.7636 12.9067 19.7636 14.4472 19.0162C14.9412 18.7766 15.1414 18.1937 14.8944 17.7144C14.6474 17.2351 14.0468 17.0408 13.5528 17.2804C12.5753 17.7547 11.4247 17.7547 10.4472 17.2804Z",fillRule:"evenodd",clipRule:"evenodd"})})}},11004:function(e,i,n){n.d(i,{A:()=>l});var t=n(4006),r=n(97731);let l=e=>{let{size:i=24,color:n="var(--color-fg-primary)",className:l}=e;return(0,t.FD)(r.A,{name:"InboxTabActiveIcon",svgParams:{viewBox:"0 0 24 24"},stroke:"none",width:i,height:i,fill:n,className:l,children:[(0,t.Y)("path",{d:"M1.22478 15.2196C1.3687 15.0789 1.5639 14.9999 1.76744 14.9999H6.10047C6.58116 14.9999 7.02116 15.2627 7.23644 15.6827C7.3959 15.9938 7.58943 16.3747 7.77311 16.7446C8.14224 17.4881 8.91496 17.991 9.76056 17.991H14.2394C15.085 17.991 15.8578 17.4881 16.2269 16.7446C16.4106 16.3746 16.6041 15.9938 16.7636 15.6827C16.9788 15.2627 17.4188 14.9999 17.8995 14.9999H22.2326C22.6564 14.9999 23 15.3357 23 15.7499L23 18.75C23 20.8211 21.282 22.5 19.1628 22.5H4.83721C2.71798 22.5 1.00001 20.8211 1 18.75L1 15.7499C0.999999 15.551 1.08085 15.3602 1.22478 15.2196Z",fillRule:"evenodd",clipRule:"evenodd"}),(0,t.Y)("path",{d:"M4.22326 2.84286C4.54919 1.75079 5.57353 1 6.73755 1H17.2625C18.4265 1 19.4508 1.75079 19.7767 2.84285L22.3553 12.58C22.423 12.8066 22.3775 13.0511 22.2325 13.24C22.0876 13.4289 21.8602 13.54 21.6186 13.54L17.0607 13.5142C16.5078 13.5111 16.0158 13.8566 15.779 14.3448C15.5784 14.7582 15.3438 15.1845 15.1341 15.5477C14.7879 16.1472 14.1305 16.5 13.4261 16.5H10.6277C9.89424 16.5 9.21567 16.1176 8.86754 15.4867C8.66157 15.1135 8.42948 14.6814 8.2237 14.2707C7.99548 13.8151 7.52704 13.5108 7.00806 13.5137L2.27908 13.54C2.03752 13.54 1.81006 13.4289 1.66512 13.24C1.52019 13.0511 1.4747 12.8066 1.54233 12.58L4.22326 2.84286Z",fillRule:"evenodd",clipRule:"evenodd"})]})}},97250:function(e,i,n){n.d(i,{A:()=>l});var t=n(4006),r=n(97731);let l=e=>{let{size:i=24,color:n="var(--color-fg-primary)",className:l}=e;return(0,t.FD)(r.A,{name:"SearchTabActiveIcon",svgParams:{viewBox:"0 0 24 24"},stroke:"none",width:i,height:i,fill:n,className:l,children:[(0,t.Y)("path",{d:"M21.707 20.293C22.0975 20.6835 22.0975 21.3165 21.707 21.707C21.3165 22.0976 20.6835 22.0976 20.293 21.707L16.3272 17.7412C16.592 17.5246 16.8469 17.2959 17.0879 17.0537C17.3176 16.8229 17.5357 16.5805 17.7422 16.3281L21.707 20.293Z"}),(0,t.Y)("path",{d:"M10 1.5C14.6944 1.5 18.5 5.30558 18.5 10C18.5 12.3397 17.5532 14.4601 16.0244 15.9961C14.4862 17.5415 12.3541 18.5 10 18.5C5.30559 18.5 1.50002 14.6944 1.50002 10C1.50002 5.30558 5.30559 1.5 10 1.5Z"})]})}},73294:function(e,i,n){n(4006),n(17402),n(84605),n(44333),n(68349),n(17028),n(40837),n(44338),n(39318)},44909:function(e,i,n){n.d(i,{o:()=>a,s:()=>o});var t=n(4006),r=n(17402);let l=(0,r.createContext)({scrollContainerRef:null});function o(e){let{scrollContainerRef:i,children:n}=e,o=(0,r.useMemo)(()=>({scrollContainerRef:i}),[i]);return(0,t.Y)(l.Provider,{value:o,children:n})}function a(){return(0,r.useContext)(l)}l.displayName="PostScrollContainerContext"},13505:function(e,i,n){n.d(i,{AG:()=>f,BF:()=>m,FJ:()=>h,kL:()=>p});var t=n(69277),r=n(70408),l=n(4006),o=n(17402),a=n(86500),s=n(55762),u=n(68349);let c={1:30,2:20,3:10},d=(0,o.createContext)({startInterval:()=>void 0,stopInterval:()=>void 0,trackInterval:()=>void 0,getCurrentUuid:()=>""});function p(e){let{children:i}=e,n=(0,o.useRef)(null),t=(0,o.useRef)(null),r=(0,o.useRef)({top:0,bottom:0}),p=(0,o.useRef)(null),h=(0,o.useCallback)(()=>{if(p.current){let{uuid:e,postId:i,containerElementRef:n,elementIsStatic:l,phase:o,count:u}=p.current;if(o&&o>3)return void m();if(u&&u>=c[o])return void b();p.current.count=u+1;let d=(null==n?void 0:n.current)?(0,s.k)(n.current,null!=l&&l):r.current,h=d.top.toFixed(2),v=d.bottom.toFixed(2);(0,a.u4)(a.qY.POST_PINGBACK_SEEN,{tracker_uuid:e,post_id:i,top_scroll_percentage:h,bottom_scroll_percentage:v,phase:o,count:u+1}),t.current!==h&&(t.current=h,i&&f(i,"read",d.top/100))}},[]),m=(0,o.useCallback)(()=>{n.current&&(clearInterval(n.current),n.current=null)},[]),v=()=>{var e,i;return 10**(null!=(i=null==(e=p.current)?void 0:e.phase)?i:1)*1e3},b=()=>{m(),p.current&&(p.current.phase+=1,p.current.count=0),n.current=setInterval(h,v())},g=(0,o.useCallback)(e=>{var i;let{postId:t,containerElementRef:r,elementIsStatic:l,phase:o=1,count:a=0}=e;"undefined"!=typeof window&&t&&r&&((null==(i=p.current)?void 0:i.postId)!==t&&(p.current={uuid:(0,u.QT)(),postId:t,containerElementRef:r,elementIsStatic:l,phase:o,count:a}),m(),n.current=setInterval(h,v()))},[h,m]),Y=(0,o.useCallback)(()=>{var e;return(null==(e=p.current)?void 0:e.uuid)||""},[]);return(0,o.useEffect)(()=>{let e=()=>{var e,i,n,t,r,l,o;document.hidden?(h(),m()):(null==(e=p.current)?void 0:e.postId)&&(null==(i=p.current)?void 0:i.containerElementRef)&&g({postId:null==(n=p.current)?void 0:n.postId,containerElementRef:null==(t=p.current)?void 0:t.containerElementRef,elementIsStatic:null==(r=p.current)?void 0:r.elementIsStatic,phase:null==(l=p.current)?void 0:l.phase,count:null==(o=p.current)?void 0:o.count})};return document.addEventListener("visibilitychange",e),()=>{h(),p.current=null,m(),document.removeEventListener("visibilitychange",e)}},[g,m]),(0,o.useEffect)(()=>{let e=e=>{var i,n,t,l,o;let a=null==(n=p.current)||null==(i=n.containerElementRef)?void 0:i.current,u=null==(t=p.current)?void 0:t.elementIsStatic;!a||e.target!==a||(null==(o=p.current)||null==(l=o.containerElementRef)?void 0:l.current)&&(r.current=(0,s.k)(a,null!=u&&u))};return window.addEventListener("scroll",e,!0),()=>{window.removeEventListener("scroll",e,!0)}},[g,m]),(0,l.Y)(d.Provider,{value:{startInterval:g,stopInterval:m,trackInterval:h,getCurrentUuid:Y},children:i})}function h(){return(0,o.useContext)(d)}function m(e){let i=(0,o.forwardRef)((i,n)=>{let o=h();return(0,l.Y)(e,(0,r._)((0,t._)({},o,i),{ref:n}))});return i.displayName="withPostPingbackTrackerContext(".concat(e.displayName||e.name||"Anonymous",")"),i}function f(e,i,n){var t;"undefined"!=typeof window&&(null==(t=window._preloads)?void 0:t.user)&&!window._preloads.user.is_magic&&fetch("/api/v1/posts/".concat(e,"/progress?type=").concat(i,"&progress=").concat(n),{method:"POST"}).catch(e=>{console.error("Failed to mark video progress:",e)})}d.displayName="PostPingbackTrackerContext"},2675:function(e,i,n){n.d(i,{Sp:()=>N,Uo:()=>q,VA:()=>V,g2:()=>z,vZ:()=>j,xr:()=>W});var t=n(69277),r=n(70408),l=n(32641),o=n(4006),a=n(32485),s=n.n(a),u=n(57157),c=n(17402),d=n(78649),p=n(84777),h=n(72880),m=n(84605),f=n(46271),v=n(64632),b=n(77405),g=n(53594),Y=n(99662),_=n(56804),y=n(35369),C=n(76977),S=n(81203),w=n(63136),k=n(83629),I=n(46453),E=n(2548),D=n(32848),A=n(47639),P=n(27747),F=n(39318),x=n(49807),T=n(69706),L=n(44307);function N(e){var i,n;let{post:t,publication:r,compact:l,readOnly:a,onClick:s,onSavePostClick:u,item:c,clipInfo:d}=e,{isHidden:p,onShow:h}=(0,v.k_)(!!(t.explicit||t.cover_image_is_explicit||(null==(i=t.videoUpload)?void 0:i.explicit))),{isPaid:m,isFreeSubscribed:f}=(0,D.NL)(r.id),b=null!=(n=t.coverImagePalette)?n:null,g=t.podcastUpload&&!t.videoUpload,Y=V({post:t,compact:l,readOnly:a});return(0,o.FD)(O,{readOnly:a,onClick:s,publication:r,post:t,compact:l,palette:b,headerRenderable:Y,children:[(0,o.Y)(R,{item:c,post:t,publication:r,clipInfo:d,isHidden:p,isFreeSubscribed:f,isPaid:m,headerRenderable:Y}),!g&&(0,o.Y)(U,{post:t,publication:r,palette:b,readOnly:a,onSavePostClick:u,compact:l}),p&&(0,o.Y)(v.f9,{onShow:h,itemName:"post"})]})}let O=e=>{let{readOnly:i,onClick:n,publication:t,post:r,compact:l,palette:a,headerRenderable:u,children:c}=e,p=q(a),h=!l&&p,m=j({post:r,publication:t,readOnly:i,onClick:n}),f=(null==u?void 0:u.type)==="video"||(null==u?void 0:u.type)==="audio";return(0,o.Y)(d.Q,{children:(0,o.Y)(C.I1,{as:i?"div":"a",className:s()(L.A.postAttachment,i&&L.A.readOnly),position:"relative",bg:"primary",radius:"md",minWidth:0,onClick:m,href:i?void 0:(0,x.wu9)(t,r,{feedViewer:!1}),target:(0,Y.y)()?"_blank":void 0,style:h?p:void 0,draggable:!1,pressable:f?void 0:"lg",showFocus:!0,children:c})})};function V(e){let{post:i,compact:n,readOnly:t}=e;return t||n||!i.videoUpload?t||!i.podcastUpload||i.videoUpload?!n&&i.cover_image?{type:"cover",coverImage:i.cover_image}:null:{type:"audio"}:{type:"video",videoUpload:i.videoUpload}}function R(e){var i,n,r,l;let{item:a,post:u,publication:d,clipInfo:p,isHidden:m,isFreeSubscribed:f,isPaid:v,headerRenderable:b}=e,g=(0,c.useRef)(null),Y=null!=(i=u.coverImagePalette)?i:null;if((null==b?void 0:b.type)==="video")return(0,o.Y)(B,{palette:Y,children:(0,o.Y)(A.U,(0,t._)({clipInfo:p,disableAutoPlay:m,isFreeSubscribed:f,isSubscribed:v,mediaUpload:b.videoUpload,post:u,pub:d,startMuted:!0,videoPlayerRef:g,videoType:p?"clip":"feed"},z({post:u,item:a,clipInfo:p})))});if((null==b?void 0:b.type)==="audio"){let e=(n=u,r=d,n.section_id&&r.sections&&null!=(l=r.sections.find(e=>e.id===n.section_id))?l:null);return(0,o.Y)(P.KQ,{isFreeSubscribed:f,isSubscribed:v,post:u,pub:d,section:e,variant:"notes-embed",trackingProps:z({post:u,item:a})})}return(null==b?void 0:b.type)==="cover"?(0,o.Y)(B,{palette:Y,borderBottom:"detail",children:(0,o.Y)(h.o,{className:s()(L.A.postImage,Y&&L.A.vibrantPostImage),imageProps:{smartCrop:!0,aspect:T.d8},src:b.coverImage,maxWidth:520,useRetinaSizing:!0,imageIsFixedWidth:!0,draggable:!1})}):null}function z(e){let{post:i,item:n,clipInfo:t}=e;return{entityKey:String(i.id),entityType:"post",primaryEntityKey:null==n?void 0:n.entity_key,primaryEntityType:null==n?void 0:n.type,surface:"feed",contentType:t?"clip":"post",feedItemTrackingParameters:null==n?void 0:n.trackingParameters}}function B(e){var{children:i,palette:n,className:a}=e,u=(0,l._)(e,["children","palette","className"]);return(0,o.Y)(C.I1,(0,r._)((0,t._)({},u),{className:s()(n?L.A.vibrantHeader:void 0,a),children:i}))}function U(e){let{post:i,publication:n,palette:t,readOnly:r,onSavePostClick:l,compact:a}=e,s=!a&&t;return(0,o.FD)(C.pT,{gap:12,padding:12,alignItems:"center",children:[(0,o.Y)(M,{publication:n,post:i,palette:s?t:null,readOnly:r}),!r&&(0,o.Y)(W,{post:i,palette:s?t:null,onSavePostClick:l})]})}function M(e){let{publication:i,post:n,palette:t,readOnly:r}=e;return(0,o.FD)(C.I1,{gap:2,flex:"grow",minWidth:0,children:[(0,o.FD)(C.pT,{gap:8,paddingBottom:4,alignItems:"center",children:[(0,o.Y)(S.Nq,{pub:i,size:20,radius:"xs"}),(0,o.Y)(w.EY.B4,{color:t?"vibrance-secondary":"secondary",ellipsis:!0,nowrap:!0,flex:"grow",children:(0,o.Y)(H,{publication:i,readOnly:r})})]}),(0,o.Y)(w.EY.B3,{clamp:2,color:t?"vibrance-primary":"primary",weight:"medium",children:n.title})]})}function H(e){let{publication:i,readOnly:n}=e;return n?(0,o.Y)(o.FK,{children:i.name}):(0,Y.y)()?(0,o.Y)(E.p2,{target:"_blank",href:(0,F.fOI)(i),draggable:!1,children:i.name}):(0,o.Y)(p.m,{pubId:i.id,trigger:(0,o.Y)(E.IE,{href:(0,F.fOI)(i),draggable:!1,children:i.name})})}function W(e){var i,n;let t,{post:r,palette:l,onSavePostClick:a,className:c}=e,{iString:d}=(0,m.GO)(),p=(0,f.Jd)(),{requireLogin:h}=(0,I.eE)(),{handleClick:v,isSaved:g}=(i=r,n=a,t=(0,b.J)(i),{handleClick:e=>{e.preventDefault(),e.stopPropagation(),t(),n&&n(i.is_saved?"unsave":"save"),i.is_saved=!i.is_saved},isSaved:i.is_saved}),Y=s()(L.A.saveButton,g&&L.A.saved,l&&L.A.vibrant,c),_=l?y.mZ:y.K0;return(0,o.Y)(_,{className:Y,priority:"tertiary",size:"sm",onClick:e=>{p?v(e):(e.preventDefault(),null==h||h({redirectOverride:(0,x.wu9)(null,r,{urlParams:{triggerSave:!0}})}))},"aria-label":d("Save"),children:(0,o.Y)(u.A,{size:18})})}function q(e,i){return e?(0,t._)({},(0,g.p4)({palette:e,colorKey:i,defaultColor:"var(--color-dark-bg-primary)"})):void 0}function j(e){let{post:i,publication:n,readOnly:t,onClick:r,urlParams:l}=e;return e=>{null==r||r(),!t&&k.Z&&(0,_.o)(e,(0,x.wu9)(n,i,{noBase:!0,feedViewer:!0,urlParams:l}))}}},60346:function(e,i,n){n.d(i,{H:()=>m});var t=n(4006),r=n(32485),l=n.n(r),o=n(72880),a=n(84605),s=n(17028),u=n(46453),c=n(11510),d=n(49807),p=n(57324),h=n(44307);function m(e){let{onDismiss:i,version:n,asParent:r}=e,o=(0,c.Iu)();return(0,t.FD)(s.I1,{borderTop:r?"detail":"transparent",gap:8,justifyContent:"center",alignItems:"center",className:l()(h.A.transparentLoginPrompt,"app"===n&&h.A.appPrompt,r&&h.A.asParent),minHeight:o?400:void 0,onClick:e=>{e.preventDefault(),e.stopPropagation()},children:["login"===n&&(0,t.Y)(f,{}),"app"===n&&(0,t.Y)(v,{onDismiss:i})]})}function f(){let{iString:e}=(0,a.GO)(),{requireLogin:i,onboardingModal:n}=(0,u.eE)();return(0,t.FD)(t.FK,{children:[(0,t.Y)(s.EY,{size:19,color:"primary",font:"display",fontWeight:"semibold",translated:!0,children:"Log in for more"}),(0,t.Y)(s.EY,{color:"secondary",size:15,translated:!0,children:"Or create an account"}),(0,t.FD)(s.Ye,{gap:8,paddingTop:8,children:[(0,t.Y)(s.$n,{style:{width:"138px"},size:"sm",priority:"secondary-outline",onClick:()=>null==i?void 0:i(),children:e("Login")}),(0,t.Y)(s.$n,{onClick:()=>{null==n||n.open()},style:{width:"138px"},size:"sm",priority:"primary",children:e("Create account")})]})]})}function v(e){let{onDismiss:i}=e,{iString:n}=(0,a.GO)();return(0,t.FD)(s.I1,{alignItems:"center",gap:16,paddingY:16,paddingX:24,paddingTop:32,children:[(0,t.Y)(s.pT,{width:48,paddingY:4,radius:"md",border:"detail",alignItems:"center",justifyContent:"center",bg:"primary",children:(0,t.Y)(o.o,{src:"https://substack.com/img/substack.png",maxWidth:40,useRetinaSizing:!0,imageIsFixedWidth:!0})}),(0,t.Y)(s.EY.B2,{size:17,textAlign:"center",font:"display",fontWeight:"semibold",translated:!0,children:"Get every post and note from creators you love with the Substack app."}),(0,t.FD)(s.I1,{style:{width:"100%"},padding:16,gap:8,children:[(0,t.Y)(s.$n,{size:"md",priority:"primary",onClick:i,href:(0,d._h3)({tab:"notes",redirect:"app-store",utm_source:p.VU.menu}),newTab:!0,children:n("Switch to the app")}),(0,t.Y)(s.$n,{onClick:i,size:"md",priority:"secondary",children:n("Maybe later")})]})]})}},3228:function(e,i,n){n.d(i,{k:()=>m});var t=n(69277),r=n(70408),l=n(32641),o=n(4006),a=n(17402),s=n(2435),u=n(83114),c=n(84605),d=n(82021),p=n(86473),h=n(85013);let m=(0,a.forwardRef)((e,i)=>{var{count:n,className:a,onClick:m,disabled:f,replyRequirement:v,priority:b="secondary"}=e,g=(0,l._)(e,["count","className","onClick","disabled","replyRequirement","priority"]);let{iString:Y}=(0,c.GO)(),_=(0,p.kS)(b);return(0,o.Y)(d.V,(0,r._)((0,t._)({priority:b,className:a,onClick:m,count:n,disabled:f,tooltip:function(e){let{iString:i}=(0,c.GO)();return"paid_subscriber"===e?i("Only paid subscribers can reply."):"free_subscriber"===e?i("Only subscribers can reply."):void 0}(v),"aria-label":Y("Comment"),ref:i},g),{children:v?(0,o.Y)(u.A,{size:_,className:h.A.lockedIcon}):(0,o.Y)(s.A,{size:_})}))})},75189:function(e,i,n){n.d(i,{b:()=>f});var t=n(4006),r=n(27749),l=n(75840),o=n(3228),a=n(74579),s=n(20474),u=n(48226),c=n(52347),d=n(60763),p=n(86473),h=n(504),m=n(2481);function f(e){var i;let{item:n,comment:f,priority:v}=e,b=(0,r.PK)(),g=(0,l.T)(),Y=(0,m.L6)(n),_=null!=(i=f.children_count)?i:0,y=f.reaction_count||0,C=!!f.reaction,S=(0,a.Y)(f,n,C),w=(0,s.l)(f,n),k=(0,p.mp)(n),I=(0,p.qW)(n);if(!n)return null;let{publication:E,post:D}=n;return(0,t.FD)(t.FK,{children:[(0,t.Y)(u.c,{onClick:S,count:y,active:C,disabled:!1,priority:v}),(0,t.Y)(o.k,{onClick:w,count:_,disabled:k,replyRequirement:Y,priority:v}),(0,t.Y)(c.H,{pub:E,post:D,comment:f,feedItem:n,disabled:I,onOpen:e=>{(0,h.Qb)(n,b,"restack",{tabId:g,extraEventProps:{isRestacked:e}})},surface:b,priority:v}),(0,t.Y)(d.f,{publication:E,post:D,comment:f,item:n,priority:v})]})}},48226:function(e,i,n){n.d(i,{c:()=>f});var t=n(69277),r=n(70408),l=n(32641),o=n(4006),a=n(32485),s=n.n(a),u=n(17402),c=n(84605),d=n(82021),p=n(83269),h=n(71836),m=n(54409);let f=(0,u.forwardRef)((e,i)=>{var{count:n,className:a,onClick:u,active:f,disabled:v,priority:b="secondary"}=e,g=(0,l._)(e,["count","className","onClick","active","disabled","priority"]);let{iString:Y}=(0,c.GO)(),[_,y]=(0,p.a)(u);return(0,o.Y)(d.V,(0,r._)((0,t._)({priority:b,className:s()(a,f&&m.A.active),onClick:y,count:n,disabled:v,"aria-label":Y("Like"),ref:i},g),{children:(0,o.Y)(h.S,{isLiked:null!=f&&f,clickedOnce:_,priority:b})}))})},82634:function(e,i,n){n.d(i,{Q:()=>m});var t=n(69277),r=n(70408),l=n(32641),o=n(4006),a=n(32485),s=n.n(a),u=n(17402),c=n(84605),d=n(82021),p=n(68838),h=n(90095);let m=(0,u.forwardRef)((e,i)=>{var{count:n,className:a,onClick:u,active:m,disabled:f,priority:v="secondary"}=e,b=(0,l._)(e,["count","className","onClick","active","disabled","priority"]);let{iString:g}=(0,c.GO)();return(0,o.Y)(d.V,(0,r._)((0,t._)({priority:v,className:s()(a,m&&h.A.active),onClick:u,count:n,disabled:f,"aria-label":g("Restack"),ref:i},b),{children:(0,o.Y)(p.U,{isRestacked:null!=m&&m,priority:v})}))})},52347:function(e,i,n){n.d(i,{H:()=>c});var t=n(4006),r=n(46271),l=n(75840),o=n(82634),a=n(88774),s=n(46453),u=n(28916);function c(e){let{pub:i,post:n,comment:c,feedItem:d,onOpen:p,onRestack:h,disabled:m,surface:f,priority:v}=e,b=(0,r.Jd)(),g=(0,l.T)(),{requireLogin:Y}=(0,s.eE)(),{canRestack:_,isRestacked:y,restacks:C,menuItems:S,nuxModal:w}=(0,u.I)({pub:i,post:n,comment:c,feedItem:d,onRestack:h,tabId:g,surface:f});return b?(0,t.FD)(t.FK,{children:[w,(0,t.Y)(a.W1,{trigger:(0,t.Y)(o.Q,{count:C,active:y,disabled:m||!_,priority:v}),onOpen:()=>null==p?void 0:p(y),children:S})]}):(0,t.Y)(o.Q,{count:C,active:y,onClick:()=>null==Y?void 0:Y(),priority:v})}},99978:function(e,i,n){n.d(i,{w:()=>p});var t=n(69277),r=n(70408),l=n(32641),o=n(4006),a=n(17402),s=n(55913),u=n(84605),c=n(82021),d=n(86473);let p=(0,a.forwardRef)((e,i)=>{var{count:n,className:a,onClick:p,disabled:h,priority:m="secondary"}=e,f=(0,l._)(e,["count","className","onClick","disabled","priority"]);let{iString:v}=(0,u.GO)(),b=(0,d.kS)(m);return(0,o.Y)(c.V,(0,r._)((0,t._)({className:a,onClick:p,count:n,disabled:h,"aria-label":v("Share"),ref:i,priority:m},f),{children:(0,o.Y)(s.A,{size:b})}))})},86998:function(e,i,n){n.d(i,{Qk:()=>a,St:()=>l,um:()=>r,zj:()=>o});var t=n(17402);function r(e){let{fileType:i}=e;return i.startsWith("image/")}function l(e){let{fileType:i}=e;return i.startsWith("video/")}function o(e){let{onAddFiles:i,acceptFile:n}=e,r=(0,t.useRef)(),l=(0,t.useRef)(),[o,a]=(0,t.useState)(!1),s=e=>Array.from(e.items).filter(e=>"file"===e.kind&&n({fileType:e.type})),u=e=>s(e).length>0,c=e=>{let{current:i}=l;i&&i===e.target&&(l.current=void 0,a(!1))};return{isDragging:o,props:{onDragEnter:e=>{let{current:i}=r,{target:n}=e;i&&n&&n instanceof HTMLElement&&(i===n||i.contains(n))&&e.dataTransfer&&(u(e.dataTransfer)||0===e.dataTransfer.items.length)&&(e.preventDefault(),l.current=n,a(!0))},onDragOver:e=>{l.current&&e.preventDefault()},onDragLeave:c,onDragEnd:c,onDrop:e=>{e instanceof globalThis.DragEvent&&!e.defaultPrevented&&e.dataTransfer&&u(e.dataTransfer)&&0!==s(e.dataTransfer).length&&(e.preventDefault(),i(Array.from(e.dataTransfer.files)),a(!1),l.current=void 0)},ref:r}}}function a(e){let i=o(e),n=(0,t.useRef)(!1);return(0,t.useEffect)(()=>{let{props:{onDragEnter:e,onDragOver:t,onDragLeave:r,onDragEnd:l,onDrop:o}}=i,a=document.body;i.props.ref.current=a;let s={dragenter:i=>{n.current||(n.current=!0,e(i))},dragover:t,dragleave:e=>{n.current&&(e.clientX<=0||e.clientX>=window.innerWidth||e.clientY<=0||e.clientY>=window.innerHeight)&&(n.current=!1,r(e))},dragend:e=>{n.current&&(n.current=!1,l(e))},drop:e=>{n.current&&(n.current=!1,o(e))}};for(let[e,i]of Object.entries(s))a.addEventListener(e,i);return()=>{for(let[e,i]of Object.entries(s))a.removeEventListener(e,i)}},[]),i}},85042:function(e,i,n){n.d(i,{M:()=>h,p:()=>p});var t=n(69277),r=n(17402),l=n(86500),o=n(94729),a=n(68349),s=n(43296),u=n(40659),c=n(55714),d=n(82776);let p=e=>{var i,n,o;let{liveStream:a,onGuestJoined:p,updateLiveStream:h}=e,m=(0,s.XW)(),[f,v]=(0,r.useState)(!a||"idle"===a.liveStream.status||"cancelled"===a.liveStream.status),[b,g]=(0,r.useState)(null!=(i=null==a?void 0:a.liveStreamGuests)?i:[]),[Y,_]=(0,r.useState)(null!=(n=null==a?void 0:a.liveStreamInformation.currentViewerCount)?n:0),[y,C]=(0,r.useState)(null!=(o=null==a?void 0:a.liveStreamInformation.concurrentViewerCount)?o:0),S=(null==a?void 0:a.liveStream.status)==="scheduled";return(0,r.useEffect)(()=>{a&&(v("idle"===a.liveStream.status||"cancelled"===a.liveStream.status),g(a.liveStreamGuests),_(a.liveStreamInformation.currentViewerCount),C(a.liveStreamInformation.concurrentViewerCount),p&&a.liveStreamGuests.forEach(e=>{p({message:{type:"live-stream:guest-joined",invited_user:e.user,invited_user_primary_publication:e.pub||void 0}})}))},[a]),(0,r.useEffect)(()=>{if(a)return null==m?void 0:m.listen({[(0,c.sl)({streamId:a.liveStream.id})]:e=>{var i,n,t,r,l;let{data:o}=e;if((null==o||null==(i=o.message)?void 0:i.type)==="live-stream:viewer-count-updated"&&(_(o.message.current_viewer_count),C(o.message.current_concurrent_viewer_count)),(null==o||null==(n=o.message)?void 0:n.type)==="live-stream:ended"&&v(!0),(null==o||null==(t=o.message)?void 0:t.type)==="live-stream:started"&&(null==h||h(a.liveStream.id)),(null==o||null==(r=o.message)?void 0:r.type)==="live-stream:guest-joined"){let e=o.message;g(i=>[...i,{user:e.invited_user,pub:e.invited_user_primary_publication}]),p&&p({message:e})}if((null==o||null==(l=o.message)?void 0:l.type)==="live-stream:guest-left"){let e=o.message;g(i=>i.filter(i=>i.user.id!==e.invited_user.id))}}})},[null==a?void 0:a.liveStream.status,null==a?void 0:a.liveStream.id,p,m]),(0,r.useEffect)(()=>{a&&(0,l.u4)(l.qY.LIVE_STREAM_JOINED,(0,t._)({live_stream_id:a.liveStream.id},(0,d.extractEventAttributionDataFromRecord)((0,u.cf)())))},[null==a?void 0:a.liveStream.id]),(0,r.useEffect)(()=>{if(!a)return;let e=()=>{(0,l.u4)(l.qY.LIVE_STREAM_LEFT,{live_stream_id:a.liveStream.id})};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}},[a,null==a?void 0:a.liveStream.id]),{guests:b,hasEnded:f,isScheduled:S,viewerCount:Y,concurrentViewerCount:y}},h=e=>{let{inputRef:i,liveStream:n}=e,[t,l]=(0,r.useState)(""),[s,u]=(0,r.useState)(!1),c=async()=>{if(!s&&t){u(!0);try{await (0,o.x6)("/api/v1/live_stream/".concat(n.liveStream.id,"/message"),{method:"POST",json:{message_body:t.trim(),message_id:(0,a.QT)()}})}catch(e){alert((0,a.uX)(e))}l(""),u(!1),setTimeout(()=>{var e;null==(e=i.current)||e.focus()},0)}};return{message:t,setMessage:l,loading:s,sendMessage:c}}},96467:function(e,i,n){n.d(i,{K:()=>r});var t=n(17402);function r(e,i,n){let[r,l]=(0,t.useReducer)(e,i,n),o=(0,t.useRef)(r);o.current=r;let a=(0,t.useMemo)(()=>async e=>{if("function"==typeof e)return await e(a,()=>o.current);l(e)},[]);return[r,a]}},55762:function(e,i,n){n.d(i,{V:()=>t,k:()=>r});let t=(e,i)=>{if(!e)return 0;let{scrollHeight:n,clientHeight:t}=e;return Math.min(i/100*(n-t),Math.max(0,n-t))},r=(e,i)=>{var n,t,r,l;let{scrollTop:o,scrollHeight:a,clientHeight:s}=i?{scrollTop:document.documentElement.scrollTop||document.body.scrollTop,scrollHeight:null!=(n=null==e?void 0:e.scrollHeight)?n:0,clientHeight:window.innerHeight}:{scrollTop:null!=(t=null==e?void 0:e.scrollTop)?t:0,scrollHeight:null!=(r=null==e?void 0:e.scrollHeight)?r:0,clientHeight:null!=(l=null==e?void 0:e.clientHeight)?l:0};return a&&s?a===s?{top:0,bottom:100}:{top:Math.min(100,o/(a-s)*100),bottom:Math.min(100,(o+s)/a*100)}:{top:0,bottom:0}}},25318:function(e,i,n){n.d(i,{D:()=>p});var t=n(4006),r=n(32485),l=n.n(r),o=n(17402),a=n(8515),s=n(76977),u=n(86465),c=n(20500),d=n(63136);let p=(0,o.forwardRef)((e,i)=>{let{action:n,children:r,className:o,errors:p,helpText:h,details:m,label:f,paddingBottom:v,paddingTop:b,flex:g,wrapWithLabel:Y,disabled:_,compact:y}=e,C=y?2:8,S=Array.isArray(m)?m:m?[m]:[];return(0,t.Y)(s.VP,{ref:i,alignItems:"stretch",className:o,gap:C,paddingBottom:v,paddingTop:b,disabled:_,flex:g,children:(0,t.FD)(s.VP,{gap:4,children:[(0,t.FD)(s.VP,{gap:C,as:Y?"label":"div",children:[f&&(0,t.FD)(s.fI,{gap:C,alignItems:"center",justifyContent:"space-between",children:[(0,t.FD)(s.fI,{gap:C,alignItems:"center",children:[(0,t.Y)(d.EY.B4,{weight:"medium",as:Y?"div":"label",color:"primary",children:f}),h&&(0,t.Y)(a.V,{text:h})]}),n]}),r&&(0,t.Y)(s.VP,{className:l()({"has-error":p}),children:r})]}),S&&S.length>0&&S.map(e=>(0,t.Y)(c.EE,{children:e})),(0,t.Y)(u.I,{errors:p})]})})})},72678:function(e,i,n){n.d(i,{g:()=>p});var t=n(4006),r=n(50802),l=n(17402),o=n(84605),a=n(12501),s=n(68349),u=n(88774),c=n(36372),d=n(39318);function p(e){let{pub:i}=e,{iString:n}=(0,o.GO)(),{popToast:p}=(0,c.d)(),{refetch:h,isLoading:m}=(0,a.st)({pathname:"/api/v1/live_stream/recording",method:"post"}),f=(0,l.useCallback)(async()=>{let e=await h();"id"in e?(0,s.V2)("".concat((0,d.$_T)({subdomain:i.subdomain}),"/publish/recording/").concat(e.id,"?startPractice=true")):p(()=>(0,t.Y)(c.y,{text:n("Something went wrong. Please try again.")}))},[h,i.subdomain]);return(0,t.Y)(u.Dr,{leading:(0,t.Y)(r.A,{}),disabled:m,onClick:f,children:n("Record a podcast")})}},44338:function(e,i,n){(0,n(17402).createContext)("")},554:function(e,i,n){n.d(i,{s:()=>w});var t=n(4006),r=n(98188),l=n(84605),o=n(85478),a=n(86500),s=n(88774),u=n(72678),c=n(80827),d=n(47049),p=n(68614),h=n(7050),m=n(17402),f=n(12501),v=n(68349);n(35369);var b=n(36372),g=n(39318);function Y(e,i,n){let{popToast:r}=(0,b.d)(),[l,o]=(0,m.useState)(!1),[a,s]=(0,m.useState)(void 0),{refetch:u,isLoading:c}=(0,f.st)({pathname:"/api/v1/@".concat(null==e?void 0:e.handle,"/personal-initialize"),method:"post"}),d=!i&&e.isPersonalEligible,p=(null==e?void 0:e.isPersonalEligible)||d?async()=>{let e=await u({query:{action:"post"}});e instanceof Error?(console.error(e),r(()=>(0,t.Y)(b.y,{text:"Something went wrong. Please try again."}))):(o(!0),"undefined"!=typeof window&&(window.location.href=e.redirectUrl))}:async()=>(0,v.V2)((0,g.YII)(),{local_navigation:!1});return(0,m.useEffect)(()=>{"undefined"!=typeof window&&(null==i?void 0:i.publication)&&!d&&s((0,g.yRP)("".concat((0,g.$_T)({subdomain:i.publication.subdomain}),"/publish/post"),{back:window.location.href,type:null==n?void 0:n.type}))},[i,d]),{onClick:p,href:a,isLoading:c,willRedirect:l}}function _(e){let{profile:i,publicationUser:n}=e,{iString:r}=(0,l.GO)(),{onClick:o,href:u,isLoading:d,willRedirect:p}=Y(i,n);return(0,t.Y)(s.Dr,{leading:(0,t.Y)(c.A,{}),disabled:d||p,onClick:async()=>{(0,a.u4)(a.qY.WEB_DESTINATION_COMPOSER_CLICKED,{clicked_element:"article"}),await o()},href:u,children:r("Article")})}function y(e){let{profile:i,publicationUser:n}=e,{iString:r}=(0,l.GO)(),{onClick:o,href:u,isLoading:c,willRedirect:p}=Y(i,n,{type:"podcast"});return(0,t.Y)(s.Dr,{leading:(0,t.Y)(d.A,{}),disabled:c||p,onClick:async()=>{(0,a.u4)(a.qY.WEB_DESTINATION_COMPOSER_CLICKED,{clicked_element:"video"}),await o()},href:u,children:r("Video")})}function C(e){let{profile:i,publicationUser:n}=e,{iString:r}=(0,l.GO)(),{onClick:o,href:u,isLoading:c,willRedirect:d}=Y(i,n,{type:"podcast"});return(0,t.Y)(s.Dr,{leading:(0,t.Y)(p.A,{}),disabled:c||d,onClick:async()=>{(0,a.u4)(a.qY.WEB_DESTINATION_COMPOSER_CLICKED,{clicked_element:"podcast"}),await o()},href:u,children:r("Podcast")})}function S(e){let{publicationUser:i}=e,{iString:n}=(0,l.GO)();if(!i.publication)return null;let r="".concat((0,g.$_T)({subdomain:i.publication.subdomain}),"/publish/live-stream/new");return(0,t.Y)(s.Dr,{leading:(0,t.Y)(h.A,{}),href:r,onClick:()=>{(0,a.u4)(a.qY.WEB_DESTINATION_COMPOSER_CLICKED,{clicked_element:"live"})},children:n("Live")})}function w(e){let{trigger:i,onNoteClick:n,profile:c,publicationUser:d,isEligibleForLiveStreamCreation:p=!1}=e,{iString:h}=(0,l.GO)(),m=(0,o.mJ)().getConfigFor("private_live_streaming_enabled")&&p;return(0,t.FD)(s.W1,{trigger:i,matchReferenceWidth:!0,children:[(0,t.Y)(s.Dr,{onClick:()=>{(0,a.u4)(a.qY.WEB_DESTINATION_COMPOSER_CLICKED,{clicked_element:"note"}),n()},leading:(0,t.Y)(r.A,{}),children:h("Note")}),c&&(0,t.Y)(_,{profile:c,publicationUser:d}),c&&(0,t.FD)(s.H9,{children:[(0,t.Y)(y,{profile:c,publicationUser:d}),(0,t.Y)(C,{profile:c,publicationUser:d}),d&&p?(0,t.Y)(S,{publicationUser:d}):null,(null==d?void 0:d.publication)&&m?(0,t.Y)(u.g,{pub:d.publication}):null]})]})}},69058:function(e,i,n){n.d(i,{d:()=>o});var t=n(4006),r=n(17028),l=n(16993);function o(e){let{title:i,subtitle:n,children:o,onClose:a}=e;return(0,t.FD)(t.FK,{children:[(0,t.Y)(l.rQ,{title:i,description:n,showClose:!0,onClose:a}),(0,t.Y)(l.cw,{children:(0,t.Y)(r.VP,{gap:12,children:o})})]})}},35276:function(e,i,n){n.d(i,{A2:()=>g,A_:()=>_,BG:()=>E,IE:()=>S,K5:()=>Y,Nq:()=>y,RZ:()=>C,Sm:()=>b,Uq:()=>k,Yz:()=>I,pL:()=>w,sF:()=>f,vu:()=>v});var t=n(4006),r=n(47504),l=n(12203),o=n(23345),a=n(47870),s=n(55300),u=n(15977),c=n(38637),d=n(37623),p=n(54687),h=n(47233),m=n(57157);function f(e){let{size:i,className:n}=e;return(0,t.Y)(r.A,{size:i,className:n})}function v(e){let{size:i,className:n}=e;return(0,t.Y)(l.A,{size:i,className:n})}function b(e){let{size:i,className:n}=e;return(0,t.Y)(o.A,{size:i,className:n})}function g(e){let{size:i,className:n}=e;return(0,t.Y)(a.A,{size:i,className:n})}function Y(e){let{size:i,className:n}=e;return(0,t.Y)(s.A,{size:i,className:n})}function _(e){let{size:i,className:n}=e;return(0,t.Y)(u.A,{size:i,className:n})}function y(e){let{size:i,className:n}=e;return(0,t.Y)(l.A,{size:i,className:n})}function C(e){let{size:i,className:n}=e;return(0,t.Y)(c.A,{size:i,className:n})}function S(e){let{size:i,className:n}=e;return(0,t.Y)(d.A,{size:i,className:n})}function w(e){let{size:i,className:n}=e;return(0,t.Y)(p.A,{size:i,className:n})}function k(e){let{size:i,className:n}=e;return(0,t.Y)(l.A,{size:i,className:n})}function I(e){let{size:i,className:n}=e;return(0,t.Y)(h.A,{size:i,className:n})}function E(e){let{size:i,className:n}=e;return(0,t.Y)(m.A,{size:i,className:n})}},76329:function(e,i,n){n.d(i,{z:()=>p});var t=n(69277),r=n(70408),l=n(32641),o=n(4006),a=n(97541),s=n(76977),u=n(83357),c=n(46453),d=n(70690);function p(e){var{forwardedRef:i,href:n,onClick:p,campaign:h}=e,m=(0,l._)(e,["forwardedRef","href","onClick","campaign"]);let{onRefresh:f}=(0,c.eE)();return(0,o.Y)(a.Match,{children:e=>{let{path:l}=e,a=n&&(0,d.y)(l,n);return m.native?(0,o.Y)(s.pT,(0,r._)((0,t._)({as:"a"},m),{href:!a||m.native?n:void 0,onClick:a&&f?f:p,ref:i})):(0,o.Y)(u.N,(0,r._)((0,t._)({},m),{campaign:h,role:"button",href:a?void 0:n,onClick:a&&f?f:p,ref:i}))}})}},72147:function(e,i,n){n.d(i,{X:()=>w});var t=n(4006),r=n(93540),l=n(17402),o=n(84605),a=n(46275),s=n(95899),u=n(6547),c=n(44333),d=n(76528),p=n(89490),h=n(97515),m=n(76977),f=n(414),v=n(67140),b=n(60281),g=n(46453),Y=n(93718),_=n(45937),y=n(11510),C=n(28700),S=n(82776);function w(e){let{id:i,subpath:n}=e,{subjectProfile:r}=(0,s.xc)({subjectId:i.startsWith("@")?i.replace("@",""):i});return r?(0,t.Y)(k,{profile:r,subpath:n}):null}function k(e){var i;let{profile:n,subpath:r}=e,{iString:s}=(0,o.GO)(),u=n.name;(0,g.t2)(u||"",{backAction:(0,C.gY)(n),alwaysPinTitle:!0});let d=(0,c.lq)(),p=(0,y.Iu)(),h=null==(i=r.match(/\/([^/]+)$/))?void 0:i[1],b=(0,l.useRef)(null),Y=!n.primaryPublication,_=(0,a.BR)().isOnDestination,S=e=>{let i=history.state;d(_?(0,C.o4)(n,e,{noBase:!0}):"/profile/".concat(e),!0),history.replaceState(i,"")};(0,l.useEffect)(()=>{Y&&"subscribers"===h&&S("followers")},[Y,h]);let w=[...Y?[]:[{value:"subscribers",label:s("Subscribers")}],{value:"followers",label:n.followerCount&&n.followerCount>0?"".concat(s("Followers")," (").concat((0,v.V)(n.followerCount,"number-truncated"),")"):s("Followers")},{value:"following",label:s("Following")}];return(0,t.FD)(m.I1,{flex:"grow",style:{maxWidth:568},minWidth:0,paddingX:20*!p,paddingTop:20,gap:20,children:[(0,t.Y)(f.r,{value:h,tabs:w,onChange:S,style:{minHeight:48},ariaLabel:s("Select filter")}),(0,t.Y)(m.I1,{gap:4,ref:b,paddingBottom:20,children:"subscribers"===h?(0,t.Y)(I,{profile:n,bodyRef:b}):"followers"===h?(0,t.Y)(E,{profile:n,bodyRef:b}):(0,t.Y)(D,{profile:n,bodyRef:b})})]})}function I(e){let{profile:i,bodyRef:n}=e,{id:l}=i,{data:o,users:a,isLoading:s,error:u}=P(l,"subscribers",n);return(0,t.Y)(t.FK,{children:u?"Error":s?Array(10).fill(null).map(()=>(0,t.Y)(b.SE,{})):o?0===a.length?(0,t.Y)(A,{children:(0,t.Y)(h.p,{icon:(0,t.Y)(r.A,{}),title:"No subscribers yet"})}):a.map(e=>(0,t.Y)(Y.I,{person:e,surface:"profile_Subscribers"},e.id)):null})}function E(e){let{profile:i,bodyRef:n}=e,r=(0,S.guessFirstName)(i.name),{data:l,users:o,isLoading:a,error:s}=P(i.id,"followers",n);return(0,t.Y)(t.FK,{children:s?"Error":a?Array(10).fill(null).map(()=>(0,t.Y)(b.SE,{})):l?o.length?o.map(e=>(0,t.Y)(Y.I,{person:e,surface:"profile_Followers"},e.id)):(0,t.Y)(A,{children:(0,t.Y)(h.p,{icon:(0,t.Y)(u.A,{}),title:"No followers yet",description:"Be the first to follow ".concat(r)})}):null})}function D(e){let{profile:i,bodyRef:n}=e,r=(0,S.guessFirstName)(i.name),{data:l,users:o,isLoading:a,error:s}=P(i.id,"following",n);return(0,t.Y)(t.FK,{children:s?"Error":a?Array(10).fill(null).map(()=>(0,t.Y)(b.SE,{})):l?o.length?o.map(e=>(0,t.Y)(Y.I,{person:e,surface:"profile_Following"},e.id)):(0,t.Y)(A,{children:(0,t.Y)(h.p,{icon:(0,t.Y)(u.A,{}),title:"".concat(r," isn't following anyone yet")})}):null})}let A=(0,p.yw)({display:"flex",paddingY:48,justifyContent:"center",alignItems:"center",flex:"grow"});function P(e,i,n){var t;let[r,o]=(0,l.useState)(20),{data:a,isLoading:s,error:u}=(0,d.OU)("/api/v1/user/".concat(e,"/subscriber-lists"),{query:{lists:i},deps:[e,i]},{revalidateOnMount:!0}),c=null!=(t=null==a?void 0:a.subscriberLists.flatMap(e=>e.groups.flatMap(e=>e.users)))?t:[],p=c.length>r;return(0,_.X)(()=>o(r+20),[r,p],{shouldCheck:p,threshold:640,bodyRef:n}),{data:a,isLoading:s,error:u,users:c.slice(0,r)}}},90389:function(e,i,n){n.d(i,{S:()=>l});var t=n(4006),r=n(63136);let l=(e,i,n)=>{if(!e)return"";if(!i)return e;i.sort((e,i)=>i.length-e.length);let l=RegExp(o(i.join("|")),"ig"),a=e.split(l),s=[...e.matchAll(l)];return a.map((e,i)=>(0,t.FD)(t.FK,{children:[e,i!==a.length-1&&(0,t.FD)(r.EY,{as:"span",weight:n||"bold",fontStyle:"italic",children:[s[i]," "]})]}))},o=e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},43296:function(e,i,n){n.d(i,{$P:()=>m,F$:()=>p,XW:()=>h});var t=n(99851),r=n(69277),l=n(70408),o=n(4006),a=n(17402),s=n(94729),u=n(35666);class c{async connect(){try{if(!this.host)throw Error("Attempted to connect without a token");this.ws=new WebSocket(this.host),this.ws.addEventListener("open",()=>{for(let[e,i]of this.channels)i.size>0&&this.send({action:"subscribe",channel:e})}),this.ws.addEventListener("error",e=>{console.error(e),"closed"!==this.connectivityState&&(this.error=Error("Generic error"),this.handleError())}),this.ws.addEventListener("close",e=>{"closed"!==this.connectivityState&&(this.error={code:e.code,reason:e.reason,wasClean:e.wasClean},this.handleError())}),this.ws.addEventListener("message",e=>{"open"!==this.connectivityState&&(this.connectivityState="open",clearTimeout(this.timeoutId),this.reconnectInterval=900,this.notifyConnectivityChange());let i=JSON.parse(e.data),n=(0,l._)((0,r._)({},i),{data:i.data?(0,l._)((0,r._)({},i.data),{message:"string"==typeof i.data.message?JSON.parse(i.data.message):null}):null});if(n.data){var t;for(let e of null!=(t=this.channels.get(n.data.channel))?t:[])e(n)}}),clearTimeout(this.timeoutId);let e=this.ws;this.timeoutId=setTimeout(()=>{"connecting"===this.connectivityState&&(this.error=Error("Timeout"),e.close(),this.handleError())},3e4)}catch(e){this.error=e instanceof Error?e:Error(String(e)),this.handleError()}}async refreshToken(){let e;this.channels.size>0&&(e=Array.from(this.channels.keys()).join(","));let i=await (0,s.x6)("/api/v1/realtime/token",{query:{channels:e}});return this.token=i.token,this.expiry=i.expiry,this.host=i.endpoint,this.ws||this.connect(),i}send(e){let{ws:i}=this;if(!i)throw Error("Cannot send without a connection.");i.send(JSON.stringify((0,r._)({token:this.token},e)))}publish(e,i){this.send({action:"publish",channel:e,message:JSON.stringify(i)})}listen(e){let i=[],n=new Set(this.channels.keys());return this.subscriptionQueue=this.subscriptionQueue.then(async()=>{for(let[n,t]of Object.entries(e)){let e=this.channels.get(n);e||(e=new Set,this.channels.set(n,e)),e.add(t),i.push(()=>{var e;let i=this.channels.get(n);null==i||i.delete(t),(null==i?void 0:i.size)===0&&(null==(e=this.ws)?void 0:e.readyState)===WebSocket.OPEN&&(this.send({action:"unsubscribe",channel:n}),this.channels.delete(n))})}let t=(0,u.iv)(new Set(this.channels.keys()),n);if(t.size>0){var r;if(await this.refreshToken(),(null==(r=this.ws)?void 0:r.readyState)===WebSocket.OPEN)for(let e of t)this.send({action:"subscribe",channel:e})}}),()=>{let e=new Set(this.channels.keys());for(let e of i)e();(0,u.iv)(e,new Set(this.channels.keys())).size>0&&this.refreshToken()}}onConnectivityChange(e){return this.connectivityHandlers.add(e),()=>{this.connectivityHandlers.delete(e)}}destroy(){var e;this.channels.clear(),this.connectivityHandlers.clear(),this.connectivityState="closed",null==(e=this.ws)||e.close(),clearTimeout(this.reconnectTimeoutId),clearTimeout(this.timeoutId)}notifyConnectivityChange(){for(let e of this.connectivityHandlers)e(this.connectivityState)}handleError(){console.info("ZyncSocket: Connection closed"),clearTimeout(this.timeoutId),"closed"!==this.connectivityState&&(this.connectivityState="closed",this.notifyConnectivityChange()),0===this.reconnectTimeoutId&&(console.info("ZyncSocket: Attempting to reconnect..."),this.reconnectTimeoutId=setTimeout(()=>{this.reconnectTimeoutId=0,this.reconnectInterval=Math.min(2*this.reconnectInterval,6e4),this.connect()},this.reconnectInterval+.2*this.reconnectInterval))}constructor(){(0,t._)(this,"token",void 0),(0,t._)(this,"expiry",void 0),(0,t._)(this,"host",void 0),(0,t._)(this,"ws",void 0),(0,t._)(this,"connectivityState","closed"),(0,t._)(this,"error",void 0),(0,t._)(this,"reconnectInterval",900),(0,t._)(this,"reconnectTimeoutId",0),(0,t._)(this,"channels",new Map),(0,t._)(this,"connectivityHandlers",new Set),(0,t._)(this,"timeoutId",0),(0,t._)(this,"subscriptionQueue",Promise.resolve())}}let d=(0,a.createContext)(null);function p(e){let{children:i}=e,[n,t]=(0,a.useState)(null);return(0,a.useEffect)(()=>{null==n||n.destroy();let e=new c;return t(e),()=>{e.destroy()}},[]),(0,o.Y)(d.Provider,{value:n,children:i})}function h(){return(0,a.useContext)(d)}function m(){var e;let i=h(),[n,t]=(0,a.useState)(null!=(e=null==i?void 0:i.connectivityState)?e:"closed");return(0,a.useEffect)(()=>null==i?void 0:i.onConnectivityChange(t),[i]),n}},10682:function(e,i,n){n.d(i,{C:()=>eU});var t=n(69277),r=n(70408),l=n(79785),o=n(4006),a=n(97213),s=n(17402),u=n(77849),c=n(43262),d=n(79909),p=n(84605),h=n(46271),m=n(85042),f=n(86500),v=n(94729),b=n(1683),g=n(68349),Y=n(89490),_=n(17028),y=n(57820),C=n(36372),S=n(7936),w=n(47963),k=n(16993);let I=e=>{let{isOpen:i,onClose:n}=e,{iString:t}=(0,p.GO)();return(0,o.FD)(k.aF,{isOpen:i,onClose:n,children:[(0,o.Y)(k.rQ,{showClose:!0,onClose:n,title:t("Download the Substack app"),description:t("The Substack app is required to use the live stream practice room"),showDivider:!0}),(0,o.Y)(w.gF,{})]})};var E=n(38992),D=n(83804),A=n(28541),P=n(45773),F=n(23623),x=n(24078),T=n(22057),L=n(16884),N=n(39318),O=n(49807),V=n(50963),R=n(57324);function z(){let e=(0,l._)(['"','" was cancelled']);return z=function(){return e},e}function B(){let e=(0,l._)(['"','" has ended']);return B=function(){return e},e}function U(){let e=(0,l._)(["Subscribed to ",""]);return U=function(){return e},e}function M(){let e=(0,l._)(["See more from ",""]);return M=function(){return e},e}function H(){let e=(0,l._)(["See more from ",""]);return H=function(){return e},e}let W=e=>{let{liveStream:i,guests:n,isSubscribedToAll:l,setSubscriptions:a,subscriptions:u}=e,{iTemplate:c,iString:d}=(0,p.GO)(),{popToast:m}=(0,C.d)(),[v,b]=(0,s.useState)([]),Y=(0,h.Jd)(),y="cancelled"===i.liveStream.status?c(z(),i.liveStream.title):c(B(),i.liveStream.title);(0,s.useEffect)(()=>{(0,f.u4)(f.qY.LIVE_STREAM_ENDED_SCREEN_VIEWED,{live_stream_id:i.liveStream.id})},[]);let S=(0,s.useMemo)(()=>[i,...n].sort((e,i)=>{var n,t,r,l,o,a,s,c;let d=["free_signup","subscribed"].includes(null!=(a=null==u||null==(n=u[null!=(o=null==(t=e.pub)?void 0:t.id)?o:0])?void 0:n.membership_state)?a:"unsubscribed")||!e.pub,p=["free_signup","subscribed"].includes(null!=(c=null==u||null==(r=u[null!=(s=null==(l=i.pub)?void 0:l.id)?s:0])?void 0:r.membership_state)?c:"unsubscribed")||!i.pub;return d&&!p?1:!d&&p?-1:0}),[]),w=async e=>{let i=!1;if(!Y){window.location.href=(0,N.my9)(e,{utm_source:R.VU.liveStreamEndCard,next:document.location.href,utm_medium:R.Jn.web});return}b(i=>[...i,e.id]);try{let l=(await (0,L.yc)(e.id,R.VU.liveStreamEndCard,{publication:null!=e?e:void 0,user:Y,openPubInNewTabAfterSubscription:!1})).errorMessage;l?m(()=>(0,o.Y)(C.y,{Icon:A.A,text:l})):n.length?(a(i=>(0,r._)((0,t._)({},i),{[e.id]:(0,r._)((0,t._)({},i[e.id]),{membership_state:"free_signup"})})),m(()=>(0,o.Y)(C.y,{Icon:P.A,text:c(U(),(null==e?void 0:e.name)||(null==Y?void 0:Y.name)||"")}))):((0,g.V2)((0,N.my9)(e,{utm_source:R.VU.liveStreamEndCard,next:document.location.href,utm_medium:R.Jn.web,just_signed_up:!0}),{local_navigation:!1}),i=!0)}catch(e){m(()=>(0,o.Y)(C.y,{Icon:A.A,text:(0,g.uX)(e)}))}finally{i||b(i=>i.filter(i=>i!==e.id))}};if(0===n.length){var k,I,E,D,H,W,j,G;let e=["free_signup","subscribed"].includes(null!=(W=null==u||null==(k=u[null!=(H=null==(I=i.pub)?void 0:I.id)?H:0])?void 0:k.membership_state)?W:"unsubscribed"),n=i.pub&&!e;return(0,o.Y)(F.a,{children:(0,o.FD)(_.VP,{alignItems:"center",gap:20,width:440,children:[(0,o.Y)(x.eu,{user:i.user,size:80}),(0,o.FD)(_.VP,{alignItems:"center",gap:8,children:[(0,o.Y)(_.EY.H3,{color:"primary",weight:"medium",textAlign:"center",children:y}),l?null:(0,o.Y)(_.EY.B4,{color:"tertiary",textAlign:"center",translated:!0,children:"Subscribe to receive a notification when the recording is published"})]}),(0,o.Y)(_.$n,{priority:"primary",size:"lg",onClick:()=>{n&&i.pub&&w(i.pub)},href:n?void 0:(0,O.gYq)(i.user,{utm_source:R.VU.liveStreamEndCard}),loading:v.includes(null!=(j=null==(E=i.pub)?void 0:E.id)?j:0),children:n?d(v.includes(null!=(G=null==(D=i.pub)?void 0:D.id)?G:0)?"Subscribing...":"Subscribe"):c(M(),(0,V.$k)(i.user.name))})]})})}return(0,o.Y)(F.a,{children:(0,o.FD)(_.VP,{alignItems:"center",gap:24,width:440,children:[(0,o.Y)(T.Z,{direction:"rtl",users:[i.user,...n.map(e=>e.user)],size:60}),(0,o.FD)(_.VP,{alignItems:"center",gap:8,children:[(0,o.Y)(_.EY.H3,{weight:"medium",color:"primary",textAlign:"center",children:y}),l?null:(0,o.Y)(_.EY.B4,{color:"tertiary",textAlign:"center",translated:!0,children:"Subscribe to receive a notification when the recording is published"})]}),(0,o.Y)(_.VP,{gap:12,children:S.map((e,i)=>{var n,t,r,l,a,s,c;return(0,o.Y)(q,{user:e.user,pub:null!=(l=e.pub)?l:void 0,isSubscribing:v.includes(null!=(a=null==(n=e.pub)?void 0:n.id)?a:0),isSubscribed:["free_signup","subscribed"].includes(null!=(c=null==u||null==(t=u[null!=(s=null==(r=e.pub)?void 0:r.id)?s:0])?void 0:t.membership_state)?c:"unsubscribed"),onSubscribe:w},e.user.id||i)})})]})})},q=e=>{let{user:i,pub:n,isSubscribed:t,isSubscribing:r,onSubscribe:l}=e,{iString:a,iTemplate:s}=(0,p.GO)(),u=n&&!t;return(0,o.FD)(_.fI,{alignItems:"center",gap:12,width:440,children:[(0,o.Y)(x.eu,{user:i,size:40}),(0,o.FD)(_.VP,{gap:2,children:[(0,o.Y)(_.EY.B3,{weight:"medium",color:"primary",children:i.name}),i.handle&&(0,o.FD)(_.EY.B5,{color:"primary",lineHeight:16,children:["@",i.handle]})]}),(0,o.Y)(_.az,{flex:"grow"}),(0,o.Y)(_.$n,{priority:u?"primary":"secondary",size:"sm",onClick:()=>{u&&l(n)},href:u?void 0:(0,O.gYq)(i,{utm_source:R.VU.liveStreamEndCard}),loading:r,children:u?a(r?"Subscribing...":"Subscribe"):s(H(),(0,V.$k)(i.name))})]})};var j=n(79391),G=n(81203),K=n(61554),$=n(40659);function Z(){let e=(0,l._)([""," and ",""]);return Z=function(){return e},e}function J(){let e=(0,l._)(["",", ",", and ",""]);return J=function(){return e},e}function X(){let e=(0,l._)(["",", and ",""]);return X=function(){return e},e}function Q(){let e=(0,l._)(["This live stream is only for founding members of ",""]);return Q=function(){return e},e}function ee(){let e=(0,l._)(["This live stream is only for paid subscribers of ",""]);return ee=function(){return e},e}function ei(){let e=(0,l._)(["This live video is only for subscribers of ",""]);return ei=function(){return e},e}function en(){let e=(0,l._)(["Subscribe to ",""]);return en=function(){return e},e}let et=e=>{let{liveStream:i,guests:n,subscriptions:t,setSubscriptions:r,open:l,setOpen:a}=e,{title:s,subtitle:u,isOpen:c,showIndividualPubs:d}=ea({liveStream:i,guests:n,open:l});if(!i.pub)return null;let p=n.find(e=>{var i;return null==(i=e.pub)?void 0:i.logo_url});return(0,o.FD)(k.aF,{isOpen:c,onClose:()=>{a(!1)},children:[(0,o.Y)(k.rQ,{showClose:!1,title:s,description:u,alignItems:"center",icon:(0,o.Y)(er,{liveStream:i,guestPubWithLogo:p})}),(0,o.Y)(k.cw,{children:(0,o.Y)(_.VP,{gap:20,paddingTop:8,children:d?(0,o.FD)(o.FK,{children:[(0,o.Y)(eo,{pub:i.pub,streamingUser:i.user,subscriptions:t,setSubscriptions:r,setOpen:a,foundingUpsell:"only_founding"===i.liveStream.audience,audience:i.liveStream.audience}),n.map(e=>{var n;return(0,o.Y)(eo,{pub:e.pub,streamingUser:e.user,subscriptions:t,setSubscriptions:r,setOpen:a,foundingUpsell:"only_founding"===i.liveStream.audience,audience:i.liveStream.audience},null==(n=e.pub)?void 0:n.id)})]}):(0,o.FD)(o.FK,{children:[(0,o.Y)(el,{liveStream:i,guests:n,subscriptions:t}),(0,o.Y)(_.az,{children:(0,o.Y)(K.U,{includeCheckbox:!1,addSubscribePreamble:!0,color:"secondary",textAlign:"center"})})]})})})]})},er=e=>{let{liveStream:i,guestPubWithLogo:n}=e;return n&&"only_free"===i.liveStream.audience?(0,o.FD)(_.az,{position:"relative",width:80,height:80,children:[(0,o.Y)(G.Nq,{className:"primaryPubAvatar-DsPqHi",pub:i.pub,size:48,radius:"xs"}),(0,o.Y)(G.Nq,{className:"guestPubAvatar-tqWNqe",pub:n.pub||void 0,size:48,radius:"xs"})]}):(0,o.Y)(G.Nq,{pub:i.pub,size:48,radius:"sm",outline:"detail"})},el=e=>{var i,n,t,r,l,a,s,u,c,d,m,f,v,b,g,Y,_,y,C;let{liveStream:S,guests:w,subscriptions:k}=e,{iString:I}=(0,p.GO)(),E=(0,h.Jd)();return S.pub?(E&&(E.is_subscribed=["subscribed"].includes(null!=(f=null==(t=k[null!=(m=null==(r=S.pub)?void 0:r.id)?m:0])?void 0:t.membership_state)?f:"unsubscribed"),E.is_free_subscribed=["free_signup","subscribed"].includes(null!=(b=null==(l=k[null!=(v=null==(a=S.pub)?void 0:a.id)?v:0])?void 0:l.membership_state)?b:"unsubscribed"),E.is_founding=["subscribed"].includes(null!=(Y=null==(s=k[null!=(g=null==(u=S.pub)?void 0:u.id)?g:0])?void 0:s.membership_state)?Y:"unsubscribed")&&!!(null==(c=k[null!=(_=null==(d=S.pub)?void 0:d.id)?_:0])?void 0:c.is_founding)),(0,o.Y)(j.A,{className:"subscribeWidget-DmciqD",pub:S.pub,user:E,foundingUpsell:"only_founding"===S.liveStream.audience,freeSignup:["free_signup","subscribed"].includes(null!=(C=null==(i=k[null!=(y=null==(n=S.pub)?void 0:n.id)?y:0])?void 0:i.membership_state)?C:"unsubscribed"),additionalPubIds:["only_free","everyone"].includes(S.liveStream.audience)?w.map(e=>{var i,n;return null!=(n=null==(i=e.pub)?void 0:i.id)?n:0}).filter(e=>!!e):[],source:R.VU.liveStreamPermalink,onSignup:["only_free","everyone"].includes(S.liveStream.audience)?()=>{location.reload()}:void 0,onConfirmationRequired:()=>{alert(I("Check your email to confirm subscription"))}})):null},eo=e=>{var i,n;let{pub:l,streamingUser:a,subscriptions:u,setSubscriptions:c,setOpen:d,foundingUpsell:m,audience:g}=e,{iString:Y}=(0,p.GO)(),y=(0,h.Jd)(),[C,S]=(0,s.useState)(!1),w=(0,$.rG)(),k=async e=>{if(e&&!C){if(S(!0),y&&"only_free"===g){try{await (0,v.x6)("/api/v1/reader/signup/pub",{method:"POST",json:{source:R.VU.liveStreamPermalink,publication_id:null==e?void 0:e.id,email:null==y?void 0:y.email,first_url:b.R9,first_referrer:b.b7,current_url:b.AT,current_referrer:b.uC,first_session_url:b.K0,first_session_referrer:b.OG}}),c(i=>(0,r._)((0,t._)({},i),{[e.id]:{is_founding:!1,membership_state:"free_signup"}})),d(!1),location.reload()}catch(e){(0,f.u4)(f.qY.FREE_SIGNUP_FAILED,{reason:e.message,source:R.VU.liveStreamPermalink}),alert("There was an error subscribing. Please try again."),S(!1)}return}try{await (0,v.x6)("/api/v1/reader/signup/pub",{method:"POST",json:(0,t._)({source:R.VU.liveStreamPermalink,publication_id:null==e?void 0:e.id,email:null==y?void 0:y.email,first_url:b.R9,first_referrer:b.b7,current_url:b.AT,current_referrer:b.uC,first_session_url:b.K0,first_session_referrer:b.OG},w)}),(0,f.$5)()}catch(e){(0,f.u4)(f.qY.FREE_SIGNUP_FAILED,{reason:e.message,source:R.VU.liveStreamPermalink})}window.location.href=(0,N.my9)(e,(0,t._)({utm_source:R.VU.liveStreamChat,next:document.location.href,utm_medium:R.Jn.web},m&&{plan:"founding"}))}};return(0,o.FD)(_.Ye,{gap:12,alignItems:"center",flex:"grow",children:[(0,o.Y)(x.eu,{user:a,size:40}),(0,o.FD)(_.VP,{flex:"grow",children:[(0,o.Y)(_.EY.B4,{fontWeight:"semibold",children:a.name}),(0,o.Y)(_.EY.B4,{color:"secondary",children:null==l?void 0:l.name})]}),(0,o.Y)(_.$n,{priority:"primary",size:"sm",disabled:C,onClick:()=>{k(l)},children:Y((null==(i=u[null!=(n=null==l?void 0:l.id)?n:0])?void 0:i.membership_state)==="free_signup"?"Upgrade":"Subscribe")})]})},ea=e=>{var i;let{liveStream:n,guests:t,open:r}=e,{iString:l,iTemplate:o}=(0,p.GO)(),a=(null==(i=n.pub)?void 0:i.name)||"",s=t.length>0,u="active"===n.liveStream.status,c=!n.liveStreamInformation.desktopPlaybackUrl,d=r||u&&c,h=e=>{let i=e[0]||"",n=e[1]||"",t=e[2]||"";return 0===e.length?"":1===e.length?i:2===e.length?o(Z(),i,n):3===e.length?o(J(),i,n,t):o(X(),e.slice(0,-1).join(", "),e[e.length-1]||"")},m=()=>[a,...t.map(e=>{var i;return(null==(i=e.pub)?void 0:i.name)||""})].filter(Boolean);switch(n.liveStream.audience){case"only_founding":return{title:s?l("This live stream is for founding members only"):o(Q(),a),subtitle:l("Become a founding member to watch now"),isOpen:d,showIndividualPubs:s};case"only_paid":return{title:s?l("This live stream is for paid subscribers only"):o(ee(),a),subtitle:l("Become a paid subscriber to watch now"),isOpen:d,showIndividualPubs:s};case"only_free":return{title:s?l("Subscribe for free to watch now"):o(ei(),a),subtitle:s?h(m()):l("Subscribe for free to watch now"),isOpen:d,showIndividualPubs:s};default:return{title:o(en(),h(m())),subtitle:"",isOpen:r,showIndividualPubs:s}}};var es=n(61616),eu=n(55696),ec=n(32485),ed=n.n(ec),ep=n(48697),eh=n(94328);function em(){let e=(0,l._)(["Subscribed to ",""]);return em=function(){return e},e}let ef=e=>{let{liveStream:i,guests:n,subscriptions:t,setSubscriptions:r,isHostsModalOpen:l,setIsHostsModalOpen:a,user:s}=e,{iString:u}=(0,p.GO)();return(0,o.FD)(k.aF,{isOpen:l,onClose:()=>a(!1),children:[(0,o.Y)(k.rQ,{showDivider:!0,showClose:!0,onClose:()=>a(!1),title:u(n.length?"Hosts":"Host")}),(0,o.Y)(k.cw,{children:(0,o.Y)(_.I1,{gap:20,children:[i,...n.map(e=>e)].map(e=>{var i,n,l;let{user:a,pub:u}=e,c=["free_signup","subscribed"].includes(null!=(l=null==(i=t[null!=(n=null==u?void 0:u.id)?n:0])?void 0:i.membership_state)?l:"unsubscribed");return(0,o.Y)(ev,{streamingUser:a,pub:u,isSubscribed:c,subscriptions:t,setSubscriptions:r,user:s})})})})]})},ev=e=>{var i,n;let{streamingUser:l,pub:a,isSubscribed:u,subscriptions:c,setSubscriptions:d,user:h}=e,{iString:m,iTemplate:f}=(0,p.GO)(),{popToast:v}=(0,C.d)(),[b,Y]=(0,s.useState)([]);return(0,o.FD)(_.Ye,{gap:12,alignItems:"center",children:[(0,o.Y)(x.dm,{user:l,size:40,utmSource:R.VU.liveStreamHostModal,linkProps:{target:"_blank"}}),(0,o.FD)(_.I1,{flex:"grow",children:[(0,o.Y)(eb,{streamingUser:l}),(0,o.Y)(eg,{pub:a})]}),a?(0,o.Y)(_.$n,{size:"sm",priority:"primary",disabled:u||b.includes(a.id)||["free_signup","subscribed"].includes(null!=(n=null==(i=c[a.id])?void 0:i.membership_state)?n:"unsubscribed"),onClick:async()=>{if(!h){window.location.href=(0,N.my9)(a,{utm_source:R.VU.liveStreamHostModal,next:document.location.href,utm_medium:R.Jn.web});return}if(a.id){Y(e=>[...e,a.id]);try{await (0,L.yc)(a.id,R.VU.liveStreamPermalink,{publication:null!=a?a:void 0,user:h,openPubInNewTabAfterSubscription:!1}),d(e=>(0,r._)((0,t._)({},e),{[a.id]:(0,r._)((0,t._)({},e[a.id]),{membership_state:"free_signup"})})),v(()=>(0,o.Y)(C.y,{Icon:P.A,text:f(em(),null==a?void 0:a.name)}))}catch(e){alert((0,g.uX)(e))}Y(e=>e.filter(e=>e!==a.id))}},children:m(u?"Subscribed":"Subscribe")}):null]},l.id)},eb=e=>{let{streamingUser:i}=e;return(0,o.Y)(_.EY.B4,{fontWeight:"semibold",children:(0,o.Y)(_.Yq,{href:(0,N.gYq)(i,{utm_source:R.VU.liveStreamHostModal}),target:"_blank",children:i.name})})},eg=e=>{let{pub:i}=e;return i?(0,o.Y)(_.EY.B4,{color:"secondary",children:(0,o.Y)(_.Yq,{href:(0,O.$_T)(i,{forceSubdomain:!0}),target:"_blank",children:i.name})}):null},eY=e=>{let{closeHref:i,liveStream:n,handle:t,guests:r,showSubscribeAllButton:l,isSubscribing:a,onSubscribeAll:u,hasEnded:c,viewerCount:d,subscriptions:p,setSubscriptions:h,user:m,isScheduled:f}=e,[v,b]=(0,s.useState)(!1);return(0,o.FD)(o.FK,{children:[(0,o.Y)(ef,{liveStream:n,guests:r,subscriptions:p,setSubscriptions:h,isHostsModalOpen:v,setIsHostsModalOpen:b,user:m}),(0,o.FD)(F.a,{children:[document.body&&(0,s.createPortal)((0,o.Y)(eD,{children:(0,o.FD)(_.fI,{minWidth:0,alignItems:"center",gap:8,children:[(0,o.Y)(eC,{closeHref:i,handle:t}),(0,o.Y)(e_,{liveStream:n,guests:r,showSubscribeAllButton:l,isSubscribing:a,onSubscribeAll:u,setIsHostsModalOpen:b})]})}),document.body),c||f?null:(0,o.Y)(_.fI,{position:"absolute",padding:16,gap:8,alignItems:"start",minWidth:0,className:"liveStreamHeaderViewerCount-UDCSmc",children:(0,o.FD)(eE,{children:[(0,o.Y)(eh.LM,{}),(0,o.Y)(eh.u8,{viewerCount:d})]})})]})]})},e_=e=>{var i;let{liveStream:n,guests:t,showSubscribeAllButton:r,isSubscribing:l,onSubscribeAll:a,setIsHostsModalOpen:s}=e;return(0,o.FD)(ek,{children:[(0,o.FD)(eI,{onClick:()=>s(!0),children:[(0,o.Y)(T.Z,{users:[n.user,...t.map(e=>e.user)],size:28,direction:"rtl"}),(0,o.FD)(_.VP,{paddingRight:20*!r,minWidth:0,children:[(0,o.Y)(eS,{children:[n.user.name,...t.map(e=>e.user.name)].filter(Boolean).join(", ")}),(0,o.Y)(ew,{children:[null==(i=n.pub)?void 0:i.name,...t.map(e=>{var i;return null==(i=e.pub)?void 0:i.name})].filter(Boolean).join(", ")})]})]}),r?(0,o.Y)(ey,{isSubscribing:l,onSubscribeAll:a}):null]})},ey=e=>{let{isSubscribing:i,onSubscribeAll:n}=e,{iString:t}=(0,p.GO)();return(0,o.Y)(_.$n,{className:"subscribeButton-CtrItP",priority:"primary",size:"sm",disabled:i,onClick:n,children:t("Subscribe")})},eC=e=>{let{closeHref:i,handle:n}=e;return(0,o.Y)(_.K0,{href:i,size:"sm",priority:"quaternary",rounded:!0,className:ed()(n.active&&"closeButtonHidden-PBnS9i"),children:(0,o.Y)(ep.A,{})})},eS=e=>{let{children:i}=e;return(0,o.Y)(_.EY.B4,{color:"vibrance-primary",weight:"medium",ellipsis:!0,children:i})},ew=e=>{let{children:i}=e;return(0,o.Y)(_.EY.B5,{color:"vibrance-secondary",opacity:70,ellipsis:!0,lineHeight:16,children:i})},ek=(0,_.I4)({display:"flex",direction:"row",alignItems:"center",gap:16,radius:"full",minWidth:0,paddingLeft:4,className:"authorPill-wbOG0c",pressable:"sm",wrap:"nowrap",userSelect:"none"}),eI=(0,_.I4)({display:"flex",direction:"row",gap:8,cursor:"pointer",alignItems:"center",minWidth:0,paddingLeft:2,height:40,sizing:"border-box"}),eE=(0,_.I4)({display:"flex",direction:"row",gap:8,alignItems:"center",className:"viewerCountContainer-XTwz_D"}),eD=(0,_.I4)({display:"flex",direction:"row",position:"absolute",padding:16,gap:8,alignItems:"start",minWidth:0,className:"liveStreamHeader-OLlNVf"});var eA=n(16291),eP=n(83873),eF=n(92636),ex=n(41086),eT=n(28700);function eL(){let e=(0,l._)(["Subscribed to "," and ",""]);return eL=function(){return e},e}function eN(){let e=(0,l._)(["Subscribed to ",", ",", and ",""]);return eN=function(){return e},e}function eO(){let e=(0,l._)(["Subscribed to ",", and ",""]);return eO=function(){return e},e}function eV(){let e=(0,l._)(["LIVE SOON: ",""]);return eV=function(){return e},e}function eR(){let e=(0,l._)(["LIVE NOW: ",""]);return eR=function(){return e},e}function ez(){let e=(0,l._)(["Starting "," at ",""]);return ez=function(){return e},e}function eB(){let e=(0,l._)([""," on Substack"]);return eB=function(){return e},e}function eU(e){var i,n,l,w,k,A;let{id:P,liveStream:F,liveStreamInvite:x,subscriptionToLiveStreamPub:T,subscriptionsToLiveStreamInvitedPub:L,smsInvite:O}=e;(0,S.y)();let{liveStream:V,setLiveStream:z}=(0,E.u)({liveStream:F||null}),[B,U]=(0,s.useState)(!!(0,ex.y)("show_test_run"));(0,s.useEffect)(()=>{P&&(0,v.x6)("/api/v1/live_stream/".concat(P)).then(e=>{z(e.activeLiveStream),e.activeLiveStream.pub&&(0,v.x6)("/api/v1/subscription/".concat(e.activeLiveStream.pub.id)).then(i=>{i.subscription&&j(n=>{var l,o;return e.activeLiveStream.pub?(0,r._)((0,t._)({},n),{[e.activeLiveStream.pub.id]:(0,r._)((0,t._)({},i.subscription),{role:null!=(o=null==(l=i.publicationUser)?void 0:l.role)?o:null})}):n})})})},[P]);let{iString:M,iTemplate:H}=(0,p.GO)(),[q,j]=(0,s.useState)((0,t._)({},T?{[null!=(w=null==V||null==(i=V.pub)?void 0:i.id)?w:0]:T}:{},L));(0,s.useEffect)(()=>{(null==V?void 0:V.liveStream.scheduled_at)&&"scheduled"===V.liveStream.status&&(0,f.u4)(f.qY.LIVE_STREAM_SCHEDULED_PERMALINK_VISITED,{liveStreamId:V.liveStream.id,addToCalendar:(0,ex.y)("add_to_calendar")})},[null==V?void 0:V.liveStream.scheduled_at,null==V?void 0:V.liveStream.status]);let G=(0,s.useCallback)(e=>{let{message:i}=e;if(i.invited_user_primary_publication&&!q[i.invited_user_primary_publication.id]){let e=i.invited_user_primary_publication;(0,v.x6)("/api/v1/subscription/".concat(e.id)).then(i=>{i.subscription&&j(n=>{var l,o;return(0,r._)((0,t._)({},n),{[e.id]:(0,r._)((0,t._)({},i.subscription),{role:null!=(o=null==(l=i.publicationUser)?void 0:l.role)?o:null})})})})}},[q]),{guests:K,hasEnded:$,isScheduled:Z,viewerCount:J}=(0,m.p)({liveStream:V,onGuestJoined:G}),X=(0,u.V)(),Q=(0,h.Jd)(),[ee,ei]=(0,s.useState)(!1),[en,er]=(0,s.useState)(!1),{popToast:el}=(0,C.d)(),eo=[null==V?void 0:V.pub,...K.map(e=>e.pub)].filter(e=>!!e).every(e=>{var i,n;return["free_signup","subscribed"].includes(null!=(n=null==(i=q[e.id])?void 0:i.membership_state)?n:"unsubscribed")}),ea=async()=>{var e,i;if(!Q)return void ei(!0);let n=[null==V||null==(e=V.pub)?void 0:e.id,...K.map(e=>{var i;return null==(i=e.pub)?void 0:i.id})].filter(Boolean);if(n.length){er(!0);try{let{subscriptionResults:e}=await (0,v.x6)("/api/v1/bulk_signup",{method:"POST",json:{publications:n,source:R.VU.liveStreamPermalink,current_referrer:b.uC,current_url:b.AT,first_referrer:b.b7,first_session_referrer:b.OG,first_session_url:b.K0,first_url:b.R9}});if(e.every(e=>e.requires_confirmation))return void alert(M("Check your email to confirm subscription"));j(e=>Object.fromEntries([...n.map(e=>[e,{is_founding:!1,membership_state:"free_signup",role:null}]),...Object.entries(e).map(e=>{let[i,n]=e;return[i,(0,r._)((0,t._)({},n),{membership_state:["free_signup","subscribed"].includes(null==n?void 0:n.membership_state)?null==n?void 0:n.membership_state:"free_signup"})]})]));let l=[null==V?void 0:V.pub,...K.map(e=>e.pub)].filter(e=>{var i,n,t;return!["free_signup","subscribed"].includes(null!=(t=null==q||null==(i=q[null!=(n=null==e?void 0:e.id)?n:0])?void 0:i.membership_state)?t:"unsubscribed")}).map(e=>null==e?void 0:e.name).filter(Boolean),s=0===l.length?"":1===l.length&&l[0]?"Subscribed to ".concat(l[0]):2===l.length&&l[0]&&l[1]?H(eL(),l[0],l[1]):3===l.length&&l[0]&&l[1]&&l[2]?H(eN(),l[0],l[1],l[2]):H(eO(),l.slice(0,-1).join(", "),null!=(i=l[l.length-1])?i:"");el(()=>(0,o.Y)(C.y,{Icon:a.A,text:s}))}catch(e){alert((0,g.uX)(e))}er(!1)}};if(!(null==V?void 0:V.liveStream.id))return(0,o.Y)(y.y$,{});let ec=(null==Q?void 0:Q.age_verification)&&Q.age_verification.status!==eP.Y.CompletedAdult,ed=(0,ex.y)("from_scheduling")?"".concat((0,eF.$_)(null==V?void 0:V.pub),"/publish/home"):(0,ex.y)("fromPub")?(0,eF.$_)(null==V?void 0:V.pub):(0,eT.gY)(null==V?void 0:V.user,{utm_source:R.VU.liveStreamExit});return(0,o.FD)(u.m,{handle:X,children:[(0,o.Y)(d.Metadata,{title:Z?H(eV(),V.liveStream.title):H(eR(),V.liveStream.title),description:Z?H(ez(),(0,eA.A)(V.liveStream.scheduled_at).tz("America/New_York").format("MMM D"),(0,eA.A)(V.liveStream.scheduled_at).tz("America/New_York").format("h:mm A z")):H(eB(),V.user.name),image:(0,N.ADu)(V),isLargeImage:!0}),(0,o.Y)(I,{isOpen:B,onClose:()=>U(!1)}),(0,o.Y)(et,{liveStream:V,guests:K,subscriptions:q,setSubscriptions:j,open:ee,setOpen:ei}),ec?(0,o.Y)(_.I1,{flex:"grow",alignItems:"center",justifyContent:"center",style:{height:"var(--full-height)"},children:(0,o.Y)(Y.az,{style:{flex:"none"},children:(0,o.Y)(c.T,{content:{id:V.liveStream.id,age_verification:{status:null!=(k=null==Q||null==(n=Q.age_verification)?void 0:n.status)?k:void 0,template_id:null!=(A=null==Q||null==(l=Q.age_verification)?void 0:l.template_id)?A:void 0}},description:"This live stream is disabled due to your country's Online Safety Act content restrictions",source:"live_stream"})})}):(0,o.FD)(eH,{children:[(0,o.FD)(eM,{children:[(0,o.Y)(eY,{closeHref:ed,liveStream:V,handle:X,guests:K,showSubscribeAllButton:!eo&&!$,isSubscribing:en,onSubscribeAll:ea,hasEnded:$,isScheduled:Z,viewerCount:J,subscriptions:q,setSubscriptions:j,user:Q}),$?(0,o.Y)(W,{liveStream:V,guests:K,isSubscribedToAll:eo,subscriptions:q,setSubscriptions:j}):Z?(0,o.Y)(es.m,{liveStreamInvite:x,liveStream:V,subscriptions:q,smsInvite:O}):V.liveStreamInformation.desktopPlaybackUrl?(0,o.Y)(eu.u,{liveStream:V,handle:X,autoPlay:!0}):(0,o.Y)(eu.A,{liveStream:V})]}),$||Z?null:(0,o.Y)(D.zK,{liveStream:V,handle:X,subscriptions:q,setSubscriptions:j})]})]})}let eM=(0,_.I4)({display:"flex",direction:"row",flex:"grow",justifyContent:"center",alignItems:"center",className:"videoContainer-bFmoVz"}),eH=(0,_.I4)({display:"flex",direction:"row",flex:"grow",alignItems:"center",className:"container-hbjpWY"})},61616:function(e,i,n){n.d(i,{m:()=>et});var t=n(79785),r=n(4006),l=n(32307),o=n(76987),a=n(48697),s=n(45773),u=n(17402),c=n(47963),d=n(23623),p=n(69277),h=n(70408),m=n(32641),f=n(97731);let v=e=>{var{size:i=24,fill:n="#363737"}=e,t=(0,m._)(e,["size","fill"]);return(0,r.Y)(f.A,(0,h._)((0,p._)({},t),{name:"HandIcon",svgParams:{height:i,width:i,viewBox:"0 0 24 24",fill:"none"},children:(0,r.Y)("path",{d:"M3.83496 14.9536V6.80225C3.83496 6.52002 3.9318 6.28206 4.12549 6.08838C4.31917 5.89469 4.55713 5.79785 4.83936 5.79785C5.11605 5.79785 5.35124 5.89469 5.54492 6.08838C5.73861 6.28206 5.83545 6.52002 5.83545 6.80225V11.9238C5.93506 11.863 6.0402 11.8021 6.15088 11.7412C6.26709 11.6803 6.38607 11.6195 6.50781 11.5586V4.2124C6.50781 3.93018 6.60465 3.69499 6.79834 3.50684C6.99202 3.31315 7.22721 3.21631 7.50391 3.21631C7.7806 3.21631 8.01579 3.31315 8.20947 3.50684C8.40316 3.69499 8.5 3.93018 8.5 4.2124V10.9941C8.61621 10.972 8.73242 10.9554 8.84863 10.9443C8.96484 10.9277 9.08105 10.9139 9.19727 10.9028V3.52344C9.19727 3.24121 9.29134 3.00326 9.47949 2.80957C9.67318 2.61589 9.91113 2.51904 10.1934 2.51904C10.4756 2.51904 10.7135 2.61589 10.9072 2.80957C11.1009 3.00326 11.1978 3.24121 11.1978 3.52344V10.9941C11.314 11.0163 11.4274 11.0439 11.5381 11.0771C11.6488 11.1048 11.7567 11.138 11.8618 11.1768V4.69385C11.8618 4.41162 11.9559 4.17367 12.144 3.97998C12.3377 3.7863 12.5757 3.68945 12.8579 3.68945C13.1401 3.68945 13.3753 3.7863 13.5635 3.97998C13.7572 4.17367 13.854 4.41162 13.854 4.69385V13.5093C13.854 13.6421 13.8761 13.7334 13.9204 13.7832C13.9702 13.8275 14.0311 13.8496 14.103 13.8496C14.1639 13.8496 14.222 13.8275 14.2773 13.7832C14.3327 13.7389 14.3853 13.6559 14.4351 13.5342L15.6055 11.0024C15.777 10.6427 15.9652 10.3771 16.1699 10.2056C16.3802 10.034 16.632 9.96484 16.9253 9.99805C17.1854 10.0257 17.3874 10.1309 17.5312 10.3135C17.6807 10.4906 17.7415 10.7091 17.7139 10.9692C17.7028 11.1242 17.6585 11.3345 17.5811 11.6001C17.5091 11.8657 17.4233 12.1535 17.3237 12.4634C17.2297 12.7733 17.1383 13.0693 17.0498 13.3516C16.9391 13.7057 16.8174 14.0848 16.6846 14.4888C16.5518 14.8927 16.4051 15.305 16.2446 15.7256C16.0897 16.1406 15.9154 16.5474 15.7217 16.9458C15.5335 17.3387 15.3288 17.7012 15.1074 18.0332C14.5264 19.0182 13.8097 19.7542 12.9575 20.2412C12.1108 20.7337 11.0705 20.98 9.83643 20.98C8.97868 20.98 8.18457 20.8444 7.4541 20.5732C6.72363 20.3021 6.08724 19.9064 5.54492 19.3862C5.00814 18.866 4.58757 18.2352 4.2832 17.4937C3.98438 16.7466 3.83496 15.8999 3.83496 14.9536Z",stroke:"none",fill:n,style:{fill:n,fillOpacity:"1"}})}))},b=e=>{var{size:i=24,fill:n="#EEEEEE"}=e,t=(0,m._)(e,["size","fill"]);return(0,r.Y)(f.A,(0,h._)((0,p._)({},t),{name:"KeyOffIcon",svgParams:{height:i,width:i,stroke:"none",viewBox:"0 0 33 33"},children:(0,r.Y)("path",{d:"M16.5 4.34766C15.5781 4.34766 14.7266 4.54297 13.9453 4.93359C13.1719 5.31641 12.5117 5.83984 11.9648 6.50391C11.418 7.16016 11.0391 7.91016 10.8281 8.75391L9.19922 7.125C9.58984 6.17188 10.1445 5.32813 10.8633 4.59375C11.5898 3.85937 12.4336 3.28516 13.3945 2.87109C14.3633 2.45703 15.3984 2.25 16.5 2.25C17.6016 2.25 18.6328 2.45703 19.5938 2.87109C20.5547 3.27734 21.3984 3.84375 22.125 4.57031C22.8594 5.29688 23.4297 6.14062 23.8359 7.10156C24.2422 8.0625 24.4453 9.08984 24.4453 10.1836C24.4453 11.7227 24.0195 13.125 23.168 14.3906C22.3242 15.6484 21.1172 16.6719 19.5469 17.4609L17.9531 15.8555C18.8438 15.5977 19.6172 15.1875 20.2734 14.625C20.9297 14.0625 21.4375 13.4023 21.7969 12.6445C22.1641 11.8789 22.3477 11.0586 22.3477 10.1836C22.3477 9.10547 22.0859 8.125 21.5625 7.24219C21.0391 6.35938 20.3359 5.65625 19.4531 5.13281C18.5703 4.60937 17.5859 4.34766 16.5 4.34766ZM16.5 9.86719C15.9766 9.86719 15.5273 9.68359 15.1523 9.31641C14.7852 8.94141 14.6016 8.49219 14.6016 7.96875C14.6016 7.44531 14.7852 7 15.1523 6.63281C15.5195 6.26563 15.9688 6.08203 16.5 6.08203C17.0234 6.08203 17.4727 6.26563 17.8477 6.63281C18.2227 7 18.4102 7.44531 18.4102 7.96875C18.4102 8.49219 18.2227 8.94141 17.8477 9.31641C17.4727 9.68359 17.0234 9.86719 16.5 9.86719ZM17.3906 31.3359C17.1328 31.5859 16.8359 31.7031 16.5 31.6875C16.1719 31.6719 15.875 31.5508 15.6094 31.3242L13.6992 29.6602C13.5117 29.5039 13.3789 29.3125 13.3008 29.0859C13.2305 28.8672 13.1953 28.6523 13.1953 28.4414V18.2695L15.2344 20.2969V27.9844L16.5 29.25L18.9141 26.8008L17.332 25.2422V22.8633L21.0586 26.5781C21.1914 26.7188 21.2617 26.8945 21.2695 27.1055C21.2852 27.3242 21.1992 27.5273 21.0117 27.7148L17.3906 31.3359ZM4.37109 7.20703C4.19141 7.02734 4.10156 6.80859 4.10156 6.55078C4.10156 6.28516 4.19141 6.0625 4.37109 5.88281C4.55078 5.70313 4.77344 5.61719 5.03906 5.625C5.29688 5.625 5.51562 5.71484 5.69531 5.89453L27.1289 27.3047C27.3086 27.4844 27.3984 27.7031 27.3984 27.9609C27.3984 28.2188 27.3086 28.4414 27.1289 28.6289C26.9492 28.8008 26.7305 28.8867 26.4727 28.8867C26.2148 28.8945 25.9922 28.8086 25.8047 28.6289L4.37109 7.20703Z",fill:n,style:{fill:n,fillOpacity:"1"}})}))},g=e=>{let{size:i=24,fill:n="#363737"}=e;return(0,r.Y)("svg",{xmlns:"http://www.w3.org/2000/svg",width:i,height:i,viewBox:"0 0 24 24",fill:"none",children:(0,r.Y)("path",{d:"M19.0889 13.667C19.0889 14.4251 18.9754 15.0892 18.7485 15.6592C18.5216 16.2292 18.1536 16.7632 17.6445 17.2612C17.141 17.7537 16.4741 18.2573 15.644 18.772C14.814 19.2922 13.7985 19.8732 12.5977 20.5151C12.4925 20.5705 12.3846 20.612 12.2739 20.6396C12.1688 20.6729 12.0775 20.6895 12 20.6895C11.9225 20.6895 11.8285 20.6729 11.7178 20.6396C11.6126 20.612 11.5047 20.5705 11.394 20.5151C10.1932 19.8732 9.17773 19.2949 8.34766 18.7803C7.52311 18.2656 6.85628 17.762 6.34717 17.2695C5.84359 16.7715 5.47559 16.2375 5.24316 15.6675C5.01628 15.092 4.90283 14.4251 4.90283 13.667V7.44971C4.90283 6.91292 5.00521 6.51725 5.20996 6.2627C5.42025 6.00814 5.75228 5.78402 6.20605 5.59033C6.3776 5.51286 6.62386 5.41602 6.94482 5.2998C7.27132 5.17806 7.63102 5.04801 8.02393 4.90967C8.42236 4.77132 8.81527 4.63298 9.20264 4.49463C9.59554 4.35628 9.94971 4.23177 10.2651 4.12109C10.5861 4.01042 10.8324 3.92741 11.0039 3.87207C11.1644 3.8278 11.3304 3.79183 11.502 3.76416C11.6735 3.73096 11.8395 3.71436 12 3.71436C12.1549 3.71436 12.321 3.73096 12.498 3.76416C12.6751 3.79736 12.8411 3.83333 12.9961 3.87207C13.1621 3.92188 13.4056 4.00212 13.7266 4.11279C14.0475 4.21794 14.4045 4.33968 14.7974 4.47803C15.1903 4.61637 15.5804 4.75749 15.9678 4.90137C16.3607 5.03971 16.7176 5.16976 17.0386 5.2915C17.3651 5.41325 17.6169 5.51286 17.7939 5.59033C18.2533 5.77848 18.5825 6.0026 18.7817 6.2627C18.9865 6.51725 19.0889 6.91292 19.0889 7.44971V13.667ZM11.8755 18.7388V5.46582C11.8201 5.46582 11.7648 5.47412 11.7095 5.49072C11.6541 5.50179 11.5794 5.52393 11.4854 5.55713C11.2861 5.6346 11.0399 5.72868 10.7466 5.83936C10.4588 5.9445 10.1462 6.05794 9.80859 6.17969C9.47103 6.30143 9.12793 6.42318 8.7793 6.54492C8.43066 6.66667 8.09587 6.78564 7.7749 6.90186C7.45947 7.01253 7.18278 7.11214 6.94482 7.20068C6.82308 7.24495 6.74284 7.30583 6.7041 7.3833C6.66536 7.46077 6.646 7.57422 6.646 7.72363V13.3599C6.646 13.952 6.729 14.4556 6.89502 14.8706C7.06104 15.2856 7.33219 15.673 7.7085 16.0327C8.09033 16.3869 8.59391 16.7632 9.21924 17.1616C9.8501 17.5601 10.6248 18.0332 11.5435 18.5811C11.6209 18.6309 11.6846 18.6668 11.7344 18.689C11.7842 18.7111 11.8312 18.7277 11.8755 18.7388Z",fill:n,style:{fill:n,fillOpacity:"1"}})})};var Y=n(79391),_=n(84605),y=n(46271),C=n(86500),S=n(94729),w=n(68349),k=n(38914),I=n(24078),E=n(17028),D=n(48535),A=n(16993),P=n(59482),F=n(36372),x=n(73357),T=n(16291),L=n(39318),N=n(92636),O=n(41086),V=n(49807),R=n(98949),z=n(57324);function B(){let e=(0,t._)(["Hey "," - Please accept this invite to my scheduled live stream on "," at "," in the Substack app: ",". Youll need the Substack iPhone or Android app with notifications on."]);return B=function(){return e},e}function U(){let e=(0,t._)(["Please accept this invite to my scheduled live stream on "," at "," in the Substack app: ",". Youll need the Substack iPhone or Android app with notifications on."]);return U=function(){return e},e}function M(){let e=(0,t._)(["Please accept this invite to my scheduled live stream on "," at "," in the Substack app: ",". Youll need the Substack iPhone or Android app with notifications on."]);return M=function(){return e},e}function H(){let e=(0,t._)([""," invited you to co-host this live video"]);return H=function(){return e},e}function W(){let e=(0,t._)([""," will start on "," at ",""]);return W=function(){return e},e}function q(){let e=(0,t._)(["You're all set and will receive an invite pop-up in the app or in your creator dashboard on desktop when ",' starts "','"']);return q=function(){return e},e}function j(){let e=(0,t._)([""," is ready for your live video"]);return j=function(){return e},e}function G(){let e=(0,t._)([""," needs the Substack app"]);return G=function(){return e},e}function K(){let e=(0,t._)(["Successfully blocked ",""]);return K=function(){return e},e}function $(){let e=(0,t._)(["Block ",""]);return $=function(){return e},e}function Z(){let e=(0,t._)(["Successfully blocked invites from strangers"]);return Z=function(){return e},e}function J(){let e=(0,t._)(["Block invites from strangers"]);return J=function(){return e},e}function X(){let e=(0,t._)(["Only people you follow can invite you"]);return X=function(){return e},e}function Q(){let e=(0,t._)(["Message "," to install the app"]);return Q=function(){return e},e}function ee(){let e=(0,t._)(["Message your guest to install the app"]);return ee=function(){return e},e}function ei(){let e=(0,t._)(["Copy and send this reminder to "," via SMS, email or direct message."]);return ei=function(){return e},e}function en(){let e=(0,t._)(["Copy and send this reminder to your guest via SMS, email or direct message."]);return en=function(){return e},e}let et=e=>{var i,n,t,c,p;let{liveStream:h,liveStreamInvite:m,smsInvite:f,subscriptions:L}=e,{language:et,iString:el,iTemplate:eo}=(0,_.GO)(),ea=(0,y.Jd)(),[es,eu]=(0,u.useState)(!1),[ec,ed]=(0,u.useState)(m),[ep,eh]=(0,u.useState)(!1),[em,ef]=(0,u.useState)(!!(0,O.y)("decline_invite_id")),[ev,eb]=(0,u.useState)(!1),[eg,eY]=(0,u.useState)(!1),[e_,ey]=(0,u.useState)(!1),[eC,eS]=(0,u.useState)(!1),ew=(0,F.d)(),{changeSetting:ek}=(0,y.ur)(),eI="undefined"!=typeof window&&(null==(i=window._preloads)?void 0:i.original_url)?(0,O.y)(window._preloads.original_url,"token"):null,[eE,eD]=(0,u.useState)(!1),[eA,eP]=(0,u.useState)(!1),[eF,ex]=(0,u.useState)(null),[eT,eL]=(0,u.useState)(null),[eN,eO]=(0,u.useState)(h.liveStream.scheduled_at?new Date(h.liveStream.scheduled_at):new Date),[eV,eR]=(0,u.useState)(!1),[ez,eB]=(0,u.useState)(null!=(c=null==ea?void 0:ea.email)?c:""),[eU,eM]=(0,u.useState)(!1),[eH,eW]=(0,u.useState)(!1),eq=!!ec||"everyone"===h.liveStream.audience||"only_free"===h.liveStream.audience&&Object.values(L).some(e=>"free_signup"===e.membership_state||"subscribed"===e.membership_state)||"only_paid"===h.liveStream.audience&&Object.values(L).some(e=>"subscribed"===e.membership_state)||"only_founding"===h.liveStream.audience&&Object.values(L).some(e=>"subscribed"===e.membership_state&&e.is_founding),ej=(null==ea?void 0:ea.id)===h.liveStream.user_id||(null==ea?void 0:ea.is_global_admin),eG=h.liveStream.scheduled_at?(0,T.A)(h.liveStream.scheduled_at).diff((0,T.A)(),"minutes"):1/0,eK=h.liveStream.scheduled_at&&new Intl.DateTimeFormat(et,{month:"short",day:"numeric"}).format(new Date(h.liveStream.scheduled_at)),e$=h.liveStream.scheduled_at&&new Intl.DateTimeFormat(et,{hour:"numeric",minute:"numeric",hour12:!0}).format(new Date(h.liveStream.scheduled_at)),eZ=(0,V.Xrv)({liveStreamId:h.liveStream.id,params:{appStoreRedirect:!0}}),eJ=(0,V.Xrv)({liveStreamId:h.liveStream.id,params:{smsInviteId:null==eT?void 0:eT.id}}),eX=(null==eF?void 0:eF.name)?eo(B(),eF.name,null!=eK?eK:"",null!=e$?e$:"",eZ):eF?eo(U(),null!=eK?eK:"",null!=e$?e$:"",eZ):eo(M(),null!=eK?eK:"",null!=e$?e$:"",eJ),eQ=(0,x._)(h.liveStream),e0=async()=>{eR(!0);try{await (0,S.x6)("/api/v1/live_stream/".concat(h.liveStream.id,"/schedule"),{method:"PUT",json:{scheduledAt:eN}}),eD(!1),ew.popToast(()=>(0,r.Y)(F.y,{text:el("Successfully updated live video schedule")})),window.location.reload()}catch(e){alert((0,S.Qd)(e))}finally{eR(!1)}},e1=()=>{let e=(0,V.Xrv)({liveStreamId:h.liveStream.id,utm_source:z.VU.liveStreamScheduledUpsell});(0,w.lW)(e),ew.popToast(()=>(0,r.Y)(F.y,{text:el("Copied link to clipboard")}))};return f?(0,r.FD)(d.a,{children:[(0,r.Y)(E.VP,{alignItems:"center",gap:20,width:320,padding:24,children:"cancelled"===f.status?(0,r.FD)(r.FK,{children:[(0,r.Y)(E.pT,{bg:"secondary",radius:"full",width:64,height:64,alignItems:"center",justifyContent:"center",children:(0,r.Y)(b,{size:32})}),(0,r.Y)(E.EY.H4,{weight:"medium",color:"white",textAlign:"center",children:el("This invite link is invalid")}),(0,r.Y)(E.EY.B3,{color:"secondary",textAlign:"center",children:el("Ask the host to send another link if you think you should be able to join.")})]}):"accepted"===f.status||eH?(0,r.FD)(r.FK,{children:[(0,r.Y)(E.pT,{bg:"secondary",radius:"full",width:64,height:64,alignItems:"center",justifyContent:"center",children:(0,r.Y)(l.A,{stroke:"white",size:32})}),(0,r.FD)(E.EY.H4,{weight:"medium",color:"white",textAlign:"center",children:[el("This live video starts")," ",eK," ",el("at")," ",e$]}),(0,r.Y)(E.EY.B3,{color:"secondary",textAlign:"center",children:el("You'll need the Substack app to join.")}),(0,r.Y)(E.$n,{priority:"primary",onClick:()=>{(0,R.Fr)()?(0,w.V2)((0,V.Xrv)({liveStreamId:h.liveStream.id,utm_source:z.VU.liveStreamScheduledUpsell,params:{appStoreRedirect:"true"}}),{local_navigation:!1}):eu(!0)},children:el("Join in app")})]}):(0,r.FD)(r.FK,{children:[(0,r.Y)(E.pT,{bg:"secondary",radius:"full",width:64,height:64,alignItems:"center",justifyContent:"center",children:(0,r.Y)(o.A,{stroke:"white",size:32})}),(0,r.Y)(E.EY.H4,{weight:"medium",color:"white",textAlign:"center",children:eo(H(),h.user.name)}),(0,r.Y)(E.I1,{gap:12,width:"100%",children:(0,r.Y)(P.U,{placeholder:el("Enter your email"),placement:"end",priority:"primary",disabled:!!(null==ea?void 0:ea.email),button:(0,r.Y)(E.$n,{priority:"primary",loading:eU,onClick:async()=>{eM(!0);try{await (0,S.x6)("/api/v1/live_stream/".concat(h.liveStream.id,"/sms_invite/").concat(f.id,"/accept"),{method:"PUT",json:{email:ez}}),ew.popToast(()=>(0,r.Y)(F.y,{text:el("Successfully accepted SMS invite")})),eW(!0)}catch(e){alert((0,S.Qd)(e))}finally{eM(!1)}},children:eU?"":el("Accept")}),value:ez,onChange:e=>eB(e.currentTarget.value)})})]})}),(0,r.Y)(er,{isOpen:es,onClose:()=>eu(!1),liveStream:h})]}):(0,r.FD)(r.FK,{children:[(0,r.Y)(d.a,{children:ec&&"pending"!==ec.status?(0,r.FD)(E.VP,{alignItems:"center",gap:20,width:320,padding:24,children:[(0,r.Y)(E.pT,{bg:"secondary",radius:"full",width:64,height:64,alignItems:"center",justifyContent:"center",children:(0,r.Y)(b,{size:32})}),(0,r.Y)(E.EY.B1,{color:"white",children:el("This invite link is invalid")}),(0,r.Y)(E.EY.B3,{color:"secondary",textAlign:"center",children:el("If you think you should be able to join, please ask the host to send another link.")})]}):(0,r.FD)(E.VP,{alignItems:"center",gap:20,width:400,padding:24,children:[(0,r.Y)(l.A,{size:32}),(0,r.FD)(E.VP,{alignItems:"center",gap:8,children:[eK&&e$?(0,r.Y)(E.EY.H4,{weight:"medium",color:"white",textAlign:"center",children:eo(W(),h.liveStream.title,eK,e$)}):(0,r.Y)(E.EY.H4,{weight:"medium",color:"white",textAlign:"center",children:el("This live video will start soon")}),(null==ec?void 0:ec.status)==="pending"?(0,r.Y)(E.EY.B3,{color:"secondary",textAlign:"center",children:eo(q(),h.user.name,h.liveStream.title)}):eq?null:(0,r.Y)(E.EY.B3,{color:"secondary",textAlign:"center",children:el("Subscribe now to watch this live video when it starts")})]}),ej?(0,r.FD)(u.Fragment,{children:[(0,r.Y)(E.EY.B3,{color:"secondary",textAlign:"center",children:el("You can start the live video up to 15 minutes before the scheduled start time")}),h.pendingLiveStreamGuests.length>0&&(0,r.FD)(E.VP,{gap:12,bg:"secondary",radius:"md",padding:12,width:400,children:[(0,r.Y)(E.EY.B4,{color:"secondary",fontWeight:"medium",textTransform:"uppercase",children:el("CO-HOSTS")}),h.pendingLiveStreamGuests.map(e=>{let{user:i}=e,n=i.reader_installed_at?"ready":"needs_app",t=i.name||i.handle||i.email||"Unknown";return(0,r.FD)(E.pT,{alignItems:"center",justifyContent:"space-between",width:"100%",children:[(0,r.FD)(E.pT,{alignItems:"center",gap:8,children:[(0,r.Y)(I.eu,{size:24,user:i}),(0,r.Y)(E.EY.B3,{color:"white",children:"ready"===n?eo(j(),t):eo(G(),t)})]}),"needs_app"===n&&(0,r.Y)(E.$n,{priority:"primary",size:"sm",onClick:()=>{ex(i),eL(null),eP(!0)},children:el("Remind")})]})}),null==(n=h.liveStream.pendingLiveStreamSmsInvites)?void 0:n.map(e=>(0,r.FD)(E.pT,{alignItems:"center",justifyContent:"space-between",width:"100%",children:[(0,r.FD)(E.pT,{alignItems:"center",gap:8,children:[(0,r.Y)(I.eu,{size:24}),(0,r.Y)(E.EY.B3,{color:"white",children:"SMS guest hasnt setup an account"})]}),(0,r.Y)(E.$n,{priority:"primary",size:"sm",onClick:()=>{ex(null),eL(e),eP(!0)},children:el("Remind")})]}))]}),(0,r.Y)(E.pT,{gap:12,width:"100%",children:eG<=15?(0,r.FD)(r.FK,{children:[(0,r.Y)(E.$n,{priority:"primary",flex:"grow",onClick:()=>{let e=(0,N.$_)(h.pub);(0,w.V2)("".concat(e,"/publish/live-stream/").concat(h.liveStream.id,"?startPractice=true"))},children:el("Start live video")}),(0,r.Y)(E.$n,{priority:"secondary",flex:"grow",onClick:e1,children:el("Copy link")})]}):(0,r.FD)(r.FK,{children:[(0,r.Y)(E.$n,{priority:"primary",flex:"grow",onClick:e1,children:el("Copy link")}),(0,r.Y)(E.$n,{priority:"secondary",flex:"grow",onClick:()=>{h.liveStream.scheduled_at?eO(new Date(h.liveStream.scheduled_at)):eO(new Date),eD(!0)},children:el("Edit")})]})})]}):ec?(0,r.Y)(E.VP,{alignItems:"center",gap:8,children:ec&&"pending"===ec.status?(0,r.Y)(E.$n,{className:"declineButton-lXoT5b",priority:"secondary",loading:ep,onClick:async()=>{eh(!0);try{let{liveStreamInvite:e}=await (0,S.x6)("/api/v1/live_stream/".concat(h.liveStream.id,"/invite/").concat(null==m?void 0:m.id,"/decline"),{method:"PUT",json:{token:eI}});ed(e),ef(!0)}catch(e){alert((0,S.Qd)(e))}finally{eh(!1)}},children:el("Decline invite")}):null}):ea&&eq||!h.pub?(0,r.Y)(E.VP,{alignItems:"center",gap:8,children:(0,r.Y)(k.L,{priority:"primary",handleClick:e=>{(0,C.u4)(C.qY.ADD_TO_CALENDAR_CLICKED,{liveStreamId:h.liveStream.id,surface:"live-stream-permalink",type:e})},event:eQ,menuProps:{onOpen:()=>{(0,S.x6)("/api/v1/live_stream/".concat(h.liveStream.id,"/rsvp"),{method:"PUT",json:{token:eI}})}}})}):(0,r.Y)(Y.A,{pub:h.pub,user:ea,freeSignup:["free_signup","subscribed"].includes(null!=(p=null==(t=L[h.pub.id])?void 0:t.membership_state)?p:""),foundingUpsell:"only_founding"===h.liveStream.audience})]})}),(0,r.FD)(A.aF,{isOpen:em,onClose:()=>ef(!1),children:[(0,r.FD)(E.I1,{gap:20,padding:16,alignItems:"center",children:[(0,r.Y)(E.pT,{bg:"accent-red",radius:"full",width:64,height:64,alignItems:"center",justifyContent:"center",children:(0,r.Y)(E.pT,{className:"headerIcon-vFzD3Y",radius:"full",width:32,height:32,alignItems:"center",justifyContent:"center",children:(0,r.Y)(a.A,{stroke:"white"})})}),(0,r.FD)(E.I1,{gap:4,children:[(0,r.Y)(E.EY.B1,{fontWeight:"medium",textAlign:"center",children:el("Invite declined")}),(0,r.Y)(E.EY.B3,{color:"secondary",textAlign:"center",children:el("You will no longer receive notifications for this live video")})]}),(0,r.Y)(E.cG,{className:"divider-RTh_Tm"})]}),(0,r.FD)(E.I1,{gap:24,paddingX:16,paddingY:12,children:[(0,r.FD)(E.pT,{gap:12,alignItems:"center",children:[(0,r.Y)(E.K0,{disabled:eg,onClick:async()=>{eY(!0);try{await (0,S.x6)("/api/v1/blocks/".concat(h.user.id),{method:"POST",json:{type:"block",surface:"live-stream-scheduled-card",token:eI}}),ew.popToast(()=>(0,r.Y)(F.y,{text:eo(K(),h.user.name)})),eb(!0)}catch(e){alert((0,S.Qd)(e))}finally{eY(!1)}},size:"md",children:eg?(0,r.Y)(E.Jb,{priority:"secondary"}):ev?(0,r.Y)(s.A,{size:24}):(0,r.Y)(v,{size:24})}),(0,r.Y)(E.EY.B3,{fontWeight:"medium",fontSize:15,children:eo($(),h.user.name)})]}),(0,r.FD)(E.pT,{gap:12,children:[(0,r.Y)(E.K0,{disabled:eC,onClick:async()=>{eS(!0);try{await ek("liveStreamAcceptableInviteLevel","follows_and_subscriptions","text",{token:eI}),ew.popToast(()=>(0,r.Y)(F.y,{text:eo(Z())})),ey(!0)}catch(e){alert((0,S.Qd)(e))}finally{eS(!1)}},size:"md",children:eC?(0,r.Y)(E.Jb,{priority:"secondary"}):e_?(0,r.Y)(s.A,{size:24}):(0,r.Y)(g,{size:24})}),(0,r.FD)(E.I1,{children:[(0,r.Y)(E.EY.B3,{fontWeight:"medium",fontSize:15,children:eo(J())}),(0,r.Y)(E.EY.B3,{color:"secondary",children:eo(X())})]})]})]}),(0,r.Y)(E.pT,{padding:16,children:(0,r.Y)(E.$n,{flex:"grow",priority:"secondary",onClick:()=>ef(!1),children:el("Done")})})]}),(0,r.Y)(er,{isOpen:es,onClose:()=>eu(!1),liveStream:h}),(0,r.FD)(A.aF,{isOpen:eE,onClose:()=>eD(!1),children:[(0,r.Y)(A.rQ,{title:el("Edit scheduled time"),showDivider:!0,showClose:!0,onClose:()=>eD(!1)}),(0,r.Y)(A.cw,{children:(0,r.FD)(E.I1,{gap:8,children:[(0,r.Y)(E.EY.B3,{children:el("Date")}),(0,r.Y)(D.ZZ,{value:eN||new Date,onChange:e=>{eO(new Date(e.currentTarget.value))}})]})}),(0,r.Y)(A.jl,{showDivider:!0,primaryButton:(0,r.Y)(E.$n,{priority:"primary",disabled:!(!h.liveStream.scheduled_at||new Date(h.liveStream.scheduled_at).getTime()!==eN.getTime())||eV,onClick:e0,loading:eV,children:el("Save changes")}),secondaryButton:(0,r.Y)(E.$n,{priority:"secondary",onClick:()=>eD(!1),disabled:eV,children:el("Cancel")})})]}),(0,r.FD)(A.aF,{isOpen:eA,onClose:()=>eP(!1),width:540,children:[(0,r.Y)(A.rQ,{title:(null==eF?void 0:eF.name)?eo(Q(),eF.name):eF?eo(ee()):el("Message your guest to accept your live video invite"),description:(null==eF?void 0:eF.name)?eo(ei(),eF.name):eF?eo(en()):el("Copy and send this reminder to your guest via SMS, email or direct message."),showClose:!0,onClose:()=>eD(!1)}),(0,r.Y)(A.cw,{children:(0,r.Y)(E.az,{padding:16,border:"detail",radius:"md",fontStyle:"italic",children:eX})}),(0,r.Y)(A.jl,{primaryButton:(0,r.Y)(E.$n,{priority:"primary",onClick:()=>{(0,w.lW)(eX)},flex:"grow",disabled:eV,children:el("Copy reminder")})})]})]})},er=e=>{let{isOpen:i,onClose:n,liveStream:t}=e,{iString:l}=(0,_.GO)(),o=(0,y.Jd)(),a=(0,V.Xrv)({liveStreamId:t.liveStream.id,utm_source:z.VU.liveStreamScheduledUpsell});return(0,r.FD)(A.aF,{isOpen:i,onClose:n,children:[(0,r.Y)(A.rQ,{title:l("Open in app"),description:l("Scan the code below to open this live video in the app"),showDivider:!0,alignItems:"center",showClose:!0,onClose:n}),(0,r.Y)(A.cw,{children:(0,r.Y)(E.I1,{gap:16,alignItems:"center",children:(0,r.Y)(E.VP,{border:"detail",radius:"lg",bg:"primary",padding:4,shadow:"md",children:(0,r.Y)(c.hj,{utm_source:z.VU.liveStreamScheduledUpsell,openUrl:(null==o?void 0:o.reader_installed_at)?a:void 0})})})}),(0,r.Y)(A.jl,{direction:"column",showDivider:!0,primaryButton:(0,R.Fr)()?(0,r.Y)(E.$n,{priority:"primary",href:(0,L.wHz)({utm_source:z.VU.liveStreamScheduledUpsell}),children:l("Get the app")}):(0,r.Y)(E.$n,{priority:"secondary",onClick:n,children:l("Done")})})]})}},55696:function(e,i,n){n.d(i,{A:()=>v,u:()=>f});var t=n(4006),r=n(38221),l=n.n(r),o=n(17402),a=n(31452),s=n(83137),u=n(17028),c=n(59294),d=n(13348);let p=e=>{let{isVisible:i,onVisibilityChange:n,videoRef:r}=e;return(0,o.useEffect)(()=>{var e;let i=e=>{e.target.muted&&(n(!0),setTimeout(()=>n(!1),6e3))},t=null==(e=r.current)?void 0:e.player;return t&&t.addEventListener("playing",i),()=>{t&&t.removeEventListener("playing",i)}},[]),(0,t.Y)("div",{className:"unmuteOverlayContainer-WcXkPG",style:{opacity:+!!i,pointerEvents:i?"auto":"none",transition:"opacity 0.5s ease"},onClick:()=>{var e;(null==(e=r.current)?void 0:e.player)&&(r.current.player.muted=!1,n(!1))},children:(0,t.Y)(d.tl,{})})};var h=n(4246),m=n(74171);let f=e=>{var i,n;let{disableZoom:r,liveStream:d,handle:f,autoPlay:v}=e,b=(0,o.useRef)(!0),g=(0,o.useRef)(null),Y=(0,o.useRef)(null),_=(0,o.useRef)(null),[y,C]=(0,o.useState)(!!d.liveStream.is_rtmp&&"9:16"===d.liveStream.mux_aspect_ratio),[S,w]=(0,o.useState)("undefined"!=typeof window&&!d.liveStream.is_rtmp&&window.innerWidth/window.innerHeight<1.2),[k,I]=(0,o.useState)(!1),{isIdle:E}=(0,s.U)({idleAfter:2e3,element:_.current}),D=(0,c.AC)(_);return(0,o.useEffect)(()=>{var e;let i=null==(e=Y.current)?void 0:e.player;if(i){i.playbackRate=1;let e=()=>{i.paused&&(i.currentTime<i.duration-1&&(i.currentTime=i.duration-1),i.play())};return i.addEventListener("click",e),()=>{i.removeEventListener("click",e)}}},[Y,null==(i=Y.current)?void 0:i.player]),(0,o.useEffect)(()=>{if(d.liveStream.is_rtmp&&"9:16"===d.liveStream.mux_aspect_ratio)return;let e=setInterval(()=>{var e;(null==(e=Y.current)?void 0:e.player)&&C(function(e,i){var n,t,r,l,o,a,s;let u=null!=(n=i.current)?n:{canvas:null,ctx:null};if(u.canvas||(u.canvas=document.createElement("canvas")),u.ctx||(u.ctx=u.canvas.getContext("2d")),i.current||(i.current=u),!u.ctx)return!1;u.canvas.width=u.canvas.height=3;try{u.ctx.drawImage(e,0,0,3,3);let i=u.ctx.getImageData(0,1,1,1),n=u.ctx.getImageData(2,1,1,1);return(null!=(t=null==i?void 0:i.data[0])?t:0)+(null!=(r=null==i?void 0:i.data[1])?r:0)+(null!=(l=null==i?void 0:i.data[2])?l:0)+(null!=(o=null==n?void 0:n.data[0])?o:0)+(null!=(a=null==n?void 0:n.data[1])?a:0)+(null!=(s=null==n?void 0:n.data[2])?s:0)<7}catch(e){return!1}}(Y.current.player,g))},250);return()=>clearInterval(e)},[null==(n=Y.current)?void 0:n.player,S,d.liveStream.is_rtmp,d.liveStream.mux_aspect_ratio]),(0,o.useEffect)(()=>{if(d.liveStream.is_rtmp)return;let e=l()(()=>{"undefined"!=typeof window&&window.innerWidth/window.innerHeight<1.2?w(!0):w(!1)},100);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,o.useEffect)(()=>{var e,i,n,t,r,l;if(b.current){b.current=!1;return}null==(e=Y.current)||e.refreshVideoSrc(),(null==(i=Y.current)?void 0:i.player)&&(null==(t=Y.current)||null==(n=t.player)?void 0:n.duration)>1&&(Y.current.player.currentTime=(null==(l=Y.current)||null==(r=l.player)?void 0:r.duration)-1)},[S]),(0,t.FD)(t.FK,{children:[(0,t.Y)(u.Ye,{position:"relative",className:(S||y)&&!r?"liveStreamVideoZoom-_qvCom":"liveStreamVideo-asigz8",alignItems:"center",justifyContent:"center",children:(0,t.Y)(a.N,{autoPlay:v,ref:Y,portrait:S,noKeyboardShortcuts:!0,noControls:!0,liveStreamId:d.liveStream.id,pub:d.pub||null,mediaUpload:{id:"ls-".concat(d.liveStream.id),width:S?m.GM:m.mc,height:S?m.dD:m.ld},isLive:!0,showPreviewWhenPaused:!0},!0)}),(0,t.Y)(u.az,{position:"absolute",style:{left:0,right:0,bottom:0},children:(0,t.Y)(h.Jf,{forLiveStream:!0,disableCaptions:!0,disableShortcuts:!0,disableTooltips:!0,disableSharing:!0,hideCaptions:!0,hidePip:!0,handle:f,hasPaywall:!1,hasTranscript:!1,hideNextVideoButton:!1,isActive:!E&&!k,isFocused:D,mediaRef:Y,mediaUpload:{id:"ls-".concat(d.liveStream.id),width:1920,height:1080},podcastUpload:null,pub:null,showPaywall:!1,showTranscript:!1,onToggleShowTranscript:()=>{},autoPlayMuted:!1})}),(0,t.Y)(p,{isVisible:k,onVisibilityChange:e=>I(e),videoRef:Y})]})},v=e=>{let{liveStream:i}=e;return(0,t.Y)("img",{src:i.liveStreamInformation.desktopThumbnailGifUrl,style:{width:"100%"}})}},73357:function(e,i,n){n.d(i,{_:()=>s});var t=n(79785),r=n(84605),l=n(39318),o=n(49807);function a(){let e=(0,t._)(["Join link:\n","\n\n---\n\nTo join this live video from your mobile device, download the Substack app from one of the links below. You can also join in your desktop browser using Chrome of Safari.\n\niOS:\n","\n  \nAndroid:\n",""]);return a=function(){return e},e}let s=e=>{let{iTemplate:i}=(0,r.GO)();if(!e)return null;let n=(0,o.Xrv)({liveStreamId:e.id,utm_source:"live-stream-calendar-invite"}),t=i(a(),n,(0,l.cxW)(),(0,l.zw3)());return{title:e.title,description:t,start:e.scheduled_at&&new Date(e.scheduled_at),duration:[1,"hour"],location:n}}},96871:function(e,i,n){n.d(i,{v:()=>l});var t=n(4006),r=n(24078);function l(e){let{user:i,isActive:n}=e;return(0,t.Y)(r.eu,{user:i,size:24,className:n?"active-Mnay2Y":void 0})}},38303:function(e,i,n){n.d(i,{X:()=>p});var t=n(4006),r=n(80697),l=n(82519),o=n(84605),a=n(46271),s=n(35369),u=n(76977),c=n(554),d=n(46453);function p(e){let{onNoteClick:i,profile:n,publicationUser:u,requireLogin:p}=e,{iString:m}=(0,o.GO)(),{isExpanded:f,isEligibleForLiveStreamCreation:v}=(0,d.eE)();return(0,a.Jd)()?(0,t.Y)(h,{children:(0,t.Y)(c.s,{trigger:f?(0,t.Y)(s.$n,{trailing:(0,t.Y)(l.A,{color:"var(--color-button-fg)"}),"aria-label":m("Create"),style:{textIndent:"20px"},children:m("Create")}):(0,t.Y)(s.K0,{priority:"primary","aria-label":m("Create"),children:(0,t.Y)(r.A,{size:24})}),onNoteClick:i,profile:n,publicationUser:u,isEligibleForLiveStreamCreation:v})}):f?(0,t.Y)(h,{children:(0,t.Y)(s.$n,{onClick:()=>null==p?void 0:p(),children:m("Create")})}):(0,t.Y)(s.K0,{onClick:()=>null==p?void 0:p(),priority:"primary","aria-label":m("Create"),children:(0,t.Y)(r.A,{size:24})})}function h(e){let{children:i}=e,{isExpanded:n}=(0,d.eE)();return(0,t.Y)(u.VP,{paddingY:12,minWidth:48,justifyContent:n?void 0:"center",alignItems:n?void 0:"center",children:i})}},46453:function(e,i,n){n.d(i,{Dx:()=>r,eE:()=>o,t2:()=>l});var t=n(17402);let r=(0,t.createContext)({setChildOptions:()=>{},isLoading:!1,subscriptions:[],publicationUsers:[],onPageScroll:()=>void 0,setPinTitle:()=>void 0,setDrawer:()=>null,checkFocus:()=>!1,requireLogin:null,isExpanded:!1});function l(e){let{shouldShowGetAppPill:i=!0,style:n,alwaysPinTitle:r,backAction:l,onRefresh:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=o();return(0,t.useLayoutEffect)(()=>{var t;null==(t=s.setChildOptions)||t.call(s,{title:e,style:n,alwaysPinTitle:r,backAction:l,shouldShowGetAppPill:i,onRefresh:a})},[s,e,n,l,i,a]),(0,t.useLayoutEffect)(()=>{var e;null==(e=s.setPinTitle)||e.call(s,!1)},[]),s}function o(){return(0,t.useContext)(r)}},61539:function(e,i,n){n.d(i,{Q:()=>I});var t=n(69277),r=n(70408),l=n(4006),o=n(3831),a=n(89230),s=n(17402),u=n(45197),c=n(84605),d=n(46275),p=n(46271),h=n(86500),m=n(35369),f=n(88774),v=n(72880),b=n(17028),g=n(16993),Y=n(31392);function _(e){let{isOpen:i,onClose:n}=e,{_internalMode:t,setMode:r}=function(){let[e,i]=(0,s.useState)(()=>"undefined"!=typeof window?localStorage.getItem("colorScheme"):null),n=e=>{document.documentElement.classList.toggle("dark-mode",e)};return{mode:null===e?"auto":e,setMode:e=>{if("auto"===e){localStorage.removeItem("colorScheme");let e=window.matchMedia("(prefers-color-scheme: dark)").matches;n(e),window.dispatchEvent(new Y.Hh(e?"dark":"light")),i(null)}else localStorage.setItem("colorScheme",e),window.dispatchEvent(new Y.Hh(e)),n("dark"===e),i(e)},_internalMode:e}}(),{iString:o}=(0,c.GO)();return(0,l.FD)(g.aF,{isOpen:i,onClose:n,width:"auto",children:[(0,l.Y)(g.rQ,{title:o("Change appearance"),onClose:n,showClose:!0,showDivider:!0}),(0,l.Y)(g.cw,{children:(0,l.FD)(b.fI,{gap:24,children:[(0,l.Y)(y,{mode:"light",onClick:()=>r("light"),label:o("Light"),isActive:"light"===t}),(0,l.Y)(y,{mode:"dark",onClick:()=>r("dark"),label:o("Dark"),isActive:"dark"===t}),(0,l.Y)(y,{mode:"auto",onClick:()=>r("auto"),label:o("Auto"),isActive:"auto"===t||null===t})]})})]})}function y(e){let{mode:i,label:n,onClick:t,isActive:r}=e;return(0,l.FD)(b.Nm,{resetCss:!0,onClick:t,display:"flex",direction:"column",flex:"grow",gap:12,cursor:"pointer",pressable:"lg",children:[(0,l.Y)(C,{mode:i,isActive:r}),(0,l.Y)(b.EY.B3,{weight:r?"semibold":"regular",color:r?"primary":"secondary",children:n})]})}function C(e){let{mode:i,isActive:n}=e;return(0,l.Y)(b.az,{outline:"detail",radius:"sm",overflow:"hidden",userSelect:"none",className:n?"active-fPhBWQ":void 0,children:(0,l.Y)(v.o,{src:"/img/color_modes/".concat(i,".png"),maxWidth:200,useRetinaSizing:!0,imageIsFixedWidth:!0,draggable:!1})})}var S=n(55287),w=n(39318),k=n(57324);function I(){let e=(0,p.Jd)(),{iString:i}=(0,c.GO)(),[n,t]=(0,s.useState)(!1),r=(0,d.BR)().isOnDestination,a=k.VU.userMenu,m="https://support.substack.com/hc/en-us/?utm_source=".concat(a);return e?(0,l.FD)(l.FK,{children:[(0,l.FD)(f.W1,{trigger:(0,l.Y)(E,{}),"aria-label":"Profile and settings",placement:"top-start",children:[(0,l.Y)(f.H9,{isFirst:!0,children:(0,l.Y)(f.Dr,{leading:(0,l.Y)(o.A,{}),href:"/archive",children:i("Archive")})}),(0,l.FD)(f.H9,{children:[r&&(0,l.Y)(f.Dr,{onClick:()=>t(!0),priority:"secondary",children:i("Appearance")}),(0,l.Y)(f.Dr,{href:(0,w.tFi)({utm_source:a}),onClick:()=>(0,h.u4)(h.qY.USER_MENU_ACCOUNT_SETTINGS_CLICKED),priority:"secondary","data-native":!0,children:i("Settings")}),(0,l.Y)(f.Dr,{href:m,priority:"secondary",children:i("Support")}),(0,l.Y)(f.Dr,{href:(0,w.bgT)({utm_source:a}),priority:"secondary","data-native":!0,children:i("Sign out")})]}),!e.reader_installed_at&&(0,l.Y)(f.H9,{children:(0,l.Y)(f.Dr,{href:(0,w.DS2)({utm_campaign:k._9.appMarketing,utm_content:k.fL.userMenuLink}),priority:"accent","data-native":!0,children:i("Get the app")})}),(0,l.Y)(u.qE,{})]}),(0,l.Y)(_,{isOpen:n,onClose:()=>t(!1)})]}):null}let E=(0,s.forwardRef)((e,i)=>{let{iString:n}=(0,c.GO)();return(0,l.Y)(m.Nm,(0,r._)((0,t._)({display:"flex",direction:"column",textAlign:"left",radius:"md",ref:i,resetCss:!0},e),{children:(0,l.Y)(S.d,{icon:(0,l.Y)(a.A,{size:24}),text:n("More")})}))});E.displayName="ProfileMenuTrigger"},55287:function(e,i,n){n.d(i,{d:()=>S});var t=n(69277),r=n(70408),l=n(32641),o=n(4006),a=n(97541),s=n(66511),u=n(46453),c=n(32485),d=n.n(c),p=n(40554),h=n(76977),m=n(39101);function f(e){let{className:i}=e;return(0,o.Y)(h.pT,{alignItems:"center",justifyContent:"center",radius:"full",className:d()(m.A.dotContainer,i),children:(0,o.Y)("div",{className:m.A.dot})})}var v=n(63136),b=n(76329),g=n(70690),Y=n(57324);function _(e){let{href:i,matchSubpaths:n,icon:t,isActive:r,activeIcon:l=t,native:a,badge:s,dot:c,forwardedRef:d,requireLogin:h,onClick:m,text:v,campaign:_}=e,{isExpanded:S}=(0,u.eE)(),w="undefined"!=typeof location?location.pathname:"",k=h?e=>{e.preventDefault(),h()}:null,I=void 0!==r?r:i&&(n?(0,g.W)(w,i):(0,g.y)(w,i));return(0,o.FD)(b.z,{href:h?void 0:i,campaign:h?void 0:null!=_?_:{source:w,medium:Y.Jn.reader2Nav},matchSubpaths:n,native:!!h||a,onClick:m||k||void 0,forwardedRef:d,"aria-current":I?"page":void 0,"aria-label":v,gap:4,minWidth:48,minHeight:48,display:"flex",justifyContent:"center",alignItems:"center",position:"relative",userSelect:"none",pressable:"lg",radius:"md",cursor:"pointer",bg:"primary",showFocus:!0,animate:!0,hover:!0,children:[(0,o.FD)(y,{isActive:!!I,children:[I?l:t,s?(0,o.Y)(p.T,{className:"badge-SSUMfv",count:s}):c?(0,o.Y)(f,{className:"dot-B4AfwU"}):null]}),S&&(0,o.Y)(C,{isActive:!!I,children:v})]})}function y(e){let{isActive:i,children:n}=e;return(0,o.Y)(h.ov,{minWidth:48,height:48,position:"relative",className:d()("icon-lyqgV5",i?"active-qkpOh1":"inactive-zdmjOL"),children:n})}function C(e){let{isActive:i,children:n}=e;return(0,o.Y)(v.EY.B3,{color:i?"primary":"secondary",weight:i?"semibold":"medium",flex:"grow",children:n})}function S(e){var{matchSubpaths:i=!0,text:n}=e,c=(0,l._)(e,["matchSubpaths","text"]);let{isExpanded:d}=(0,u.eE)();return(0,o.Y)(a.Match,{children:()=>(0,o.Y)(s.m_,{text:n,side:"right",disabled:d||!n,children:(0,o.Y)(_,(0,r._)((0,t._)({},c),{matchSubpaths:i,text:n}))})})}},21713:function(e,i,n){n.d(i,{D:()=>p});var t=n(4006),r=n(32485),l=n.n(r),o=n(40554),a=n(76329),s=n(55700),u=n(70690),c=n(57324),d=n(44567);function p(e){let{href:i,children:n,requireLogin:r,badge:p,icon:h,activeIcon:m,native:f,className:v}=e,b="undefined"!=typeof location?location.pathname:"",g=m?i&&((0,u.W)(b,i)?m:h):h,Y=(0,s.M)(r);return(0,t.FD)(a.z,{className:l()("reader2-mobile-nav-icon",v),href:r?void 0:i,campaign:r?void 0:{source:b,medium:c.Jn.reader2Nav},native:f,onClick:null!=Y?Y:void 0,onPointerDown:()=>{},children:[g,n,p?(0,t.Y)(o.T,{count:p,className:d.A.badge}):null]})}},62956:function(e,i,n){n.d(i,{J:()=>o});var t=n(46275),r=n(70486),l=n(16291);function o(e){var i,n,o,a,s;let{chatLastClicked:u}=e,c=(0,r.Pk)(),d=(0,t.BR)().isOnDestination,p=(0,r.a8)();if(!d)return{chatUnreadCount:null!=(o=null==(n=p.data)?void 0:n.unreadCount)?o:0,useChatBadge:!1};let h=null!=(a=c.inbox.directMessagesUnreadCount)?a:0,m=null!=(s=null==c||null==(i=c.inbox)?void 0:i.pubChatUnreadCount)?s:0,f=0===h&&m>0&&c.inbox.mostRecentChatTimestamp&&(!u||u.isBefore((0,l.A)(c.inbox.mostRecentChatTimestamp)));return{chatUnreadCount:h,useChatBadge:f}}},59901:function(e,i,n){n.d(i,{c:()=>ez});var t=n(69277),r=n(70408),l=n(4006),o=n(17402),a=n(69715),s=n(83628),u=n(15667),c=n(58398),d=n(64591),p=n(44909),h=n(46271),m=n(86500),f=n(12501),v=n(43528),b=n(31669),g=n(89490),Y=n(76977),_=n(57820),y=n(46453),C=n(51735),S=n(32485),w=n.n(S),k=n(85478),I=n(73957),E=n(21398);function D(e){let{post:i,publication:a,publicationUser:s,subscription:u,publicationSettings:c,isPledged:d,postContainerRef:p,videoPlayerRef:m,onLike:f}=e,v=(0,k.mJ)(),b=(0,h.Jd)(),[g,_]=(0,o.useState)(!1);(0,o.useLayoutEffect)(()=>{_(!1)},[null==i?void 0:i.id]),(0,o.useEffect)(()=>{i&&requestAnimationFrame(()=>{_(!0)})},[i]);let y=b?(0,r._)((0,t._)({},b),{is_contributor:(null==s?void 0:s.role)==="contributor",is_admin:(null==s?void 0:s.role)==="admin",is_public_admin:!!(null==s?void 0:s.public),is_subscribed:(null==u?void 0:u.membership_state)==="subscribed",is_free_subscribed:(null==u?void 0:u.membership_state)==="free_signup",is_pledged:d}):null;return(0,l.FD)(h.vu,{defaultValue:y,children:[(0,l.Y)(I.PostMetaTags,{post:i,publication:a,siteConfigs:v.allConfigs}),(0,l.Y)(Y.VP,{className:w()("post-Ogv8cn",g&&"loaded-yPoGB8"),children:(0,l.Y)(E.Ic,{module:"@/frontend/reader2/PostRenderer",onRequest:()=>n.e("16545").then(n.bind(n,41176)),resolve:e=>e.ReaderPost,post:i,pub:a,user:y,publicationSettings:c,postContainerRef:p,videoPlayerRef:m,onLike:f})})]})}var A=n(75107),P=n(72102),F=n(35369),x=n(68940),T=n(66511);function L(e){let{onNext:i,onPrevious:n,isReading:t}=e;return(0,l.Y)(Y.VP,{position:"absolute",zIndex:1,gap:32,className:w()("root-M94l49",t&&"reading-djeafr"),children:(i||n)&&(0,l.FD)(Y.VP,{gap:8,children:[(0,l.Y)(O,{onClick:n}),(0,l.Y)(N,{onClick:i})]})})}function N(e){let{onClick:i}=e;return(0,l.Y)(T.m_,{text:"Next post",trailing:(0,l.Y)(x.u,{children:"J"}),side:"right",children:(0,l.Y)(F.K0,{onClick:()=>null==i?void 0:i(),disabled:!i,priority:"secondary","aria-label":"Next",children:(0,l.Y)(A.A,{size:20,"aria-hidden":!0})})})}function O(e){let{onClick:i}=e;return(0,l.Y)(T.m_,{text:"Previous post",trailing:(0,l.Y)(x.u,{children:"K"}),side:"right",children:(0,l.Y)(F.K0,{onClick:()=>null==i?void 0:i(),disabled:!i,priority:"secondary","aria-label":"Previous",children:(0,l.Y)(P.A,{size:20,"aria-hidden":!0})})})}var V=n(79785),R=n(48697),z=n(84605),B=n(94729),U=n(24078),M=n(33727),H=n(63136),W=n(49807);function q(){let e=(0,V._)(["You subscribed to "," because it was recommended by ","."]);return q=function(){return e},e}function j(e){let{publication:i,referringPub:n}=e,{iTemplate:t,iString:r}=(0,z.GO)(),[a,s]=(0,o.useState)(!1);if(a||!n)return null;let u=async()=>{await (0,B.x6)("/api/v1/publication_user_settings/user",{method:"PUT",json:{publication_id:i.id,type:"hide_referring_recommendation",value:!0}}),s(!0)},c=t(q(),i.name,n.author_name||n.name);return(0,l.Y)(Y.ov,{children:(0,l.FD)(M.Z,{direction:"row",className:"card-N02akT",gap:12,padding:16,children:[(0,l.Y)(U.eu,{user:{id:n.author_id,name:n.author_name},photoUrl:n.author_photo_url,size:40}),(0,l.FD)(Y.VP,{flex:"grow",children:[(0,l.Y)(H.EY.B4,{weight:"medium",children:c}),(0,l.Y)(H.EY.B4,{color:"secondary",children:(0,l.Y)(H.Yq,{href:(0,W.MWx)(i),decoration:"underline",children:r("Manage your subscription")})})]}),(0,l.Y)(Y.VP,{children:(0,l.Y)(F.K0,{priority:"quaternary",size:"xs",onClick:u,children:(0,l.Y)(R.A,{size:16})})})]})})}function G(e){let{children:i,isReading:n}=e;return(0,l.Y)(Y.ov,{position:"absolute",className:w()("container-KBEuyU",n&&"hidden-sy3u5P"),children:i})}var K=n(54718),$=n(81203),Z=n(82853),J=n(93164),X=n(16858),Q=n(7611),ee=n(85731),ei=n(34316),en=n(57157),et=n(38637),er=n(3831),el=n(84934),eo=n(37946),ea=n(60996),es=n(6212),eu=n(41935),ec=n(9979),ed=n(40691),ep=n(68349),eh=n(88774),em=n(78526),ef=n(76531),ev=n(32848),eb=n(82776);function eg(e){var i;let{post:n,publication:t,onArchive:r,onSavePost:o,onReport:a,isArchived:s}=e,{iString:u}=(0,z.GO)(),c=(0,h.Jd)(),{openModal:d,closeModal:p}=(0,ed.hS)(),{isSaved:f,onSave:v}=(0,eu.Jj)({post:n}),b=(0,em.L)(),g=(0,ev.n7)(),{getConfigFor:Y}=(0,k.mJ)(),{activePost:_,isPlaying:y,onToggle:C,onPlay:S}=(0,ef.p)(),w=!!(y&&_&&_.id===(null==n?void 0:n.id)),I=r?e=>{(0,m.u4)(m.qY.POST_ARCHIVED,{post_id:e,surface:"post viewer"}),r(e)}:void 0,E=(null==t?void 0:t.id)?null==(i=g.result)?void 0:i.publicationUserMap.get(t.id):void 0,D=t&&E&&(0,eb.isAtLeastContributorRole)(E.role)?()=>{(0,m.u4)(m.qY.READER_EDIT_POST_BUTTON_CLICKED,{publication_id:t.id,post_id:n.id}),location.href=(0,W.I_S)(t,n.id,{addBase:!0})}:void 0;return(0,l.FD)(eh.W1,{trigger:(0,l.Y)(F.K0,{"aria-label":"View more",priority:"secondary",children:(0,l.Y)(K.A,{size:20})}),children:[(0,l.Y)(eh.Dr,{onClick:()=>{b((0,ec.x5)(null,{post:n,pub:t,user:c}))},leading:(0,l.Y)(Z.A,{}),children:u("Copy link")}),(0,l.Y)(eh.Dr,{leading:(0,l.Y)(J.A,{}),onClick:()=>{d({children:(0,l.Y)(ea.k,{post:n,pub:t,onClose:p}),width:540})},children:u("Embed")}),"podcast"===n.type&&n.video_upload_id&&!Y("disable_clipping_for_readers")&&(0,l.Y)(eh.Dr,{leading:(0,l.Y)(X.A,{}),onClick:()=>{let e=(0,W.wu9)(t,n,{urlParams:{clippingMode:!0}});(0,ep.V2)(e)},children:u("Create clips")}),(0,l.FD)(eh.H9,{children:[(0,es.Mq)(n)&&!(0,es.dm)(n)&&(0,l.Y)(eh.Dr,{onClick:()=>{w?C():S({post:n,publication:t})},leading:w?(0,l.Y)(Q.A,{}):(0,l.Y)(ee.A,{}),trailing:(0,l.Y)(x.u,{children:"P"}),children:u(w?"Pause audio":"Play audio")}),o&&(0,l.Y)(eh.Dr,{onClick:()=>o({post:n,isSaved:v()}),target:"_blank",leading:f?(0,l.Y)(ei.A,{}):(0,l.Y)(en.A,{}),trailing:(0,l.Y)(x.u,{children:"S"}),children:u(f?"Unsave":"Save")}),I&&(s?(0,l.Y)(eh.Dr,{onClick:()=>I(n.id),leading:(0,l.Y)(et.A,{}),trailing:(0,l.Y)(x.u,{children:"E"}),children:u("Unarchive")}):(0,l.Y)(eh.Dr,{onClick:()=>I(n.id),leading:(0,l.Y)(er.A,{}),trailing:(0,l.Y)(x.u,{children:"E"}),children:u("Archive")})),D&&(0,l.Y)(eh.H9,{children:(0,l.Y)(eh.Dr,{onClick:D,leading:(0,l.Y)(el.A,{}),children:u("Edit post")})})]}),(0,l.Y)(eh.H9,{children:a&&(0,l.Y)(eh.Dr,{priority:"destructive",onClick:a,leading:(0,l.Y)(eo.A,{}),children:u("Report")})})]})}var eY=n(85050),e_=n(57324);function ey(e){let{publication:i,user:n,canSubscribe:t,isFreeSubscribed:r,isAuthor:o}=e,{iString:a}=(0,z.GO)(),s=(0,ev.n7)(),u=(0,eY.s)({surface:"post-viewer"});if(!i||o)return null;let c=t?(0,eb.getSubscribeText)(i,{isFreeSubscribed:r}):a("Subscribed"),d=(0,W.eV6)(i,{user:n,addBase:!0,params:{utm_source:e_.VU.substack,utm_medium:e_.Jn.web,utm_campaign:e_._9.postViewer}});return(0,l.Y)(F.$n,{priority:t?"primary":"secondary",newTab:!0,href:d,onClick:e=>{!n&&i?u(i)(e):setTimeout(()=>{s.refetchPublication(i.id)},5e3)},children:c})}var eC=n(63558),eS=n(43510),ew=n(32641),ek=n(97731);let eI=e=>{var{size:i=20,fill:n="var(--color-fg-primary)"}=e,o=(0,ew._)(e,["size","fill"]);return(0,l.Y)(ek.A,(0,r._)((0,t._)({},o),{name:"PlayIconLockFilled",svgParams:{viewBox:"0 0 20 20"},width:i,height:i,fill:n,children:(0,l.Y)("path",{stroke:"none",fillRule:"evenodd",clipRule:"evenodd",d:"M4.04688 18.5527C4.4375 18.5527 4.76953 18.3965 5.16016 18.1719L6.2041 17.5685V14.633V13.4815C6.2041 12.4757 6.61309 11.9682 7.46663 11.9001C7.46663 10 9.07077 8.01343 11.4472 8.01343C13.8237 8.01343 15.4278 10 15.4278 11.901C15.5875 11.9144 15.7314 11.9429 15.86 11.9869L16.5469 11.5898C17.3574 11.1113 17.6406 10.7988 17.6406 10.2812C17.6406 9.76367 17.3574 9.45117 16.5469 8.98242L5.16016 2.39062C4.76953 2.16602 4.4375 2.01953 4.04688 2.01953C3.32422 2.01953 2.875 2.56641 2.875 3.41602V17.1465C2.875 17.9961 3.32422 18.5527 4.04688 18.5527ZM10.1094 12.9648H12.7852V11.8418C12.7852 10.8262 12.2871 10.2793 11.4473 10.2793C10.6074 10.2793 10.1094 10.8262 10.1094 11.8418V12.9648ZM14.0645 12.9707V11.9492C14.0645 10.1816 13.0098 9 11.4473 9C9.8848 9 8.8301 10.1816 8.8301 11.9492V12.97C8.2689 13.0149 8 13.3485 8 14.0098V17.8086C8 18.5215 8.3125 18.8535 8.9668 18.8535H13.918C14.582 18.8535 14.8945 18.5215 14.8945 17.8086V14.0098C14.8945 13.3515 14.6281 13.0179 14.0645 12.9707Z"})}))};var eE=n(91461);function eD(e){let{post:i,publication:n}=e,{activePost:t,isPlaying:r,onToggle:o,onPlay:a}=(0,ef.p)();if(!i||!(0,es.Mq)(i))return null;let s=(0,es.dm)(i),u=!!(r&&t&&t.id===i.id);return(0,l.Y)(T.m_,{leading:s?(0,l.Y)(eE.A,{size:12}):void 0,text:s?"Paid subscribers only":"Play audio",side:"bottom",delayEnter:0,children:(0,l.Y)(F.K0,{onClick:()=>{s||(u?o():a({post:i,publication:null!=n?n:void 0}))},disabled:s,children:s?(0,l.Y)(eI,{size:20,fill:"var(--color-fg-secondary)"}):u?(0,l.Y)(eC.A,{size:20}):(0,l.Y)(eS.A,{size:20})})})}function eA(e){let{onClick:i,className:n}=e;return(0,l.Y)(T.m_,{text:"Close",trailing:(0,l.Y)(x.u,{children:"ESC"}),side:"right",children:(0,l.Y)(F.K0,{onClick:i,priority:"secondary","aria-label":"Close",className:n,children:(0,l.Y)(R.A,{size:20,"aria-hidden":!0})})})}function eP(e){let{children:i}=e;return(0,l.Y)(Y.fI,{position:"relative",justifyContent:"space-between",alignItems:"center",sizing:"border-box",padding:16,children:i})}var eF=n(11510);function ex(e){let{publication:i,user:n,canSubscribe:t,isFreeSubscribed:r,isAuthor:o,result:a,isLoading:s,onArchive:u,onSavePost:c,onReport:d,onClose:p,isArchived:h}=e,m=(0,eF.Iu)();return(0,l.FD)(eP,{children:[(0,l.Y)(eA,{onClick:p}),(0,l.Y)($.wg,{pub:i,size:40,radius:"sm",outline:"detail",className:"avatar-P2dQ60"}),(0,l.FD)(Y.fI,{gap:8,children:[!m&&(0,l.Y)(ey,{publication:i,user:n,canSubscribe:t,isFreeSubscribed:r,isAuthor:o}),(null==a?void 0:a.post)&&(0,l.Y)(eD,{post:a.post,publication:a.publication}),!a||s?(0,l.Y)(F.K0,{"aria-label":"View more",priority:"secondary",children:(0,l.Y)(K.A,{size:20})}):(0,l.Y)(eg,{post:a.post,publication:i,onArchive:u,onSavePost:c,onReport:d,isArchived:h})]})]})}function eT(e){let{children:i,isReading:n}=e;return(0,l.Y)(Y.VP,{position:"absolute",className:w()("container-DLG3Xp",n&&"hidden-ioFwzU"),children:i})}var eL=n(59339),eN=n(45854);function eO(e){let{isLoading:i=!1,publication:n,post:t,onLike:r}=e;return(0,l.Y)(eN.t,{children:(0,l.Y)(eL.u,{isLoading:i,publication:n,post:t,onLike:r})})}var eV=n(6074),eR=n(90554);function ez(e){var i;let n=(0,y.eE)();return(0,o.useEffect)(()=>()=>{var e;null==(e=n.setDrawer)||e.call(n,null)},[]),n.setDrawer&&null!=(i=n.setDrawer((0,l.Y)(eH,(0,t._)({},e))))?i:null}function eB(e){var i,n,t,r,a,g,S,w;let{postId:k,post:I,publication:E,videoPlayerRef:A,onClose:P,onPrevious:F,onNext:x,onSave:T,onArchive:N,onLike:O,onLoad:V,isArchived:R,publicationSettings:z,referringRecommendation:B,referringPub:U}=e,M=(0,ev.n7)(),H=(0,h.Jd)(),W=(0,o.useRef)(null),q=(0,b.V)(),{result:K,isLoading:$}=(0,f.st)({pathname:"/api/v1/posts/by-id/".concat(k),query:{preview:null!=(t=new URLSearchParams(document.location.search).get("postPreview"))?t:void 0},deps:[k],auto:!(I&&E&&z),initialResult:I&&E&&z?{post:I,publication:E,publicationSettings:z,referringRecommendation:B,referringPub:U}:void 0}),Z=(0,v.cz)(null,{ignoreSafari:!0});(0,o.useEffect)(()=>{(0,m.u4)(m.qY.POST_VIEWER_VIEWED,{post_id:k})},[k]),(0,o.useEffect)(()=>{K&&M.updatePublication(K.publication.id,K)},[K]),(0,o.useEffect)(()=>{V&&K&&V(K)},[K]),(0,o.useEffect)(()=>{K&&Z.postSelection&&Z.highlightSelection()},[K,Z.postSelection]);let J=(0,o.useCallback)(()=>{(0,m.u4)(m.qY.POST_VIEWER_CLOSED,{post_id:k}),P()},[P,k]),{subscription:X,publicationUser:Q,isFreeSubscribed:ee,isPaid:ei,isAuthor:en,isPledged:et}=(0,ev.NL)(null!=(r=null==K||null==(i=K.post)?void 0:i.publication_id)?r:0),{isReading:er,handleScroll:el}=function(){let[e,i]=(0,o.useState)(!1),n=(0,o.useRef)(0),{setIsReading:t}=(0,y.eE)();return{isReading:e,handleScroll:e=>{let r=e.currentTarget,l=r.scrollTop;l>r.scrollHeight-r.offsetHeight-100?(i(!1),null==t||t(!1)):l>n.current?(i(!0),null==t||t(!0)):(i(!1),null==t||t(!1)),n.current=l}}}(),eo=(0,C._)({publication:null!=(a=null==K?void 0:K.publication)?a:E,postId:k,onSuccess:()=>es(!1)}),[ea,es]=(0,o.useState)(!1),[eu,ec]=(0,o.useState)(!1);(0,eR.y)({name:"share",action:()=>{ec(!0)}});let ed=null!=(g=null==K?void 0:K.publication)?g:E,ep=null!=(S=null==K?void 0:K.publicationSettings)?S:{},eh=!((null==ed?void 0:ed.payments_state)==="enabled"?ei:ei||ee),em=K&&(0,eV.u)(K.post,I),ef=(0,s.Rv)(null!=(w=null==K||null==(n=K.post)?void 0:n.body_html)?w:"");return(0,l.FD)(l.FK,{children:[(0,l.Y)(eU,{children:(0,l.FD)(eM,{children:[(0,l.Y)(eT,{isReading:er,children:(0,l.Y)(ex,{publication:ed,user:H,canSubscribe:eh,isFreeSubscribed:ee,isAuthor:en,result:K,isLoading:$,onArchive:N,onSavePost:T,onReport:()=>es(!0),onClose:J,isArchived:R})}),(0,l.FD)(Y.VP,{position:"relative",flex:"grow",children:[(0,l.Y)(L,{onNext:x,onPrevious:F,isReading:er}),(0,l.Y)(Y.VP,{className:"post-mS6ZNe",flex:"grow",onScroll:el,ref:W,children:(0,l.Y)(p.s,{scrollContainerRef:W,children:$?(0,l.Y)(_.y$,{flex:"grow"}):K&&K.post.id===k&&(0,l.FD)(l.FK,{children:[K.referringPub&&(0,l.Y)(j,{publication:K.publication,referringPub:K.referringPub,referringRecommendation:K.referringRecommendation}),(0,l.Y)(D,{post:em,publication:K.publication,publicationUser:Q,subscription:X,publicationSettings:ep,isPledged:et,postContainerRef:W,videoPlayerRef:A,onLike:O})]})})}),ef&&(0,l.Y)(d.M,{toc:ef,position:"absolute"})]}),!q&&(0,l.Y)(G,{isReading:er,children:(0,l.Y)(eO,{publication:ed,post:em,onLike:O,isLoading:$})})]})}),(0,l.Y)(u.H,{isOpen:ea,onSubmit:eo,onClose:()=>es(!1)}),em&&ed&&(0,l.Y)(c.Z,{isOpen:eu,onClose:()=>ec(!1),medium:"post viewer",user:H,post:em,pub:ed})]})}let eU=(0,g.I4)({display:"flex",padding:{desktop:12,mobile:0},minWidth:0});function eM(e){let{children:i}=e,n=(0,eF.Iu)();return(0,l.Y)(Y.VP,{className:"viewer-uYulTr",bg:"primary",flex:"grow",position:"relative",overflow:"hidden",minWidth:0,border:n?"transparent":"detail",radius:n?"none":"md",children:i})}let eH=e=>{let i=(0,o.useRef)(null);return(0,l.Y)(a.UQ,{postId:e.postId,videoPlayerRef:i,children:(0,l.Y)(eB,(0,r._)((0,t._)({},e),{videoPlayerRef:i}))})}},42120:function(e,i,n){n.d(i,{n7:()=>nG,ww:()=>nj});var t=n(69277),r=n(4006),l=n(17159),o=n.n(l),a=n(45773),s=n(17402),u=n(70345),c=n(58398),d=n(82936),p=n(58050),h=n(95899),m=n(46271),f=n(86500),v=n(72343),b=n(92476),g=n(44333),Y=n(68349),_=n(76977),y=n(75303),C=n(36372),S=n(10455),w=n(79785),k=n(47963),I=n(79391),E=n(85048),D=n(84605),A=n(16993),P=n(81203),F=n(63136),x=n(41086),T=n(49807),L=n(57324);let N="tos-fWRMR_",O="subscribeWidgetContainer-xBr6Eu",V="mainPubAvatar-jsZ95u",R="invitedPubAvatar-OPhB0e",z="pubAvatars-nTTf2Z";function B(){let e=(0,w._)([""," and ",""]);return B=function(){return e},e}function U(){let e=(0,w._)([""," by ",""]);return U=function(){return e},e}let M=e=>{let{profile:i,activeLiveStream:n,subscriptionToLiveStreamPub:t,invitedLiveStreamPublications:l,subscriptionsToLiveStreamInvitedPub:o,freeSignup:a,freeSignupEmail:u}=e,[c,d]=(0,s.useState)(!0);return(0,r.Y)(H,{profile:i,activeLiveStream:n,subscriptionToLiveStreamPub:t,isOpen:c,onClose:()=>d(!1),freeSignup:a,freeSignupEmail:u,invitedLiveStreamPublications:l,subscriptionsToLiveStreamInvitedPub:o})},H=e=>{var i,n,t,l,o,a,u,c,d,p,h,v,b;let{profile:g,activeLiveStream:Y,subscriptionToLiveStreamPub:y,isOpen:C,onClose:S,freeSignup:w,freeSignupEmail:M,invitedLiveStreamPublications:H,subscriptionsToLiveStreamInvitedPub:W}=e,q=(0,T.Xrv)({liveStreamId:Y.liveStream.id,utm_source:L.VU.web,utm_campaign:L._9.profileLiveStream,params:{appStoreRedirect:!0}}),[j,G]=(0,s.useState)(!1),{iTemplate:K}=(0,D.GO)(),$=(0,m.Jd)(),Z=Y.pub,J=Object.entries(null!=W?W:{}).find(e=>{var i;let[n,t]=e;return["free_signup","subscribed"].includes(null!=(i=t.membership_state)?i:"unsubscribed")}),X=!["free_signup","subscribed"].includes(null!=(h=null==y?void 0:y.membership_state)?h:"unsubscribed")&&(null==H?void 0:H.find(e=>"enabled"===e.payments_state&&e.plans&&Number(null==J?void 0:J[0])===e.id)),Q=Object.entries(null!=W?W:{}).find(e=>{let[i,n]=e;return"free_signup"===n.membership_state}),ee=(null==y?void 0:y.membership_state)!=="free_signup"&&(null==H?void 0:H.find(e=>"enabled"===e.payments_state&&e.plans&&Number(null==Q?void 0:Q[0])===e.id)),{version:ei,showLogo:en,Header:et,Subtext:er,CTA:el,invitedPub:eo=null}=!Z||"only_founding"!==Y.liveStream.audience||(null==y?void 0:y.membership_state)==="subscribed"&&(null==y?void 0:y.is_founding)||(null==J||null==(i=J[1])?void 0:i.membership_state)==="subscribed"&&(null==J||null==(n=J[1])?void 0:n.is_founding)?Z&&"only_paid"===Y.liveStream.audience&&(null==y?void 0:y.membership_state)!=="subscribed"&&(null==Q||null==(o=Q[1])?void 0:o.membership_state)!=="subscribed"?{version:"paywall",showLogo:!1,invitedPub:ee,Header:(0,r.FD)(F.EY.H4,{weight:"heavy",align:"center",translated:!0,children:["This live video is for paid subscribers of"," ",I18N.p(ee?ee.name:Z.name)]}),Subtext:(0,r.Y)(F.EY.B3,{align:"center",translated:!0,children:"Choose a paid subscription to watch"}),CTA:(0,r.FD)(_.I1,{className:O,alignItems:"stretch",padding:20,children:[(0,r.Y)(I.A,{freeSignup:w||(null==y?void 0:y.membership_state)==="free_signup"||(null==H?void 0:H.find(e=>"enabled"===e.payments_state&&e.plans&&Number(null==Q?void 0:Q[0])===e.id))&&(null==Q||null==(a=Q[1])?void 0:a.membership_state)==="free_signup",freeSignupEmail:M,isStatic:!1,pub:ee||Z,source:L.VU.profileLiveStream,user:$}),(0,r.Y)(E.qd,{className:N,publication:Z})]})}:!Z||"only_free"!==Y.liveStream.audience||["subscribed","free_signup"].includes((null==y?void 0:y.membership_state)||"unsubscribed")||Object.values(null!=W?W:{}).every(e=>["subscribed","free_signup"].includes(e.membership_state||"unsubscribed"))||w?{version:"open app",showLogo:!1,Header:(0,r.FD)(F.EY.H4,{weight:"heavy",align:"center",translated:!0,children:["Watch ",I18N.p(g.name),"'s live video in the Substack app"]}),Subtext:(0,r.Y)(F.EY.B3,{align:"center",translated:!0,children:"Available now for iOS and Android"}),CTA:(0,r.Y)(k.gF,{hideEmailPrompt:!0,utm_campaign:"profile-live-stream",utm_source:"web",openUrl:q})}:{version:"freewall",showLogo:!!(null==H?void 0:H.length),Header:(0,r.FD)(F.EY.H4,{weight:"heavy",align:"center",translated:!0,children:["Subscribe for free to watch"," ",I18N.p(Y.liveStream.title)]}),Subtext:(0,r.Y)(F.EY.B3,{align:"center",color:"secondary",children:(null==H?void 0:H.find(e=>e.name))?K(B(),Z.name,(null==(u=H.find(e=>e.name))?void 0:u.name)||""):Z.author_name?K(U(),Z.name,Z.author_name):Z.name}),CTA:(0,r.FD)(_.I1,{className:O,alignItems:"stretch",padding:20,children:[(0,r.Y)(I.A,{freeSignup:w||(null==y?void 0:y.membership_state)==="free_signup"||Object.values(null!=W?W:{}).some(e=>"free_signup"===e.membership_state),freeSignupEmail:M,isStatic:!1,pub:Z,additionalPubIds:(null==H?void 0:H.find(e=>e.name))?[null==(c=H.find(e=>e.name))?void 0:c.id].filter(e=>!!e):[],source:L.VU.profileLiveStream,user:$,onSignup:()=>{j||window.location.reload()},onConfirmationRequired:()=>{window.location.search+="&requires_confirmation=true",G(!0)}}),(0,r.Y)(E.qd,{className:N,publication:Z})]})}:{version:"founding paywall",showLogo:!1,invitedPub:X,Header:(0,r.FD)(F.EY.H4,{weight:"heavy",align:"center",translated:!0,children:["This live video is for founding subscribers of"," ",I18N.p(X?X.name:Z.name)]}),Subtext:(0,r.Y)(F.EY.B3,{align:"center",translated:!0,children:"Choose a founding subscription to watch"}),CTA:(0,r.FD)(_.I1,{className:O,alignItems:"stretch",padding:20,children:[(0,r.Y)(I.A,{freeSignup:w||(null==y?void 0:y.membership_state)==="free_signup"||(null==y?void 0:y.membership_state)==="subscribed"||(null==H?void 0:H.find(e=>"enabled"===e.payments_state&&e.plans&&Number(null==J?void 0:J[0])===e.id))&&((null==J||null==(t=J[1])?void 0:t.membership_state)==="free_signup"||(null==J||null==(l=J[1])?void 0:l.membership_state)==="subscribed"),freeSignupEmail:M,isStatic:!1,pub:X||Z,source:L.VU.profileLiveStream,user:$,foundingUpsell:!0}),(0,r.Y)(E.qd,{className:N,publication:Z})]})};return((0,s.useEffect)(()=>{if(C){var e;(0,f.u4)(f.qY.LIVE_STREAM_UPSELL_MODAL_SEEN,{live_stream_id:Y.liveStream.id,publication_id:null==(e=Y.pub)?void 0:e.id,version:ei})}},[C,ei,Y.liveStream.id,null==(d=Y.pub)?void 0:d.id]),(0,x.y)("requires_confirmation"))?(0,r.FD)(A.aF,{isOpen:C,onClose:S,children:[(0,r.Y)(A.rQ,{showClose:!0,onClose:S,icon:en&&eo&&(null==eo?void 0:eo.logo_url)&&(null==(v=Y.pub)?void 0:v.logo_url)?(0,r.FD)(_.I1,{className:z,alignItems:"center",children:[(0,r.Y)(P.Nq,{className:R,pub:eo,size:48}),(0,r.Y)(P.Nq,{className:V,pub:Y.pub,size:48})]}):void 0}),(0,r.Y)(A.cw,{children:(0,r.FD)(_.I1,{gap:4,children:[(0,r.Y)(F.EY.H4,{weight:"heavy",align:"center",translated:!0,children:"Confirm your email address"}),(0,r.FD)(F.EY.B3,{align:"center",translated:!0,children:["We sent an email to"," ",I18N.p(null!=(b=M||(null==$?void 0:$.email))?b:"")," with a confirmation link. Click the link to finish your subscription."]})]})})]}):(0,r.FD)(A.aF,{isOpen:C,onClose:S,children:[(0,r.Y)(A.rQ,{showClose:!0,onClose:S,icon:en&&eo&&(null==eo?void 0:eo.logo_url)&&(null==(p=Y.pub)?void 0:p.logo_url)?(0,r.FD)(_.I1,{className:z,alignItems:"center",children:[(0,r.Y)(P.Nq,{className:R,pub:eo,size:48}),(0,r.Y)(P.Nq,{className:V,pub:Y.pub,size:48})]}):void 0}),(0,r.Y)(A.cw,{children:(0,r.FD)(_.I1,{gap:4,children:["active"===Y.liveStream.status?et:(0,r.FD)(F.EY.H4,{weight:"heavy",align:"center",translated:!0,children:[I18N.p(g.name),"'s live video has ended. Download the app so you can join next time"]}),er]})}),el]})};var W=n(46453),q=n(32485),j=n.n(q),G=n(17028),K=n(52742);function $(e){let{isOpen:i,onClose:n,photoUrl:t}=e;return(0,r.Y)(K.V,{isOpen:i,modalContent:[{attrs:{src:t}}],onClose:n,step:0})}var Z=n(11510),J=n(69706);let X={container:"container-wcKC8m",image:"image-WJiR9w"};function Q(e){var i,n;let{profile:t}=e,{iString:l}=(0,D.GO)(),o=(0,Z.Iu)(),[a,u]=(0,s.useState)(!1),c=null==(i=t.theme)?void 0:i.cover_image,d=null==c?void 0:c.url;if(!d)return null;let p=null!=(n=null==c?void 0:c.raw_url)?n:d;return(0,r.FD)(G.VP,{paddingTop:{desktop:24,mobile:0},children:[(0,r.Y)(G.VP,{className:X.container,onClick:()=>u(!0),position:"relative",style:{"--overflow":o?"0":"-".concat(20,"px"),"--aspect":"".concat(J.VE)},children:(0,r.Y)(G.az,{as:"img",src:d,draggable:!1,alt:l("Cover image"),radius:o?void 0:"sm",outline:o?void 0:"detail",className:j()(X.image,o&&X.mobile)})}),(0,r.Y)($,{isOpen:a,onClose:()=>u(!1),photoUrl:p})]})}var ee=n(79909),ei=n(39318);function en(e){var i,n;let{profile:t,shareImageVariantFromQuery:l,activeLiveStream:o}=e,a=(null==t?void 0:t.max_pub_tier)===2,s=!!(null==t?void 0:t.profile_set_up_at),u=t&&t.photo_url&&(0,ei.dJ9)(t.photo_url);if(o)u=(0,T.ADu)(o.liveStream.id,{isGif:!0});else l&&(u=(0,ei.Aih)({userId:t.id,variant:l,aspectRatio:"link"}));return(0,r.Y)(ee.Metadata,{title:o?"LIVE NOW: ".concat(t.name||o.user.name||(null==(n=o.pub)?void 0:n.name)," on Substack"):"".concat(t.name||"<no name>"," | Substack"),description:(null==o||null==(i=o.pub)?void 0:i.name)||t.bio,image:u,seoProps:{noindex:!a||!t.photo_url&&!t.bio&&!s}})}var et=n(31125),er=n(89490),el=n(35369),eo=n(16074),ea=n(97515);function es(){let e=(0,w._)([""," blocked you"]);return es=function(){return e},e}function eu(){let e=(0,w._)(["You are blocked from subscribing to "," and their publications"]);return eu=function(){return e},e}function ec(){let e=(0,w._)(["You blocked ",""]);return ec=function(){return e},e}function ed(){let e=(0,w._)(["You can manage your blocks in your account settings."]);return ed=function(){return e},e}function ep(e){let{profile:i}=e,{iTemplate:n}=(0,D.GO)();return(0,r.FD)(em,{children:[(0,r.Y)(eo.c,{}),(0,r.Y)(ea.p,{icon:(0,r.Y)(et.A,{}),title:n(es(),i.name||"This user"),description:n(eu(),i.name||"this user")})]})}function eh(e){let{profile:i}=e,{iString:n,iTemplate:t}=(0,D.GO)();return(0,r.FD)(em,{children:[(0,r.Y)(eo.c,{}),(0,r.Y)(ea.p,{icon:(0,r.Y)(et.A,{}),title:t(ec(),i.name||"this user"),description:t(ed()),button:(0,r.Y)(el.$n,{href:(0,ei.tFi)(),children:n("Account settings")})})]})}let em=(0,er.I4)({display:"flex",direction:"column",gap:32,paddingX:{desktop:0,mobile:16}});var ef=n(83673),ev=n.n(ef),eb=n(46275),eg=n(85478),eY=n(414),e_=n(70408),ey=n(98188),eC=n(27749),eS=n(44451),ew=n(64892),ek=n(96467),eI=n(12501),eE=n(5180),eD=n(2481);function eA(e){let{profile:i,type:n}=e,t=(0,m.Jd)(),l=(0,Z.Iu)();return i&&i.id===(null==t?void 0:t.id)&&"notes"===n?l?(0,r.Y)(_.VP,{borderBottom:"detail",children:(0,r.Y)(eD.um,{surface:"profile"})}):(0,r.Y)(_.VP,{paddingTop:16,children:(0,r.Y)(eD.Ay,{surface:"profile"})}):null}var eP=n(45937),eF=n(40659),ex=n(82776);function eT(){let e=(0,w._)([""," hasn't published anything yet."]);return eT=function(){return e},e}function eL(){let e=(0,w._)(["","'s likes will appear here."]);return eL=function(){return e},e}function eN(e){var i;let n,{profile:l,type:o="notes"}=e;(0,s.useEffect)(()=>{(0,eF.l)(),(0,f.u4)(f.qY.FEED_PROFILE_SCREEN_VIEWED,(0,t._)({target_user_id:l.id},(0,ex.extractEventAttributionDataFromRecord)((0,eF.cf)())))},[]);let a=(0,m.Jd)(),u=(0,eb.BR)().isOnDestination,c=!a&&u,[p,h]=(0,ek.K)(eE.B9,eE.To);"likes"===o?n=["like"]:"notes"===o?n=void 0:console.warn("Unrecognized type in NotesList: ".concat(o));let{canFetchMore:v,lastPage:b,fetchMore:g,hasLoadedOnce:Y}=(0,eI.U1)({pathname:"/api/v1/reader/feed/profile/".concat(l.id),query:{types:n},getPageInit:e=>{var i;let{lastPage:n,init:r}=e,l=null==n||null==(i=n.result)?void 0:i.nextCursor;return l&&(r.query=(0,e_._)((0,t._)({},r.query),{cursor:l})),r},auto:!0,deps:[l.id,o],pages:p.pages,dispatch:h}),y=v&&!!(null==b||null==(i=b.result)?void 0:i.nextCursor)&&!c,{bodyRef:C}=(0,eP.X)(g,[b],{shouldCheck:y,threshold:640}),S=p.pages.map(e=>{var i;return(null==(i=e.result)?void 0:i.items)||[]}).flat(),w=c&&S.length>2;w&&(S=S.slice(0,3));let k=l&&l.id===(null==a?void 0:a.id);return(0,s.useEffect)(()=>{var e;(null==b||null==(e=b.result)?void 0:e.items.length)===0&&y&&g()},[b]),(0,r.Y)(eC.IJ,{surface:"profile",dispatch:h,state:p,children:(0,r.FD)(_.I1,{ref:C,children:[(0,r.Y)(eA,{profile:l,type:o}),(0,r.Y)(d.uL,{children:S.map((e,i)=>(0,r.Y)(eS.GJ,{item:(0,eE.bL)(p,e),showLoginPrompt:!!(w&&2===i)}))}),(null==b?void 0:b.isLoading)||!Y?(0,r.Y)(ew.D,{}):0===S.length?(0,r.Y)(_.pT,{paddingY:64,flex:"grow",children:"notes"===o?(0,r.Y)(eO,{profile:l,yourProfile:k}):(0,r.Y)(eV,{profile:l,yourProfile:k})}):null]})})}function eO(e){let{profile:i,yourProfile:n}=e,{iString:t,iTemplate:l}=(0,D.GO)(),o=(0,eD.NP)();return(0,r.Y)(ea.p,{icon:(0,r.Y)(ey.A,{}),title:n?t("You haven't published anything yet."):l(eT(),i.name),description:t(n?"Get started by creating a note.":"Once they do, you'll see their activity here."),button:n?(0,r.Y)(el.$n,{onClick:()=>o.open({}),children:"Create a note"}):(0,r.Y)(el.$n,{href:(0,T.jQ6)(),children:"Explore more"})})}function eV(e){let{yourProfile:i,profile:n}=e,{iString:t,iTemplate:l}=(0,D.GO)(),o=(0,ex.guessFirstName)(n.name);return(0,r.Y)(ea.p,{title:t("No likes yet"),description:i?t("Your likes will appear here."):o?l(eL(),o):t("Their likes will appear here.")})}var eR=n(57820),ez=n(2548),eB=n(45795);function eU(e){var i,n;let{profile:t,userId:l}=e,[o,a]=(0,s.useState)(0),[u,c]=(0,s.useState)([]),d=(0,m.Jd)(),p=(0,eb.BR)().isOnDestination,h=!d&&p,{result:v,isLoading:b}=(0,eI.st)({pathname:"/api/v1/profile/posts",query:{profile_user_id:l,offset:o,limit:13},auto:!0,deps:[l,o]}),g=h&&((null==(n=u[0])||null==(i=n.posts)?void 0:i.length)||0)>2;(0,s.useLayoutEffect)(()=>{v&&c(0===o?[v]:[...u,v])},[v]);let y=(0,s.useMemo)(()=>{let e=u.map(e=>e.posts.slice(0,12)).flat();return g&&(e=e.slice(0,3)),{posts:e,publicationMap:new Map(u.map(e=>e.publications).flat().map(e=>[e.id,e]))}},[u]),C=u[u.length-1],S=C&&C.posts.length>12&&!h,{bodyRef:w}=(0,eP.X)(()=>{a(o+12)},[y,b],{shouldCheck:!!S&&!b}),{posts:k,publicationMap:I}=y;return(0,r.Y)(_.I1,{children:(0,r.FD)(ez.ix,{ref:w,children:[v?k.length>0?k.map((e,i)=>{let n=I.get(e.publication_id);if(n){let l="profile"===n.homepage_type&&t.handle?(0,T.VRc)({postId:e.id,handle:t.handle,noBase:!1}):null;return(0,r.Y)(eB.CF,{post:e,pub:n,isViewed:!0,isLiked:!!e.reaction,isSaved:e.is_saved,showLoginPrompt:!!(g&&2===i),onClick:r=>{if((0,f.u4)(f.qY.ARCHIVE_PAGE_POST_CLICKED,{post_id:e.id,tab:"new",rank_in_feed:i,source:"profile"}),r.ctrlKey||r.metaKey)return;r.preventDefault(),r.stopPropagation();let l=p?(0,T.VRc)(t.handle?{postId:e.id,handle:t.handle,noBase:!0}:{readerProfileUser:t,postId:e.id,noBase:!0}):(0,T.wu9)(n,e,{noBase:!1});(0,Y.V2)(l)},utmSource:"profile",openInPostViewer:!0,canonicalUrl:l},e.id)}}):(0,r.Y)(eM,{profile:t}):(0,r.Y)(eB.i3,{}),b&&(0,r.Y)(eR.y$,{})]})})}function eM(e){let{profile:i}=e,n=(0,m.Jd)(),t=i&&i.id===(null==n?void 0:n.id);return(0,r.Y)(_.pT,{paddingY:64,flex:"grow",children:(0,r.Y)(ea.p,{icon:(0,r.Y)(ey.A,{}),title:"".concat(t?"You havent":"".concat(i.name," hasnt")||"This user hasnt"," published any posts yet."),description:"Once they do, youll see them here."})})}var eH=n(80964),eW=n(48697),eq=n(88774),ej=n(45846),eG=n(16884),eK=n(28700),e$=n(46120);function eZ(e){let{subscriptions:i,profile:n}=e,t=(0,m.Jd)(),l=n.id===(null==t?void 0:t.id);return 0===i.length?(0,r.Y)(_.pT,{paddingY:64,flex:"grow",children:l?n.hasHiddenPublicationUsers?(0,r.Y)(ea.p,{title:"All of your publications are hidden.",description:"Edit your profile to show others what you read.",button:(0,r.Y)(el.$n,{href:(0,ei.rj)(),children:"Edit profile"})}):(0,r.Y)(ea.p,{title:"You havent subscribed to any publications yet.",description:"Visit Explore to find something to read.",button:(0,r.Y)(el.$n,{href:(0,ei.U4Y)(),children:"Explore"})}):(0,r.Y)(ea.p,{title:"".concat(n.name," doesnt have any subscriptions to show."),description:"Visit Explore to find something to read.",button:(0,r.Y)(el.$n,{href:(0,ei.U4Y)(),children:"Explore"})})}):(0,r.Y)(_.I1,{flex:"fill",gap:{desktop:8,mobile:0},padding:8,children:i.map(e=>(0,r.Y)(eJ,{subscription:e},e.id))})}function eJ(e){let{subscription:i}=e,{iString:n}=(0,D.GO)(),t=i.is_founding?"founder":"subscribed"===i.membership_state?"subscribed":null,{publication:l}=i,{author:o}=l,a=(0,eG.Zm)({publication:l,subscriptionSource:L.VU.profileSubscriptions}),s="profile"===l.homepage_type&&o&&o.handle?(0,eK.fm)(o.handle):(0,ei.fOI)(l);return(0,r.FD)(_.Ye,{as:"a",href:s,gap:12,alignItems:"center",paddingY:8,paddingX:8,className:e$.A.readsRow,minWidth:0,flex:"grow",children:[(0,r.Y)(P.Nq,{pub:l,size:40,badgeType:t}),(0,r.FD)(_.I1,{flex:"grow",minWidth:0,children:[(0,r.Y)(F.EY.B4,{ellipsis:!0,weight:"semibold",color:"primary",children:l.name}),o&&(0,r.FD)(F.EY.B4,{ellipsis:!0,color:"secondary",children:["by ",o.name]})]}),a.isSubscribed?(0,r.Y)(eX,{onUnsubscribe:a.unsubscribe,publication:l,button:(0,r.Y)(el.$n,{priority:"secondary",size:"sm",children:n("Subscribed")})}):(0,r.Y)(el.$n,{priority:"primary",size:"sm",onClick:a.subscribe,children:n("Subscribe")})]})}function eX(e){let{onUnsubscribe:i,publication:n,button:t,manageOnly:l,isPledged:o}=e,a=(0,ej.SC)(),s=async()=>{!a.isConfirming&&await a.confirm()&&i()};return(0,r.FD)(r.FK,{children:[(0,r.Y)(ej.uo,{modal:a,title:"Unsubscribe from ".concat(n.name,"?"),body:o?"Unsubscribing will also cancel your pledge.":"You can resubscribe at any time.",cancelLabel:"Cancel",confirmLabel:"Unsubscribe"}),(0,r.FD)(eq.W1,{trigger:t,children:[(0,r.Y)(eq.Dr,{leading:(0,r.Y)(eH.A,{}),target:"_blank",href:(0,ei.FCy)(n,{addBase:!0}),children:"Manage subscription"}),l?null:(0,r.Y)(eq.Dr,{leading:(0,r.Y)(eW.A,{}),onClick:s,priority:"destructive",children:"Unsubscribe"})]})]})}var eQ=n(80697),e0=n(8853),e1=n(63840);let e2=e=>{let{lists:i,reads:n,ownProfile:t}=e,[l,o]=(0,s.useState)(!1),[a,u]=(0,s.useState)(null!=i?i:[]);return(0,s.useEffect)(()=>{(0,f.u4)(f.qY.LIST_PROFILE_TAB_SEEN)}),(0,r.FD)(_.I1,{flex:"fill",gap:16,padding:8,children:[t&&(0,r.Y)(e7,{openModal:()=>o(!0)}),null==a?void 0:a.map(e=>(0,r.Y)(e4,{list:e})),(0,r.Y)(e1.a,{open:l,close:e=>{e&&u([...a,e]),o(!1)},reads:n})]})},e4=e=>{let{list:i}=e,{iPlural:n}=(0,D.GO)();return(0,r.Y)("a",{href:"".concat((0,T.$_T)(),"/list/").concat(i.slug),target:"_blank",rel:"noopener",onClick:()=>(0,f.u4)(f.qY.LIST_PROFILE_TAB_LIST_CLICKED,{list_id:i.id}),children:(0,r.FD)(_.Ye,{alignItems:"start",justifyContent:"center",gap:12,children:[(0,r.Y)(e0.c,{src:(0,T.wv4)(i),width:40,height:40}),(0,r.FD)(_.I1,{minWidth:0,flex:"grow",children:[(0,r.Y)(F.EY.B4,{weight:"semibold",ellipsis:!0,children:i.name}),(0,r.Y)(F.EY.B4,{color:"secondary",ellipsis:!0,children:n("1 item","%1 items",i.publications.length)})]})]})})},e7=e=>{let{openModal:i}=e;return(0,r.FD)(_.Ye,{alignItems:"center",justifyContent:"start",gap:8,cursor:"pointer",onClick:i,children:[(0,r.Y)(el.K0,{priority:"secondary-outline",children:(0,r.Y)(eQ.A,{size:20})}),(0,r.Y)(F.EY.B3,{translated:!0,weight:"medium",children:"Create new list"})]})},e5=new Set(["notes","posts","likes","lists","reads"]);function e3(e){let{subscriptions:i,profile:n,subpath:t}=e,l=(0,g.lq)(),{iString:o}=(0,D.GO)(),a=(0,m.Jd)(),{getConfigFor:s}=(0,eg.mJ)(),u=s("lists_enabled"),c=(0,eb.BR)().isOnDestination,d=t?t.slice(1):void 0,p=(null==a?void 0:a.id)===n.id,h=d&&e5.has(d)?d:n.hasActivity||p?"notes":n.hasPosts?"posts":n.hasLikes?"likes":(null==n?void 0:n.lists)&&u?"lists":"reads",v=ev()([{value:"notes",label:o("Activity")},{value:"posts",label:o("Posts")},{value:"likes",label:o("Likes")},u?{value:"lists",label:o("Lists")}:null,{value:"reads",label:"".concat(o("Reads")).concat(n.visibleSubscriptionsCount>0?" (".concat(n.visibleSubscriptionsCount,")"):"")}]);return(0,r.FD)(_.I1,{children:[(0,r.Y)(eY.r,{tabs:v,value:h,onChange:e=>{let i=history.state,t=c?"".concat((0,ei.gYq)(n,{noBase:!0}),"/").concat(e):"/profile/".concat(e);(0,f.u4)(f.qY.PROFILE_TAB_TAPPED,{tab_id:e}),l(t,!0),history.replaceState(i,"")}}),(0,r.FD)(_.I1,{flex:"fill",paddingBottom:20,children:["posts"===h&&(0,r.Y)(eU,{profile:n,userId:n.id}),"notes"===h&&(0,r.Y)(eN,{profile:n}),"likes"===h&&(0,r.Y)(eN,{profile:n,type:"likes"}),u&&"lists"===h&&(0,r.Y)(e2,{lists:n.lists,ownProfile:(null==a?void 0:a.id)===n.id}),"reads"===h&&(0,r.Y)(eZ,{subscriptions:i,profile:n})]})]})}var e8=n(37946);function e6(){let{iString:e}=(0,D.GO)();return(0,r.FD)(ez.YW,{className:e$.A.page,children:[(0,r.Y)(ee.Metadata,{title:e("Profile not found")}),(0,r.Y)(ea.p,{icon:(0,r.Y)(e8.A,{}),title:e("Profile not found"),description:e("We couldn't load this profile."),button:(0,r.Y)(el.$n,{href:(0,ei.Tvl)({params:{searching:"profile"}}),children:e("Search people on Substack")})})]})}var e9=n(95201),ie=n.n(e9),ii=n(24078),it=n(81929),ir=n(43296),il=n(16291),io=n(55714);function ia(e){let{profile:i,activeLiveStream:n,hasCoverImage:t}=e,l=(0,Z.Iu)(),o=(0,ei.pIF)(i),[a,u]=(0,s.useState)(!1),{isLive:c}=id(n);return(0,r.FD)(is,{hasCoverImage:t,children:[(0,r.FD)(iu,{onClick:()=>{c&&(null==n?void 0:n.liveStream.id)?(0,Y.V2)((0,T.Xrv)({liveStreamId:n.liveStream.id,utm_source:L.VU.profileAvatar,utm_campaign:L._9.substackProfile,params:{utm_medium:L.Jn.web}}),{local_navigation:!1}):u(!0)},children:[(0,r.Y)(ii.eu,{size:t?l?88:112:l?64:88,user:i,className:j()(c?"liveStreamAvatar-f516FN":void 0,"avatar-h98fMT")}),(0,r.Y)(ic,{isLive:c})]}),(0,r.Y)($,{isOpen:a,onClose:()=>u(!1),photoUrl:o})]})}function is(e){let{hasCoverImage:i,children:n}=e;return(0,r.Y)(G.az,{position:i?"absolute":void 0,className:i?"position-PH56bs":void 0,children:n})}function iu(e){let{onClick:i,children:n}=e;return(0,r.Y)(_.pT,{onClick:i,tabIndex:0,showFocus:!0,animate:!0,radius:"full",position:"relative",cursor:"pointer",bg:"primary",className:"container-JHgoYl",children:n})}function ic(e){let{isLive:i}=e,{iString:n}=(0,D.GO)();return i?(0,r.Y)(it.vw,{className:"liveTag-Gk0dUD",theme:"error",priority:"primary",children:n("LIVE")}):null}let id=e=>{let i=(0,ir.XW)(),[n,t]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{if(null==e?void 0:e.liveStream.id)return null==i?void 0:i.listen({[(0,io.sl)({streamId:e.liveStream.id})]:e=>{var i;let{data:n}=e;(null==n||null==(i=n.message)?void 0:i.type)==="live-stream:ended"&&t(!0)}})},[i,null==e?void 0:e.liveStream.id]),{isLive:!!(null==e?void 0:e.liveStream.id)&&"active"===e.liveStream.status&&(0,il.A)(e.liveStream.started_streaming_at).isBefore((0,il.A)().subtract(1,"minute"))&&!n}};var ip=n(54718),ih=n(82853),im=n(72170),iv=n(27775),ib=n(18931),ig=n(67078),iY=n(30622),i_=n(70416),iy=n(15734),iC=n.n(iy),iS=n(82519),iw=n(15667),ik=n(94874),iI=n(554),iE=n(69058),iD=n(44080);function iA(e){let{user:i,profile:n}=e,{iString:t}=(0,D.GO)(),{popToast:l}=(0,C.d)(),[o,a]=(0,s.useState)(!1),{refetch:u,isLoading:c}=(0,eI.st)({pathname:"/api/v1/@".concat(n.handle,"/personal-initialize"),method:"post"}),d=async()=>{(0,f.u4)(f.qY.PROFILE_MENU_DASHBOARD_LINK_CLICKED);let e=await u({query:{action:"access_dashboard"}});e instanceof Error?(console.error(e),l(()=>(0,r.Y)(C.y,{text:"Something went wrong. Please try again.",Icon:eW.A}))):(a(!0),location.href=e.redirectUrl)},p=i?(0,ei.yRA)(i,{params:{utm_source:L.VU.substack}}):void 0;return p||n.isPersonalEligible?(0,r.Y)(eq.Dr,{leading:(0,r.Y)(iD.A,{}),disabled:c||o,onClick:p?void 0:d,href:p,children:t("Publisher dashboard")}):null}var iP=n(78526),iF=n(62203);function ix(){let e=(0,w._)([""," only accepts messages from subscribers"]);return ix=function(){return e},e}function iT(){let e=(0,w._)([""," only accepts messages from paid subscribers"]);return iT=function(){return e},e}function iL(){let e=(0,w._)([""," only accepts messages from founding members"]);return iL=function(){return e},e}let iN=(0,T.W$o)({utm_source:L.VU.substack}),iO=e=>{var i,n,l;let{profile:o,subscribeButton:a,yourProfile:u,user:c,onShare:p,showCTAs:h}=e,{iString:m}=(0,D.GO)(),v=(0,Z.Iu)(),{isEligibleForLiveStreamCreation:b}=(0,W.eE)(),g=(0,d.bd)(o,{surface:"profile",onClick(e){(0,f.u4)(f.qY.PROFILE_BLOCKED_MUTED_CHANGED,{action:e,target_user_id:o.id})}}),[Y,y]=(0,s.useState)(!1),C=(0,iP.L)(),S=()=>{C((0,ei.gYq)(o))},w=(0,ik.F)({source:"profile"}),k=(0,eD.NP)(),I=null==o||null==(i=o.publicationUsers)?void 0:i.find(e=>(0,ex.isAtLeastContributorRole)(e.role)),E=I||(null==o?void 0:o.isPersonalEligible),A={size:v?"sm":"md",flex:"grow"};return(0,r.FD)(_.pT,{gap:8,direction:"row",justifyContent:"end",children:[!u&&(0,r.FD)(r.FK,{children:[a,h&&!a&&(0,r.Y)(iB,(0,t._)({profile:o},A)),o.can_dm?(0,r.Y)(iV,(0,t._)({profile:o},A)):(null!=(l=null==(n=o.dm_upgrade_options)?void 0:n.length)?l:0)>0&&o.primaryPublication&&(0,r.Y)(iR,(0,t._)({profile:o,publication:o.primaryPublication},A)),(0,r.FD)(eq.W1,{trigger:(0,r.Y)(el.K0,{size:A.size,children:(0,r.Y)(ip.A,{size:20})}),children:[(0,r.Y)(eq.Dr,{leading:(0,r.Y)(ih.A,{}),priority:"primary",onClick:S,children:m("Copy link")}),(0,r.Y)(eq.Dr,{leading:(0,r.Y)(im.A,{}),onClick:p,children:m("Share")}),(0,r.FD)(eq.H9,{children:[o.can_dm&&(0,r.Y)(eq.Dr,{leading:(0,r.Y)(iv.A,{}),onClick:()=>w.handleStart([o.id]),children:m("Send message")}),(0,r.Y)(iz,(0,t._)({profile:o},A)),o.primaryPublication&&["free_can_upgrade","free_can_pledge"].includes(o.primaryPublicationSubscriptionState)&&(0,r.Y)(eq.Dr,{leading:(0,r.Y)(eH.A,{}),href:(0,ei.FCy)(o.primaryPublication,{addBase:!0}),children:m("Manage Subscription")}),o.subscribesToViewerSubdomain&&(0,r.Y)(eq.Dr,{leading:(0,r.Y)(ib.A,{}),href:(0,ei.w8b)({subdomain:o.subscribesToViewerSubdomain},{userId:o.id},{addBase:!0}),children:m("Subscriber details")})]}),(0,r.FD)(eq.H9,{children:[g,(0,r.Y)(eq.Dr,{leading:(0,r.Y)(e8.A,{}),priority:"destructive",onClick:()=>y(!0),children:m("Report")})]}),(null==c?void 0:c.is_global_admin)&&(0,r.Y)(eq.H9,{children:(0,r.Y)(eq.Dr,{leading:(0,r.Y)(ib.A,{}),priority:"secondary",onClick:()=>window.location.href=(0,ei.CHS)(o.id),children:m("Open in Underground")})})]}),(0,r.Y)(iw.H,{canReportToAdmins:!1,isOpen:Y,onClose:()=>y(!1),onSubmit:async e=>{let{reportCategory:i,details:n}=e;await iC().post("/api/v1/users/".concat(o.id,"/profile/report")).send({details:n,reportCategory:i,surface:"profile"}),y(!1)},reasons:iw.w})]}),h&&u&&(0,r.FD)(r.FK,{children:[o&&E?(0,r.Y)(iI.s,{trigger:(0,r.Y)(el.$n,(0,e_._)((0,t._)({trailing:(0,r.Y)(iS.A,{color:"var(--color-button-fg)"}),"aria-label":m("Create")},A),{children:m("Create")})),profile:o,publicationUser:I,onNoteClick:()=>k.open({}),isEligibleForLiveStreamCreation:b}):o.profile_set_up_at?(0,r.Y)(el.$n,(0,e_._)((0,t._)({},A),{onClick:p,children:m("Share profile")})):(0,r.Y)(el.$n,(0,e_._)((0,t._)({},A),{href:iN,localNavigation:!1,children:m("Set up profile")})),(0,r.Y)(el.$n,(0,e_._)((0,t._)({},A),{priority:"secondary",href:(0,ei.rj)(),children:m("Edit profile")})),(0,r.FD)(eq.W1,{trigger:(0,r.Y)(el.K0,{size:A.size,children:(0,r.Y)(ip.A,{size:20})}),children:[(0,r.Y)(eq.Dr,{leading:(0,r.Y)(ih.A,{}),priority:"primary",onClick:S,children:m("Copy link")}),(0,r.Y)(eq.Dr,{leading:(0,r.Y)(im.A,{}),onClick:p,children:m("Share")}),(0,r.Y)(eq.H9,{children:(0,r.Y)(iA,{user:c,profile:o})}),(null==c?void 0:c.is_global_admin)&&(0,r.Y)(eq.H9,{children:(0,r.Y)(eq.Dr,{leading:(0,r.Y)(ib.A,{}),priority:"secondary",onClick:()=>window.location.href=(0,ei.CHS)(o.id),children:m("Open in Underground")})})]})]})]})};function iV(e){let{profile:i,size:n,flex:t}=e,{isLoading:l,handleStart:o}=(0,ik.F)({source:"profile"}),{iString:a}=(0,D.GO)();return(0,r.Y)(el.$n,{priority:"secondary",onClick:()=>o([i.id]),disabled:l,size:n,flex:t,children:a("Message")})}function iR(e){let{profile:i,publication:n,size:l,flex:o}=e,{iString:a,iTemplate:s}=(0,D.GO)(),u=(0,m.Jd)(),c=(0,iF.h)(),{dm_upgrade_options:d}=i,p=null==d?void 0:d.includes("free_subscribers"),h=null==d?void 0:d.includes("paid_subscribers");return(0,r.FD)(r.FK,{children:[(0,r.Y)(el.$n,{priority:"secondary",leading:(0,r.Y)(ig.A,{size:20}),onClick:c.onOpen,size:l,flex:o,children:a("Message")}),(0,r.Y)(A.aF,(0,e_._)((0,t._)({},c),{width:360,children:(0,r.FD)(iE.d,{title:a(p?"Subscribers only":h?"Paid subscribers only":"Founding members only"),subtitle:s(p?ix():h?iT():iL(),i.name),onClose:c.onClose,children:[(0,r.Y)(el.$n,{priority:"primary",href:(0,T.eV6)(n,{user:u,addBase:!0,params:{next:document.location.href,utm_source:"profile-dm",utm_medium:L.Jn.web,utm_campaign:L._9.substackProfile}}),children:a("Subscribe")}),(0,r.Y)(el.$n,{priority:"secondary",onClick:c.onClose,children:a("Cancel")})]})}))]})}function iz(e){let{profile:i}=e,{iString:n}=(0,D.GO)(),{isFollowing:l,buttonProps:o}=(0,p.km)(i,"profile");return(0,r.Y)(eq.Dr,(0,e_._)((0,t._)({leading:l?(0,r.Y)(iY.A,{}):(0,r.Y)(i_.A,{})},o),{children:n(l?"Unfollow":"Follow")}))}function iB(e){let{profile:i,size:n,flex:l}=e,{isFollowing:o,buttonProps:a}=(0,p.km)(i,"profile"),{iString:s}=(0,D.GO)();return(0,r.Y)(el.$n,(0,e_._)((0,t._)({priority:o?"secondary":"primary",size:n,flex:l},a),{children:s(o?"Following":i.followsViewer?"Follow back":"Follow")}))}var iU=n(66803),iM=n(95701),iH=n(60745),iW=n(9184),iq=n(49031),ij=n(84713),iG=n(34581),iK=n(61039),i$=n(23571),iZ=n(76891),iJ=n(65217),iX=n(38685),iQ=n(65590),i0=n(93946),i1=n(11993);let i2={books:{icon:(0,r.Y)(iW.A,{size:16}),label:"Book"},facebook:{icon:(0,r.Y)(iq.A,{size:16}),label:"Facebook"},instagram:{icon:(0,r.Y)(ij.A,{size:16}),label:"Instagram"},linkedin:{icon:(0,r.Y)(iG.A,{size:16}),label:"LinkedIn"},youtube:{icon:(0,r.Y)(iQ.A,{size:16}),label:"YouTube"},tiktok:{icon:(0,r.Y)(iJ.A,{size:16}),label:"TikTok"},bluesky:{icon:(0,r.Y)(iH.A,{size:16}),label:"Bluesky"},soundcloud:{icon:(0,r.Y)(iZ.A,{size:16}),label:"Soundcloud"},bandcamp:{icon:(0,r.Y)(iM.A,{size:16}),label:"Bandcamp"},reddit:{icon:(0,r.Y)(i$.A,{size:16}),label:"Reddit"},twitter:{icon:(0,r.Y)(iX.A,{size:16}),label:"Twitter",verifiedIcon:(0,r.Y)(iU.A,{className:j()(e$.A.fillIcon,e$.A.twitterVerifiedIcon),size:18})}},i4={icon:(0,r.Y)(iK.A,{size:16,stroke:"var(--color-fg-primary) !important"}),label:"Website"};function i7(e){var i;if(!e.type)return i4.icon;let n=i2[e.type];return null!=(i=null==n?void 0:n.icon)?i:i4.icon}function i5(e){return e?Object.keys(i2).indexOf(e):-1}var i3=n(65915);let i8="chip-fQexYY";function i6(e){var i,n,t,l;let o,a,s,u,{link:c}=e;return(0,r.Y)(i3.v,{leading:(0,r.Y)(i9,{children:i7(c)}),href:c.url,newTab:!0,className:i8,children:(o="Link",a=null===c.type,t=c.value,s=!!(0,i0.TZ)(t)||!!(0,i0.TZ)("https://".concat(t))&&t.includes(".")&&!t.includes(" "),u="books"===c.type||"facebook"===c.type?c.value:null==(i=(null==(l=c.value)?void 0:l.startsWith("@"))?l:l?"@".concat(l):null)?void 0:i.toLocaleLowerCase(),a?(0,i1.H)(c.value,0,!1):s?null!=(n=c.label)?n:o:null!=u?u:o)})}let i9=(0,y.I4)({display:"flex",alignItems:"center",justifyContent:"center",paddingLeft:4});function ne(e){let{pubs:i,links:n,onChipClick:t,params:l}=e,o=i.length+n.length;return(0,r.FD)(eq.W1,{trigger:(0,r.Y)(i3.v,{flex:"auto",children:"+".concat(o.toLocaleString())}),placement:"bottom-start",children:[i.length>0&&i.map(e=>(0,r.Y)(nn,{pub:e,onClick:t,params:l},e.id)),n.length>0&&n.map(e=>(0,r.Y)(ni,{userLink:e},e.url))]})}function ni(e){var i;let{userLink:n}=e,t=n.type&&i2[n.type],l=null!=(i=null==t?void 0:t.label)?i:n.value;return(0,r.Y)(eq.Dr,{leading:i7(n),href:n.url,target:"_blank",children:(0,r.Y)(nt,{title:l,body:n.value})},n.url)}function nn(e){let{pub:i,onClick:n,params:t}=e;return(0,r.Y)(eq.Dr,{leading:(0,r.Y)(er.az,{children:(0,r.Y)(P.Nq,{pub:i,size:20,radius:"xs"})}),href:(0,ei.fOI)(i,{params:t}),onClick:e=>n({e,pub:i}),children:(0,r.Y)(nt,{title:i.name,body:i.subdomain})},i.id)}function nt(e){let{title:i,body:n}=e;return(0,r.FD)(_.VP,{minWidth:0,children:[(0,r.Y)(F.EY.B4,{weight:"semibold",maxWidth:200,ellipsis:!0,children:i}),(0,r.Y)(F.EY.B4,{color:"secondary",maxWidth:200,ellipsis:!0,children:n})]})}var nr=n(84777);function nl(e){let{pub:i,onClick:n,params:t}=e;return(0,r.Y)(nr.m,{pubId:i.id,trigger:(0,r.Y)(i3.v,{leading:(0,r.Y)(P.Nq,{pub:i,size:20,radius:"full",alt:""}),href:(0,ei.fOI)(i,{params:t}),onClick:e=>n({e,pub:i}),newTab:!0,className:i8,flex:"auto",children:i.name})})}function no(e){var i;let n,t,l,o,a,u,c,{profile:d,primaryPublication:p,utmParams:h}=e,{visibleChips:m,overflowChips:v,handleChipClick:b}=(n=(0,Z.Iu)(),t=(0,iP.L)(),l=(0,eb.BR)().isOnDestination,o=n?2:3,u=(a=d.publicationUsers.filter(e=>{var i;return(null==(i=e.publication)?void 0:i.id)!==(null==p?void 0:p.id)})).length>0?ev()(a.map(e=>e.publication)):[],{visibleChips:(c=[p,...u,...(null!=(i=d.userLinks)?i:[]).sort((e,i)=>{let n=i5(e.type),t=i5(i.type);if(n!==t)return n-t;let r=String(e.id||""),l=String(i.id||"");return r.localeCompare(l)})].filter(Boolean)).slice(0,o),overflowChips:c.slice(o),handleChipClick:e=>{let{e:i,pub:n}=e,r=(0,ei.fOI)(n,{params:void 0}),o=!1;try{o=!l&&(window.location.origin===new URL(r).origin||n.custom_domain===window.location.hostname)}catch(e){o=!1}o?(i.preventDefault(),t(r),(0,f.u4)(f.qY.PUBLICATION_URL_COPIED)):(0,f.fN)(n,"profile")}}),g=e=>!!(e&&"object"==typeof e&&"subdomain"in e),Y=e=>!!(e&&"object"==typeof e&&"type"in e),_=(0,s.useMemo)(()=>m.filter(g),[m]),y=(0,s.useMemo)(()=>m.filter(Y),[m]),C=(0,s.useMemo)(()=>v.filter(g),[v]),S=(0,s.useMemo)(()=>v.filter(Y),[v]);return(0,r.FD)(na,{children:[_.map(e=>(0,r.Y)(nl,{pub:e,onClick:b,params:h},"pub-".concat(e.id))),y.map(e=>(0,r.Y)(i6,{link:e},"link-".concat(e.id))),v.length>0&&(0,r.Y)(ne,{pubs:C,links:S,onChipClick:b,params:h})]})}let na=(0,y.I4)({display:"flex",gap:6,wrap:"nowrap"});var ns=n(25859),nu=n(22057),nc=n(73030);function nd(e){let{profile:i}=e,{leaderboardRanking:n}=i;if(!n)return null;let t=(0,nc.kN)(n);return(0,r.FD)(r.FK,{children:[(0,r.Y)(F.EY.B3,{color:"secondary",as:"span",children:"  "}),(0,r.Y)(F.EY.B3,{color:"accent",as:"span",children:(0,r.Y)(ns.Yq,{href:(0,T.Rtp)({categoryId:n.category_id,ranking:n.ranking,utm_source:"profile",focusedPubId:n.publication_id,backAction:(0,ei.gYq)(i)}),children:t})})]})}function np(e){let{profile:i,yourProfile:n}=e;return(0,r.FD)(_.fI,{alignItems:"center",wrap:"wrap",gap:8,children:[(0,r.Y)(nh,{profile:i,yourProfile:n}),(0,r.Y)(nd,{profile:i})]})}function nh(e){let{profile:i,yourProfile:n}=e;return n||!i.mutualsContext?(0,r.Y)(nf,{profile:i}):(0,r.Y)(nm,{profile:i})}function nm(e){let{profile:i}=e,n=i.mutualsContext;if(!(n&&n.users.length>0))return(0,r.Y)(nf,{profile:i});let t=n.users.filter(e=>e.name);return(0,r.FD)(nb,{children:[(0,r.Y)(nv,{faces:t}),(0,r.Y)(nf,{profile:i})]})}function nf(e){let{profile:i}=e,n=(0,eb.BR)().isOnDestination?(0,T.o4H)(i,null,{noBase:!0}):"/profile/subscribers";return(0,r.Y)(F.EY.B3,{color:"secondary",children:(0,r.Y)(ns.Yq,{href:n,state:{showBack:!0},decoration:"hover-underline",color:"secondary",children:i.subscriberCountString})})}function nv(e){let{faces:i}=e;return(0,r.Y)(nu.Z,{users:i,max:3,size:20,renderAvatar:e=>(0,r.Y)(ii.tp,(0,t._)({},e))})}let nb=(0,er.I4)({display:"flex",direction:"row",gap:12,minWidth:0,alignItems:"center"});var ng=n(66511),nY=n(85520);function n_(e){let{profile:i,yourProfile:n}=e;return i.handle?(0,r.Y)(ny,{profile:i}):n?(0,r.Y)(nC,{}):null}let ny=e=>{let{profile:i}=e,n=(0,Z.Iu)(),t=(0,iP.L)();return(0,r.Y)(F.EY.B3,{color:"secondary",children:(0,r.Y)(ns.Yq,{onClick:()=>{(0,f.u4)(f.qY.PROFILE_LINK_COPIED,{surface:"profile_page",profile_link:i.subdomainUrl,shared_user_id:i.id}),t((0,ei.gYq)(i))},cursor:"pointer",decoration:"hover-underline",children:(0,r.Y)(ng.m_,{text:"Copy link",disabled:n,side:"left",children:"@".concat(i.handle)})})})};function nC(){let{iString:e}=(0,D.GO)();return(0,r.FD)(_.fI,{gap:4,alignItems:"center",children:[(0,r.Y)(eQ.A,{size:16,stroke:"var(--color-accent-themed)"}),(0,r.Y)(F.EY.B3,{color:"accent",children:(0,r.Y)(ns.Yq,{href:(0,ei.rj)({params:{utm_source:L.VU.handleNotification,[nY.B9]:!0}}),children:e("Claim your handle")})})]})}var nS=n(49095);function nw(e){var i,n;let{profile:t,yourProfile:l,user:o,showCTAs:a,subscribeButton:s,onShare:u,activeLiveStream:c,primaryPublication:d,isBlocked:p}=e,h=!!(null==(n=t.theme)||null==(i=n.cover_image)?void 0:i.url);return(0,r.FD)(nD,{children:[(0,r.FD)(nP,{children:[(0,r.FD)(nA,{hasCoverImage:h,children:[(0,r.Y)(nk,{profile:t}),(0,r.FD)(_.fI,{gap:8,alignItems:"center",children:[(0,r.Y)(n_,{profile:t,yourProfile:l}),(0,r.Y)(nS.ProfileRelationshipBadge,{profile:t})]})]}),(0,r.Y)(ia,{profile:t,activeLiveStream:c,hasCoverImage:h})]}),(0,r.Y)(nI,{profile:t}),!p&&(0,r.FD)(r.FK,{children:[(0,r.Y)(no,{profile:t,primaryPublication:d,utmParams:{utm_campaign:L._9.profileChips}}),(0,r.Y)(np,{profile:t,yourProfile:l}),(0,r.Y)(iO,{subscribeButton:s,profile:t,yourProfile:l,user:o,showCTAs:a,onShare:u})]})]})}function nk(e){let{profile:i}=e,{iString:n}=(0,D.GO)(),t=(0,Z.Iu)(),l=i.name||n("Substack user");return(0,r.FD)(F.EY.H4,{fontWeight:"bold",as:"span",size:t?17:20,children:[l,(0,r.Y)(nE,{profile:i})]})}function nI(e){let{profile:i}=e;return i.bio?(0,r.Y)(F.EY.B3,{children:(0,r.Y)(ie(),{options:{attributes:{rel:"nofollow ugc"}},children:i.bio})}):null}function nE(e){var i;let{profile:n}=e;return(null==(i=n.status)?void 0:i.badge)?(0,r.FD)("span",{style:{whiteSpace:"nowrap"},children:["\xa0",(0,r.Y)(F.EY,{as:"span",paddingLeft:4,children:(0,r.Y)(nS.UserStatusSymbols,{status:n.status,userId:n.id,inline:!0,size:"md",hideViewProfileButton:!0,noRelationshipBadge:!0})})]}):null}function nD(e){let{children:i}=e;return(0,r.Y)(_.VP,{display:"flex",direction:"column",gap:12,paddingTop:16,children:i})}function nA(e){let{children:i,hasCoverImage:n}=e,t=(0,Z.Iu)();return(0,r.Y)(_.VP,{display:"flex",direction:"column",gap:{desktop:2,mobile:0},style:{paddingRight:n?20+(t?88:112):void 0},children:i})}let nP=(0,y.I4)({display:"flex",direction:"row",justifyContent:"space-between",alignItems:"center",position:"relative"});var nF=n(32641),nx=n(97731);let nT=e=>{var{strokeWidth:i=1.5}=e,n=(0,nF._)(e,["strokeWidth"]);return(0,r.FD)(nx.A,(0,e_._)((0,t._)({},n),{name:"UserIcon",svgParams:{width:24,height:24,viewBox:"0 0 24 24",fill:"none"},children:[(0,r.Y)("path",{d:"M20 21V19C20 17.9391 19.5786 16.9217 18.8284 16.1716C18.0783 15.4214 17.0609 15 16 15H8C6.93913 15 5.92172 15.4214 5.17157 16.1716C4.42143 16.9217 4 17.9391 4 19V21",strokeWidth:i,strokeLinecap:"round","stroke-linejoin":"round"}),(0,r.Y)("path",{d:"M12 11C14.2091 11 16 9.20914 16 7C16 4.79086 14.2091 3 12 3C9.79086 3 8 4.79086 8 7C8 9.20914 9.79086 11 12 11Z",strokeWidth:i,strokeLinecap:"round","stroke-linejoin":"round"})]}))};function nL(){let{iString:e}=(0,D.GO)();return(0,r.Y)(ez.jC,{children:(0,r.Y)(_.pT,{paddingY:64,flex:"grow",children:(0,r.Y)(ea.p,{icon:(0,r.Y)(nT,{}),title:e("You havent set up your profile yet."),description:e("Click the button below to get started."),button:(0,r.Y)(el.$n,{href:(0,ei.tFi)(),children:e("Set up profile")})})})})}var nN=n(22602);function nO(){return(0,r.Y)(_.I1,{style:{maxWidth:600},flex:"grow",children:(0,r.FD)(_.I1,{gap:{desktop:20,mobile:16},paddingTop:{desktop:32,mobile:16},paddingBottom:16,children:[(0,r.FD)(_.Ye,{justifyContent:"space-between",alignItems:"center",children:[(0,r.FD)(_.I1,{justifyContent:"center",gap:8,children:[(0,r.Y)(nN.O,{height:36,width:200}),(0,r.Y)(nN.O,{height:20,width:180})]}),(0,r.Y)(nN.O,{radius:"full",width:88,height:88})]}),(0,r.FD)(_.I1,{gap:8,flex:"grow",minWidth:0,children:[(0,r.Y)(nN.O,{height:20,width:"70%"}),(0,r.Y)(nN.O,{height:20,width:"80%"}),(0,r.Y)(nN.O,{height:20,width:"30%"})]}),(0,r.Y)(nN.O,{height:40,width:120})]})})}var nV=n(41935),nR=n(22230),nz=n(59901);function nB(e){let{postId:i,onClose:n}=e,t=(0,nR.$)(i),l=(0,eE.wA)(),o=(0,s.useRef)(null),{posts:a,publications:u,publicationSettings:c,publicationRecommendations:d}=(0,eE.Ro)(),p=a.get(i),h=(0,nV.ln)({postId:i,isSaved:!!(null==p?void 0:p.is_saved),trackSurface:"post-viewer"}),m=p?u.get(p.publication_id):void 0,f=p?c.get(p.publication_id):void 0,v=m?d.get(m.id):void 0,b=v?u.get(v.recommending_publication_id):void 0;return(0,r.Y)(nz.c,{post:p,postId:i,videoPlayerRef:o,onClose:n,onLike:t,onSave:()=>{h.onSave(),l({type:"post_save",payload:{postId:i}})},onLoad:e=>{l({type:"post_load",payload:e})},publication:m,publicationSettings:f,referringRecommendation:v,referringPub:b})}function nU(e){let{profile:i,subscriptionSource:n}=e,t=(0,Z.Iu)(),{refetch:l,isLoading:o}=(0,eI.st)({pathname:(0,T.yRP)("/api/v1/@".concat(i.handle,"/personal-initialize"),{source:n}),method:"post"}),a=async()=>{let e=await l({query:{action:"subscribe"}});if(e instanceof Error)throw e;location.href=e.redirectUrl};return i.handle?(0,r.Y)(el.$n,{priority:"primary",size:t?"sm":"md",flex:"grow",onClick:a,localNavigation:!1,disabled:o,children:"Subscribe"}):null}var nM=n(74297),nH=n(85050);function nW(e){let{user:i,profile:n,primaryPublication:l,subscriptionSource:o}=e,{iString:a}=(0,D.GO)(),u=(0,Z.Iu)(),c=(0,nH.s)({surface:"profile"}),[d,p]=(0,s.useState)(n.primaryPublicationSubscriptionState),h=(0,eG.Zm)({publication:l,subscriptionSource:"profile"}),{isLoading:m,subscribe:v}=(0,nM.M)({publication:l,profileId:n.id,source:o,params:(0,eF.cf)(),onSuccess:()=>p("free")}),b=(0,T.eV6)(l,{user:i,addBase:!0,params:{next:document.location.href,utm_source:o,utm_medium:L.Jn.web,utm_campaign:L._9.substackProfile,just_signed_up:!0}}),g=(0,eb.BR)().isOnDestination,Y={size:u?"sm":"md",flex:"grow"};return["free","paid","founding"].includes(d)?(0,r.Y)(eX,{publication:l,onUnsubscribe:async()=>{await h.unsubscribe(),p("none")},button:(0,r.Y)(el.$n,(0,e_._)((0,t._)({priority:"secondary"},Y),{children:a("Subscribed")})),manageOnly:["paid","founding"].includes(d),isPledged:n.primaryPublicationIsPledged}):"free_can_upgrade"===d?(0,r.Y)(el.$n,(0,e_._)((0,t._)({},Y),{href:b,localNavigation:!1,onClick:()=>{(0,f.u4)(f.qY.ACCOUNT_CARD_UPGRADE_CLICKED,{homepage_type:l.homepage_type,is_on_destination:g,target_user_id:n.id,target_publication_id:l.id}),(0,f.fN)(l,"hover_profile")},children:a("Upgrade")})):"free_can_pledge"===d?(0,r.Y)(el.$n,(0,e_._)((0,t._)({},Y),{href:b,localNavigation:!1,onClick:()=>{(0,f.u4)(f.qY.ACCOUNT_CARD_PLEDGE_CLICKED,{homepage_type:l.homepage_type,is_on_destination:g,target_user_id:n.id,target_publication_id:l.id}),(0,f.fN)(l,"hover_profile")},children:a("Pledge")})):"none"===d&&o===nj?i?(0,r.Y)(el.$n,(0,e_._)((0,t._)({},Y),{priority:"primary",onClick:e=>{e.preventDefault(),v()},disabled:m,children:a("Subscribe")})):(0,r.Y)(el.$n,(0,e_._)((0,t._)({},Y),{priority:"primary",onClick:c(l,n),children:a("Subscribe")})):(0,r.Y)(el.$n,(0,e_._)((0,t._)({},Y),{href:b,localNavigation:!1,onClick:()=>{(0,f.u4)(f.qY.ACCOUNT_CARD_SUBSCRIBE_CLICKED,{homepage_type:l.homepage_type,is_on_destination:g,target_user_id:n.id,target_publication_id:l.id}),(0,f.fN)(l,"hover_profile")},title:l.name,children:a("Subscribe")}))}var nq=n(14984);let nj="profile-page-feed";function nG(e){var i,n,l,o;let b,_,y,w,{id:k,subpath:I,initialData:{profileSubscribeOnTransit:E=!1,referringUser:D,freeSignup:A,freeSignupEmail:P,activeLiveStream:F,subscriptionToLiveStreamPub:T,invitedLiveStreamPublications:L,subscriptionsToLiveStreamInvitedPub:N,shareImageVariantFromQuery:O}}=e,V=(0,m.Jd)(),R=(0,g.lq)(),[z,B]=(0,s.useState)(!1),U=(0,C.d)(),[H]=(0,s.useState)(!!((0,x.y)("followPrompt")&&D)),{addSurface:q}=(0,nq.fk)();(0,W.t2)(""),k.includes("-")?(y=function(e){let i=e.split("-")[0];if(!i)return -1;let n=parseInt(i);return isNaN(n)?-1:n}(k),w=(b=k.split("-")).length?b.slice(1).join("-"):""):y=k;let{subjectProfile:j,error:G}=(0,h.xc)({subjectId:y,subjectName:w}),K=RegExp("/p-(\\d+)"),$=null,Z=I.match(K);Z&&Z[1]&&($=Number(Z[1]));let J=(0,d.Hv)(null==j?void 0:j.id),X="blocked"===J||"blocking"===J,ee=!!(null==j?void 0:j.profile_set_up_at),et=j&&j.id===(null==V?void 0:V.id),er=(null==j?void 0:j.subscriptions)||[],el=(null==j?void 0:j.primaryPublication)&&(null==(i=j.publicationUsers.find(e=>{var i;return e.publication_id===(null==j||null==(i=j.primaryPublication)?void 0:i.id)}))?void 0:i.publication),eo=!!(el&&(null==j?void 0:j.isSubscribed)),ea=(0,p.cC)(j,"profile");(0,s.useEffect)(()=>{var e;(null==(e=new URL(document.location.href).searchParams)?void 0:e.has("invite"))?(0,Y.V2)("/app",{local_navigation:!1}):j&&((0,f.u4)(f.qY.PROFILE_VISITED,(0,t._)({profile_user_id:j.id,is_set_up:ee,is_self:et,has_name:!!j.name,has_photo:!!j.photo_url,has_bio:!!j.bio,has_twitter:!!j.twitterAccount,reads_count:j.visibleSubscriptionsCount,writes_count:j.publicationUsers.length,subscribe_cta_publication_id:!eo&&(null==el?void 0:el.id),live_stream_id:null==F?void 0:F.liveStream.id,primary_publication_id:null==el?void 0:el.id,is_free_subscribed:!["none"].includes(j.primaryPublicationSubscriptionState),is_subscribed:["paid","founding","author"].includes(j.primaryPublicationSubscriptionState)},(0,ex.extractEventAttributionDataFromRecord)((0,eF.cf)()))),E&&((0,Y.qm)("subscribed"),U.popToast(()=>(0,r.Y)(C.y,{text:"Subscribed to ".concat((null==el?void 0:el.name)||j.name||"user"),Icon:a.A}))))},[k,j]),(0,s.useEffect)(()=>{var e;(null==(e=new URL(document.location.href).searchParams)?void 0:e.has("follow"))&&j&&ea.isLoaded&&((0,Y.qm)("follow"),et||ea.isFollowing||ea.toggle())},[k,j,ea.isLoaded]),(0,s.useEffect)(()=>{V&&j&&q({type:"visited-profile",profile:j})},[q,j,V]);let{url:es}=(0,g.zy)(),eu=(n=es,l=(0,v.tm)(),(_=null==(o=new URL(n,"https://monograph.dev").searchParams)?void 0:o.get("utm_source"))&&nJ.includes(_)||(null==l?void 0:l.source)&&nJ.includes(l.source))?nj:"profile-page",ec=(0,x.y)(document.location.href,"liveStream")&&(null==F?void 0:F.liveStream.id),ed=null;j&&!et&&!X&&(el?ed=(0,r.Y)(nW,{user:V,profile:j,primaryPublication:el,subscriptionSource:eu}):j.isPersonalEligible&&(ed=(0,r.Y)(nU,{profile:j,subscriptionSource:eu})));let em=null!=ed;return((0,s.useEffect)(()=>{if(!j)return;let e=[];if(et)e.push("share","edit");else{var i;em&&e.push((null==j?void 0:j.isSubscribed)?"subscribed":"subscribe"),j.isSubscribed||e.push(j.isFollowing?"following":"follow"),(j.can_dm||(null!=(i=j.dm_upgrade_options)?i:[]).length>0)&&e.push("message")}0!==e.length&&(0,f.u4)(f.qY.PROFILE_PRIMARY_ACTIONS_SHOWN,{actions:e})},[j,et,em]),G)?(0,r.Y)(e6,{}):j?(0,r.Y)(S.b,{theme:j.theme,children:(0,r.FD)(nK,{children:[(0,r.Y)(en,{profile:j,activeLiveStream:F,shareImageVariantFromQuery:O}),(0,r.Y)(nZ,{profile:j}),(0,r.Y)(Q,{profile:j}),(0,r.Y)(n$,{children:(0,r.Y)(nw,{profile:j,yourProfile:!!et,primaryPublication:el,user:V,showCTAs:!X,onShare:()=>B(!0),subscribeButton:ed,activeLiveStream:F,isBlocked:X})}),"blocked"===J&&(0,r.Y)(ep,{profile:j}),"blocking"===J&&(0,r.Y)(eh,{profile:j}),!X&&!!j.name&&(0,r.Y)(e3,{subscriptions:er,profile:j,subpath:I}),!ee&&et&&(0,r.Y)(nL,{}),$&&(0,r.Y)(nB,{postId:$,onClose:()=>{R((0,ei.gYq)(j,{noBase:!0}))}}),(0,r.Y)(c.Z,{isOpen:z,onClose:()=>B(!1),medium:"profile-page",user:V,profile:j}),H&&D?(0,r.Y)(u.y$,{referringUser:D,freeSignupEmail:P,forceFollowPrompt:!0,surface:"profile-follow-referrer-prompt"}):null,ec?(0,r.Y)(M,{profile:j,activeLiveStream:F,subscriptionToLiveStreamPub:T,invitedLiveStreamPublications:L,subscriptionsToLiveStreamInvitedPub:N,freeSignup:A,freeSignupEmail:P}):null]})}):(0,r.Y)(nO,{})}function nK(e){let{children:i}=e;return(0,r.Y)(_.VP,{style:{maxWidth:568},minWidth:0,flex:"grow",children:i})}let n$=(0,y.I4)({display:"flex",direction:"column",gap:8,paddingX:{desktop:0,mobile:16},paddingBottom:8,zIndex:1}),nZ=e=>{let{profile:i}=e;return(0,r.Y)("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:o()((0,b.n6)(i),{json:!0,isScriptContext:!0})}})},nJ=["feed","feed-mentions","notes-inline-suggestions","notes-all-suggestions","notes-like-list","notes-restack-list","substack-feed-item"]},45846:function(e,i,n){n.d(i,{SC:()=>a,uo:()=>s});var t=n(4006),r=n(17402),l=n(35369),o=n(19832);function a(){let[e,i]=(0,r.useState)(null);return{confirm:()=>new Promise((n,t)=>{e&&t(Error("Already confirming.")),i({resolve:n,reject:t})}),isConfirming:!!e,handleConfirm:n=>{i(null),null==e||e.resolve(n)},handleCancel:n=>{i(null),null==e||e.resolve(n)}}}function s(e){let{title:i,body:n,cancelLabel:r="Cancel",confirmLabel:a="Confirm",modal:s}=e;return(0,t.Y)(o.m,{isOpen:s.isConfirming,onClose:()=>s.handleCancel(!1),title:i,description:n,primaryButton:(0,t.Y)(l.$n,{priority:"destructive",onClick:()=>s.handleConfirm(!0),children:a}),secondaryButton:(0,t.Y)(l.$n,{priority:"secondary",onClick:()=>s.handleCancel(!1),children:r})})}},62203:function(e,i,n){n.d(i,{h:()=>r});var t=n(17402);function r(){let[e,i]=(0,t.useState)(!1);return{isOpen:e,onOpen:()=>i(!0),onClose:()=>i(!1)}}},30:function(e,i,n){function t(e,i){return e.map(i).filter(e=>null!=e)}n.d(i,{Gt:()=>t}),n(58156)},73030:function(e,i,n){n.d(i,{Ew:()=>t,kN:()=>r});let t=25,r=e=>"paid"===e.ranking?"#".concat(e.rank," in ").concat(e.category_name):"bestseller"===e.category_id?"#".concat(e.rank," New bestseller"):"#".concat(e.rank," Rising in ").concat(e.category_name)},74171:function(e,i,n){n.d(i,{GM:()=>l,dD:()=>o,ld:()=>r,mc:()=>t});let t=1920,r=1080,l=1080,o=1920},96301:function(e,i,n){n.d(i,{GU:()=>u,KB:()=>l,ZA:()=>a,cE:()=>o});var t=n(4016);let r=new Set(["subscribed","free_signup"]);function l(e){return r.has(e)}function o(e,i){if(!e)return!1;if(!i)return!0;let n=["unsubscribed","free_signup","subscribed"];return n.indexOf(e)>=n.indexOf(i)}function a(e){let{pub:i,subscriptionType:n}=e;return(0,t.ri)({pub:i})&&"comp"===n}function s(e){if(e){if(e.current_period_end){let i=e.current_period_end;return new Date("number"==typeof i?1e3*i:i)}else if(e.expiry)return new Date(e.expiry)}return null}function u(e){let i;if(!e||e.parent_subscription_id||e.is_group_parent)return!1;let n=e.type||(e.status&&"trialing"!==e.status?null:"trial");if("gift"===n||"lifetime"===n||"bitcoin"===n||"ios_app"===n)return!1;let t=s(e);return!e.cancel_at_period_end&&!((i=s(e))&&i>new Date("2100-01-01"))&&!0!==e.paused&&"past_due"!==e.status&&!("trial"===n&&t&&t>new Date&&t<new Date(Date.now()+3e5))}}}]);