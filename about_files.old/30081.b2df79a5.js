!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};e.SENTRY_RELEASE={id:"substack@af5f699"};var t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="bda5878a-76ab-4e84-bb02-6789aefaad8f",e._sentryDebugIdIdentifier="sentry-dbid-bda5878a-76ab-4e84-bb02-6789aefaad8f")}catch(e){}}();"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["30081"],{36906:function(e,t,n){n.d(t,{A:()=>i});let i={placeholder:"placeholder-lQYQJg",placeholderMessage:"placeholderMessage-GZJPyX"}},6045:function(e,t,n){n.d(t,{A:()=>i});let i={pubTheme:"pubTheme-yiXxQA",headerTheme:"headerTheme-cI2mYP",footerTheme:"footerTheme-BgBgJ9",footerSecondaryTheme:"footerSecondaryTheme-_7Juj4"}},52050:function(e,t,n){n.d(t,{A:()=>i});let i={selectedSpeaker:"selectedSpeaker-icrBiI",datetimeInput:"datetimeInput-OqKjSC",ticketButton:"ticketButton-_hOigI",ticketButtonContainer:"ticketButtonContainer-A4voWr",formLabel:"formLabel-LFkbuh",columnLabel:"columnLabel-bQ1kce",tabs:"tabs-d40s8L",carouselSection:"carouselSection-gPB50n",viewAll:"viewAll-yqgIin",activeIndicator:"activeIndicator-I76W2t",body:"body-MEXoZj",gridContainer:"gridContainer-cUzqtv",gridElement:"gridElement-yo5ihO",gridContentWide:"gridContentWide-rxBiud",minusPadding:"minusPadding-PaL7bd",header:"header-mDRyAe",upcomingEventsHeader:"upcomingEventsHeader-woqqJt",section:"section-K5XK4J",overviewContent:"overviewContent-XLjjqs",storyFilters:"storyFilters-Lww1a5",eventFilterSidebar:"eventFilterSidebar-HGZH1F",eventFiltersContainer:"eventFiltersContainer-PfCZ51",eventFilters:"eventFilters-Gdxaic",filterDrawer:"filterDrawer-fhVjQs",halfWidth:"halfWidth-O2RF3T",fullWidth:"fullWidth-PjDnZi",gridDrawer:"gridDrawer-HhS2nB",filterLabel:"filterLabel-vseYc7",isOpen:"isOpen-d3Hazm",filterInput:"filterInput-uDsFci",link:"link-yscYw4",caret:"caret-hr8414",collapsed:"collapsed-IIhTt4",presentingSponsorItem:"presentingSponsorItem-IK1Qmj",logoImage:"logoImage-kRUrob",sponsorsSection:"sponsorsSection-BrYna3",presentingSponsors:"presentingSponsors-UxJZOf",associateSponsorItem:"associateSponsorItem-zHyb7w",associateSponsors:"associateSponsors-a_8Uy9",eventSponsors:"eventSponsors-I3hh3z",accentText:"accentText-Jdzypb",clearAll:"clearAll-e_qauL",grid2:"grid2-omt62a",radioButton:"radioButton-YqfUDb",contentBlock:"contentBlock-vCbxlb",thickDivider:"thickDivider-GSdz5t",speakerContainer:"speakerContainer-Cy_jJg",subscribeButton:"subscribeButton-EGn0ZU",authorCard:"authorCard-jki8YU",eventsPreview:"eventsPreview-jo606i",seriesItem:"seriesItem-mdFy9Y",eventsContainer:"eventsContainer-oKPVOv",manifesto:"manifesto-dsJabs",keepReading:"keepReading-ZcGvRV",filterButton:"filterButton-P9_uB2"}},62227:function(e,t,n){n.d(t,{A:()=>i});let i={button:"button-NT7dt3",avatarWithPubLogo:"avatarWithPubLogo-FS3Qv7",avatar:"avatar-mn4drz",pubLogo:"pubLogo-cMWGpU",displayedBadge:"displayedBadge-gAo5ie",pubAvatar:"pubAvatar-QXvrAG",offer:"offer-BpTfs_",unavailable:"unavailable-hONyuw",description:"description-Ca932u",check:"check-lUurJO",disabledCheck:"disabledCheck-I9na7Z",originalPrice:"originalPrice-GLByyh",closeButton:"closeButton-l2SNve"}},23382:function(e,t,n){n.d(t,{A:()=>i});let i={content:"content-G_L5eC",expand:"expand-AIPHFb",collapse:"collapse-KRyDqG"}},18993:function(e,t,n){n.d(t,{Dx:()=>e7,I8:()=>eT,dw:()=>eA,eT:()=>ex,gL:()=>ef,lS:()=>eg,mj:()=>tn});var i=n(69277),r=n(70408),a=n(32641),l=n(79785),o=n(4006),s=n(50172),c=n(45994),d=n(32485),u=n.n(d),p=n(95201),h=n.n(p),m=n(99609),g=n(6896),f=n(40972),v=n(54718),b=n(35404),y=n(82853),Y=n(48587),_=n(54687),w=n(98188),C=n(37946),k=n(48686),S=n(16079),I=n(32708),F=n(65892),D=n(87677),T=n(67078),A=n(26683),E=n(73040),N=n(91461),P=n(86404),x=n(66443);n(72880);var L=n(15688),O=n(82936),B=n(84605),M=n(46275),R=n(46271),U=n(88325),j=n(25714),z=n(86500),H=n(27069),W=n(94729),V=n(72569),K=n(68349),q=n(24078),G=n(15040),J=n(35369),$=n(17028),Z=n(88774),Q=n(75303),X=n(81929),ee=n(36372),et=n(3046),en=n(46647),ei=n(69089),er=n(70486),ea=n(42831);n(53457);var el=n(32848),eo=n(20437),es=n(49807),ec=n(82776),ed=n(11993),eu=n(45464),ep=n(3898),eh=n(36083);function em(){let e=(0,l._)(["You are not allowed to post or react to this chat. ",""]);return em=function(){return e},e}function eg(e){var t,n,i;let{communityPost:r,author:a,pubRole:l,userStatus:s,extras:d,withAttribution:u,flex:p,hideReply:h,isReadOnly:g,onReply:f,onDelete:v,pub:b,truncate:y=!0,surface:Y,useClientSideRouting:_,utmSource:w,isPaid:C,isFounding:k}=e,{iString:S}=(0,B.GO)(),I=(0,c.li)(null),F=_?(0,es.e$6)({pubId:r.publication_id,postId:r.id,noBase:!0}):(0,es.sWz)({postId:r.id,utm_source:w}),D=(0,ea.d)({entityType:"communityPost",publication:b}),T=(0,O._N)(r.user_id);return(0,o.FD)(eB,{pubThemeAccentColor:null!=(i=null==b||null==(t=b.theme)?void 0:t.background_pop_color)?i:null==b?void 0:b.theme_var_background_pop,pubThemePrintOnPopColor:null==b||null==(n=b.theme)?void 0:n.print_on_pop,user:a,pubRole:l,userStatus:s,flex:p,containerRef:I,extras:d,children:[u&&(0,o.Y)(tn,{text:"From ".concat(a.name,"’s subscriber chat")}),!T&&(0,o.Y)(et.Nf,{user:a}),(0,o.Y)(eb,{actionMenuProps:{communityEntity:r,publicationId:r.publication_id,replyAction:f&&!h&&(0,o.Y)(Z.Dr,{leading:(0,o.Y)(m.A,{}),disabled:r.is_locked,onClick:f,children:S("Reply")}),onReply:g||h||r.is_locked?void 0:f,onDelete:v,onReport:D,isReadOnly:g,isFlagged:r.reported_by_user},flex:p,children:(0,o.Y)(ef,{communityPost:r,hideReply:h,userBlockStatus:T,isFounding:k,isPaid:C,isReadOnly:g,useClientSideRouting:_,utmSource:w,pub:b,truncate:y,surface:Y,author:a})}),!h&&(0,o.Y)(Q.AE,{href:F,children:(0,o.Y)(e7,{onClick:f,direction:"incoming",commenters:r.recent_commenters,count:r.comment_count,hasUnread:!!(r.most_recent_comment_created_at&&r.user_last_viewed_timestamp&&r.user_last_viewed_timestamp<r.most_recent_comment_created_at)})}),!h||r.body||r.link_metadata?(0,o.Y)(et.Xx,{direction:"incoming"}):null]})}function ef(e){let{communityPost:t,hideReply:n,userBlockStatus:a,isReadOnly:l,isFounding:s,isPaid:c,pub:d,surface:p,communityPostEmbedPostId:h,useClientSideRouting:m,utmSource:g,truncate:f,onReply:v,reactionsContext:b,handleReactionClick:y,reaction:Y,reactions:_,backAction:w,outline:C}=e,{images:k,video:S}=ev(t.mediaAttachments),I=!(k.length>0||S),F=null!=b?b:{type:"posts",id:t.id},{audience:D}=t,{canReply:T,shouldShowToken:A}=e9({audience:D,isFounding:s,isPaid:c,chatPaywallStatus:null==d?void 0:d.paywall_chat}),E=(0,er.wA)(),N=m?(0,es.e$6)({pubId:t.publication_id,postId:t.id,noBase:!0,params:{backAction:w}}):(0,es.sWz)({postId:t.id,utm_source:g}),P=function(e,t){if(!e||!(null==t?void 0:t.url))return e;let n=t.url,i=e.trim();return i.startsWith(n)?i.slice(n.length).trim():i.endsWith(n)?i.slice(0,-n.length).trim():e}(t.body,t.link_metadata),L=e=>{"feed-recommended"!==F.type&&(y?y({id:t.id,reaction:e}):ey(t.id,"posts",E,t.reaction)(e))},O=null!=Y?Y:t.reaction,B=null!=_?_:t.reactions,M=p&&(p.startsWith("chat_inbox")?"chat_inbox":(0,U.u)(p));return(0,o.FD)(eQ,{hasFooter:!n,children:[!a&&"media"===t.type&&(k.length>0||S)&&(0,o.FD)(ei.e,{context:F,reactions:B,currentReaction:O,onReactionClick:L,isReadOnly:l,children:[S&&(0,o.Y)(eo.R8,{mediaUpload:S.mediaUpload,composing:!1,maxWidth:400,videoPlayerProps:{surface:M,entityType:"community_post",entityKey:t.id,contentType:"communityPost",primaryEntityKey:h,primaryEntityType:h?"post":void 0}},S.mediaUpload.id),k&&(0,o.FD)($.az,{children:[(0,o.Y)(x.K,{assets:k.filter(e=>e.url).map(e=>({src:e.url,explicit:e.explicit,width:e.width,height:e.height})),className:u()(eu.A.imageGroup,n&&!t.body&&eu.A.isLast),maxWidth:400,maxHeight:420,readOnly:l,isContained:!0,outline:C}),A&&!t.body&&(0,o.Y)(e1,{className:eu.A.right,canReply:!!T,audience:t.audience,style:"media"})]})]}),!a&&t.link_metadata&&(0,o.Y)(ei.e,{context:F,reactions:B,currentReaction:null!=Y?Y:t.reaction,onReactionClick:L,setReactions:!!(I&&t.link_metadata),isReadOnly:l,alignSelf:"stretch",children:(0,o.Y)(et.ZT,{metadata:t.link_metadata,isFirst:I,direction:"incoming"})}),(t.body||I&&!t.link_metadata)&&(0,o.Y)(ei.e,{context:F,reactions:B,currentReaction:null!=Y?Y:t.reaction,onReactionClick:L,setReactions:I&&!t.link_metadata,isReadOnly:l,alignSelf:"stretch",children:P&&(0,o.Y)(Q.AE,{href:N,style:{display:"flex"},children:(0,o.Y)(e0,{publication:d,communityEntity:(0,r._)((0,i._)({},t),{body:P}),onClick:e=>{!e.defaultPrevented&&v&&v(e)},truncate:f,isPaid:c,isFounding:s,outline:C})})})]})}let ev=e=>{let t=[],n=null;for(let i of e)"image"===i.type?t.push(i):n||(n=i);return{images:t,video:n}};function eb(e){let{children:t,actionMenuProps:n,flex:r="grow"}=e;return(0,o.FD)($.Ye,{alignItems:"start",gap:12,flex:r,children:[(0,o.Y)(et.dU,{children:t}),(0,o.Y)(eU,(0,i._)({},n))]})}let ey=(e,t,n,i)=>async r=>{i===r?n(e_(r,e,t)):n(eY(r,e,t,i))},eY=(e,t,n,i)=>async(r,a)=>{let{iString:l,iTemplate:o}=I18N.i("en");r({type:"".concat(n,"-new_reaction"),payload:{id:t,reaction:e}});let s=await (0,A.YD)(e,t,n);if(s instanceof W.fk){var c,d;(null==(c=s.body)?void 0:c.status)==="PUBLICATION_BAN"?alert(o(em(),null==(d=s.body)?void 0:d.error)):alert(l("We failed post your reaction. Please try again later."))}else(0,H.v)(s,{message:"Failed to add reaction"});s instanceof Error&&r(i?{type:"".concat(n,"-new_reaction"),payload:{id:t,reaction:i}}:{type:"".concat(n,"-remove_reaction"),payload:{id:t,reaction:e}})},e_=(e,t,n)=>async(i,r)=>{i({type:"".concat(n,"-remove_reaction"),payload:{id:t,reaction:e}}),await (0,A.jx)(e,t,n) instanceof Error&&i({type:"".concat(n,"-new_reaction"),payload:{id:t,reaction:e}})};async function ew(e,t){try{return await fetch("/api/v1/community/posts/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({is_locked:t})})}catch(e){return e}}async function eC(e,t){try{return await fetch("/api/v1/community/comments/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({is_locked:t})})}catch(e){return e}}async function ek(e,t){try{return await fetch("/api/v1/community/comments/".concat(e,"/publication_bans?ban=").concat(t.toString()),{method:"POST"})}catch(e){return e}}async function eS(e){try{return await (0,W.x6)("/api/v1/community/comments/".concat(e),{method:"DELETE",json:{commentId:e}})}catch(e){return e}}async function eI(e){try{return await (0,W.x6)("/api/v1/community/comments/".concat(e),{method:"GET"})}catch(e){return console.warn(e),e}}async function eF(e){try{return await (0,W.x6)("/api/v1/community/posts/".concat(e),{method:"GET"})}catch(e){return console.warn(e),e}}async function eD(e){try{return await (0,W.x6)("/api/v1/community/posts/".concat(e),{method:"DELETE",json:{postId:e}})}catch(e){return e}}function eT(e){let{author:t,extras:n,showReply:a=!0,analyticsParams:l,commenters:s,count:d,audience:u,paywallInfo:p,onClick:h}=e;return(0,c.vJ)(()=>{var e;l&&(0,z.u4)(z.qY.THREAD_PAYWALL_SCREEN_VIEWED,(0,r._)((0,i._)({},l),{audience:u&&("only_founding"===(e=u)?"founding":"only_paid"===e?"paid":"free")}))},[]),(0,o.FD)(eB,{user:t,extras:n,children:[t&&(0,o.Y)(et.Nf,{user:t}),(0,o.FD)(eQ,{children:[p?(0,o.Y)(te,{audience:u,paywallInfo:p,onClick:h}):(0,o.Y)(e8,{audience:u,onClick:h}),a&&(0,o.Y)(e7,{isLocked:!0,direction:"incoming",commenters:s,count:d,onClick:h})]})]})}function eA(e){let{author:t,extras:n,showReply:i=!0,commenters:r,count:a}=e;return(0,o.Y)(eB,{user:t,extras:n,children:(0,o.FD)(eQ,{children:[(0,o.Y)(e5,{}),i&&(0,o.Y)(e7,{isLocked:!0,direction:"incoming",commenters:r,count:a})]})})}function eE(e){return"string"==typeof e.message}function eN(e){let{text:t,rawText:n,specialText:i,mentionMap:r,direction:a="incoming",limit:l=600,linkify:s=!0}=e,{iString:d}=(0,B.GO)(),[p,h]=(0,c.J0)(!1);if(i)return(0,o.Y)("em",{children:i});if(!t)return(0,o.Y)(o.FK,{});let m=[{characters:t.length,message:t}];n&&r&&(m=function(e,t,n){let i=/\$\{(\d+)\}/g,r=i.exec(e),a=[],l=0;for(;r;){var s,c,d;let u=t[Number(r[1])],p=u.text.slice(1);u?(r.index>l&&a.push({characters:r.index-l,message:e.slice(l,r.index)}),a.push({characters:u.text.length,message:(s=u.user_id,c=p,d=n,(0,o.Y)(j.P,{id:s,label:c,type:"user",unstyled:"outgoing"===d}))})):a.push({characters:i.lastIndex-l,message:e.slice(l,i.lastIndex)}),l=i.lastIndex,r=i.exec(e)}return l<e.length&&a.push({characters:e.length-l,message:e.slice(l)}),a}(n,r,a));let{alwaysShow:g,afterExpansion:f}=function(e,t){let n=0,i=[],r=[];for(let a of e){let e=a;if(n<t){if(n+e.characters>t&&eE(e)){let i=t-n,a={characters:i,message:e.message.slice(0,i)},l={characters:e.characters-i,message:e.message.slice(i)};e=a,r.push(l)}n+=e.characters,i.push(e)}else r.push(e)}return{alwaysShow:i,afterExpansion:r}}(m,l),v=f.length>0;return(0,o.FD)(o.FK,{children:[g.map(e=>s&&eE(e)?(0,o.Y)(eP,{children:e.message}):e.message),v&&!p&&(0,o.FD)(o.FK,{children:[(0,o.Y)("span",{children:" "}),(0,o.Y)(J.Nm,{resetCss:!0,className:u()(eu.A.readMore,eu.A[a]),onClick:e=>{e.preventDefault(),h(!0)},children:d("See more")})]}),v&&p&&(0,o.Y)(o.FK,{children:f.map(e=>s&&eE(e)?(0,o.Y)(eP,{children:e.message}):e.message)})]})}function eP(e){let{children:t}=e;return(0,o.Y)(h(),{options:{attributes:{rel:"nofollow ugc",onClick:e=>e.stopPropagation()},className:eu.A.textLink,format:(e,t)=>"url"===t?(0,ed.H)(e,64):e},children:t})}function ex(e){var{communityComment:t,quoteReply:n,isTargeted:r,isBanned:l,pubRole:s,isNew:c,error:d}=e,u=(0,a._)(e,["communityComment","quoteReply","isTargeted","isBanned","pubRole","isNew","error"]);return(0,o.Y)(eL,(0,i._)({isTargeted:r,isNew:c,comments:[{communityComment:t,quoteReply:n,isBanned:l,pubRole:s,isNew:c,error:d}]},u))}function eL(e){let{comments:t,author:n,isNew:i,chatPublicationId:r,hideReply:a,onReply:l,onNewQuote:c,onQuoteReplyClick:d,onDelete:u,commentRef:p,isTargeted:h,isReadOnly:m,chatAuthorNameAttribution:f,extras:v,flex:b,pub:y}=e,Y=(0,er.wA)(),_=t[t.length-1].communityComment,{reply_count:w=0,recent_commenters:C=[]}=null!=_?_:{},k=(0,ea.d)({entityType:"communityComment",publication:y}),S=!a&&w>0,I=t[0],{communityComment:F}=I;return(0,o.FD)(eB,{user:n,pubRole:t[0].pubRole,containerRef:p,id:"comment-".concat(null==_?void 0:_.id),flex:b,extras:v,children:[f&&(0,o.Y)(tn,{text:"Comment from ".concat(f,"’s subscriber chat")}),(0,o.Y)(eb,{actionMenuProps:{communityEntity:F,isBanned:I.isBanned,isFlagged:F.reported_by_user,replyAction:l&&(0,o.Y)(Z.Dr,{disabled:!!F.is_locked,onClick:l,leading:(0,o.Y)(g.A,{}),children:"Reply in ".concat(0===w?"a new":"","thread")}),onDelete:u,onNewQuote:c,onReport:k,isReadOnly:m,publicationId:r,isNew:i},flex:b,children:(0,o.Y)(eQ,{hasFooter:S,children:t.map((e,n)=>{var i,r;let{communityComment:{id:a,body:c,quote_id:u,media_uploads:p,reactions:g,reaction:f,reported_by_user:v},quoteReply:b,isNew:y,error:_}=e;return(0,o.FD)(s.Fragment,{children:[!y&&!v&&p&&p.length>0&&null===u&&(0,o.FD)(ei.e,{context:{type:"comments",id:a},reactions:g,currentReaction:f,onReactionClick:ey(a,"comments",Y,f),isReadOnly:m||y,children:[(0,o.Y)(L.f,{mediaAssets:(null!=p?p:[]).filter(e=>e.media_upload_id).map(e=>({media_upload_id:e.media_upload_id})),surface:"chat_inbox",entityType:"community_comment",entityKey:a,contentType:"communityComment"}),(0,o.Y)(x.K,{assets:p.filter(e=>e.url).map(e=>({src:e.url,explicit:!!e.is_explicit,width:e.image_width,height:e.image_height})),className:eu.A.ImageGrid,maxWidth:400,maxHeight:420,readOnly:m,isContained:!0})]}),c&&(0,o.Y)(ei.e,{context:{type:"comments",id:a},reactions:g,currentReaction:f,onReactionClick:ey(a,"comments",Y,f),setReactions:!p||0===p.length,isReadOnly:m||y,children:(0,o.FD)(eX,{isTargeted:h,onClick:l,children:[b&&(0,o.Y)(e6,{body:b.comment.body,author:null!=(r=null==(i=b.user)?void 0:i.name)?r:"",onClick:d,direction:"outgoing"}),(0,o.Y)(e3,{communityEntity:t[n].communityComment})]})}),_&&(0,o.Y)($.EY.B5,{color:"error",children:"\uDBC0\uDC5F Not delivered."})]},a)})})}),S&&(0,o.Y)(Q.AE,{href:(0,es.e$6)({pubId:F.post_id,postId:F.post_id,commentId:F.id,noBase:!0}),children:(0,o.Y)(e7,{direction:"incoming",commenters:C,count:w,onClick:l})})]})}function eO(e){return void 0===e.post_id}function eB(e){var t;let{user:n,children:i,extras:r,flex:a="grow",containerRef:l,id:s,pubRole:c,userStatus:d,pubThemeAccentColor:p,pubThemePrintOnPopColor:h}=e,m=(0,O._N)(null!=(t=null==n?void 0:n.id)?t:0);return(0,o.FD)($.I1,{id:s,flex:a,gap:2,ref:l,className:u()(ep.A.reactionsHoverZone,eu.A.avatarContainer),children:[(0,o.FD)($.pT,{alignItems:"end",gap:12,children:[(0,o.Y)($.pT,{paddingTop:4,children:m?(0,o.Y)(eM,{user:n}):n?(0,o.Y)(ti,{pubThemeAccentColor:p,pubThemePrintOnPopColor:h,user:n,pubRole:c,userStatus:d,size:32}):(0,o.Y)(eR,{})}),(0,o.Y)($.I1,{flex:"grow",gap:2,position:"relative",alignItems:"start",children:i})]}),r&&(0,o.FD)($.pT,{gap:12,children:[(0,o.Y)($.az,{width:32}),(0,o.Y)($.I1,{flex:"grow",gap:4,children:r})]})]})}function eM(e){let{user:t}=e,n=(0,M.BR)().isOnDestination;return(0,o.Y)(Q.AE,{href:t?(0,es.gYq)(t,{noBase:n}):void 0,children:(0,o.Y)(eR,{children:(0,o.Y)(f.A,{size:20,stroke:"var(--color-fg-tertiary)"})})})}let eR=(0,Q.I4)({radius:"full",width:32,height:32,bg:"secondary"},Q.ov);function eU(e){var{isNew:t}=e,n=(0,a._)(e,["isNew"]);if(t)return null;let{onNewQuote:r,onReply:l,communityEntity:s}=n;return(0,o.FD)($.pT,{alignItems:"center",gap:4,className:eu.A.actions,children:[r&&s&&(0,o.Y)(ez,{onNewQuote:r,communityComment:s}),l&&s&&(0,o.Y)(eH,{onReply:l}),(0,o.Y)(Z.W1,{trigger:(0,o.Y)(J.K0,{"aria-label":"Options",size:"sm",priority:"tertiary",children:(0,o.Y)(v.A,{size:20})}),children:(0,o.Y)(ej,(0,i._)({},n))})]})}function ej(e){let{communityEntity:t,replyAction:n,onDelete:i,onReport:r,isReadOnly:a,publicationId:l,isBanned:s,isFlagged:c,onNewQuote:d}=e,u=(0,R.Jd)(),{isAuthor:p,publicationUser:h}=(0,el.NL)(null!=l?l:0),m=(null==h?void 0:h.role)==="community_moderator",g=l&&p,f=t&&u&&t.user_id===u.id,v=t&&!eO(t),b=v&&"parent_id"in t&&null!==t.parent_id,y=f||g||m,Y=f||g||m,_=!f&&!c,w=(g||m)&&v&&!f,C=!v&&u&&(null==t?void 0:t.user_id)===u.id;return t?(0,o.FD)(o.FK,{children:[(0,o.Y)(eK,{communityEntity:t}),t.body&&(0,o.Y)(eV,{communityEntity:t}),!a&&d&&v&&(0,o.Y)(eW,{onNewQuote:d,communityComment:t}),!a&&n,C&&(0,o.Y)(eG,{communityEntity:t}),(0,o.FD)(Z.H9,{children:[!a&&!b&&Y&&(0,o.Y)(eq,{communityEntity:t}),!a&&y&&(0,o.Y)(eZ,{communityEntity:t,onDelete:i}),!a&&void 0!==s&&w&&(0,o.Y)(e$,{communityEntity:t,isBanned:s}),!a&&_&&(0,o.Y)(eJ,{onReport:r,communityEntity:t})]}),(0,o.Y)(Z.NW,{children:(0,o.Y)($.pT,{paddingY:4,children:(0,o.Y)(en.D,{conjunction:!0,timestamp:t.created_at})})})]}):null}function ez(e){let{onNewQuote:t,communityComment:n}=e;return(0,o.Y)(J.K0,{size:"sm",priority:"tertiary","aria-label":"Reply",onClick:()=>{t(n)},children:(0,o.Y)(m.A,{size:20})})}function eH(e){let{onReply:t}=e;return(0,o.Y)(J.K0,{size:"sm",priority:"tertiary","aria-label":"Reply",onClick:t,children:(0,o.Y)(m.A,{size:20})})}function eW(e){let{onNewQuote:t,communityComment:n}=e,{iString:i}=(0,B.GO)();return(0,o.Y)(Z.Dr,{leading:(0,o.Y)(m.A,{}),onClick:()=>{t(n)},children:i("Reply")})}function eV(e){let{communityEntity:t}=e,{iString:n}=(0,B.GO)(),i=(0,ee.d)();return(0,o.Y)(Z.Dr,{leading:(0,o.Y)(b.A,{}),onClick:()=>{if(t){let{body:e}=t;(0,K.lW)(e),i.popToast(()=>(0,o.Y)(ee.y,{text:n("Text copied to clipboard"),Icon:b.A}))}},children:n("Copy text")})}function eK(e){let{communityEntity:t}=e,{iString:n}=(0,B.GO)(),i=(0,V.c)(),{id:r}=t,a=eO(t);return(0,o.Y)(Z.Dr,{leading:(0,o.Y)(y.A,{}),onClick:()=>{let e;if(a)e=(0,es.sWz)({postId:r});else if(t.parent_id){var n;e=(0,es.j5y)({commentId:null!=(n=t.parent_id)?n:r,targetReplyId:t.parent_id?r:void 0,showTarget:!0})}else e=(0,es.sWz)({postId:t.post_id,targetReplyId:t.id,showTarget:!0});i(e)},children:n("Copy link")})}function eq(e){let{communityEntity:t}=e,{iString:n}=(0,B.GO)(),i=(0,er.wA)(),r=(0,ee.d)(),{id:a,is_locked:l}=t,s=eO(t),c=async()=>{if(s){let e;i((e=!l,async(t,n)=>{t({type:"posts-lock_replies",payload:{id:a,isLocked:e}});let i=await ew(a,e);i instanceof Error&&(console.warn("error locking post",i),alert("There was an error ".concat(e?"locking":"unlocking"," replies to this post. Please try again later.")),t({type:"posts-lock_replies",payload:{id:a,isLocked:!e}}))}))}else{let e;i((e=!l,async(t,n)=>{t({type:"comments-lock_replies",payload:{id:a,isLocked:e}});let i=await eC(a,e);i instanceof Error&&(console.warn("error locking comment",i),alert("There was an error ".concat(e?"locking":"unlocking"," replies to this comment. Please try again later.")),t({type:"comments-lock_replies",payload:{id:a,isLocked:!e}}))}))}l?r.popToast(()=>(0,o.Y)(ee.y,{text:n("Enabled replies"),Icon:_.A})):r.popToast(()=>(0,o.Y)(ee.y,{text:n("Disabled replies"),Icon:Y.A}))};return(0,o.Y)(Z.Dr,{leading:(0,o.Y)(Y.A,{}),onClick:c,priority:"destructive",children:l?n("Re-enable replies"):n("Disable replies")})}function eG(e){let{communityEntity:t}=e,n=(0,er.wA)(),i=eO(t),r=async()=>{i&&n({type:"posts-edit_post",payload:{post:t}})};return(0,o.Y)(Z.Dr,{leading:(0,o.Y)(w.A,{}),onClick:r,priority:"primary",children:"Edit"})}function eJ(e){let{onReport:t,communityEntity:n}=e,{iString:i}=(0,B.GO)();return(0,o.Y)(o.FK,{children:(0,o.Y)(Z.Dr,{leading:(0,o.Y)(C.A,{}),onClick:()=>{t(n.id,"admin"!==n.user_pub_role)},priority:"destructive",children:i("Report")})})}function e$(e){let{communityEntity:t,isBanned:n}=e,{iString:i}=(0,B.GO)(),r=(0,er.wA)(),a=async()=>{if(confirm("Are you sure you want to ban this user?")){let e,{id:i}=t;r((e=!n,async(t,n)=>{t({type:"comments-ban_author",payload:{id:i,ban:e}});let r=await ek(i,e);r instanceof Error&&(console.warn("error toggling ban for comment author",r),alert("There was an error ".concat(e?"banning":"unbanning"," this user. Please try again later.")),t({type:"comments-ban_author",payload:{id:i,ban:!e}}))}))}};return(0,o.Y)(Z.Dr,{leading:n?(0,o.Y)(k.A,{}):(0,o.Y)(S.A,{}),onClick:a,priority:"destructive",children:i(n?"Unban":"Ban")})}function eZ(e){let{communityEntity:t,onDelete:n}=e,{iString:i}=(0,B.GO)(),r=(0,er.wA)(),a=eO(t),l=async()=>{if(confirm("Are you sure you want to delete this ".concat(a?"thread":"comment","?"))){let{id:e}=t;if(a){let{publication_id:n}=t;r(async(t,i)=>{t({type:"posts-delete_post",payload:{id:e,publication_id:n}});let r=await eD(e);r instanceof Error&&console.warn("error deleting thread",r)})}else{let{post_id:n,parent_id:i}=t;r(async(t,r)=>{t({type:"comments-delete_comment",payload:{id:e,postId:n}});let a=await eS(e);if(a instanceof Error&&console.warn("error deleting comment",a),i){let e=await eI(i);e instanceof Error||t({type:"comments-update_comment",payload:{id:i,comment:e.comment}})}let l=await eF(n);l instanceof Error||t({type:"posts-update_post",payload:{id:n,post:l.communityPost}})})}n&&setTimeout(n,500)}};return(0,o.Y)(Z.Dr,{leading:(0,o.Y)(I.A,{}),onClick:l,priority:"destructive",children:i("Delete")})}function eQ(e){var{hasFooter:t}=e,n=(0,a._)(e,["hasFooter"]);return(0,o.Y)($.I1,(0,i._)({className:u()(eu.A.bubbleStack,t&&eu.A.hasFooter),gap:2,alignItems:"start"},n))}function eX(e){var{isTargeted:t,className:n}=e,r=(0,a._)(e,["isTargeted","className"]);return(0,o.Y)($.I1,(0,i._)({className:u()(eu.A.bubble,t&&eu.A.highlight,n),sizing:"border-box",paddingY:8,paddingX:12,bg:"secondary",minWidth:0,gap:8},r))}function e0(e){let{communityEntity:t,publication:n,isTargeted:i,onClick:r,truncate:a=!0,isPaid:l,isFounding:s,outline:c}=e,{audience:d}=t,{canReply:u,shouldShowToken:p}=e9({audience:d,isFounding:s,isPaid:l,chatPaywallStatus:null==n?void 0:n.paywall_chat}),h=p||t.is_edited,m=t.reactions?Object.keys(t.reactions).length:0;return(0,o.FD)(eX,{isTargeted:i,onClick:r,className:eh.A[m>0?"reactions-".concat(m):""],outline:c,children:[(0,o.Y)(e3,{communityEntity:t,truncate:a}),h&&(0,o.FD)($.Ye,{justifyContent:"end",gap:2,children:[p&&(0,o.Y)(e1,{canReply:!!u,audience:d}),t.is_edited&&(0,o.Y)(e4,{})]})]})}function e1(e){let{canReply:t,audience:n,style:i="default",showLabel:r=!0,className:a}=e,l=r?"media"===i?"var(--vibrance-primary)":"var(--color-chat-incoming-fg-primary)":"var(--color-fg-primary)";return(0,o.FD)(X.vw,{className:u()(eu.A.paywallReplyTag,"media"===i&&eu.A.media,!r&&eu.A.iconOnly,a),priority:"secondary",children:[t?(0,o.Y)(P.A,{size:12,color:l}):(0,o.Y)(N.A,{size:12,color:l}),r&&(0,o.Y)($.EY.B5,{weight:"medium",children:e2.get(n)})]})}let e2=new Map([["only_paid","Paid subscribers only"],["only_paid_replies","Paid subscriber replies"],["only_founding","Founding members only"],["only_founding_replies","Founding member replies"]]);function e4(){return(0,o.FD)(X.vw,{className:eu.A.paywallReplyTag,priority:"secondary",children:[(0,o.Y)(F.A,{size:12}),(0,o.Y)($.EY.B5,{weight:"medium",children:"Edited"})]})}function e6(e){let{author:t,body:n,direction:i,onClick:r,children:a,isFirst:l=!0,pubThemeBackgroundColor:s,isAuthorContributor:c}=e,d="incoming"===i&&c,p=d&&s;return(0,o.Y)($.pT,{pullX:4,children:(0,o.FD)($.pT,{gap:12,className:u()(eu.A.quote,eu.A[i],!l&&eu.A.notFirst,d&&eu.A.author),onClick:r,radius:"md",overflow:"hidden",padding:8,flex:"grow",style:{"--color-chat-author-bg-overlay":p?"".concat(s,"33"):"oklch(from var(--color-bg-accent-themed) l c h / 0.2)"},children:[(0,o.FD)($.I1,{children:[(0,o.Y)($.EY.B4,{weight:"bold",children:null!=t?t:""}),(0,o.Y)($.EY.B3,{clamp:2,isParagraph:!0,children:n})]}),a]})})}function e3(e){var t,n,i,r,a;let{communityEntity:l,truncate:s=!0}=e,c=null,d=eO(l)?"thread":"reply";l.reported_by_user&&(c="You reported this ".concat(d)),"deleted"!==l.status&&l.body||(c="This ".concat(d," is not available"));let u=(0,O._N)(l.user_id);c||"blocking"!==u?c||"blocked"!==u||(c="This person is blocked"):c="This person blocked you";let p=null!=(t=l.raw_body)?t:l.body;return p?eO(l)&&l.link_url&&!l.link_metadata&&(p="".concat(p,"\n\n").concat(l.link_url).trim()):eO(l)?(null==(i=l.media_assets)?void 0:i.length)?c="".concat(l.media_assets.length," ").concat(l.media_assets.length>1?"photos":"photo","."):l.link_url&&(l.link_metadata?c='Link: "'.concat(l.link_metadata.title,'"'):(p=l.link_url,c=null)):(null==(n=l.media_uploads)?void 0:n.length)&&(c="".concat(l.media_uploads.length," ").concat(l.media_uploads.length>1?"photos":"photo",".")),(0,o.Y)($.EY.B3,{className:eu.A.body,isParagraph:!0,children:(p||c)&&(0,o.Y)(eN,{text:p,rawText:null!=(r=l.raw_body)?r:"",mentionMap:Array.isArray(l.mentions)?void 0:null!=(a=l.mentions)?a:void 0,specialText:c,limit:s?void 0:9999999})})}function e7(e){let{isLocked:t,count:n=0,commenters:i,hasUnread:r,onClick:a,direction:l,outline:s}=e,{iString:c,iPlural:d}=(0,B.GO)();return(0,o.Y)(et.Zh,{isLast:!0,messageDirection:l,onClick:a,cursor:a?"pointer":void 0,height:36,paddingY:4,paddingRight:12,paddingLeft:12,outline:s,children:(0,o.FD)($.pT,{justifyContent:"space-between",alignItems:"center",gap:32,children:[(0,o.FD)($.pT,{alignItems:"center",gap:8,children:[i&&n>0&&(0,o.Y)($.pT,{className:eu.A.facepile,alignItems:"center",children:i.map(e=>(0,o.Y)(q.eu,{className:u()(eu.A.facepileAvatar,"outgoing"===l&&eu.A.outgoing),user:e,size:22}))}),(0,o.Y)($.pT,{gap:8,alignItems:"center",children:(0,o.Y)($.EY.B3,{as:"span",className:r?eu.A.hasUnread:eu.A.noUnread,children:0===n?c("Leave a reply"):d("%1 reply","%1 replies",n)})})]}),t?(0,o.Y)(N.A,{size:14,color:"var(--color-chat-fg-secondary)"}):(0,o.Y)(D.A,{size:20,stroke:r?"var(--color-chat-reply-active)":"var(--color-chat-fg-secondary)"})]})})}function e8(e){let{audience:t,href:n,onClick:i}=e;return(0,o.Y)($.I1,{className:eu.A.paywallBubble,as:n?"a":"div",onClick:i,cursor:i?"pointer":void 0,alignSelf:"stretch",alignItems:"center",justifyContent:"center",bg:"secondary",href:n,target:n?"_blank":void 0,children:(0,o.FD)($.pT,{alignItems:"center",gap:4,children:[(0,o.Y)(T.A,{size:12,stroke:"var(--color-fg-secondary)"}),(0,o.Y)($.EY.Meta,{weight:"semibold",children:"only_founding"===t?"FOUNDING MEMBERS ONLY":"only_paid"===t?"PAID SUBSCRIBERS ONLY":"SUBSCRIBERS ONLY"})]})})}function e5(){return(0,o.Y)($.I1,{className:eu.A.paywallBubble,alignSelf:"stretch",alignItems:"center",justifyContent:"center",bg:"secondary",children:(0,o.FD)($.pT,{alignItems:"center",gap:4,children:[(0,o.Y)(T.A,{size:12,stroke:"var(--color-fg-secondary)"}),(0,o.Y)($.EY.Meta,{weight:"semibold",children:"SUBSCRIBERS ONLY"})]})})}function e9(e){let{audience:t,isFounding:n,isPaid:i,chatPaywallStatus:r}=e,a=["only_founding","only_founding_replies"].includes(t);return{canReply:n||"all_subscribers"===t||i&&["only_paid","only_paid_replies"].includes(t),shouldShowToken:r&&("free"===r&&"all_subscribers"!==t||"paid"===r&&a)}}function te(e){let{paywallInfo:t,audience:n,onClick:i}=e,{mediaAttachments:r}=t,{body:a}=t,l=r[0];return a||l||(a=[,,,,].fill("Blah blah blah blahhhhh blah.").join(" ")),(0,o.FD)(o.FK,{children:[l&&(0,o.Y)($.I1,{position:"relative",children:(0,o.Y)(x.K,{className:eu.A.ImageGrid,assets:[{src:l.thumb_url,width:l.width,height:l.height,explicit:!1}],maxWidth:400,maxHeight:420,readOnly:!0,isContained:!0,children:(0,o.Y)(tt,{className:eu.A.paywallFade,children:(0,o.Y)(e1,{canReply:!1,audience:null!=n?n:"only_paid",style:"media",showLabel:!a,className:a?eu.A.right:eu.A.center})})})}),a&&(0,o.FD)(eX,{className:eu.A.bubble,onClick:i,children:[(0,o.Y)($.EY.B3,{className:eu.A.paywallText,isParagraph:!0,children:a}),(0,o.Y)(tt,{className:u()(eu.A.paywallFade,eu.A.paywallBlur),children:(0,o.Y)($.az,{className:eu.A.paywallReplyTagAbsolute,children:(0,o.Y)(e1,{canReply:!1,audience:null!=n?n:"only_paid",style:"media"})})})]})]})}let tt=(0,Q.I4)({position:"absolute",inset:0,alignItems:"center",justifyContent:"center"},Q.VP);function tn(e){let{text:t,isStatic:n}=e;return(0,o.Y)($.pT,{paddingX:8,paddingY:4,children:(0,o.FD)($.EY.B5,{color:"secondary",weight:"semibold",children:[(0,o.Y)(E.A,{strokeWidth:2,height:12,stroke:"#808080",fill:"transparent",isStatic:n})," ",t]})})}function ti(e){let t,{user:n,size:i,pubRole:r,userStatus:a,className:l,disabled:s,pubThemeAccentColor:c,pubThemePrintOnPopColor:d}=e,u=(0,M.BR)().isOnDestination;(0,ec.isAtLeastContributorRole)(null==r?void 0:r.role)?t="author":(null==r?void 0:r.is_founding)?t="founding":(null==r?void 0:r.membership_state)==="subscribed"&&(t="paid");let p=(0,o.Y)(q.tp,{user:n,size:i,className:l,disabled:s,linkProps:{target:"_blank"},noBase:u});return"author"!==t?(null==a?void 0:a.badge)?(0,o.Y)(G.Pk,{badge:a.badge,children:p}):p:(0,o.Y)(G.w4,{tier:t,fgOverride:d,bgOverride:c,children:p})}},26683:function(e,t,n){n.d(t,{LI:()=>T,Sd:()=>D,YD:()=>B,jx:()=>M});var i=n(69277),r=n(70408),a=n(4006),l=n(50172),o=n(17402),s=n(45994),c=n(32485),d=n.n(c),u=n(78649),p=n(7147),h=n(44518),m=n(46271),g=n(94729),f=n(12501),v=n(35369),b=n(17028),y=n(97515),Y=n(37598),_=n(57820),w=n(40837),C=n(75303),k=n(63136),S=n(66511),I=n(3898);let F=(0,l.createContext)({isLoading:!1,emojis:{suggestedReactionTypes:[],categories:[],reactionTypes:{}}});function D(e){let{children:t}=e,{user:n}=(0,m.ur)(),{result:i,isLoading:r}=(0,f.st)({pathname:"/api/v1/threads/reactions",method:"GET",cacheTtl:6e5,auto:!!n});return(0,a.Y)(F.Provider,{value:{emojis:i,isLoading:r},children:t})}function T(e){let{context:t,reactions:n,currentReaction:i,onReactionClick:r,isReadOnly:l,showCounts:o=!0,maxReactions:c,direction:p}=e,h=n&&Object.keys(n).some(e=>n[e]>0),m=(0,s.li)(null),[g,f]=(0,s.J0)(!1),{emojis:v,isLoading:y}=(0,s.NT)(F),_=(0,s.Kr)(()=>n&&(null==v?void 0:v.reactionTypes)?Object.entries(n).sort((e,t)=>{let[n,i]=e,[r,a]=t;return i===a?n.localeCompare(r):a-i}).filter(e=>{let[t,n]=e;return n>0&&v.reactionTypes[t]}).slice(0,3):[],[n,v]);return(null==v?void 0:v.reactionTypes)?(0,a.Y)(u.Q,{children:(0,a.FD)(b.Ye,{onClick:O,className:d()(I.A.reactionsContainer,{[I.A.show]:h||g,[I.A.outgoing]:"outgoing"===p}),children:[_.map(e=>{let[n,l]=e,s=v.reactionTypes[n],c=n===i||s===i,u=(0,a.FD)(b.Ye,{className:d()(I.A.reaction,{[I.A.selected]:o&&c}),shadow:"sm",bg:"primary",gap:4,alignItems:"center",justifyContent:"center",paddingX:6,onClick:()=>s&&r&&r(n,s),children:[(0,a.Y)(k.EY.B4,{font:"emoji",children:s}),o&&(0,a.Y)(k.EY.Meta,{fontWeight:"bold",color:c?"white":"primary",children:l})]},n);return["feed-recommended","direct-message"].includes(t.type)?u:(0,a.Y)(S.m_,{text:(0,a.Y)(N,{context:t,reaction:n}),side:"bottom",children:u},n)}),!l&&(!c||!i)&&(0,a.Y)(Y.A,{trigger:(0,a.Y)(A,{}),onOpen:()=>f(!0),onClose:()=>f(!1),children:e=>{let{close:t}=e;return(0,a.Y)(E,{emojis:v,isLoading:y,currentReaction:i,onPick:(e,n)=>{r&&r(e,n),t()},inputRef:m})}})]})}):null}let A=(0,o.forwardRef)((e,t)=>(0,a.Y)(v.Nm,(0,r._)((0,i._)({ref:t,resetCss:!0,className:I.A.addReactButton,shadow:"sm",bg:"primary",paddingX:4,alignItems:"center"},e),{children:(0,a.Y)(p.A,{className:I.A.addReactIcon})})));function E(e){var t;let{emojis:i,isLoading:r,currentReaction:l,onPick:o,inputRef:c}=e,d=(0,s.Kr)(()=>(null==i?void 0:i.reactionTypes)&&!r?Object.keys(i.reactionTypes):[],[null==i?void 0:i.reactionTypes,r]),{result:p,isLoading:m}=(0,f.qK)(()=>n.e("74022").then(n.t.bind(n,70405,19)),[],{auto:!0}),g=(0,s.hb)(e=>[e,...(null==p?void 0:p[e])||[]],[p]),{filteredItems:v,setQuery:Y,hasFiltered:C,query:k}=(0,h.S)({items:d,getKeys:g,deps:[d,g]});return(0,a.Y)(u.Q,{children:(0,a.FD)(b.I1,{sizing:"border-box",gap:12,padding:12,minWidth:320,height:400,onClick:O,overflowY:"auto",children:[(0,a.Y)(w.D,{ref:c,onChange:Y}),r||m?(0,a.Y)(b.I1,{flex:"grow",justifyContent:"center",alignItems:"center",children:(0,a.Y)(_.y$,{})}):(0,a.FD)(a.FK,{children:[C&&(v&&v.length>0?(0,a.Y)(P,{reactions:v,currentReaction:l,onPick:o,emojiMap:i.reactionTypes,title:null}):(0,a.Y)(y.p,{title:"No results for ".concat(k),description:"Try another search"})),!C&&(0,a.FD)(a.FK,{children:[(0,a.Y)(P,{reactions:i.suggestedReactionTypes,currentReaction:l,onPick:o,emojiMap:i.reactionTypes,title:"Suggested"}),null==(t=i.categories)?void 0:t.map(e=>(0,a.Y)(P,{reactions:e.reactionTypes,currentReaction:l,onPick:o,emojiMap:i.reactionTypes,title:e.title},e.title))]})]})]})})}function N(e){var t;let{reaction:n,context:i}=e,r=["posts","feed-subscribed"].includes(i.type)?"/api/v1/community/posts/".concat(i.id,"/reactions"):"/api/v1/community/comments/".concat(i.id,"/reactions"),{result:a,isLoading:l}=(0,f.st)({pathname:r,method:"GET",auto:!0});if(l)return"Loading...";let o=(null!=(t=null==a?void 0:a.reactions.filter(e=>e.reaction===n))?t:[]).map(e=>e.user.name),s=o.slice(0,6),c=Math.max(0,o.length-6),d=s.join(", ");return c>0?"".concat(d," + ").concat(c," ").concat(1===c?"other":"others"):d}function P(e){let{reactions:t,currentReaction:n,onPick:i,emojiMap:r,title:l}=e;return(0,a.FD)(b.I1,{gap:4,children:[l&&(0,a.Y)(k.EY.B4,{color:"secondary",children:l}),(0,a.Y)(b.az,{className:I.A.emojiGrid,gap:2,alignItems:"center",justifyContent:"center",children:null==t?void 0:t.map(e=>(0,a.Y)(x,{onClick:()=>i(e,r[e]),className:d()(I.A.emojiBox,{[I.A.selected]:e===n}),children:(0,a.Y)(L,{children:r[e]})},e))})]})}let x=(0,C.I4)({bg:"primary",alignItems:"center",justifyContent:"center",radius:"sm",width:32,height:32,cursor:"pointer"},C.fI),L=(0,C.I4)({fontSize:20,lineHeight:20,color:"primary",fontWeight:"medium",font:"emoji"}),O=e=>{e.stopPropagation(),e.preventDefault()};async function B(e,t,n){try{return await (0,g.x6)("/api/v1/community/".concat(n,"/").concat(t,"/reaction"),{method:"POST",json:{reaction:e}})}catch(e){return e}}async function M(e,t,n){try{return await (0,g.x6)("/api/v1/community/".concat(n,"/").concat(t,"/reaction"),{method:"DELETE",query:{reaction:e}})}catch(e){return e}}},36066:function(e,t,n){n.d(t,{A:()=>o});var i=n(4006),r=n(67078),a=n(46137),l=n(3364);let o=e=>{let{audience:t,className:n,size:o=16,isStatic:s,thin:c}=e;return"only_paid"===t?c?(0,i.Y)(l.A,{className:n,height:o,isStatic:s}):(0,i.Y)(r.A,{className:n,size:o}):"founding"===t?(0,i.Y)(a.A,{className:n,height:o,isStatic:s,strokeWidth:1}):null}},28308:function(e,t,n){n.d(t,{DZ:()=>p});var i=n(4006),r=n(32485),a=n.n(r);n(17402);var l=n(15734),o=n.n(l),s=n(3680),c=n(84605),d=n(58418);let u=function(){let{children:e,dismissKey:t,dismissDurationInSeconds:n,beforeDismiss:r,className:l,level:o="info"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[c,u]=(0,d.A)(t,n,r);return c?null:(0,i.FD)("div",{className:a()("banner",o,l),children:[e,(0,i.Y)(s.A,{width:12,height:12,className:"banner-close",onClick:e=>{e.preventDefault(),e.stopPropagation(),u()}})]})},p=e=>{let{}=e,{iString:t}=(0,c.GO)();return(0,i.FD)(u,{level:"coming-soon",dismissKey:"coming-soon-banner.dismissed",beforeDismiss:()=>{o().put("/api/v1/publication_settings").send({seen_coming_soon_explainer:!0})},children:[(0,i.Y)("div",{className:"coming-soon-banner-header",children:t("Welcome to Substack!")}),(0,i.Y)("br",{}),(0,i.Y)("p",{children:t('We\'ve created this "Coming Soon" post for you. To edit it, click the three-dot icon.')}),(0,i.Y)("br",{}),(0,i.Y)("p",{children:t("It's just a placeholder and won't be sent out to your subscribers. To email them, click the \"New Post\" button.")})]})}},89333:function(e,t,n){n.d(t,{Ay:()=>O,Dw:()=>x,NJ:()=>B});var i=n(69277),r=n(70408),a=n(4006),l=n(50180),o=n(56808),s=n(16858),c=n(17402),d=n(15734),u=n.n(d),p=n(78423),h=n(69715),m=n(9486),g=n(41935),f=n(9979),v=n(41873),b=n(86500),y=n(58418),Y=n(66714),_=n(74049),w=n(68349),C=n(89490),k=n(35369),S=n(16074),I=n(76977),F=n(16993),D=n(57820),T=n(63136),A=n(39318),E=n(92967),N=n(57324),P=n(36906);let x=e=>{let[t,n]=(0,c.useState)(null),[i,r]=(0,c.useState)(null),[a]=(0,c.useState)(!0),[l,o]=(0,c.useState)(null),[s,d]=(0,c.useState)(null),p=async()=>{let t=await u().get("/api/v1/video/upload/".concat(e));n(t.body);let{id:a,state:l}=t.body;if(["uploaded","transcoded"].includes(l)&&!i){let{body:{src:e}}=await u().get("/api/v1/video/upload/".concat(a,"/src.json?type=original"));r(e)}},h=async()=>{let{mux_asset:t,mux_preview_asset:n}=(await u().get("/api/v1/video/upload/".concat(e,"/assets"))).body;o(t),d(n)};return(0,c.useEffect)(()=>{p(),h()},[e]),(0,c.useEffect)(()=>{let a=setInterval(()=>{let l=async()=>{let t=await u().get("/api/v1/video/upload/".concat(e)),{id:l,mux_rendition_quality:o,state:s}=t.body;if(n(t.body),o&&clearInterval(a),["uploaded","transcoded"].includes(s)&&!i){let{body:{src:e}}=await u().get("/api/v1/video/upload/".concat(l,"/src.json?type=original"));r(e)}else h()};(null==t?void 0:t.state)==="error"?(console.warn("error creating clip"),clearInterval(a)):(null==t?void 0:t.mux_rendition_quality)?clearInterval(a):l()},5e3);return()=>{clearInterval(a)}},[t]),{mediaUpload:t,loading:a,downloadUrl:i,muxAsset:l,muxPreviewAsset:s}};function L(e){var t;let{pub:n,post:r,mediaUploadId:s,isOpen:d,onClose:u,surface:p}=e,h=(0,c.createRef)(),{mediaUpload:g,downloadUrl:y,muxPreviewAsset:Y}=x(s);(0,c.useEffect)(()=>{s&&(0,b.u4)(b.qY.VIDEO_CLIP_SEEN,{post_id:r.id,clip_id:s,surface:p})},[s]);let L=async()=>{g&&await (0,_.P)(g)},O=()=>{(0,b.u4)(b.qY.VIDEO_CLIP_WATCH_FULL_EPISODE_BUTTON_CLICKED,{name:"watch full episosde",post_id:r?r.id:null,utm_campaign:N._9.substackClips,utm_medium:N.Jn.web,surface:p}),window.history.pushState({},"",(0,A.oRR)(window.location.href,{clipId:void 0,share:void 0})),u()};if(!g)return null;let B=null!==new URL(window.location.href).searchParams.get("share"),M=["uploaded","transcoded"].includes(g.state),R=(0,w.rr)(),U="creating";"error"===g.state?U="error":"transcoded"===g.state?U="transcoded":"uploaded"===g.state?U="uploaded":null!==g.mux_preview_playback_id&&(null==Y?void 0:Y.status)==="ready"&&(U="preview");let j={entityType:"post",entityKey:String(r.id),surface:"editor",contentType:"clip"};return(0,a.FD)(F.aF,{width:640,fullscreenMobile:!0,isOpen:d,onClose:u,children:[(0,a.Y)(F.rQ,{showClose:!0,title:B?"Share Clip":"Clip",onClose:u,description:"✂️ ".concat((0,E.lL)(null!=(t=g.duration)?t:0)," | ").concat(r.title)}),(0,a.FD)(F.cw,{children:["transcoded"===U&&(0,a.Y)(v.A,(0,i._)({ref:h,mediaUpload:g,pub:null!=n?n:null,autoPlay:!1,isClip:!0,videoType:"clip"},j)),"preview"===U&&(0,a.Y)(v.A,(0,i._)({ref:h,mediaUpload:g,pub:null!=n?n:null,autoPlay:!1,isClip:!0,usePreview:!0,videoType:"clip"},j)),"uploaded"===U&&y&&(0,a.Y)("div",{class:"video-player-wrapper",children:(0,a.Y)("div",{class:"video-player",children:(0,a.Y)("video",{src:y,type:"video/mp4",controls:!0})})}),"creating"===U&&(0,a.Y)(I.Ye,{children:(0,a.Y)(I.I1,{className:P.A.placeholder,justifyContent:"center",alignItems:"center",children:(0,a.FD)(I.I1,{justifyContent:"center",alignItems:"center",className:P.A.placeholderMessage,gap:8,children:[(0,a.Y)(D.y$,{}),(0,a.Y)(T.EY.B3,{weight:"bold",children:"Your clip is being processed"}),(0,a.FD)(T.EY.B4,{weight:"medium",color:"secondary",align:"center",children:["Clips may take up to a minute to process. Meanwhile, ",(0,a.Y)("b",{children:"share your clip link below"})]})]})})}),"error"===U&&(0,a.Y)(I.Ye,{children:(0,a.FD)(I.I1,{className:P.A.placeholder,children:[(0,a.Y)(l.A,{stroke:"gray"}),(0,a.Y)(T.EY.B4,{weight:"medium",color:"secondary",children:"Oops! There was an error creating the clip"})]})}),"error"!==U&&(0,a.FD)(I.I1,{paddingTop:16,children:[(0,a.Y)(S.c,{}),(0,a.Y)(C.az,{children:(0,a.FD)(I.Ye,{justifyContent:"space-between",flex:"grow",paddingTop:16,children:[!B&&(0,a.Y)(I.Ye,{children:R?(0,a.Y)(k.K0,{priority:"primary",onClick:O,children:(0,a.Y)(o.A,{})}):(0,a.Y)(k.$n,{priority:"primary",onClick:O,children:"Watch full episode"})}),(0,a.Y)(m.e,{shareUrl:(e,t,i)=>(0,f.x5)(e,{clip:g,post:r,pub:n,medium:i,utm_campaign:t}),pub:n,clip:g,post:r,selectionId:void 0,disabled:!1,disabledInstagram:!M,disabledDownload:!M,onDownloadClick:L,isSharing:B,surface:p})]})})]})]})]})}function O(e){let{post:t,mediaUploadId:n,surface:l}=e,[o,s]=(0,c.useState)(!0),[d,u]=(0,c.useState)(n);(0,c.useEffect)(()=>{let e=()=>{u(new URLSearchParams(window.location.search).get("clipId")),s(!0)};return window.addEventListener("urlchange",e),window.addEventListener("popstate",e),e(),()=>{window.removeEventListener("urlchange",e),window.removeEventListener("popstate",e)}},[]);let{mediaUpload:p,loading:h}=(0,Y.X)({mediaUploadId:d});return!h&&p&&d?(0,a.Y)(L,(0,r._)((0,i._)({},e),{mediaUploadId:d,isOpen:o,onClose:()=>{s(!1),(0,b.u4)(b.qY.VIDEO_CLIP_MODAL_CLOSED,{post_id:null==t?void 0:t.id,clip_id:d,surface:l})}})):null}let B=e=>{var t;let{post:n,mediaUpload:i,disabled:r,style:l,surface:o}=e,[,c]=(0,y.A)(p.h7),{onStartClipping:d}=(0,h.MC)(),u=(null!=(t=null==i?void 0:i.duration)?t:0)>5;return(0,a.Y)(g.fp,{title:u?r?"upgrade in order to watch this video and be able to clip it":"":"can't clip videos shorter than 5 seconds",isDisabled:!u||r,style:l,onClick:()=>{c(),u&&(d({source:"post-ufi",title:null}),(0,b.u4)(b.qY.MEDIA_CLIP_BUTTON_CLICKED,{button:"create",source:"player ufi",surface:o}),(0,b.u4)(b.qY.VIDEO_CLIP_BUTTON_CLICKED,{post_id:n.id,surface:o}))},icon:(0,a.Y)(s.A,{className:"icon",height:(0,g.t2)(l),strokeWidth:g.mV})})}},9486:function(e,t,n){n.d(t,{e:()=>E});var i=n(4006),r=n(32485),a=n.n(r),l=n(82853),o=n(48309),s=n(17402),c=n(68924),d=n(4067),u=n(69277),p=n(70408),h=n(97731);let m=e=>(0,i.Y)(h.A,(0,p._)((0,u._)({},e),{name:"ShareInstagramIcon",svgParams:{height:1e3,width:1e3},children:(0,i.FD)("svg",{width:"1000.0001",height:"1000.0001",viewBox:"0 0 264.58332 264.58332",version:"1.1",id:"svg15",xmlns:"http://www.w3.org/2000/svg",children:[(0,i.FD)("defs",{id:"defs11",children:[(0,i.Y)("radialGradient",{id:"f",cx:"158.429",cy:"578.08801",r:"52.351501",href:"#a",gradientUnits:"userSpaceOnUse",gradientTransform:"matrix(0,-4.03418,4.28018,0,-2332.2273,942.2356)",fx:"158.429",fy:"578.08801"}),(0,i.Y)("radialGradient",{href:"#b",id:"g",gradientUnits:"userSpaceOnUse",gradientTransform:"matrix(0.67441,-1.16203,1.51283,0.87801,-814.3657,-47.8354)",cx:"172.6149",cy:"600.69238",fx:"172.6149",fy:"600.69238",r:"65"}),(0,i.Y)("radialGradient",{href:"#c",id:"h",cx:"144.01199",cy:"51.3367",fx:"144.01199",fy:"51.3367",r:"67.081001",gradientTransform:"matrix(-2.3989,0.67549,-0.23008,-0.81732,464.9957,-26.4035)",gradientUnits:"userSpaceOnUse"}),(0,i.Y)("radialGradient",{href:"#d",id:"e",gradientUnits:"userSpaceOnUse",gradientTransform:"matrix(-3.10797,0.87652,-0.6315,-2.23914,1345.6503,1374.1983)",cx:"199.78841",cy:"628.43793",fx:"199.78841",fy:"628.43793",r:"52.351501"}),(0,i.FD)("linearGradient",{id:"d",children:[(0,i.Y)("stop",{offset:"0","stop-color":"#ff005f",id:"stop1"}),(0,i.Y)("stop",{offset:"1","stop-color":"#fc01d8",id:"stop2"})]}),(0,i.FD)("linearGradient",{id:"c",children:[(0,i.Y)("stop",{offset:"0","stop-color":"#780cff",id:"stop3"}),(0,i.Y)("stop",{"stop-color":"#820bff",offset:"1","stop-opacity":"0",id:"stop4"})]}),(0,i.FD)("linearGradient",{id:"b",children:[(0,i.Y)("stop",{offset:"0","stop-color":"#fc0",id:"stop5"}),(0,i.Y)("stop",{offset:"1","stop-color":"#fc0","stop-opacity":"0",id:"stop6"})]}),(0,i.FD)("linearGradient",{id:"a",children:[(0,i.Y)("stop",{offset:"0","stop-color":"#fc0",id:"stop7"}),(0,i.Y)("stop",{offset:".1242","stop-color":"#fc0",id:"stop8"}),(0,i.Y)("stop",{offset:".5672","stop-color":"#fe4a05",id:"stop9"}),(0,i.Y)("stop",{offset:".6942","stop-color":"#ff0f3f",id:"stop10"}),(0,i.Y)("stop",{offset:"1","stop-color":"#fe0657","stop-opacity":"0",id:"stop11"})]}),(0,i.Y)("clipPath",{id:"clipCircle",children:(0,i.Y)("circle",{cx:"132",cy:"132",r:"132",fill:"#ffffff",stroke:"#000000",id:"circle11"})})]}),(0,i.FD)("g",{"clip-path":"url(#clipCircle)",id:"g15",children:[(0,i.Y)("path",{d:"m 204.1503,18.1429 c -55.2305,0 -71.3834,0.057 -74.5232,0.3175 -11.3342,0.9424 -18.387,2.7275 -26.0708,6.554 -5.9214,2.9413 -10.5915,6.3506 -15.2005,11.1298 -8.3938,8.7157 -13.481,19.4383 -15.3226,32.1842 -0.8953,6.1877 -1.1558,7.4496 -1.2087,39.0558 -0.0203,10.5354 0,24.4007 0,42.9984 0,55.2008 0.061,71.3418 0.3256,74.4764 0.9157,11.032 2.6453,17.9728 6.3081,25.565 7,14.5329 20.369,25.4428 36.119,29.5137 5.4535,1.4044 11.4767,2.1779 19.2092,2.5442 3.2762,0.1425 36.6684,0.2443 70.081,0.2443 33.4127,0 66.8253,-0.0407 70.02,-0.2035 8.9535,-0.4214 14.1526,-1.1195 19.9011,-2.6054 15.8517,-4.0912 28.9767,-14.8383 36.119,-29.5748 3.5916,-7.409 5.4128,-14.6144 6.237,-25.0704 0.179,-2.2796 0.2543,-38.6263 0.2543,-74.924 0,-36.304 -0.0814,-72.5835 -0.2605,-74.8632 -0.8343,-10.6249 -2.6555,-17.7692 -6.363,-25.3207 -3.0421,-6.1816 -6.42,-10.798 -11.324,-15.518 -8.752,-8.3616 -19.4555,-13.4502 -32.2101,-15.2902 -6.18,-0.8936 -7.411,-1.1582 -39.033,-1.2131 z",fill:"url(#e)",transform:"translate(-71.8155,-18.1429)",id:"path11",style:{fill:"url(#e)"}}),(0,i.Y)("path",{d:"m 204.1503,18.1429 c -55.2305,0 -71.3834,0.057 -74.5232,0.3175 -11.3342,0.9424 -18.387,2.7275 -26.0708,6.554 -5.9214,2.9413 -10.5915,6.3506 -15.2005,11.1298 -8.3938,8.7157 -13.481,19.4383 -15.3226,32.1842 -0.8953,6.1877 -1.1558,7.4496 -1.2087,39.0558 -0.0203,10.5354 0,24.4007 0,42.9984 0,55.2008 0.061,71.3418 0.3256,74.4764 0.9157,11.032 2.6453,17.9728 6.3081,25.565 7,14.5329 20.369,25.4428 36.119,29.5137 5.4535,1.4044 11.4767,2.1779 19.2092,2.5442 3.2762,0.1425 36.6684,0.2443 70.081,0.2443 33.4127,0 66.8253,-0.0407 70.02,-0.2035 8.9535,-0.4214 14.1526,-1.1195 19.9011,-2.6054 15.8517,-4.0912 28.9767,-14.8383 36.119,-29.5748 3.5916,-7.409 5.4128,-14.6144 6.237,-25.0704 0.179,-2.2796 0.2543,-38.6263 0.2543,-74.924 0,-36.304 -0.0814,-72.5835 -0.2605,-74.8632 -0.8343,-10.6249 -2.6555,-17.7692 -6.363,-25.3207 -3.0421,-6.1816 -6.42,-10.798 -11.324,-15.518 -8.752,-8.3616 -19.4555,-13.4502 -32.2101,-15.2902 -6.18,-0.8936 -7.411,-1.1582 -39.033,-1.2131 z",fill:"url(#f)",transform:"translate(-71.8155,-18.1429)",id:"path12",style:{fill:"url(#f)"}}),(0,i.Y)("path",{d:"m 204.1503,18.1429 c -55.2305,0 -71.3834,0.057 -74.5232,0.3175 -11.3342,0.9424 -18.387,2.7275 -26.0708,6.554 -5.9214,2.9413 -10.5915,6.3506 -15.2005,11.1298 -8.3938,8.7157 -13.481,19.4383 -15.3226,32.1842 -0.8953,6.1877 -1.1558,7.4496 -1.2087,39.0558 -0.0203,10.5354 0,24.4007 0,42.9984 0,55.2008 0.061,71.3418 0.3256,74.4764 0.9157,11.032 2.6453,17.9728 6.3081,25.565 7,14.5329 20.369,25.4428 36.119,29.5137 5.4535,1.4044 11.4767,2.1779 19.2092,2.5442 3.2762,0.1425 36.6684,0.2443 70.081,0.2443 33.4127,0 66.8253,-0.0407 70.02,-0.2035 8.9535,-0.4214 14.1526,-1.1195 19.9011,-2.6054 15.8517,-4.0912 28.9767,-14.8383 36.119,-29.5748 3.5916,-7.409 5.4128,-14.6144 6.237,-25.0704 0.179,-2.2796 0.2543,-38.6263 0.2543,-74.924 0,-36.304 -0.0814,-72.5835 -0.2605,-74.8632 -0.8343,-10.6249 -2.6555,-17.7692 -6.363,-25.3207 -3.0421,-6.1816 -6.42,-10.798 -11.324,-15.518 -8.752,-8.3616 -19.4555,-13.4502 -32.2101,-15.2902 -6.18,-0.8936 -7.411,-1.1582 -39.033,-1.2131 z",fill:"url(#g)",transform:"translate(-71.8155,-18.1429)",id:"path13",style:{fill:"url(#g)"}}),(0,i.Y)("path",{d:"m 204.1503,18.1429 c -55.2305,0 -71.3834,0.057 -74.5232,0.3175 -11.3342,0.9424 -18.387,2.7275 -26.0708,6.554 -5.9214,2.9413 -10.5915,6.3506 -15.2005,11.1298 -8.3938,8.7157 -13.481,19.4383 -15.3226,32.1842 -0.8953,6.1877 -1.1558,7.4496 -1.2087,39.0558 -0.0203,10.5354 0,24.4007 0,42.9984 0,55.2008 0.061,71.3418 0.3256,74.4764 0.9157,11.032 2.6453,17.9728 6.3081,25.565 7,14.5329 20.369,25.4428 36.119,29.5137 5.4535,1.4044 11.4767,2.1779 19.2092,2.5442 3.2762,0.1425 36.6684,0.2443 70.081,0.2443 33.4127,0 66.8253,-0.0407 70.02,-0.2035 8.9535,-0.4214 14.1526,-1.1195 19.9011,-2.6054 15.8517,-4.0912 28.9767,-14.8383 36.119,-29.5748 3.5916,-7.409 5.4128,-14.6144 6.237,-25.0704 0.179,-2.2796 0.2543,-38.6263 0.2543,-74.924 0,-36.304 -0.0814,-72.5835 -0.2605,-74.8632 -0.8343,-10.6249 -2.6555,-17.7692 -6.363,-25.3207 -3.0421,-6.1816 -6.42,-10.798 -11.324,-15.518 -8.752,-8.3616 -19.4555,-13.4502 -32.2101,-15.2902 -6.18,-0.8936 -7.411,-1.1582 -39.033,-1.2131 z",fill:"url(#h)",transform:"translate(-71.8155,-18.1429)",id:"path14",style:{fill:"url(#h)"}}),(0,i.Y)("path",{d:"m 132.3452,33.973 c -26.7167,0 -30.0696,0.1167 -40.5629,0.5939 -10.4727,0.4792 -17.6212,2.136 -23.8762,4.567 -6.4701,2.5107 -11.9586,5.8693 -17.4265,11.3352 -5.472,5.464 -8.8332,10.9483 -11.354,17.4116 -2.4389,6.2524 -4.099,13.3976 -4.5703,23.8585 -0.4693,10.4854 -0.5923,13.8379 -0.5923,40.5348 0,26.697 0.1189,30.0371 0.5943,40.5225 0.4817,10.465 2.1397,17.6082 4.5703,23.8585 2.5147,6.4654 5.8758,11.9497 11.3458,17.4136 5.466,5.468 10.9544,8.8349 17.4204,11.3456 6.259,2.4309 13.4097,4.0877 23.8803,4.567 10.4933,0.477 13.8441,0.5938 40.5588,0.5938 26.7188,0 30.0615,-0.1167 40.5547,-0.5939 10.4728,-0.4792 17.6295,-2.136 23.8885,-4.567 6.4681,-2.5106 11.9484,-5.8775 17.4143,-11.3455 5.472,-5.4639 8.8332,-10.9482 11.354,-17.4115 2.4183,-6.2524 4.0784,-13.3976 4.5703,-23.8585 0.4713,-10.4854 0.5943,-13.8277 0.5943,-40.5246 0,-26.697 -0.123,-30.0473 -0.5943,-40.5328 -0.4919,-10.465 -2.152,-17.6081 -4.5703,-23.8584 -2.5208,-6.4654 -5.882,-11.9498 -11.354,-17.4137 C 208.7183,45.0011 203.2462,41.6425 196.77,39.1338 190.4986,36.7029 183.346,35.0461 172.8733,34.5669 162.38,34.0897 159.0394,33.973 132.3145,33.973 Z m -8.825,17.7147 c 2.6193,-0.0041 5.5418,0 8.825,0 26.2659,0 29.379,0.0942 39.7513,0.5652 9.5915,0.4383 14.7971,2.0397 18.2648,3.3852 4.5908,1.7817 7.8638,3.9116 11.3048,7.3521 3.4431,3.4406 5.5745,6.7173 7.3617,11.3046 1.3465,3.461 2.9512,8.6628 3.3877,18.2472 0.4714,10.3625 0.5739,13.4754 0.5739,39.7095 0,26.234 -0.1025,29.347 -0.5739,39.7095 -0.4386,9.5843 -2.0412,14.7861 -3.3877,18.2471 -1.783,4.5874 -3.9186,7.8539 -7.3617,11.2923 -3.443,3.4406 -6.712,5.5704 -11.3048,7.3521 -3.4636,1.3517 -8.6733,2.949 -18.2648,3.3873 -10.3702,0.471 -13.4854,0.5734 -39.7513,0.5734 -26.2679,0 -29.381,-0.1024 -39.7513,-0.5734 -9.5914,-0.4423 -14.797,-2.0438 -18.2668,-3.3893 -4.5908,-1.7817 -7.87,-3.9116 -11.313,-7.3521 -3.4431,-3.4405 -5.5745,-6.709 -7.3617,-11.2985 -1.3465,-3.461 -2.9512,-8.6628 -3.3877,-18.2471 -0.4714,-10.3626 -0.5657,-13.4754 -0.5657,-39.7259 0,-26.2504 0.0943,-29.347 0.5657,-39.7095 0.4386,-9.5844 2.0412,-14.7861 3.3877,-18.2512 1.783,-4.5874 3.9186,-7.8641 7.3617,-11.3046 3.443,-3.4406 6.7222,-5.5704 11.313,-7.3562 3.4677,-1.3517 8.6754,-2.949 18.2668,-3.3894 9.075,-0.4096 12.5919,-0.5324 30.9264,-0.553 z m 61.3363,16.322 c -6.5173,0 -11.805,5.2776 -11.805,11.792 0,6.5125 5.2877,11.7962 11.805,11.7962 6.5172,0 11.8049,-5.2837 11.8049,-11.7962 0,-6.5124 -5.2877,-11.796 -11.805,-11.796 z m -52.5113,13.7826 c -27.8993,0 -50.5191,22.6031 -50.5191,50.4817 0,27.8786 22.6198,50.4714 50.5191,50.4714 27.8993,0 50.511,-22.5928 50.511,-50.4714 0,-27.8786 -22.6137,-50.4817 -50.513,-50.4817 z m 0,17.7147 c 18.109,0 32.7914,14.6694 32.7914,32.767 0,18.0956 -14.6824,32.767 -32.7914,32.767 -18.111,0 -32.7913,-14.6714 -32.7913,-32.767 0,-18.0976 14.6803,-32.767 32.7913,-32.767 z",fill:"#ffffff",id:"path15"})]})]})}));var g=n(49331),f=n(79146),v=n(86500),b=n(35369),y=n(76977),Y=n(16993),_=n(63136);let w="step-Rk40vT",C=e=>{let{isOpen:t,onClose:n,onCopyLinkClick:r,mediaCarousel:a}=e;return(0,s.useEffect)(()=>{t&&(0,v.u4)(v.qY.VIDEO_CLIP_INSTAGRAM_SHARE_MODAL_SEEN,{source:"clip-share-modal"})},[t]),(0,i.FD)(Y.aF,{isOpen:t,onClose:n,fullscreenMobile:!0,children:[(0,i.Y)(Y.rQ,{showClose:!0,onClose:n,title:"Share to Instagram"}),(0,i.Y)(Y.cw,{children:(0,i.FD)(y.I1,{gap:32,children:[(0,i.FD)(y.Ye,{children:[(0,i.Y)(y.Ye,{justifyContent:"center",className:w,children:(0,i.Y)(_.EY.H4,{children:"1"})}),(0,i.Y)(y.Ye,{children:(0,i.FD)(y.I1,{gap:16,children:[(0,i.Y)(_.EY.H4,{children:"Download clip"}),(0,i.Y)(y.I1,{bg:"secondary",radius:"md",border:"detail",children:a})]})})]}),(0,i.FD)(y.Ye,{children:[(0,i.Y)(y.Ye,{justifyContent:"center",className:w,children:(0,i.Y)(_.EY.H4,{children:"2"})}),(0,i.Y)(y.Ye,{children:(0,i.FD)(y.I1,{gap:16,children:[(0,i.FD)(y.I1,{gap:4,children:[(0,i.Y)(_.EY.H4,{children:"Copy a link to the post"}),(0,i.Y)(_.EY.B4,{children:"Add a link to your Instagram story or bio."})]}),(0,i.Y)(y.Ye,{children:(0,i.Y)(b.$n,{priority:"secondary",onClick:()=>r("instagram","substack-clips","social"),trailing:(0,i.Y)(l.A,{}),children:"Copy link"})})]})})]}),(0,i.FD)(y.Ye,{children:[(0,i.Y)(y.Ye,{justifyContent:"center",className:w,children:(0,i.Y)(_.EY.H4,{children:"3"})}),(0,i.Y)(y.Ye,{children:(0,i.Y)(y.I1,{gap:16,children:(0,i.FD)(y.I1,{gap:4,children:[(0,i.Y)(_.EY.H4,{children:"Post from Instagram"}),(0,i.Y)(_.EY.B4,{children:"Visit the Instagram app and share the image with a link to the post. Or share from Instagram on desktop"})]})})})]}),(0,i.Y)(y.Ye,{justifyContent:"end",paddingTop:32,paddingX:16,children:(0,i.Y)(b.$n,{priority:"primary",onClick:n,children:"Done"})})]})})]})};var k=n(9979),S=n(68349),I=n(57820),F=n(36372),D=n(66511),T=n(39318),A=n(49807);function E(e){let{shareUrl:t,pub:n,post:r,clip:u,selectionId:p,disabled:h,disabledInstagram:Y,disabledDownload:_,onDownloadClick:w,isSharing:E,surface:N}=e,P=(0,F.d)(),[x,L]=(0,s.useState)(!1),O=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"copy",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"substack-clip",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"web";B(e,t,n,e=>((0,S.lW)(e),P.popToast(()=>(0,i.Y)(F.y,{text:"Copied link to clipboard"})),!1))},B=(e,i,a,l)=>{(0,k.Q_)(e,l,{shareUrl:t(e,i,a),post:r,pub:n,selectionId:p,utm_campaign:i,utm_medium:a,event:v.qY.VIDEO_CLIP_SHARE_BUTTON_CLICKED,trackParams:{surface:N}})},M=async()=>{B("facebook","substack-clips","social",e=>(0,A.yRP)("https://www.facebook.com/sharer/sharer.php",{u:e}))},R=async()=>{r&&B("twitter","substack-clips","social",e=>(0,T.gKg)({url:e,text:r.title}))},U=async()=>{B("linkedin","substack-clips","social",e=>(0,A.yRP)("https://www.linkedin.com/sharing/share-offsite/",{url:e}))};return(0,i.FD)(y.Ye,{justifyContent:"space-between",flex:"fill",children:[E?(0,i.Y)(y.Ye,{children:(0,i.Y)(b.$n,{priority:"primary",rounded:!1,onClick:()=>O(),leading:(0,i.Y)(l.A,{size:20}),children:"Copy link"})}):(0,i.Y)("div",{}),(0,i.FD)(y.Ye,{gap:8,children:[(0,i.Y)(D.m_,{text:_?"Your clip will be ready to download shortly":"Download",children:(0,i.Y)(b.K0,{className:a()({"disabledButton-hUWISL":_}),priority:"secondary-outline",onClick:w,disabled:_,children:_?(0,i.Y)(I.y$,{}):(0,i.Y)(o.A,{size:20})})}),!E&&(0,i.Y)(b.K0,{priority:"secondary-outline",onClick:()=>O(),disabled:h,children:(0,i.Y)(l.A,{size:20})}),(0,i.Y)(b.K0,{priority:"secondary-outline",onClick:()=>{(0,k.HT)({shareUrl:t("notes","substack-clips","web"),pub:n,post:r,utm_campaign:"substack-clips"})},disabled:h,children:(0,i.Y)(g.A,{height:24})}),(0,i.Y)(b.K0,{priority:"secondary-outline",onClick:()=>{(0,v.u4)(v.qY.VIDEO_CLIP_SHARE_BUTTON_CLICKED,{name:"instagram",post_id:r?r.id:null,utm_campaign:"substack-clips",utm_medium:"social",surface:N}),L(!0)},disabled:h||Y,children:(0,i.Y)(m,{height:20,width:20})}),(0,i.Y)(b.K0,{priority:"secondary-outline",onClick:R,disabled:h,children:(0,i.Y)(f.A,{height:20,width:20})}),(0,i.Y)(b.K0,{priority:"secondary-outline",onClick:M,disabled:h,children:(0,i.Y)(c.A,{height:20,width:20})}),(0,i.Y)(b.K0,{priority:"secondary-outline",onClick:U,disabled:h,children:(0,i.Y)(d.A,{height:20,width:20})}),(0,i.Y)(C,{isOpen:x,onClose:()=>{L(!1)},onCopyLinkClick:O,mediaCarousel:(0,i.FD)(y.Ye,{gap:16,alignItems:"center",justifyContent:"center",padding:16,position:"relative",children:[(0,i.Y)("img",{src:(0,T.Pzx)(u),width:"300px"}),(0,i.Y)("div",{className:"download-QWI_A5",children:(0,i.Y)(y.Ye,{padding:32,children:(0,i.Y)(b.mZ,{onClick:()=>w&&w(),children:(0,i.Y)(o.A,{size:"16"})})})})]})})]})]})}},96250:function(e,t,n){n.d(t,{D:()=>m});var i=n(4006),r=n(17402),a=n(58471),l=n(23044),o=n(13950),s=n(56778),c=n(86500),d=n(68410),u=n(76977),p=n(63136),h=n(39318);let m=(0,r.memo)(e=>{var t;let{pub:n,user:r,path:l,showIntrinioAttrib:m}=e,{isMobile:f,isTablet:v}=(0,d.sM)(),b="/"===l,y=null==(t=n.theme)?void 0:t.custom_footer,Y=b&&(null==y?void 0:y.backgroundColor),_=(null==y?void 0:y.showPublicationName)&&(null==y?void 0:y.publicationNamePosition)==="bottom",w=(0,i.Y)(g,{pub:n,showIntrinioAttrib:null!=m&&m}),C=(0,i.FD)("div",{className:"footer-wrap compact-footer",children:[(0,i.Y)(s.A,{onVisible:()=>{var e;(0,c.u4)(c.qY.PUBLICATION_FOOTER_SEEN,{publication_id:null==n?void 0:n.id,user_id:null==r?void 0:r.id,source:(e=l)?"/"===e?"pub-homepage":e.startsWith("/p")?"pub-post":e:"unknown"})}}),(0,i.Y)("div",{className:"footer custom-themed-background",children:f||v?(0,i.FD)(u.VP,{alignItems:"center",gap:12,children:[w,(0,i.Y)(a.k,{user:r,size:"sm"}),(0,i.FD)(p.EY,{translated:!0,as:"div",className:"footer-slogan-blurb",children:[(0,i.Y)("a",{href:"".concat((0,h.Ewe)()),"data-native":!0,children:"Substack"})," ","is the home for great culture"]})]}):(0,i.FD)(u.fI,{alignItems:"center",flex:"grow",gap:12,children:[(0,i.Y)(u.fI,{flex:"grow",minWidth:0,nowrap:!0,children:w}),(0,i.Y)(u.fI,{children:(0,i.Y)(a.k,{user:r,size:"sm"})}),(0,i.Y)(u.fI,{flex:"grow",minWidth:0,justifyContent:"end",children:(0,i.FD)(p.EY,{translated:!0,as:"div",className:"footer-slogan-blurb",children:[(0,i.Y)("a",{href:"".concat((0,h.Ewe)()),"data-native":!0,children:"Substack"})," ","is the home for great culture"]})})]})})]});return(0,i.Y)(o.DH,{prefix:Y?_?"footer_secondary":"footer":void 0,children:C})}),g=e=>{let{pub:t,showIntrinioAttrib:n}=e,{isMobile:r,isTablet:a}=(0,d.sM)();return(0,l.PG)(t)?(0,i.FD)(u.pT,{alignItems:r||a?"center":"start",direction:"column",gap:4,children:[(0,i.FD)(u.pT,{alignItems:"center",gap:4,children:[(0,i.Y)(l.d_,{pub:t}),(0,i.Y)(l.TB,{}),(0,i.Y)(l.P0,{pub:t})]}),(0,i.FD)(u.pT,{alignItems:"center",gap:4,children:[(0,i.Y)("span",{children:"Substack"}),n&&(0,i.FD)(i.FK,{children:[(0,i.Y)(l.TB,{}),(0,i.Y)(l.kz,{})]}),(0,i.Y)(l.TB,{}),(0,i.Y)(l.vA,{pub:t})]})]}):(0,i.FD)("span",{children:[(0,i.Y)(l.d_,{pub:t}),n&&(0,i.FD)(i.FK,{children:[(0,i.Y)(l.TB,{}),(0,i.Y)(l.kz,{})]}),(0,i.Y)(l.TB,{}),(0,i.Y)(l.vA,{pub:t})]})}},23044:function(e,t,n){n.d(t,{P0:()=>s,PG:()=>d,TB:()=>u,d_:()=>l,kz:()=>c,vA:()=>o});var i=n(4006),r=n(85048),a=n(63136);let l=e=>{let{pub:t}=e;return(0,i.FD)("span",{children:["\xa9 ",new Date().getFullYear()," ",(null==t?void 0:t.copyright)||"Substack Inc"]})},o=e=>{let{pub:t}=e;return(0,i.Y)(r.Nf,{publication:t})},s=e=>{let{pub:t}=e;return(0,i.Y)(r.Gf,{pub:t})},c=()=>(0,i.FD)(a.EY,{translated:!0,as:"span",children:["Market data by ",(0,i.Y)("a",{href:"https://intrinio.com/",children:"Intrinio"})]}),d=e=>!!(e.has_custom_tos||e.has_custom_privacy),u=()=>(0,i.Y)("span",{children:" \xb7 "})},52742:function(e,t,n){n.d(t,{V:()=>F});var i=n(69277),r=n(70408),a=n(32641),l=n(4006),o=n(32485),s=n.n(o),c=n(48635),d=n(90232),u=n(48697),p=n(48309),h=n(17402),m=n(12791),g=n(84605),f=n(22858),v=n(68349),b=n(89490),y=n(35369),Y=n(76977),_=n(19008),w=n(82439),C=n(57820),k=n(36372),S=n(39318),I=n(37749);function F(e){var{isOpen:t,onClose:n}=e,o=(0,a._)(e,["isOpen","onClose"]);let{iString:s}=(0,g.GO)();return(0,l.FD)(_.h,{isOpen:t,onClose:n,children:[(0,l.Y)(w.l,{title:s("Fullscreen image")}),(0,l.Y)(D,(0,r._)((0,i._)({},o),{isOpen:t,onClose:n}))]})}function D(e){let{modalContent:t=[],onClose:n,step:i,post:r,publication:a,feedItem:o,onLike:c,restackedPost:d,restackedPublication:u}=e,p=(0,v.rr)(),[g,y]=(0,h.useState)(i),[_,w]=(0,h.useState)(!0),[k,F]=(0,h.useState)(!1),D=(0,h.useCallback)(()=>{0!==g&&y(g-1)},[g]),P=(0,h.useCallback)(()=>{g!==t.length-1&&y(g+1)},[g,t]);(0,h.useEffect)(()=>{t.forEach(e=>{e.attrs.src&&(new Image().src=(0,S.dJ9)(e.attrs.src,void 0,{quality:"auto:good"}))})},[t]),(0,h.useEffect)(()=>{if(!p){let e,t=t=>{(null==t?void 0:t.type)==="keydown"&&(e=>{let{key:t}=e;["ArrowRight","ArrowDown"].includes(t)?(P(),e.stopPropagation()):["ArrowLeft","ArrowUp"].includes(t)&&(D(),e.stopPropagation())})(t),clearTimeout(e),F(!1),e=setTimeout(()=>{F(!0)},2e3)};return window.addEventListener("pointermove",t,{capture:!0,passive:!0}),window.addEventListener("pointerdown",t,{capture:!0,passive:!0}),window.addEventListener("keydown",t,{capture:!0,passive:!0}),t(),()=>{clearTimeout(e),window.removeEventListener("pointermove",t,{capture:!0}),window.removeEventListener("pointerdown",t,{capture:!0}),window.removeEventListener("keydown",t,{capture:!0})}}},[p,g,t,P,D]);let x=t[g];if(!x)return null;let{src:L,alt:O="",title:B=""}=x.attrs;return(0,l.FD)(l.FK,{children:[(0,l.FD)(b.az,{className:s()(I.A.chrome,k&&I.A.hidden),children:[(0,l.FD)(Y.fI,{justifyContent:"space-between",alignItems:"center",className:s()(I.A.top,I.A.left,I.A.right),position:"absolute",children:[(0,l.Y)(E,{onClick:n}),d&&u&&(0,l.Y)(f.L,{post:d,publication:u}),(0,l.Y)(N,{title:B,src:L})]}),g<t.length-1&&(0,l.Y)(T,{onClick:P}),g>0&&(0,l.Y)(A,{onClick:D}),(0,l.Y)(m.W,{post:r,publication:a,feedItem:o,onLike:c})]}),(0,l.FD)(Y.ov,{position:"absolute",inset:0,pointerEvents:"none",children:[(0,l.Y)(b.az,{as:"img",className:s()(I.A.img,_&&I.A.loading),onLoad:()=>{w(!1)},onClick:n,alt:null!=O?O:void 0,title:null!=B?B:void 0,src:(0,S.dJ9)(L,void 0,{quality:"auto:good"}),animate:!0}),_&&(0,l.Y)(C.y$,{className:I.A.spinner,theme:"media"})]})]})}function T(e){let{onClick:t}=e,{iString:n}=(0,g.GO)();return(0,l.Y)(P,{className:s()(I.A.right,I.A.middle),onClick:t,"aria-label":n("Next image"),position:"absolute",children:(0,l.Y)(c.A,{size:20})})}function A(e){let{onClick:t}=e,{iString:n}=(0,g.GO)();return(0,l.Y)(P,{className:s()(I.A.left,I.A.middle),onClick:t,"aria-label":n("Previous image"),position:"absolute",children:(0,l.Y)(d.A,{size:20})})}function E(e){let{onClick:t}=e,{iString:n}=(0,g.GO)();return(0,l.Y)(P,{onClick:t,"aria-label":n("Close image viewer"),children:(0,l.Y)(u.A,{size:20})})}function N(e){let{title:t,src:n}=e,{iString:i}=(0,g.GO)(),r=(0,k.d)(),a=async()=>{r.popToast(()=>(0,l.Y)(k.y,{text:i("Downloading image..."),Icon:p.A}));try{await fetch(n).then(async e=>{var t,n,i;let r=null==(i=e.headers.get("Content-Disposition"))||null==(n=i.split("filename="))||null==(t=n[1])?void 0:t.replace(/"/g,"");return{blob:await e.blob(),filename:r}}).then(e=>{let{blob:n,filename:i}=e,r=i?decodeURIComponent(i):null;!r&&(t?(r=t.replace(/[<>:"/\\|?*]/g,"_").replace(/\s+/g,"_").trim().slice(0,100)).includes(".")||(r="".concat(r,".jpg")):r="image.jpg");let a=window.URL.createObjectURL(n),l=document.createElement("a");l.href=a,l.download=r,document.body.appendChild(l),l.click(),l.remove(),window.URL.revokeObjectURL(a)})}catch(e){console.error(e)}};return(0,l.Y)(P,{onClick:a,"aria-label":i("Download image"),children:(0,l.Y)(p.A,{size:20})})}function P(e){var{children:t}=e,n=(0,a._)(e,["children"]);return(0,l.Y)(y.mZ,(0,r._)((0,i._)({rounded:!0},n),{children:t}))}},22857:function(e,t,n){n.d(t,{q:()=>a});var i=n(4006),r=n(10996);let a=e=>{let{children:t,disable:n}=e;return n?(0,i.Y)(i.FK,{children:t}):(0,i.Y)(r.NP,{theme:"light-theme",children:t})}},38959:function(e,t,n){n.d(t,{C:()=>l});var i=n(4006),r=n(13950),a=n(76977);let l=()=>(0,i.Y)(r.DH,{children:(0,i.Y)(a.Ye,{height:56,borderBottom:"detail-themed"})})},58398:function(e,t,n){n.d(t,{Z:()=>w});var i=n(69277),r=n(70408),a=n(32641),l=n(79785),o=n(4006),s=n(69715),c=n(9979),d=n(97948),u=n(84605),p=n(10398),h=n(42509),m=n(2675),g=n(8103),f=n(64839),v=n(86500),b=n(76977),y=n(16993),Y=n(75303);function _(){let e=(0,l._)(["Share this ",""]);return _=function(){return e},e}let w=e=>{var{isOpen:t,onClose:n,shareUrl:l,post:u,pub:p,profile:h,comments:m,commentId:g,medium:Y="web",utm_campaign:_,referral_token:w,position:S,clippingAllowed:I}=e,F=(0,a._)(e,["isOpen","onClose","shareUrl","post","pub","profile","comments","commentId","medium","utm_campaign","referral_token","position","clippingAllowed"]);let{handleClose:D,internalUtmCampaign:T}=(0,f.W)((0,i._)({isOpen:t,onClose:n,shareUrl:l,post:u,pub:p,profile:h,comments:m,commentId:g,medium:Y,utm_campaign:_,referral_token:w},F)),{onStartClipping:A}=(0,s.MC)(),E="post_share_dropdown",N=m&&g&&m.find(e=>e.id===g),P=N?"comment":p&&!u?"publication":u?"post":h?"profile":void 0;return(0,o.FD)(y.aF,{isOpen:t,onClose:D,children:[(0,o.Y)(C,{type:P,onClose:D}),(0,o.Y)(y.cw,{children:(0,o.FD)(b.VP,{gap:20,children:[(0,o.Y)(k,{type:P,pub:p,post:u,profile:h,comment:N,shareUrl:l}),(0,o.Y)(d.k,(0,r._)((0,i._)({utm_campaign:null!=T?T:_,medium:Y,post:u,pub:p},F),{shareName:(0,c.ZE)({post:u,pub:p,profile:h}),handleOnClipClick:()=>{(0,v.u4)(v.qY.MEDIA_CLIP_BUTTON_CLICKED,{button:"create",source:"post share dropdown",surface:E}),(0,v.u4)(v.qY.VIDEO_CLIP_BUTTON_CLICKED,{post_id:null==u?void 0:u.id,source:S,type:null==u?void 0:u.type,surface:E}),A({source:"post-share-dropdown",title:null}),n()},showClipping:!!I,disableClipping:!I,shareUrl:null!=l?l:(0,c.x5)(null,{medium:Y,post:u,pub:p,profile:h,comments:m,commentId:g,utm_campaign:_,referral_token:w})}))]})})]})};function C(e){let{type:t,onClose:n}=e,{iString:i,iTemplate:r}=(0,u.GO)(),a="publication"===t?"Substack":t;return(0,o.Y)(y.rQ,{title:a?r(_(),a):i("Share"),onClose:n,showClose:!0})}let k=e=>{let{type:t,pub:n,post:i,profile:r,comment:a,shareUrl:l}=e;return(0,o.FD)(S,{shareUrl:l,children:["comment"==t&&a&&(0,o.Y)(p.Hr,{comment:a,readOnly:!0}),"post"==t&&i&&n&&(0,o.Y)(m.Sp,{post:i,publication:n,readOnly:!0}),"publication"==t&&n&&(0,o.Y)(g.S,{publication:n,readOnly:!0}),"profile"==t&&r&&(0,o.Y)(h.i,{url:l,readOnly:!0,title:r.name,host:"substack.com",image:r.photo_url}),void 0==t&&(0,o.Y)(h.i,{url:l,readOnly:!0})]})},S=e=>{let{shareUrl:t,children:n}=e,{handleCopyLink:i}=(0,c._m)();return(0,o.Y)(Y.AE,{onClick:()=>i({shareUrl:null!=t?t:"#"}),href:null!=t?t:"#",children:n})}},15688:function(e,t,n){n.d(t,{f:()=>u});var i=n(69277),r=n(32641),a=n(4006),l=n(17402),o=n(94729),s=n(76977),c=n(20437);let d=e=>{var{mediaAsset:t}=e,n=(0,r._)(e,["mediaAsset"]);let[i,s]=(0,l.useState)(null);return((0,l.useEffect)(()=>{let e=async e=>{s(await (0,o.x6)("/api/v1/video/upload/".concat(e)))};t.media_upload_id&&e(t.media_upload_id)},[t.media_upload_id]),i)?(0,a.Y)(c.R8,{mediaUpload:i,composing:!1,videoPlayerProps:n}):null},u=e=>{var{mediaAssets:t=[]}=e,n=(0,r._)(e,["mediaAssets"]);return(0,a.Y)(s.VP,{children:t.map(e=>(0,a.Y)(d,(0,i._)({mediaAsset:e},n),e.media_upload_id))})}},4169:function(e,t,n){n.d(t,{b:()=>l});var i=n(4006),r=n(17028),a=n(37316);function l(e){let{containerRef:t,currentTime:n,remainingTime:l,progress:u,onMouseDown:p}=e;return(0,i.FD)(d,{"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":100*u,children:[(0,i.Y)(s,{time:n,textAlign:"left"}),(0,i.FD)(r.fI,{flex:"grow",position:"relative",alignItems:"center",cursor:"pointer",height:12,className:a.A.container,style:{"--progress":"".concat(u)},ref:t,onMouseDown:p,children:[(0,i.Y)(o,{}),(0,i.Y)(c,{})]}),(0,i.Y)(s,{time:l,textAlign:"right"})]})}function o(){return(0,i.Y)(r.fI,{flex:"grow",radius:"full",overflow:"hidden",position:"relative",bg:"tertiary",height:4,children:(0,i.Y)(r.az,{position:"absolute",opacity:90,className:a.A.fill})})}function s(e){let{time:t,textAlign:n}=e;return(0,i.Y)(r.EY.B4,{color:"secondary",minWidth:40,textAlign:n,children:t})}let c=(0,r.I4)({width:12,height:12,radius:"full",shadow:"xs",position:"absolute",className:a.A.playhead}),d=(0,r.I4)({display:"flex",flex:"grow",alignItems:"center",gap:8})},8273:function(e,t,n){n.d(t,{A:()=>c});var i=n(4006),r=n(17402);let a={lenny:[{slug:"lenny-bot",iframe_url:"https://www.delphi.ai/embeddable/config/bd9a8c49-766e-4bb4-8a41-11ecbd8cfb0d",title:"Lenny Bot",description:"Chat with Lenny Bot"}],yourlocalepidemiologist:[{slug:"ask-yle",iframe_url:"https://app.askdewey.co/c/2c22acae-54d4-42eb-bd38-7cdf6c0422c1/chat/new",title:"Ask Your Local Epidemiologist",description:"Chat with Your Local Epidemiologist"}],foundny:[{slug:"ask-foundny",iframe_url:"https://app.askdewey.co/c/1c2b73ca-d270-4a7d-bc5d-8e4aa53fea4f/chat/new",title:"Ask FOUND NY",description:"Chat with FOUND NY on AskDewey.co"}]};var l=n(79909),o=n(13950),s=n(57820);function c(e){var t;let n,{pub:c,slug:d,config:u}=e,[p,h]=(0,r.useState)(!0),m=null!=u?u:(t=c.subdomain,(n=a[t])&&n.find(e=>e.slug===d)||null);return m?(0,i.FD)(o.DH,{children:[(0,i.Y)(l.Metadata,{title:m.title,description:m.description}),(0,i.FD)("div",{className:"pageWrapper-JRNFOD",children:[p&&(0,i.Y)("div",{className:"loadingContainer-RJ6q8J",children:(0,i.Y)(s.y$,{})}),m.iframe_url&&(0,i.Y)("iframe",{src:m.iframe_url,className:"iframe-UZJJEZ",style:{display:p?"none":"block"},onLoad:()=>{h(!1)},title:m.title,referrerPolicy:"no-referrer"})]})]}):null}},41880:function(e,t,n){n.d(t,{$E:()=>p,Ne:()=>Y,Oy:()=>v,Rm:()=>_,U2:()=>h,WZ:()=>b,eo:()=>f,n1:()=>g,u0:()=>m,vC:()=>y});var i=n(69277),r=n(70408),a=n(32641),l=n(4006),o=n(15894),s=n(25006),c=n(63136),d=n(4016),u=n(80051);function p(e){var{children:t,paddingBottom:n=8}=e,u=(0,a._)(e,["children","paddingBottom"]);let p=(0,s.df)();return(0,d.lu)({pub:p})?(0,l.Y)(o.T,(0,r._)((0,i._)({},u),{preset:"h4-sans-condensed",style:{paddingBottom:n},children:t})):(0,l.Y)(c.EY.H1,(0,r._)((0,i._)({},u),{style:{paddingBottom:8},children:t}))}function h(e){var{children:t,paddingBottom:n=8}=e,u=(0,a._)(e,["children","paddingBottom"]);let p=(0,s.df)();return(0,d.lu)({pub:p})?(0,l.Y)(o.T,(0,r._)((0,i._)({},u),{preset:"h6-sans",style:{paddingBottom:n},children:t})):(0,l.Y)(c.EY.H2,(0,r._)((0,i._)({style:{paddingBottom:n}},u),{children:t}))}function m(e){var{children:t}=e,n=(0,a._)(e,["children"]);let u=(0,s.df)();return(0,d.lu)({pub:u})?(0,l.Y)(o.T,(0,r._)((0,i._)({},n),{preset:"d1-sans-regular",children:t})):(0,l.Y)(c.EY.B1,(0,r._)((0,i._)({},n),{children:t}))}function g(e){var{children:t}=e,n=(0,a._)(e,["children"]);let u=(0,s.df)();return(0,d.lu)({pub:u})?(0,l.Y)(o.T,(0,r._)((0,i._)({},n),{color:"tertiary",preset:"detail-small",children:t})):(0,l.Y)(c.EY.B4,(0,r._)((0,i._)({},n),{color:"secondary",children:t}))}function f(e){var{children:t}=e,n=(0,a._)(e,["children"]);let u=(0,s.df)();return(0,d.lu)({pub:u})?(0,l.Y)(o.T,(0,r._)((0,i._)({},n),{preset:"list-item-menu",children:t})):(0,l.Y)(c.EY.B4,(0,r._)((0,i._)({},n),{children:t}))}function v(e){var{href:t,onClick:n,children:u}=e,p=(0,a._)(e,["href","onClick","children"]);let h=(0,s.df)();return(0,d.lu)({pub:h})?(0,l.Y)(o.T,(0,r._)((0,i._)({},p),{as:"a",href:t,preset:"list-item-menu",onClick:n,style:{textDecoration:"underline",fontWeight:"bold"},color:"blue","data-native":!0,children:u})):(0,l.Y)(c.EY.B4,(0,r._)((0,i._)({},p),{as:"a",href:t,onClick:n,children:u}))}function b(e){var{children:t}=e,n=(0,a._)(e,["children"]);let u=(0,s.df)();return(0,d.lu)({pub:u})?(0,l.Y)(o.T,(0,r._)((0,i._)({},n),{color:"tertiary",preset:"detail-small",children:t})):(0,l.Y)(c.EY.B4,(0,r._)((0,i._)({},n),{color:"secondary",children:t}))}function y(e){var{children:t}=e,n=(0,a._)(e,["children"]);let u=(0,s.df)();return(0,d.lu)({pub:u})?(0,l.Y)(o.T,(0,r._)((0,i._)({},n),{preset:"lg-preview-byline",children:t})):(0,l.Y)(c.EY.B4,(0,r._)((0,i._)({},n),{color:"secondary",children:t}))}function Y(){return(0,l.Y)("hr",{className:u.A.hrSmall})}function _(){return(0,l.Y)("hr",{className:u.A.hrLarge})}},31793:function(e,t,n){n.d(t,{E:()=>D});var i=n(69277),r=n(70408),a=n(4006),l=n(83673),o=n.n(l),s=n(38970),c=n.n(s),d=n(17402),u=n(15734),p=n.n(u),h=n(89160),m=n(79796),g=n(27428),f=n(95691),v=n(84605),b=n(25006),y=n(46271),Y=n(12501),_=n(68349),w=n(36372),C=n(56458),k=n(4016),S=n(96301),I=n(77124),F=n(39318);let D=()=>{let e=(0,y.Jd)(),t=(0,b.df)(),n=(0,w.d)(),{iString:l}=(0,v.GO)(),[s,u]=(0,d.useState)((null==e?void 0:e.name)||""),[D,T]=(0,d.useState)((null==e?void 0:e.email)||""),[A,E]=(0,d.useState)(!1),[N,P]=(0,d.useState)(!1),[x,L]=(0,d.useState)(null),[O,B]=(0,d.useState)(null),[M,R]=(0,d.useState)(!1),[U,j]=(0,d.useState)(!1),[z]=(0,d.useState)(0),[H,W]=(0,d.useState)(new Set),{ids:V}=(0,m.i)({pub:t}),{ids:K}=(0,m.i)({pub:t,pubSetting:"fp_primary_column_section_ids"}),{ids:q}=(0,I.q)({pub:null!=t?t:void 0}),{ids:G}=(0,f.P)({pub:null!=t?t:void 0}),{ids:J}=(0,g.M)({pub:null!=t?t:void 0}),{ids:$}=(0,h.G)({pub:null!=t?t:void 0}),{result:Z,isLoading:Q,refetch:X}=(0,Y.st)({pathname:"/api/v1/subscription",auto:!0}),{refetch:ee,isLoading:et}=(0,Y.st)({pathname:"/api/v1/subscription/sections/email",auto:!1,method:"PATCH"}),{refetch:en}=(0,Y.st)({pathname:"/api/v1/subscription/email",auto:!1,method:"POST"});(0,d.useEffect)(()=>{!Q&&(null==Z?void 0:Z.email_settings)&&W(new Set(Object.keys(Z.email_settings).filter(e=>{var t;return"individual"===(null==(t=Z.email_settings)?void 0:t[e])}).map(e=>Number(e))))},[Q,Z]);let ei=(0,d.useCallback)(async e=>{if(e&&e!==s){E(!0),L(null);try{await p().put("/api/v1/user/profile").send({name:e}),u(e)}catch(e){L((0,_.uX)(e)),console.error("Name update failed:",e)}finally{E(!1)}}},[s]),er=(0,d.useCallback)(async()=>{if(!(null==e?void 0:e.email))return{success:!1};R(!0);try{return await p().post("/api/v1/forgot").send({email:e.email,for_pub:null==t?void 0:t.subdomain,redirect:window.location.pathname}),n.popToast(()=>(0,a.Y)(w.y,{text:"Password reset email sent. Please check your inbox."})),{success:!0}}catch(e){return console.error("Password reset failed:",e),n.popToast(()=>(0,a.Y)(w.y,{text:(0,_.uX)(e)})),{success:!1}}finally{R(!1)}},[null==e?void 0:e.email,n]),ea=(0,d.useCallback)(async(e,n)=>{if(e&&e!==D){if(e!==n)return void B("Email addresses do not match");P(!0),B(null);try{await p().put("/api/v1/user/email").send({email:e,email_doublecheck:n}),T(e),(0,_.V2)((0,F.bgT)({redirect:"/subscribe?isSignInAttempt=true",for_pub:null==t?void 0:t.subdomain}))}catch(e){var i;(null==(i=e.response)?void 0:i.status)===403?B("This email is already associated with another account"):B((0,_.uX)(e)),console.error("Email update failed:",e)}finally{P(!1)}}},[D]),el=(0,d.useMemo)(()=>t?(0,C.Jh)({pub:t,includeMainPub:!(0,k.lu)({pub:t})}):[],[t]),eo=(0,d.useMemo)(()=>el.filter(e=>{var t,n,i,r;return!q.includes(null!=(t=e.sectionId)?t:-1)&&!G.includes(null!=(n=e.sectionId)?n:-1)&&!J.includes(null!=(i=e.sectionId)?i:-1)&&!$.includes(null!=(r=e.sectionId)?r:-1)}),[el,q,G,J,$]),es=(0,d.useMemo)(()=>{let e=c()(el,"sectionId"),t=[...q,...G].filter(e=>!$.includes(e));return o()(t.map(t=>e[t]))},[el,q,G,$]),ec=(0,d.useCallback)(async(e,n)=>{if(!e||!t)return;let i=new Set(H);n?i.add(e):i.delete(e);try{await ee({json:eo.reduce((t,i)=>(i.sectionId===e&&(t[i.sectionId]={setting:n?"individual":"disabled"}),t),{})}),n&&(null==Z?void 0:Z.email_disabled)&&(await en({json:{publication_id:t.id,email_disabled:!1,receive_podcast_emails:!0,source:"account_settings"}}),await X()),W(i)}catch(e){console.error("Failed to update newsletter subscription:",e)}},[t,H,eo,ee,en,Z,X]),ed=(0,d.useCallback)(async(e,n)=>{if(!t)return;let i=[];"fromTheFreePress"===e?i=K:"featured"===e?i=V.filter(e=>!K.includes(e)):"topic"===e?i=eo.filter(e=>!K.includes(e.sectionId||0)&&!V.includes(e.sectionId||0)).map(e=>e.sectionId||0):"video"===e&&(i=es.map(e=>e.sectionId).filter(e=>null!=e));let r=new Set(H);i.forEach(e=>{n?r.add(e):r.delete(e)});try{let e=i.reduce((e,t)=>(e[t]={setting:n?"individual":"disabled"},e),{});await ee({json:e}),n&&(null==Z?void 0:Z.email_disabled)&&(await en({json:{publication_id:t.id,email_disabled:!1,receive_podcast_emails:!0,source:"account_settings"}}),await X()),W(r)}catch(e){console.error("Failed to update newsletter group:",e)}},[t,K,V,H,ee,en,Z,X]),eu=(0,d.useCallback)(async()=>{if(t&&e)try{let e=eo.filter(e=>e.sectionId).map(e=>e.sectionId);if(e.length>0){let t=e.reduce((e,t)=>(e[t]={setting:"disabled"},e),{});await ee({json:t})}await en({json:{publication_id:t.id,email_disabled:!0,receive_podcast_emails:!1,source:"account_settings"}}),await X(),W(new Set),n.popToast(()=>(0,a.Y)(w.y,{text:"Successfully unsubscribed from all emails."}))}catch(e){console.error("Failed to unsubscribe from all emails:",e),n.popToast(()=>(0,a.Y)(w.y,{text:(0,_.uX)(e)}))}},[t,e,eo,ee,en,X,n]),ep=(0,d.useCallback)(async()=>{if(confirm(l("Are you sure? Time paid will not be refunded")))try{await p().del("/api/v1/subscription").send({force_now:!0}),n.popToast(()=>(0,a.Y)(w.y,{text:"Subscription cancelled successfully."})),setTimeout(()=>{window.location.reload()},1e3)}catch(e){console.error("Failed to delete subscription:",e),n.popToast(()=>(0,a.Y)(w.y,{text:(0,_.uX)(e)}))}},[l,n]),eh=(0,d.useCallback)(async()=>{j(!0);try{await p().post("/api/v1/subscription/reactivate").send({}),n.popToast(()=>(0,a.Y)(w.y,{text:"Your subscription is set to renew."})),await X()}catch(e){console.error("Failed to set to renew:",e),n.popToast(()=>(0,a.Y)(w.y,{text:(0,_.uX)(e)}))}finally{j(!1)}},[n,X]),em=c()(eo,"sectionId"),eg=t&&K?{name:"From The Free Press",newsletters:o()(K.map(e=>em[e])).map(e=>(0,r._)((0,i._)({},e),{selected:H.has(e.sectionId||0),onToggle:t=>ec(e.sectionId||0,t)}))}:{name:"From The Free Press",newsletters:[]},ef=t&&K?{name:"All",newsletters:o()(eo.filter(e=>e.sectionId).map(e=>(0,r._)((0,i._)({},e),{selected:H.has(e.sectionId||0),onToggle:t=>ec(e.sectionId||0,t)})))}:{name:"All",newsletters:[]},ev=t&&V?{name:"Featured",newsletters:o()(V.filter(e=>!K.includes(e)).map(e=>em[e])).map(e=>(0,r._)((0,i._)({},e),{selected:H.has(e.sectionId||0),onToggle:t=>ec(e.sectionId||0,t)}))}:{name:"Featured",newsletters:[]},eb=t&&eo?{name:"Topic Alerts",newsletters:o()(eo.filter(e=>!!e.sectionId&&!K.includes(e.sectionId)&&!V.includes(e.sectionId)).map(e=>(0,r._)((0,i._)({},e),{selected:H.has(e.sectionId||0),onToggle:t=>ec(e.sectionId||0,t)})))}:{name:"Topic Alerts",newsletters:[]},ey=t&&eo?{name:"Podcast and Video Alerts",newsletters:o()(es.map(e=>(0,r._)((0,i._)({},e),{selected:H.has(e.sectionId||0),onToggle:t=>ec(e.sectionId||0,t)})))}:{name:"Podcast and Video Alerts",newsletters:[]},eY=(null==Z?void 0:Z.status)==="trialing",e_=null;return eY&&(Z.current_period_end?e_=new Date(1e3*Z.current_period_end):Z.expiry&&(e_=new Date(Z.expiry))),{name:s,email:D,updateName:ei,updateEmail:ea,isUpdatingName:A,isUpdatingEmail:N,nameError:x,emailError:O,isSendingReset:M,handlePasswordChange:er,newsletters:{isLoading:Q||et,fromTheFreePress:eg,all:ef,featured:ev,topic:eb,video:ey,updateNewsletter:ec,updateNewsletterGroup:ed,unsubscribeFromAllEmails:eu,pubEmailsDisabled:!!(null==Z?void 0:Z.email_disabled)},plan:null==Z?void 0:Z.plan,totalAmount:null==Z?void 0:Z.totalAmount,currency:null==Z?void 0:Z.currency,isLifetime:(null==Z?void 0:Z.type)==="lifetime"||(null==Z?void 0:Z.never_ends)||!1,isComped:(null==Z?void 0:Z.is_comped)||!1,isTrial:eY,giftCount:z,trialEnd:e_,canChangeSubscription:!!Z&&(0,S.GU)(Z),subscription:null!=Z?Z:void 0,renewing:U,onSetToRenew:eh,onUnsubscribeNow:ep}}},68188:function(e,t,n){n.d(t,{A:()=>c});var i=n(69277),r=n(4006),a=n(32485),l=n.n(a),o=n(17402),s=n(79909);class c extends o.Component{render(){let{html:e,children:t,metadata:n}=this.props;return(0,r.FD)("div",{className:l()("pageContainer-PCEs9w","container-border"),children:[(0,r.Y)(s.Metadata,(0,i._)({},n)),(0,r.Y)("div",{className:"container",children:(0,r.FD)("div",{className:"page typography",children:[t,(0,r.Y)("div",{className:"body markup",dangerouslySetInnerHTML:{__html:e}})]})})]})}}},68924:function(e,t,n){n.d(t,{A:()=>o});var i=n(69277),r=n(70408),a=n(4006),l=n(97731);let o=e=>(0,a.FD)(l.A,(0,r._)((0,i._)({},e),{name:"FacebookIconCircle",svgParams:{height:24,width:24},children:[(0,a.Y)("circle",{cx:"12",cy:"12",r:"11.75",fill:"white",stroke:"none"}),(0,a.Y)("path",{d:"M12 0C5.37098 0 0 5.37089 0 11.9975C0 17.9844 4.38331 22.9414 10.1117 23.8491L10.1164 15.473H7.04998V12.0021H10.1164C10.1164 12.0021 10.1023 10.0269 10.1164 9.14743C10.1305 8.26797 10.3045 7.42142 10.7607 6.65008C11.4615 5.4555 12.5526 4.87237 13.893 4.70775C14.9935 4.57135 16.08 4.72183 17.1664 4.87237C17.2416 4.88176 17.2792 4.89115 17.3545 4.90529C17.3545 4.90529 17.3592 5.03225 17.3545 5.11222C17.3498 5.94933 17.3545 7.86819 17.3545 7.86819C16.8324 7.8588 15.9671 7.80706 15.3933 7.89641C14.4433 8.04221 13.8977 8.64891 13.8789 9.6036C13.8601 10.3467 13.8695 12.0021 13.8695 12.0021H17.2134L16.6726 15.473H13.8742V23.8491C19.612 22.9508 24 17.9844 24 11.9975C23.9953 5.37089 18.6243 0 11.9977 0Z",fill:"#1877f2",stroke:"none"})]}))},4067:function(e,t,n){n.d(t,{A:()=>o});var i=n(69277),r=n(70408),a=n(4006),l=n(97731);let o=e=>(0,a.Y)(l.A,(0,r._)((0,i._)({},e),{name:"LinkedInShareIcon",svgParams:{height:24,width:24,stroke:"none",viewBox:"0 0 72 72"},children:(0,a.FD)("g",{fill:"none",fillRule:"evenodd",stroke:"none",children:[(0,a.Y)("path",{d:"M36,72 L36,72 C55.882251,72 72,55.882251 72,36 L72,36 C72,16.117749 55.882251,-3.65231026e-15 36,0 L36,0 C16.117749,3.65231026e-15 -2.4348735e-15,16.117749 0,36 L0,36 C2.4348735e-15,55.882251 16.117749,72 36,72 Z",fill:"#007EBB"}),(0,a.Y)("path",{d:"M59,57 L49.959375,57 L49.959375,41.6017895 C49.959375,37.3800228 48.3552083,35.0207581 45.0136719,35.0207581 C41.3785156,35.0207581 39.4792969,37.4759395 39.4792969,41.6017895 L39.4792969,57 L30.7666667,57 L30.7666667,27.6666667 L39.4792969,27.6666667 L39.4792969,31.6178624 C39.4792969,31.6178624 42.0989583,26.7704897 48.3236979,26.7704897 C54.5455729,26.7704897 59,30.5699366 59,38.4279486 L59,57 Z M20.372526,23.8257036 C17.4048177,23.8257036 15,21.4020172 15,18.4128518 C15,15.4236864 17.4048177,13 20.372526,13 C23.3402344,13 25.7436198,15.4236864 25.7436198,18.4128518 C25.7436198,21.4020172 23.3402344,23.8257036 20.372526,23.8257036 Z M15.8736979,57 L24.958724,57 L24.958724,27.6666667 L15.8736979,27.6666667 L15.8736979,57 Z",fill:"#FFF",stroke:"none"})]})}))},36534:function(e,t,n){n.d(t,{A:()=>o});var i=n(69277),r=n(70408),a=n(4006),l=n(97731);let o=e=>(0,a.Y)(l.A,(0,r._)((0,i._)({},e),{name:"PlayIcon",svgParams:{height:43,width:35},children:(0,a.Y)("path",{d:"M34.428 20.819C34.8483 21.0821 34.8483 21.7121 34.428 21.9752L1.74924 42.4349C1.3132 42.7079 0.755859 42.3835 0.755859 41.8568V0.937387C0.755859 0.410635 1.3132 0.0862969 1.74925 0.359298L34.428 20.819Z"})}))},49331:function(e,t,n){n.d(t,{A:()=>o});var i=n(69277),r=n(70408),a=n(4006),l=n(97731);let o=e=>(0,a.Y)(l.A,(0,r._)((0,i._)({},e),{name:"ShareSubstackIcon",svgParams:{height:24,width:24,viewBox:"0 0 24 24",stroke:"none"},children:(0,a.Y)("path",{d:"M21.6608 8.55517H2.33838V5.9555H21.6617V8.55517H21.6608ZM2.33838 10.911V23L12 17.6008L21.6617 23V10.911H2.33838ZM21.6617 1H2.33838V3.59967H21.6617V1Z",fill:"var(--color-semantic-substack-bg-primary)",stroke:"none"})}))},79146:function(e,t,n){n.d(t,{A:()=>o});var i=n(69277),r=n(70408),a=n(4006),l=n(97731);let o=e=>(0,a.Y)(l.A,(0,r._)((0,i._)({},e),{name:"ShareTwitterIcon",svgParams:{height:24,width:24,stroke:"none"},children:(0,a.Y)("path",{d:"M17.7508 2.96069H20.8175L14.1175 10.619L22 21.0382H15.8283L10.995 14.7182L5.46333 21.0382H2.395L9.56167 12.8465L2 2.96153H8.32833L12.6975 8.73819L17.7508 2.96069ZM16.675 19.2032H18.3742L7.405 4.69986H5.58167L16.675 19.2032Z",fill:"var(--color-fg-primary)",stroke:"none"})}))},23725:function(e,t,n){n.d(t,{A:()=>o});var i=n(69277),r=n(70408),a=n(4006),l=n(97731);let o=e=>(0,a.FD)(l.A,(0,r._)((0,i._)({},e),{name:"SimpleCheckmarkIcon",svgParams:{height:100,width:100},children:[(0,a.Y)("path",{d:"m40.9 70c-.5 0-1-.2-1.4-.6-.8-.8-.8-2 0-2.8l36.8-36.8c.8-.8 2-.8 2.8 0s.8 2 0 2.8l-36.8 36.8c-.4.4-.9.6-1.4.6z"}),(0,a.Y)("path",{d:"m40.9 70c-.5 0-1-.2-1.4-.6l-16.5-16.5c-.8-.8-.8-2 0-2.8s2-.8 2.8 0l16.5 16.5c.8.8.8 2 0 2.8-.4.4-.9.6-1.4.6z"})]}))},60745:function(e,t,n){n.d(t,{A:()=>s});var i=n(69277),r=n(70408),a=n(32641),l=n(4006),o=n(97731);let s=e=>{var{size:t=24,fill:n="var(--color-fg-primary)"}=e,s=(0,a._)(e,["size","fill"]);return(0,l.Y)(o.A,(0,r._)((0,i._)({},s),{name:"BlueskyIcon",svgParams:{viewBox:"0 0 600 600"},width:t,height:t,fill:n,stroke:"none",children:(0,l.Y)("path",{stroke:"none",d:"m135.72 44.03c66.496 49.921 138.02 151.14 164.28 205.46 26.262-54.316 97.782-155.54 164.28-205.46 47.98-36.021 125.72-63.892 125.72 24.795 0 17.712-10.155 148.79-16.111 170.07-20.703 73.984-96.144 92.854-163.25 81.433 117.3 19.964 147.14 86.092 82.697 152.22-122.39 125.59-175.91-31.511-189.63-71.766-2.514-7.3797-3.6904-10.832-3.7077-7.8964-0.0174-2.9357-1.1937 0.51669-3.7077 7.8964-13.714 40.255-67.233 197.36-189.63 71.766-64.444-66.128-34.605-132.26 82.697-152.22-67.108 11.421-142.55-7.4491-163.25-81.433-5.9562-21.282-16.111-152.36-16.111-170.07 0-88.687 77.742-60.816 125.72-24.795z"})}))}},49031:function(e,t,n){n.d(t,{A:()=>s});var i=n(69277),r=n(70408),a=n(32641),l=n(4006),o=n(97731);let s=e=>{var{size:t=24,fill:n="var(--color-fg-primary)"}=e,s=(0,a._)(e,["size","fill"]);return(0,l.Y)(o.A,(0,r._)((0,i._)({},s),{name:"FacebookIcon",svgParams:{viewBox:"0 0 20 20"},width:t,height:t,fill:n,stroke:"none",children:(0,l.Y)("path",{stroke:"none",d:"M20 10C20 4.47715 15.5229 0 10 0C4.47715 0 0 4.47715 0 10C0 14.9912 3.65684 19.1283 8.4375 19.8785V12.8906H5.89844V10H8.4375V7.79688C8.4375 5.29063 9.93047 3.90625 12.2146 3.90625C13.3084 3.90625 14.4531 4.10156 14.4531 4.10156V6.5625H13.1922C11.95 6.5625 11.5625 7.3334 11.5625 8.125V10H14.3359L13.8926 12.8906H11.5625V19.8785C16.3432 19.1283 20 14.9912 20 10Z"})}))}},34581:function(e,t,n){n.d(t,{A:()=>s});var i=n(69277),r=n(70408),a=n(32641),l=n(4006),o=n(97731);let s=e=>{var{size:t=24,fill:n="var(--color-fg-primary)"}=e,s=(0,a._)(e,["size","fill"]);return(0,l.Y)(o.A,(0,r._)((0,i._)({},s),{name:"LinkedInIcon",svgParams:{viewBox:"0 0 20 20"},width:t,height:t,fill:n,stroke:"none",children:(0,l.Y)("path",{stroke:"none",d:"M18.5195 0H1.47656C0.660156 0 0 0.644531 0 1.44141V18.5547C0 19.3516 0.660156 20 1.47656 20H18.5195C19.3359 20 20 19.3516 20 18.5586V1.44141C20 0.644531 19.3359 0 18.5195 0ZM5.93359 17.043H2.96484V7.49609H5.93359V17.043ZM4.44922 6.19531C3.49609 6.19531 2.72656 5.42578 2.72656 4.47656C2.72656 3.52734 3.49609 2.75781 4.44922 2.75781C5.39844 2.75781 6.16797 3.52734 6.16797 4.47656C6.16797 5.42188 5.39844 6.19531 4.44922 6.19531ZM17.043 17.043H14.0781V12.4023C14.0781 11.2969 14.0586 9.87109 12.5352 9.87109C10.9922 9.87109 10.7578 11.0781 10.7578 12.3242V17.043H7.79688V7.49609H10.6406V8.80078H10.6797C11.0742 8.05078 12.043 7.25781 13.4844 7.25781C16.4883 7.25781 17.043 9.23438 17.043 11.8047V17.043Z"})}))}},38685:function(e,t,n){n.d(t,{A:()=>s});var i=n(69277),r=n(70408),a=n(32641),l=n(4006),o=n(97731);let s=e=>{var{size:t=24,fill:n="var(--color-fg-primary)"}=e,s=(0,a._)(e,["size","fill"]);return(0,l.Y)(o.A,(0,r._)((0,i._)({},s),{name:"XIcon",svgParams:{viewBox:"0 0 20 20"},width:t,height:t,fill:n,children:(0,l.Y)("path",{stroke:"none",fillRule:"evenodd",clipRule:"evenodd",d:"M13.2879 19.1666L8.66337 12.575L2.87405 19.1666H0.424805L7.57674 11.0258L0.424805 0.833252H6.71309L11.0717 7.04577L16.5327 0.833252H18.982L12.1619 8.59699L19.5762 19.1666H13.2879ZM16.0154 17.3083H14.3665L3.93176 2.69159H5.58092L9.7601 8.54422L10.4828 9.55981L16.0154 17.3083Z"})}))}},14701:function(e,t,n){n.d(t,{A:()=>s});var i=n(69277),r=n(70408),a=n(32641),l=n(4006),o=n(97731);let s=e=>{var{size:t=24,fill:n="var(--color-fg-primary)"}=e,s=(0,a._)(e,["size","fill"]);return(0,l.Y)(o.A,(0,r._)((0,i._)({},s),{name:"CommentBadgeFoundingIcon",svgParams:{viewBox:"0 0 26 26"},width:t,height:t,stroke:"none",fill:n,children:(0,l.Y)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.82184 6.14159C7.56025 6.78804 7.4162 7.49464 7.4162 8.23489C7.4162 9.09949 7.61271 9.91819 7.9635 10.6488C8.60389 10.4676 9.27965 10.3706 9.97806 10.3706C10.1536 10.3706 10.3278 10.3767 10.5003 10.3888C10.6996 9.28561 11.1441 8.26769 11.7752 7.39342C10.8114 6.60183 9.57792 6.12665 8.23342 6.12665C8.09499 6.12665 7.95774 6.13168 7.82184 6.14159ZM5.77711 6.69453C5.67168 7.19136 5.6162 7.70664 5.6162 8.23489C5.6162 9.34746 5.86227 10.4026 6.30295 11.3487C5.04556 12.0717 4.02116 13.1542 3.37011 14.456C2.91142 13.6453 2.64961 12.7084 2.64961 11.7105C2.64961 9.50798 3.92478 7.60333 5.77711 6.69453ZM6.62812 4.50164C3.32204 5.23459 0.849609 8.18379 0.849609 11.7105C0.849609 13.5781 1.54303 15.2838 2.68647 16.5842C2.62578 16.9653 2.59425 17.3562 2.59425 17.7544C2.59425 21.8324 5.9001 25.1382 9.97806 25.1382C11.0364 25.1382 12.0427 24.9156 12.9527 24.5146C13.8703 24.9237 14.8868 25.1511 15.9565 25.1511C20.0344 25.1511 23.3403 21.8453 23.3403 17.7673C23.3403 17.3869 23.3115 17.0133 23.256 16.6484C24.4334 15.3402 25.15 13.609 25.15 11.7105C25.15 8.18398 22.6778 5.23491 19.372 4.50176C18.0895 2.31749 15.716 0.851074 13 0.851074C10.2841 0.851074 7.91059 2.31743 6.62812 4.50164ZM8.97613 4.36354C10.502 4.51594 11.8911 5.13289 12.9998 6.07089C14.1086 5.1328 15.4978 4.51583 17.0239 4.36349C16.008 3.30789 14.5807 2.65107 13 2.65107C11.4193 2.65107 9.99198 3.30791 8.97613 4.36354ZM18.1782 6.14162C18.0422 6.1317 17.9047 6.12665 17.7661 6.12665C16.4217 6.12665 15.1881 6.60183 14.2244 7.39342C14.8571 8.26995 15.3022 9.29088 15.5008 10.3974C15.6515 10.3882 15.8034 10.3835 15.9565 10.3835C16.6738 10.3835 17.3673 10.4858 18.0231 10.6766C18.3823 9.93902 18.5838 9.11049 18.5838 8.23489C18.5838 7.49466 18.4398 6.78807 18.1782 6.14162ZM16.872 12.2582C16.5741 12.2091 16.2683 12.1835 15.9565 12.1835C15.8373 12.1835 15.7189 12.1873 15.6016 12.1946C15.5866 12.4264 15.5609 12.6552 15.525 12.8807C15.5917 12.9565 15.6569 13.0338 15.7205 13.1123C16.1408 12.8774 16.5276 12.5897 16.872 12.2582ZM16.6751 14.6406C17.456 14.1916 18.147 13.6039 18.7146 12.9112C19.918 13.5961 20.8419 14.7155 21.2731 16.0559C20.3145 16.8304 19.0945 17.2943 17.7661 17.2943C17.6251 17.2943 17.4852 17.289 17.3468 17.2788C17.2872 16.341 17.0525 15.4508 16.6751 14.6406ZM14.6053 15.4437C14.7432 15.4131 14.8797 15.3787 15.0146 15.3405C15.2344 15.7983 15.3936 16.2906 15.4819 16.8072C15.0272 16.6031 14.6048 16.3399 14.2244 16.0275C14.3602 15.8394 14.4874 15.6446 14.6053 15.4437ZM13.5397 13.4538C13.5008 13.5722 13.4581 13.689 13.4116 13.8038C13.2757 13.8137 13.1384 13.8187 13 13.8187C12.8614 13.8187 12.724 13.8136 12.588 13.8037C12.5373 13.6787 12.4911 13.5513 12.4495 13.4219C12.6177 13.286 12.794 13.1597 12.9774 13.0437C13.1735 13.1688 13.3613 13.3059 13.5397 13.4538ZM12.9818 11.0072C13.2248 10.9001 13.4747 10.8057 13.7305 10.725C13.6069 10.0305 13.3548 9.3804 12.9998 8.80019C12.6435 9.3825 12.3909 10.0352 12.2677 10.7325C12.5116 10.8119 12.7499 10.9038 12.9818 11.0072ZM10.3974 12.1861C10.259 12.1758 10.1191 12.1706 9.97806 12.1706C9.68186 12.1706 9.39103 12.1937 9.1073 12.2381C9.44659 12.5681 9.82768 12.8553 10.2419 13.0911C10.3148 13.0021 10.3897 12.9149 10.4666 12.8294C10.4344 12.6178 10.4112 12.4032 10.3974 12.1861ZM9.27818 14.6135C8.50368 14.1606 7.81907 13.5707 7.25761 12.877C6.04543 13.5545 5.11183 14.6709 4.67178 16.0111C5.63842 16.8125 6.87966 17.2943 8.23342 17.2943C8.35261 17.2943 8.47093 17.2905 8.58827 17.2832C8.64976 16.3331 8.89095 15.432 9.27818 14.6135ZM10.4498 16.8371C10.5392 16.3038 10.7042 15.7962 10.9334 15.3256C11.085 15.3697 11.2387 15.4091 11.3942 15.4436C11.5121 15.6445 11.6393 15.8393 11.7752 16.0275C11.3759 16.3554 10.9304 16.6291 10.4498 16.8371ZM8.68906 19.0804C8.53836 19.0896 8.38643 19.0943 8.23342 19.0943C6.82992 19.0943 5.51788 18.7027 4.40059 18.0228C4.54064 20.982 6.98419 23.3382 9.97806 23.3382C10.3286 23.3382 10.6715 23.3059 11.0041 23.2442C9.81887 22.1718 8.98334 20.72 8.68906 19.0804ZM12.9571 22.478C11.6671 21.6549 10.7378 20.3165 10.4593 18.7528C11.4019 18.4552 12.2628 17.9735 12.9998 17.35C13.7201 17.9595 14.5588 18.4334 15.4765 18.7324C15.1983 20.3075 14.2597 21.6548 12.9571 22.478ZM14.9067 23.2526C15.2467 23.3173 15.5976 23.3511 15.9565 23.3511C18.9412 23.3511 21.379 21.0093 21.5326 18.0627C20.4299 18.718 19.1419 19.0943 17.7661 19.0943C17.5906 19.0943 17.4164 19.0881 17.2439 19.0761C16.9463 20.7231 16.1024 22.18 14.9067 23.2526ZM22.5911 14.5228C21.9495 13.2133 20.9316 12.1216 19.6783 11.3888C20.1308 10.4323 20.3838 9.36317 20.3838 8.23489C20.3838 7.70673 20.3284 7.19153 20.223 6.69479C22.075 7.60369 23.35 9.50818 23.35 11.7105C23.35 12.736 23.0735 13.6969 22.5911 14.5228Z"})}))}},14647:function(e,t,n){n.d(t,{A:()=>s});var i=n(69277),r=n(70408),a=n(32641),l=n(4006),o=n(97731);let s=e=>{var{size:t=24,fill:n="var(--color-fg-primary)"}=e,s=(0,a._)(e,["size","fill"]);return(0,l.Y)(o.A,(0,r._)((0,i._)({},s),{name:"CommentBadgeFoundingIcon",svgParams:{viewBox:"0 0 24 24"},width:t,height:t,stroke:"none",fill:n,children:(0,l.Y)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.0436 3.51174C14.4213 1.66968 17.8438 1.81108 20.0161 3.98341C22.1882 6.15552 22.3297 9.5776 20.4883 11.9552C22.308 14.3248 22.1043 17.7443 19.9244 19.9242C17.7446 22.104 14.3255 22.3079 11.956 20.4885C9.57839 22.3299 6.1564 22.1883 3.98435 20.0162C1.8125 17.8443 1.67073 14.4227 3.51158 12.0451C1.69209 9.67557 1.89593 6.25627 4.07573 4.07643C6.25532 1.8968 9.67415 1.69278 12.0436 3.51174ZM10.7862 4.82251C9.14237 3.68439 6.84468 3.85303 5.34853 5.34921C3.8523 6.84546 3.68371 9.14337 4.822 10.7873C6.30674 9.7329 8.15567 9.41636 9.84859 9.84842C9.41641 8.15584 9.73255 6.30722 10.7862 4.82251ZM6.19444 12.0422C7.5081 11.2786 9.12685 11.2691 10.425 12.0048C9.11132 12.7684 7.49256 12.7779 6.19444 12.0422ZM4.82075 13.3014C3.6397 14.9746 3.79215 17.2784 5.25715 18.7435C6.72233 20.2087 9.02649 20.361 10.6997 19.1794C9.66398 17.7076 9.37248 15.8727 9.81462 14.1861C8.12786 14.6285 6.29279 14.3372 4.82075 13.3014ZM11.9587 17.8054C11.2232 16.5075 11.2326 14.8891 11.9957 13.5756C12.7312 14.8735 12.7218 16.4919 11.9587 17.8054ZM13.2136 19.178C14.8575 20.3162 17.1553 20.1477 18.6516 18.6514C20.1479 17.155 20.3164 14.8568 19.1778 13.2128C17.6931 14.2668 15.8445 14.5832 14.1519 14.1512C14.5841 15.8441 14.2678 17.6931 13.2136 19.178ZM17.805 11.958C16.4917 12.7209 14.8738 12.7303 13.5761 11.9952C14.8894 11.2324 16.5073 11.2229 17.805 11.958ZM19.1791 10.6991C20.3608 9.02581 20.2085 6.72146 18.7433 5.25619C17.2779 3.79079 14.9733 3.63863 13.3 4.82071C14.3361 6.29264 14.6277 8.1277 14.1855 9.81454C15.8722 9.37211 17.7071 9.66343 19.1791 10.6991ZM12.0413 6.19502C12.7767 7.49269 12.7676 9.1108 12.0048 10.4243C11.2694 9.12658 11.2786 7.50848 12.0413 6.19502Z"})}))}},20713:function(e,t,n){n.d(t,{A:()=>s});var i=n(69277),r=n(70408),a=n(32641),l=n(4006),o=n(97731);let s=e=>{var{size:t=24,fill:n="var(--color-fg-primary)"}=e,s=(0,a._)(e,["size","fill"]);return(0,l.Y)(o.A,(0,r._)((0,i._)({},s),{name:"CommentBadgeStarIcon",svgParams:{viewBox:"0 0 20 20"},width:t,height:t,fill:n,children:(0,l.Y)("path",{stroke:"none",d:"M5.29389 16.7794C5.1238 16.6496 5.02086 16.4773 4.98505 16.2625C4.94924 16.0521 4.97834 15.8081 5.07233 15.5306L6.43525 11.4822L2.95746 8.99133C2.71576 8.81677 2.54568 8.6355 2.44721 8.44751C2.35322 8.25505 2.34203 8.05587 2.41364 7.84998C2.48078 7.64856 2.60834 7.49862 2.79633 7.40015C2.98432 7.30168 3.22602 7.25468 3.52143 7.25916L7.79145 7.28601L9.08722 3.21069C9.17674 2.92871 9.29759 2.71387 9.44977 2.56616C9.60195 2.41398 9.78323 2.33789 9.9936 2.33789C10.2084 2.33789 10.392 2.41398 10.5441 2.56616C10.6963 2.71387 10.8172 2.92871 10.9067 3.21069L12.2025 7.28601L16.4658 7.25916C16.7656 7.25468 17.0096 7.30168 17.1976 7.40015C17.3856 7.49862 17.5131 7.64856 17.5803 7.84998C17.6519 8.05587 17.6385 8.25505 17.54 8.44751C17.446 8.6355 17.2781 8.81677 17.0364 8.99133L13.5587 11.4822L14.9216 15.5306C15.0156 15.8081 15.0447 16.0521 15.0089 16.2625C14.973 16.4773 14.8701 16.6496 14.7 16.7794C14.5255 16.9092 14.3308 16.9562 14.1159 16.9204C13.9055 16.8846 13.6817 16.7794 13.4445 16.6049L9.9936 14.0737L6.54938 16.6049C6.31216 16.7794 6.08613 16.8846 5.87128 16.9204C5.66091 16.9562 5.46845 16.9092 5.29389 16.7794Z"})}))}},69990:function(e,t,n){n.d(t,{M:()=>ei});var i=n(69277),r=n(70408),a=n(4006),l=n(32485),o=n.n(l),s=n(17402),c=n(45773),d=n(80697),u=n(74919),p=n(72880),h=n(15894),m=n(79796),g=n(25006),f=n(17306),v=n(68410),b=n(76977),y=n(63136),Y=n(4016),_=n(39318),w=n(98949);let C={containerFP:"containerFP-Ndac1V",containerFp:"containerFP-Ndac1V",name:"name-mkZ7O7",imgFP:"imgFP-nsipp_",imgFp:"imgFP-nsipp_",toggleBox:"toggleBox-FyAfgO",selected:"selected-bOtT9y",previewLink:"previewLink-nVh1jb",img:"img-tyGf_Q",container:"container-Yff188",selectableContainer:"selectableContainer-nkPfNo",selectedContainer:"selectedContainer-jizK_g",clickableContainer:"clickableContainer-BH19PC",containerMobile:"containerMobile-MaSyfh",imgMobile:"imgMobile-afxbEf",selector:"selector-x5tcGg",unselected:"unselected-B90yNk",seeLatest:"seeLatest-OQwW6G"},k=e=>{var t,n,i,r,l;let{newsletter:s,hideLink:c=!1,onToggle:d,onClick:p,isTopicAlert:h=!1}=e,f=(0,g.df)(),{metadata:v}=(0,m.i)({pub:f}),{metadata:k}=(0,m.i)({pub:f,pubSetting:"fp_primary_column_section_ids"});p&&d&&console.error("you cannot pass both onToggle and onClick");let F=!!d;if((0,Y.lu)({pub:f}))return(0,a.Y)(S,{newsletter:s,onClick:p,onToggle:d,isTopicAlert:h});if((0,w.Fr)())return(0,a.Y)(I,{newsletter:s,hideLink:c,onClick:p,onToggle:d});let D=null!=(l=null==(t=v[null!=(i=s.sectionId)?i:-1])?void 0:t.frequency)?l:null==(n=k[null!=(r=s.sectionId)?r:-1])?void 0:n.frequency;return(0,a.FD)(b.I1,{className:o()(C.container,{[C.selectedContainer]:F&&s.selected,[C.selectableContainer]:F,[C.clickableContainer]:!!p}),justifyContent:"space-between",radius:"md",padding:16,onClick:F?e=>{e.stopPropagation(),null==d||d({sectionId:s.sectionId,isSelected:!s.selected})}:null!=p?p:void 0,children:[F&&s.selected?(0,a.Y)(u.A,{className:o()(C.selector)}):F?(0,a.Y)("div",{className:o()(C.unselected,C.selector)}):null,(0,a.FD)(b.I1,{gap:24,children:[s.logoUrl&&(0,a.Y)("div",{className:C.img,children:s.logoUrl&&(0,a.Y)("img",{className:C.img,src:(0,_.dJ9)(s.logoUrl,64)})}),(0,a.FD)(b.I1,{gap:8,children:[(0,a.FD)(y.EY.H3,{paddingRight:32*!s.logoUrl,weight:"semibold",color:"pub-primary-text",clamp:2,children:[s.name,D&&(0,a.FD)(a.FK,{children:[(0,a.Y)("br",{}),(0,a.Y)(y.EY.B4,{color:"secondary",weight:"semibold",children:D})]})]}),(0,a.Y)(y.EY.B4,{color:"pub-secondary-text",clamp:4,children:s.description})]})]}),!c&&(0,a.Y)(y.EY,{size:14,weight:"semibold",font:"text",color:"pub-secondary-text",children:(0,a.Y)("a",{onClick:e=>e.stopPropagation(),className:C.seeLatest,href:s.linkUrl,"data-native":!0,children:"See the latest"})})]})},S=e=>{var t,n,l,s,u,y,Y,_,w,k,S;let{newsletter:I,onToggle:F,isTopicAlert:D}=e,{isMobile:T}=(0,v.sM)(),A=(0,g.df)(),{metadata:E,ids:N}=(0,m.i)({pub:A}),{metadata:P,ids:x}=(0,m.i)({pub:A,pubSetting:"fp_primary_column_section_ids"}),L=N.concat(x),{markdownProps:O}=(0,f.$)(I.description);if(!F)return null;let B=L.includes(null!=(u=I.sectionId)?u:-1),M=null!=(_=null==(t=E[null!=(y=I.sectionId)?y:-1])?void 0:t.frequency)?_:null==(n=P[null!=(Y=I.sectionId)?Y:-1])?void 0:n.frequency,R=null!=(S=null==(l=E[null!=(w=I.sectionId)?w:-1])?void 0:l.tagline)?S:null==(s=P[null!=(k=I.sectionId)?k:-1])?void 0:s.tagline;return(0,a.FD)(b.pT,{direction:T?"row":"column",gap:8,className:o()(C.containerFP,{[C.selectedContainerFP]:I.selected}),justifyContent:"space-between",padding:16,paddingRight:T?48:void 0,children:[(0,a.Y)(b.I1,{className:o()(C.toggleBox,{[C.selected]:I.selected}),onClick:()=>{F({sectionId:I.sectionId,isSelected:!I.selected})},children:I.selected?(0,a.Y)(c.A,{stroke:"#FFFFFF",size:20}):(0,a.Y)(d.A,{stroke:"var(--color-fg-primary-themed)",size:20})}),I.logoUrl&&!D&&(0,a.Y)("div",{children:(0,a.Y)(p.o,{src:I.logoUrl,className:C.imgFP,maxWidth:80,imageIsFixedWidth:!0,useRetinaSizing:!0})}),(0,a.FD)(b.I1,{justifyContent:"space-between",style:{height:"100%"},children:[(0,a.FD)(b.I1,{gap:8,children:[(0,a.FD)(h.T,{preset:"h7-sans",className:C.name,children:[I.name,R&&": ".concat(R)]}),(0,a.Y)(h.T,(0,r._)((0,i._)({},O),{preset:"d4-serif",clamp:4}))]}),B&&(0,a.FD)(b.Ye,{gap:8,paddingTop:16,children:[(0,a.Y)(h.T,{className:C.previewLink,as:"a",preset:"caption",color:"accent",onClick:e=>e.stopPropagation(),href:I.linkUrl,"data-native":!0,children:"Preview"}),M&&(0,a.Y)(h.T,{as:"a",preset:"caption",color:"tertiary",onClick:e=>e.stopPropagation(),href:I.linkUrl,"data-native":!0,children:M})]})]})]})},I=e=>{var t,n;let{newsletter:i,hideLink:r,onClick:l,onToggle:s}=e,c=(0,g.df)(),{metadata:d}=(0,m.i)({pub:c}),p=!!s,h=e=>{e.stopPropagation(),null==s||s({sectionId:i.sectionId,isSelected:!i.selected})},f=null==(t=d[null!=(n=i.sectionId)?n:-1])?void 0:t.frequency;return(0,a.FD)(b.I1,{className:o()(C.containerMobile,{[C.selectedContainer]:p&&i.selected,[C.selectableContainer]:p,[C.clickableContainer]:!!h}),justifyContent:"space-between",radius:"md",padding:16,onClick:p?h:null!=l?l:void 0,children:[p&&i.selected?(0,a.Y)(u.A,{className:o()(C.selector)}):p?(0,a.Y)("div",{className:o()(C.unselected,C.selector)}):null,(0,a.FD)(b.I1,{gap:8,children:[(0,a.FD)(b.Ye,{gap:8,children:[i.logoUrl&&(0,a.Y)("img",{className:C.imgMobile,src:(0,_.dJ9)(i.logoUrl,64)}),(0,a.Y)(y.EY.B3,{paddingRight:32,weight:"semibold",color:"primary",font:"text",clamp:2,children:i.name})]}),(0,a.Y)(y.EY.B4,{color:"secondary",clamp:2,font:"text",children:i.description}),f&&(0,a.FD)(y.EY.B4,{color:"secondary",weight:"semibold",children:["Frequency: ",f]})]}),!r&&(0,a.Y)(y.EY,{translated:!0,size:14,weight:"semibold",font:"text",color:"pub-secondary-text",children:(0,a.Y)("a",{href:i.linkUrl,"data-native":!0,children:"See the latest"})})]})};var F=n(84605),D=n(68349);let T=e=>{let{newsletters:t,hideLinks:n,onNewsletterClick:i,justifyItems:r,isTopicAlert:l=!1}=e,{iString:o}=(0,F.GO)(),{isMobile:s}=(0,v.sM)(),c=(0,g.df)();return(0,a.FD)(b.pT,{direction:(0,Y.lu)({pub:c})&&s?"column":"row",className:"container-AE41Ma",wrap:"wrap",justifyContent:r,gap:(0,Y.lu)({pub:c})&&s?16:(0,Y.lu)({pub:c})?40:24,children:[0===t.length&&(0,a.Y)("div",{children:o("No additional newsletters")}),t.map((e,t)=>(0,a.Y)(k,{newsletter:e,hideLink:n,isTopicAlert:l,onToggle:i?e=>{let{sectionId:t,isSelected:n}=e;i({sectionId:t,isSelected:n})}:void 0,onClick:n||(0,Y.lu)({pub:c})?void 0:()=>{(0,D.V2)(e.linkUrl,{local_navigation:!1})}},t))]})};var A=n(13950),E=n(83673),N=n.n(E),P=n(38221),x=n.n(P),L=n(38970),O=n.n(L),B=n(72102),M=n(75107),R=n(41640),U=n(73869);let j={containerFP:"containerFP-07t9zF",containerFp:"containerFP-07t9zF",name:"name-a0Fz9O",sectionName:"sectionName-rkaqT2",imgFP:"imgFP-inDFlQ",imgFp:"imgFP-inDFlQ",toggleBox:"toggleBox-imiF_d",selected:"selected-BzhSfY",previewLink:"previewLink-E_1a9P",img:"img-WX3nAp",container:"container-o46UIK",newsletter:"newsletter-D2dW12",selectableContainer:"selectableContainer-YL_iyh",selectedContainer:"selectedContainer-n52rn6",clickableContainer:"clickableContainer-kN6aXS",containerMobile:"containerMobile-FCXV4L",imgMobile:"imgMobile-yxcTR0",selector:"selector-m97riq",unselected:"unselected-o9ICqY",seeLatest:"seeLatest-RyDQ23"},z=e=>{var t,n,l,s,u,v,y,Y,_,w,C;let{newsletter:k,onToggle:S,isTopicAlert:I}=e,F=(0,g.df)(),{metadata:D,ids:T}=(0,m.i)({pub:F}),{metadata:A,ids:E}=(0,m.i)({pub:F,pubSetting:"fp_primary_column_section_ids"}),N=T.concat(E),{markdownProps:P}=(0,f.$)(k.description);if(!S)return null;let x=N.includes(null!=(u=k.sectionId)?u:-1),L=null!=(Y=null==(t=D[null!=(v=k.sectionId)?v:-1])?void 0:t.frequency)?Y:null==(n=A[null!=(y=k.sectionId)?y:-1])?void 0:n.frequency,O=null!=(C=null==(l=D[null!=(_=k.sectionId)?_:-1])?void 0:l.tagline)?C:null==(s=A[null!=(w=k.sectionId)?w:-1])?void 0:s.tagline;return(0,a.FD)(b.pT,{className:o()(j.containerFP,j.newsletter,{[j.selectedContainerFP]:k.selected}),direction:"row",gap:16,justifyContent:"space-between",padding:16,children:[(0,a.Y)(b.I1,{className:o()(j.toggleBox,{[j.selected]:k.selected}),onClick:()=>{S({sectionId:k.sectionId,isSelected:!k.selected})},children:k.selected?(0,a.Y)(c.A,{size:20,stroke:"#FFFFFF"}):(0,a.Y)(d.A,{size:20,stroke:"var(--color-fg-primary-themed)"})}),(0,a.FD)(b.I1,{flex:"grow",justifyContent:"space-between",minWidth:0,style:{height:"100%"},children:[(0,a.FD)(b.I1,{gap:8,children:[(0,a.FD)(h.T,{className:j.name,preset:"h7-sans",children:[k.name,O&&": ".concat(O)]}),(0,a.Y)(h.T,(0,r._)((0,i._)({},P),{preset:"d4-serif"}))]}),x&&(0,a.FD)(b.Ye,{gap:8,paddingTop:16,children:[(0,a.Y)(h.T,{as:"a",className:j.previewLink,color:"accent","data-native":!0,href:k.linkUrl,preset:"caption",onClick:e=>e.stopPropagation(),children:"Preview"}),L&&(0,a.Y)(h.T,{as:"a",color:"tertiary","data-native":!0,href:k.linkUrl,preset:"caption",onClick:e=>e.stopPropagation(),children:L})]})]}),k.logoUrl&&!I&&(0,a.Y)("div",{children:(0,a.Y)(p.o,{className:j.imgFP,imageIsFixedWidth:!0,maxWidth:80,src:k.logoUrl,useRetinaSizing:!0})})]})},H=e=>{let{isMobile:t,selected:n,id:i,name:r,tagline:l,description:s,onToggle:u}=e;return(0,a.FD)(b.pT,{className:o()(j.containerFP,j.section,{[j.selectedContainerFP]:n}),direction:"row",gap:16,padding:16,paddingBottom:24,paddingLeft:16*!!t,children:[(0,a.Y)(b.I1,{className:o()(j.toggleBox,{[j.selected]:n}),onClick:u,children:n?(0,a.Y)(c.A,{size:20,stroke:"#FFFFFF"}):(0,a.Y)(d.A,{size:20,stroke:"var(--color-fg-primary-themed)"})}),(0,a.FD)(b.I1,{gap:8,children:[(0,a.FD)(h.T,{className:j.sectionName,id:i,preset:"h5-sans",children:[r,l&&": ".concat(l)]}),(0,a.Y)(h.T,{clamp:4,preset:"d4-serif",children:s})]})]})};var W=n(89160),V=n(27428),K=n(77124),q=n(95691),G=n(12501),J=n(36372);let $={container:"container-TdpX8j",menuContainer:"menuContainer-eVgk2K",menu:"menu-QeR7Zf",menuOpen:"menuOpen-Y2LbVM",menuFixed:"menuFixed-aZOMlg",activeDropdown:"activeDropdown-TfhPGt",dropdownItem:"dropdownItem-CUrbuV",activeButton:"activeButton-mA_kLf",sectionItem:"sectionItem-qgeeAr",fullWidth:"fullWidth-MFfT4k",dividerFP:"dividerFP-xuOYlu",dividerFp:"dividerFP-xuOYlu",dividerLight:"dividerLight-El30xh",selectAll:"selectAll-mqDRzw",selectAllWrapper:"selectAllWrapper-NrGWzW",contentColumn:"contentColumn-dSrdJe",sectionContainer:"sectionContainer-TeyA0k"},Z=e=>{var t,n;let{pub:l,user:d,newsletters:u,freeSignupEmail:p,newsletter_management_token:g}=e,{ids:f}=(0,q.P)({pub:l}),{ids:y}=(0,V.M)({pub:l}),{ids:Y}=(0,K.q)({pub:l}),{ids:w}=(0,m.i)({pub:l}),{ids:C}=(0,m.i)({pub:l,pubSetting:"fp_primary_column_section_ids"}),{ids:k}=(0,W.G)({pub:l}),{isMobile:S,isTablet:I,isDesktop:F}=(0,v.sM)(),{popToast:T}=(0,J.d)(),E=O()(l.authorPagesInfo,"primary_section_id"),P=u.filter(e=>{var t,n,i,r;return!f.includes(null!=(t=e.sectionId)?t:-1)&&!Y.includes(null!=(n=e.sectionId)?n:-1)&&!y.includes(null!=(i=e.sectionId)?i:-1)&&!k.includes(null!=(r=e.sectionId)?r:-1)}).map(e=>{var t;let n=e.sectionId?E[e.sectionId]:void 0;return(0,r._)((0,i._)({},e),{linkUrl:n&&null!=(t=(0,_.cxh)({userId:n.user_id,pub:l}))?t:e.linkUrl})}),L=P.filter(e=>{var t;return!C.includes(e.sectionId||-1)&&!w.includes(e.sectionId||-1)&&!k.includes(null!=(t=e.sectionId)?t:-1)}),j=u.filter(e=>{var t,n;return f.includes(null!=(t=e.sectionId)?t:-1)&&!k.includes(null!=(n=e.sectionId)?n:-1)}).map(e=>{var t;let n=e.sectionId?E[e.sectionId]:void 0;return(0,r._)((0,i._)({},e),{linkUrl:n&&null!=(t=(0,_.cxh)({userId:n.user_id,pub:l}))?t:e.linkUrl})}),Z=u.filter(e=>{var t,n;return Y.includes(null!=(t=e.sectionId)?t:-1)&&!k.includes(null!=(n=e.sectionId)?n:-1)}).map(e=>{var t;let n=e.sectionId?E[e.sectionId]:void 0;return(0,r._)((0,i._)({},e),{linkUrl:n&&null!=(t=(0,_.cxh)({userId:n.user_id,pub:l}))?t:e.linkUrl})}),Q=!!d||!!p,[X,ee]=(0,s.useState)(new Set),[et,en]=(0,s.useState)("from-the-free-press"),ei=(0,s.useRef)(null),[er,ea]=(0,s.useState)(!1),[el,eo]=(0,s.useState)(!1),[es,ec]=(0,s.useState)(!1);(0,s.useEffect)(()=>{if("undefined"!=typeof window&&Q){var e;let t=new URL(window.location.href),n=Number(null!=(e=t.searchParams.get("unsubscribed_from"))?e:t.searchParams.get("subscribed_to")),i=[...P,...j,...Z].find(e=>e.sectionId===n);i&&T(()=>(0,a.Y)(J.y,{Icon:c.A,text:t.searchParams.get("unsubscribed_from")?"You will no longer receive emails for ".concat(i.name,"."):"You will start receiving emails for ".concat(i.name,".")}))}},[]);let{result:ed,isLoading:eu}=(0,G.st)({pathname:"/api/v1/subscription",auto:Q,query:{token:g}});(0,s.useEffect)(()=>{!eu&&(null==ed?void 0:ed.email_settings)&&ee(new Set(Object.keys(ed.email_settings).filter(e=>"individual"===ed.email_settings[e]).map(e=>Number(e))))},[eu]);let{refetch:ep}=(0,G.st)({pathname:"/api/v1/subscription/sections/email",auto:!1,method:"PATCH",query:{token:g},deps:[X]}),eh=e=>{Q&&ep({json:[...P,...j,...Z].reduce((t,n)=>(n.sectionId&&(t[n.sectionId]={setting:e.has(n.sectionId)?"individual":"disabled"}),t),{})}).then(()=>{T(()=>(0,a.Y)(J.y,{Icon:c.A,text:"Subscription updated!"}))})},em=O()(P,"sectionId"),eg=N()(w.map(e=>em[e])),ef=N()(C.map(e=>em[e])),ev=eg.some(e=>X.has(e.sectionId||0)),eb=ef.some(e=>X.has(e.sectionId||0)),ey=L.some(e=>X.has(e.sectionId||0)),eY=Z.some(e=>X.has(e.sectionId||0)),e_=j.some(e=>X.has(e.sectionId||0)),ew=e=>{var t;return null==(t=document.getElementById(e))?void 0:t.scrollIntoView({behavior:"smooth"})},eC=(0,s.useMemo)(()=>[{id:"from-the-free-press",name:"From The Free Press",description:"As a subscriber, every week you'll receive:",newsletters:ef,selected:eb,groupKey:"from-thefp"},{id:"featured",name:"Featured",description:"",newsletters:eg,selected:ev,groupKey:"columns"},{id:"topic-alerts",name:"Topic Alerts",description:"Click to select which Free Press stories you'd like delivered directly to your inbox, the moment we publish them:",newsletters:L,selected:ey,groupKey:"topics",isTopicAlert:!0,shouldSort:!0},{id:"podcast-alerts",name:"Podcast Alerts",description:"Get notified when we publish new podcast episodes:",newsletters:Z,selected:eY,groupKey:"podcasts",isTopicAlert:!1,shouldSort:!0},{id:"video-alerts",name:"Video Alerts",description:"Get notified when we publish new videos:",newsletters:j,selected:e_,groupKey:"videos",isTopicAlert:!1,shouldSort:!0}],[ef,eb,eg,ev,L,ey,Z,eY,j,e_]);(0,s.useEffect)(()=>{let e=[];return eC.forEach(t=>{let n=document.getElementById(t.id);if(n){let i=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&en(t.id)})},{rootMargin:"-10% 0px -50% 0px"});i.observe(n),e.push(i)}}),()=>e.forEach(e=>e.disconnect())},[eC]);let ek=(0,s.useCallback)(()=>{if(ei.current){var e,t,n;let i=ei.current.getBoundingClientRect(),r=null==(e=ei.current.parentElement)?void 0:e.getBoundingClientRect(),a=null==(n=ei.current.parentElement)||null==(t=n.parentElement)?void 0:t.getBoundingClientRect();if(i&&r&&a){let e=r.top;!S&&a.bottom<i.height+64?(ea(!1),eo(!0)):e<=64*!S?(eo(!1),ea(!0)):(eo(!1),ea(!1))}}},[S,eo]),eS=(0,s.useMemo)(()=>x()(ek,25,{trailing:!0,leading:!0,maxWait:60}),[ek]);return((0,s.useEffect)(()=>(window.addEventListener("scroll",eS,{passive:!0}),()=>{window.removeEventListener("scroll",eS)}),[eS]),eu&&Q)?(0,a.Y)("div",{style:{minHeight:"var(--full-height)"}}):(0,a.FD)(A.DH,{children:[(0,a.Y)("div",{className:o()("page","typography",$.container,$.large,"the-free-press-theme"),children:(0,a.FD)(b.I1,{children:[(0,a.FD)(b.I1,{gap:8,position:"relative",children:[(0,a.FD)(b.I1,{padding:16,children:[(0,a.Y)(h.T,{preset:"h1-sans",children:"Newsletters"}),(0,a.Y)(h.T,{preset:"d1-sans-regular",children:"We’ll email you when there’s something new from the voices and topics you care about."}),(null==d?void 0:d.is_admin)&&(0,a.Y)(b.Ye,{position:"absolute",style:{top:0,right:0},children:(0,a.Y)(U.m,{pub:l,sectionType:"columns",user:d})})]}),(0,a.Y)("div",{className:$.dividerFP})]}),(0,a.FD)(b.pT,{alignItems:"start",direction:S&&!I?"column":"row",gap:64,justifyContent:"space-between",paddingTop:36*!S,position:"relative",children:[(0,a.Y)("div",{className:o()($.menuContainer),children:(0,a.Y)("div",{ref:ei,className:o()($.menu,er&&$.menuFixed,es&&$.menuOpen),style:el?{top:"auto",bottom:0}:{},children:S&&!I?(0,a.FD)(b.I1,{gap:8,zIndex:1,children:[(0,a.FD)(b.Ye,{className:o()($.activeDropdown,$.dropdownItem),justifyContent:"space-between",onClick:()=>ec(!es),children:[(0,a.Y)(h.T,{preset:"detail-large",children:(null==(t=eC.find(e=>e.id===et))?void 0:t.name)||(null==(n=eC[0])?void 0:n.name)}),es?(0,a.Y)(B.A,{size:24,stroke:"var(--color-accent-themed)"}):(0,a.Y)(M.A,{size:24,stroke:"var(--color-accent-themed)"})]}),es&&(0,a.Y)(b.I1,{paddingBottom:8,children:eC.filter(e=>e.id!==et).map(e=>(0,a.Y)(h.T,{className:$.dropdownItem,preset:"detail-large",onClick:()=>{ew(e.id),ec(!1)},children:e.name},e.id))})]}):(0,a.Y)(b.I1,{alignItems:"start",gap:16,children:eC.map(e=>(0,a.Y)(h.T,{className:o()(et===e.id&&$.activeButton,$.sectionItem),preset:"detail-large",whiteSpace:"nowrap",onClick:()=>ew(e.id),children:e.name},e.id))})})}),(0,a.Y)(b.I1,{className:$.contentColumn,gap:40,padding:16,children:eC.map(e=>{if(!e.newsletters.length)return null;let t=e.newsletters.map(e=>{var t;let n=e.sectionId?l.sections.find(t=>t.id===e.sectionId):void 0,a=null==n||null==(t=n.custom_config)?void 0:t.short_description;return(0,r._)((0,i._)({},e),{description:a||e.description,selected:X.has(e.sectionId||0)})}),n=e.shouldSort?t.sort((e,t)=>e.name<t.name?-1:+(e.name>t.name)):t;return(0,a.FD)(b.I1,{children:[(0,a.Y)(b.I1,{gap:8,children:(0,a.Y)(H,{description:e.description,id:e.id,isMobile:S,name:e.name,selected:e.selected,onToggle:()=>{var t,n;let i,r,a;t=e.groupKey,n=!e.selected,r=("from-thefp"===t?ef:"columns"===t?eg:"topics"===t?L:"podcasts"===t?Z:j).map(e=>e.sectionId||0),a=Array.from(X),eh(i=new Set(n?a.concat(r):a.filter(e=>!r.includes(e)))),ee(i)}})}),!F&&(0,a.Y)("div",{className:$.dividerLight}),(0,a.Y)(b.pT,{className:$.sectionContainer,direction:F?"row":"column",display:F?"grid":"flex",gap:0,wrap:"wrap",children:n.map((t,i)=>(0,a.FD)(s.Fragment,{children:[(0,a.Y)(z,{isTopicAlert:e.isTopicAlert,newsletter:t,onClick:()=>{(0,D.V2)(t.linkUrl,{local_navigation:!1})},onToggle:e=>{let{sectionId:t,isSelected:n}=e;(e=>{let{sectionId:t,isSelected:n}=e;if(!t)return;let i=new Set(X);n?i.add(t):i.delete(t),eh(i),ee(i)})({sectionId:t,isSelected:n})}}),!F&&i<n.length-1&&(0,a.Y)("div",{className:$.dividerLight})]},t.sectionId))})]},e.id)})})]})]})}),!Q&&(0,a.Y)(R.C,{isOpen:X.size>0,pub:l,selectedNewsletters:X,user:d,onSuccess:e=>{(0,D.V2)((0,_.my9)(l,{just_signed_up:!0,autoSubmit:!!e.body.prompt_to_login||void 0,email:e.body.email,skip_sections:!0,next:"/newsletters"}),{replace:!0,local_navigation:!1})}})]})};var Q=n(35369),X=n(16074),ee=n(56458),et=n(92636),en=n(57324);let ei=e=>{let{pub:t,user:n,freeSignupEmail:l,newsletter_management_token:c}=e,d=(0,s.useMemo)(()=>(0,ee.Jh)({pub:t,includeMainPub:!(0,Y.lu)({pub:t}),excludePodcasts:(0,Y.s7)({pub:t})}).map(e=>(0,r._)((0,i._)({},e),{linkUrl:(0,_.oRR)(e.linkUrl,{utm_source:en.VU.newsletterPage}),selected:e.defaultOn})),[t]);return 0===d.length?("undefined"!=typeof window&&(window.location.href=(0,et.$_)(t)),(0,a.Y)("div",{children:"loading..."})):(0,Y.lu)({pub:t})?(0,a.Y)(Z,{newsletter_management_token:c,newsletters:d,pub:t,user:n,freeSignupEmail:l}):(0,a.Y)("div",{className:o()("page","typography","container-moTuSH"),children:(0,a.Y)(A.DH,{children:(0,a.FD)(b.I1,{children:[(0,a.FD)(b.Ye,{justifyContent:"space-between",alignItems:"center",children:[(0,a.FD)(b.I1,{gap:8,paddingBottom:40,paddingTop:48,children:[(0,a.Y)(y.EY.H2,{color:"pub-primary-text",children:"Newsletters"}),(0,a.FD)(y.EY.B3,{color:"pub-secondary-text",children:["Get the best of ",t.name," in your inbox.",(null==n?void 0:n.is_subscribed)?(0,a.FD)(a.FK,{children:[" ","You can manage your subscription in your"," ",(0,a.Y)("a",{className:"accountLink-UwyLNq",href:(0,_.FCy)(t),"data-native":!0,children:"account settings"}),"."]}):""]})]}),(!n||!n.is_subscribed)&&(0,a.Y)(Q.$n,{priority:"primary",href:(0,_.eV6)(t,{addBase:!0,utm_source:en.VU.newsletterPage}),localNavigation:!1,children:"Subscribe"})]}),(0,a.Y)(X.c,{}),(0,a.Y)("div",{className:"newsletterList-TOG54r",children:(0,a.Y)(T,{newsletters:d,hideLinks:!1,justifyItems:"start"})})]})})})}},41935:function(e,t,n){n.d(t,{AS:()=>e2,Bq:()=>eX,Cg:()=>eB,E0:()=>eH,I2:()=>eA,Jj:()=>ej,N9:()=>eN,Ph:()=>eE,Z4:()=>eU,bW:()=>e8,fp:()=>eQ,fz:()=>e5,hy:()=>e7,ib:()=>eW,if:()=>eG,ln:()=>ez,mV:()=>eI,o$:()=>e1,sk:()=>eL,sq:()=>e4,t2:()=>eS,uC:()=>e0,wR:()=>e3,xx:()=>eD});var i=n(69277),r=n(70408),a=n(79785),l=n(4006),o=n(32485),s=n.n(o),c=n(36119),d=n.n(c),u=n(7350),p=n.n(u),h=n(54718),m=n(96758),g=n(18771),f=n(14520),v=n(80827),b=n(57157),y=n(47796),Y=n(72170),_=n(43954),w=n(69308),C=n(17402),k=n(15734),S=n.n(k),I=n(36066),F=n(89333),D=n(27437),T=n(4013),A=n(20297),E=n(89839),N=n(18325),P=n(43427),x=n(14394),L=n(78330),O=n(15074),B=n(58299),M=n(26184),R=n(97683),U=n(33460),j=n(30653),z=n(55136),H=n(50883),W=n(58398),V=n(94794),K=n(84605),q=n(53989),G=n(85478),J=n(98747),$=n(46271),Z=n(6049),Q=n(86500),X=n(94729),ee=n(12501),et=n(31669),en=n(68349),ei=n(98920),er=n(35369),ea=n(76977),el=n(88774),eo=n(16993),es=n(57820),ec=n(63136),ed=n(36372),eu=n(25758);n(5180);var ep=n(83629),eh=n(28916),em=n(11510),eg=n(16291),ef=n(98111),ev=n(56262),eb=n(19601),ey=n(39318),eY=n(49807),e_=n(82776),ew=n(30077),eC=n(57324);function ek(){let e=(0,a._)(["Published on ",""]);return ek=function(){return e},e}function eS(e,t){if("button"===e&&"verbose"===t)return 16;if("button"===e)return 20;if("tabs"===e)return 24;if("compressed"===e)return 14;if("large-on-dark"===e)return 20;return 0}let eI=2,eF=e=>{let{isFullWidth:t,children:n}=e;return t?(0,l.Y)(ea.Ye,{className:"post-ufi-button-wrapper",gap:8,children:n}):n};function eD(e){let{post:t,pub:n,user:i,style:r,justified:a,isStatic:o,hideReactions:c,hideComments:u,hideShare:p,hideSavePost:m,useShareLabel:g,allowEdit:f,editButtonIsLast:v,onChange:b,hidePinning:y,showEmailSent:Y,allowSendEmail:_,footerHidden:w,onCommentsClick:k,labelStyle:S,showPreamble:I,preambleConfig:D={},position:T,hideByDisabling:A,showRestackButton:E,showRestackModal:N,showClipping:P,hideFeedRestackButton:x,onToggleMenu:L,postReactionToken:O,initialShareTimestamp:B}=e,M=(0,J.oY)(),{showPins:R,showAudience:z,showDate:H,showDatetime:W,showAuthor:q,showPublicationName:$,showCrossPostedPublicationName:Z}=D;c=c||!n.community_enabled||!t.slug||t.is_draft;let Q=d()(Object.values((null==t?void 0:t.reactions)||{})),X=Y?!!t.email_sent_at:null,ee=(0,V.aZ)(),{iString:et}=(0,K.GO)(),en=f&&(null==i?void 0:i.is_contributor)&&!ee,ei=eT({post:t,pub:n,user:i,defaultOpen:E&&N&&"post-footer"!==T&&"post-footer-full-width"!==T}),{getConfigFor:ea}=(0,G.mJ)(),eo=(0,em.Iu)(),[es,ec]=(0,C.useState)({isOpen:!1,action:null}),ed=(0,C.useMemo)(()=>{var e;let i=null==(e=t.publishedBylines)?void 0:e[0];return(null==i?void 0:i.name)&&(i.photo_url||n.logo_url)?{author:{id:i.id,name:i.name,photo_url:i.photo_url||null},pub:{subdomain:n.subdomain,name:n.name,logo_url:n.logo_url}}:null},[t.publishedBylines,n.subdomain,n.name,n.logo_url]),eu=!i&&eo&&!o&&!!ed,ep=i&&(0,l.Y)(eZ,{style:r,pub:n,post:t,user:i,hidePinning:y,emailSent:null!=X?X:void 0,allowSendEmail:_,footerHidden:w,canBeCrossPosted:E,onToggleMenu:L}),eh=!x&&n.community_enabled&&t.slug&&!t.is_draft,eg=E&&!I&&(A||c&&u&&p&&!en),ef="counts-or-none"===S&&t.comment_count?"count":"labels"===S?"cta":"none",ev=i&&t.videoUpload&&(0,ew.Z)(i,t,t.videoUpload),eb="post-footer-full-width"===T;return(0,l.FD)("div",{className:s()("post-ufi","style-".concat(r),{justified:a,themed:M,"single-full-width-button":eg,"vertically-stacked":"shows-episode-player"===T}),children:[(0,l.FD)(eF,{isFullWidth:eb,children:[I&&D&&(0,l.Y)(e6,{pub:n,post:t,showPins:R,showAudience:z,showDate:H,showDatetime:W,showEmailSent:Y,showAuthor:q,showPublicationName:$,showCrossPostedPublicationName:Z}),en&&!v&&ep,P&&t.videoUpload&&!ea("disable_clipping_for_readers")&&(0,l.Y)(F.NJ,{post:t,mediaUpload:t.videoUpload,disabled:!ev,style:r,surface:"post"}),(A||!c)&&(0,l.Y)(eP,{post:t,pub:n,user:i,labelStyle:A&&c?"none":"counts-or-none"===S&&Q?"count":"labels"===S?"cta":"none",style:r,onChange:b,isStatic:!!o,isDisabled:A&&c||"shows-episode-player"===T&&!i,postReactionToken:O,onOpenUpsellModal:eu?()=>ec({isOpen:!0,action:"like"}):void 0}),(A||!u)&&(0,l.Y)(eq,{post:t,pub:n,isStatic:o,labelStyle:A&&u?"none":ef,style:r,count:t.comment_count,onClick:k,isDisabled:A&&u,onOpenUpsellModal:eu?()=>ec({isOpen:!0,action:"comment"}):void 0}),eh&&(0,l.Y)(eL,{pub:n,post:t,onChange:b,style:r,onToggleMenu:L,isStatic:o,onOpenUpsellModal:eu?()=>ec({isOpen:!0,action:"restack"}):void 0}),!p&&(0,l.Y)(U.$8,{post:t,pub:n,user:i,trigger:{style:r,labelStyle:g?"cta":"none",isStatic:o},position:T,initialShareTimestamp:B,showClipping:P&&!!t.videoUpload,disableClipping:!ev})]}),(0,l.FD)(eF,{isFullWidth:eb,children:[!m&&!E&&i&&(0,l.Y)(eV,{post:t,labelStyle:ef,position:T,style:r,onChange:b}),en&&v&&ep,E&&!en&&"post-header"===T&&(0,l.Y)(l.FK,{children:(0,l.FD)(el.W1,{trigger:(0,l.Y)(er.K0,{"aria-label":et("View repost options"),priority:"secondary-outline",children:(0,l.Y)(h.A,{size:20})}),children:[i&&(0,l.Y)(e$,{onClick:ei.open,post:t,pub:n,user:i}),(0,l.Y)(eK,{post:t,onChange:b})]})}),E&&!en&&eb&&(0,l.FD)(l.FK,{children:[!m&&(0,l.Y)(eV,{post:t,labelStyle:"verbose",position:T,style:"button",onChange:b}),i&&(0,l.Y)(eJ,{onClick:ei.open,post:t,pub:n,user:i,style:"button"})]})]}),ei.modal,(0,l.Y)(j.M,{isOpen:es.isOpen,setOpen:e=>ec({isOpen:e,action:es.action}),author:null==ed?void 0:ed.author,pub:null==ed?void 0:ed.pub,action:es.action||"like",postId:t.id,postSlug:t.slug})]})}function eT(e){let{pub:t,user:n,post:i,defaultOpen:r=!1}=e,[a,o]=(0,C.useState)(r);return(0,C.useEffect)(()=>{r&&n&&(0,Q.u4)(Q.qY.RESTACK_POST_CLICKED,{restacked_publication_id:t.id,restacked_post_id:i.id,restacking_user_id:n.id,is_from_email:!0})},[r,t,i,n]),{open:()=>o(!0),modal:(0,l.Y)(H.T,{pub:t,user:n,post:i,open:a,setOpen:o}),isOpen:a}}function eA(e){let{post:t,pub:n,user:i,isStatic:r,onChange:a,allowEdit:o,hidePinning:c,showEmailSent:d,allowSendEmail:u,hideComments:h,onCommentsClick:m,showRestackButton:g,showRestackModal:f,setFooterShown:v,postReactionToken:b}=e,y=function(){let e="undefined"==typeof window,[t,n]=(0,C.useState)(e?0:window.pageYOffset),[i,r]=(0,C.useState)(!0),a=(0,C.useMemo)(()=>Date.now()+1e3,[]),l=(0,C.useRef)(0);return(0,C.useEffect)(()=>{let e=p()(()=>{let e=Date.now(),i=(e-l.current)/1e3,o=(t-window.pageYOffset)/i;l.current=e,window.pageYOffset<0||(e<a||-o>100?r(!0):o>100&&r(!1),n(window.pageYOffset))},250);return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[t,n,r,a,l,!0]),i}(),Y=(0,ed.d)(),_=(0,et.V)();return((0,C.useEffect)(()=>{Y.addOffset(64*(y?1:-1)),v&&v(!y)},[y,v]),_)?null:(0,l.Y)(ea.pT,{alignItems:"center",padding:8,className:s()("mobile-footer-ufi",{hidden:y}),children:(0,l.Y)(eD,{post:t,pub:n,user:i,isStatic:r,justified:!0,style:"tabs",onChange:a,allowEdit:o,editButtonIsLast:!0,hidePinning:c,showEmailSent:d,allowSendEmail:u,footerHidden:y,labelStyle:"counts-or-none",hideComments:h,onCommentsClick:m,position:"mobile-toolbar",hideByDisabling:!0,showRestackModal:f,showRestackButton:g,postReactionToken:b})})}function eE(e){let{post:t,user:n,surface:i,onChange:r,postReactionToken:a}=e,l=!!(null==t?void 0:t.reaction),o=(0,V.aZ)(),s=(0,ee.st)({pathname:(0,eY.yRP)(o?"/api/v1/cross-post/".concat(null==t?void 0:t.id,"/reaction"):"/api/v1/post/".concat(null==t?void 0:t.id,"/reaction"),{token:a}),method:"POST",deps:[null==t?void 0:t.id]});return{isLiked:l,toggle:async()=>{var e;if(s.isLoading)return"error";if(!n)return"unauthorized";let{reaction:a,reactions:l,reactor_names:o}=(0,z.Qw)(n,t);t.reaction=null!=a&&a,t.reactions=l,t.reactor_names=null!=o?o:[],null==r||r({post:t});let c=await s.refetch(a?{method:"POST",json:{reaction:"❤",surface:i}}:{method:"DELETE"}),d=null==c||null==(e=c.response)?void 0:e.status;if(d){let{reaction:e,reactions:i,reactor_names:a}=(0,z.Qw)(n,t);t.reaction=null!=e&&e,t.reactions=i,t.reactor_names=null!=a?a:[],null==r||r({post:t})}return 401===d?"unauthorized":d?"error":a?"liked":"unliked"}}}function eN(){return async function(e,t){let{tabId:n,restacking_user_id:i,media_clip_id:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};await (0,X.x6)("/api/v1/post/".concat(e,"/reaction"),t?{method:"POST",json:{reaction:"❤",surface:"reader",tabId:n,restacking_user_id:i,media_clip_id:r}}:{method:"DELETE",json:{tabId:n,media_clip_id:r}})}}function eP(e){let{post:t,pub:n,user:i,style:r,labelStyle:a,onChange:o,isStatic:s,isDisabled:c,postReactionToken:u,onOpenUpsellModal:p}=e,{iString:h}=(0,K.GO)(),m=d()(Object.values((null==t?void 0:t.reactions)||{})),g="count"===a?(0,e_.numberToString)(m||0):"cta"===a?"Like":null;return(0,l.Y)(eU,{post:t,pub:n,user:i,onChange:o,isStatic:s,style:r,postReactionToken:u,onOpenUpsellModal:p,children:e=>{let{isLiked:t,handleLike:n}=e;return(0,l.Y)(eQ,{style:r,state:t?"liked":void 0,icon:(0,l.Y)(P.A,{className:"icon",height:eS(r),strokeWidth:eI}),onClick:c?()=>{}:n,noLabel:"none"===a,isDisabled:c,ariaLabel:h("Like")+("count"===a?" (".concat((0,e_.numberToString)(m||0),")"):""),ariaPressed:t,children:g})}})}function ex(e){let{style:t,onClick:n}=e;return(0,l.Y)(eQ,{style:t,state:void 0,icon:(0,l.Y)(m.A,{className:"icon",height:eS(t),strokeWidth:eI}),"aria-label":"menu",onClick:n})}function eL(e){let{renderTrigger:t,pub:n,post:a,style:o,onToggleMenu:s,onChange:c,isStatic:d,onOpenUpsellModal:u}=e,[p,h]=(0,C.useState)(!1),{iString:m}=(0,K.GO)(),{canRestack:g,isRestacked:f,restacks:v,menuItems:b,nuxModal:y,loggedOutRestackAttempt:Y}=(0,eh.I)({pub:n,post:a,onRestack:e=>{null==c||c({post:(0,r._)((0,i._)({},a),{restacked:e,restacks:v+(e?1:-1)})})},renderWithoutUser:!0});if((0,C.useEffect)(()=>{Y&&h(!0)},[Y]),!g)return null;let _=!n.community_enabled,w=void 0!==u,k=e=>{if((0,Q.u4)(Q.qY.POST_UFI_BUTTON_CLICKED,{type:"restack",post_id:a.id}),w){e.preventDefault(),e.stopPropagation(),u();return}},S=t?t({restacks:v,isRestacked:f,isDisabled:_,onClick:k}):(0,l.Y)(eQ,{style:o,state:f?"restacked":void 0,icon:(0,l.Y)(B.A,{className:"icon",height:eS(o),strokeWidth:eI}),noLabel:0===v,"aria-label":"menu",isDisabled:_,onClick:k,children:v.toLocaleString(void 0,{maximumSignificantDigits:4})});return(0,l.FD)(l.FK,{children:[y,_||w?S:(0,l.Y)(el.W1,{trigger:S,onOpen:()=>{s&&s({active:!0})},onClose:()=>{s&&s({active:!1})},"aria-label":m("View repost options"),children:b}),(0,l.Y)(ei.Z,{displaySignInModal:p,onCloseSignInModal:()=>h(!1),isStatic:!!d,entry:"post-preview-like"})]})}function eO(e){let{postId:t,isOpen:n,onClose:i}=e,r=(0,G.mJ)(),{iString:a}=(0,K.GO)(),[o,s]=(0,C.useState)(),c=!0==r.getConfigFor("enable_post_summarization"),d=(0,C.useRef)(!1),u=(0,C.useCallback)(()=>{d.current=!0,S().post("/api/v1/posts/".concat(t,"/summary")).then(e=>{var t;(null==(t=e.body)?void 0:t.summary)&&s(e.body.summary)}).finally(()=>{d.current=!1})},[t]);return((0,C.useEffect)(()=>{n&&c&&!o&&!d.current&&u()},[n,u,c,o]),c)?(0,l.FD)(eo.aF,{isOpen:n,onClose:i,width:750,children:[(0,l.Y)(eo.rQ,{showClose:!0,title:a("Reader guide"),onClose:i}),(0,l.Y)(ea.I1,{padding:16,paddingBottom:32,children:o?(0,l.Y)("div",{dangerouslySetInnerHTML:{__html:o}}):(0,l.Y)(ea.I1,{alignItems:"center",justifyContent:"center",style:{flex:1,minHeight:300},children:(0,l.Y)("div",{className:"embed-loader"})})})]}):null}let eB=e=>{let{isOpen:t,setIsOpen:n}=e;return(0,C.useEffect)(()=>{let e=setTimeout(()=>{t&&n(!1)},1e4);return()=>clearTimeout(e)},[t]),(0,l.Y)(eo.aF,{isOpen:t,onClose:()=>n(!1),width:300,children:(0,l.FD)(ea.I1,{padding:16,gap:16,children:[(0,l.Y)(ec.EY.H4,{translated:!0,children:"Generating PDF..."}),(0,l.Y)(ea.I1,{alignItems:"center",children:(0,l.Y)(es.y$,{})})]})})};function eM(e){let{post:t,pub:n,user:i,onChange:r,showRestackModal:a,canBeCrossPosted:o,onSummaryOpen:s,onToggleRestackModal:c}=e,{iString:d}=(0,K.GO)(),u="button",p=(0,G.mJ)(),m=!0==p.getConfigFor("enable_post_summarization"),[b,y]=(0,C.useState)(!1),Y=eT({pub:n,user:i,post:t,defaultOpen:a&&o});return(0,C.useEffect)(()=>{null==c||c(Y.isOpen)},[c,Y.isOpen]),(0,l.FD)(l.FK,{children:[(0,l.Y)(eB,{isOpen:b,setIsOpen:y}),(0,l.FD)(el.W1,{trigger:(0,l.Y)(eQ,{style:u,icon:(0,l.Y)(h.A,{className:"icon edit-icon",size:eS(u),strokeWidth:2}),noLabel:!0,"aria-label":d("More")}),children:[i&&(0,l.Y)(eK,{post:t,onChange:r,showIcon:!0}),m&&(0,l.Y)(el.Dr,{leading:(0,l.Y)(g.A,{}),onClick:s,children:d("Reader guide")}),o&&(0,l.Y)(el.Dr,{leading:(0,l.Y)(f.A,{}),onClick:()=>{Y.open(),(0,Q.u4)(Q.qY.RESTACK_POST_CLICKED,{restacked_publication_id:n.id,restacked_post_id:t.id,restacking_user_id:i.id,is_from_email:!1})},children:d("Cross post")}),p.getConfigFor("show_open_post_as_pdf_button")&&(0,l.Y)(el.Dr,{leading:(0,l.Y)(v.A,{}),onClick:()=>{y(!0),(0,en.V2)((0,eY.MGs)(n,t.id),{local_navigation:!1})},children:d("Open as PDF")})]}),Y.modal]})}function eR(e){var t;let n=d()(Object.values((null==(t=e.post)?void 0:t.reactions)||{}));return(0,l.Y)(eP,(0,r._)((0,i._)({},e),{labelStyle:n>0?"count":"none"}))}function eU(e){let{post:t,pub:n,user:i,onChange:r,isStatic:a,children:o,style:c,postReactionToken:d,onOpenUpsellModal:u}=e,[p,h]=(0,C.useState)(!1),{isLiked:m,toggle:g}=eE({post:t,user:i,onChange:r,postReactionToken:d}),[f,v]=(0,C.useState)(!1),b=(0,C.useCallback)(async e=>{var n;if(null==e||null==(n=e.stopPropagation)||n.call(e),(0,Q.u4)(Q.qY.POST_UFI_BUTTON_CLICKED,{type:"like",post_id:t.id}),void 0!==u){u(),null==e||e.preventDefault();return}"unauthorized"===await g()&&v(!0)},[g,u,t.id]);return(0,l.FD)("div",{className:s()("like-button-container","post-ufi-button","style-".concat(c),m&&"state-liked"),children:[o({isLiked:m,handleLike:b}),(0,l.Y)(ei.Z,{isStatic:a,displaySignInModal:f,onCloseSignInModal:()=>v(!1),entry:"post-preview-restack"}),!a&&(0,l.Y)(W.Z,{isOpen:p,medium:"web",pub:n,user:i,post:t,onClose:()=>h(!1)})]})}function ej(e){var t;let{post:n,defaultSaved:i,isSaved:r,trackSurface:a}=e;return ez({postId:n.id,defaultSaved:null!=(t=null!=i?i:n.is_saved)&&t,isSaved:r,trackSurface:a})}function ez(e){let{postId:t,defaultSaved:n,isSaved:i,trackSurface:r}=e,[a,l]=(0,C.useState)(n),o=null!=i?i:a,{refetch:s}=(0,ee.st)({pathname:"/api/v1/posts/saved",method:"POST",json:{post_id:t,surface:r},deps:[t]}),c=eW();return{isSaved:o,onSave:()=>(s({method:o?"DELETE":"POST"}),l(!o),c(!o),!o)}}async function eH(e,t,n){let{surface:i}=n;await (0,X.x6)("/api/v1/posts/saved",{method:t?"POST":"DELETE",json:{post_id:e}}),(0,Q.u4)(Q.qY.POST_SAVED,{post_id:e,surface:i,is_saved:t})}function eW(){let e=(0,ed.d)(),{iString:t}=(0,K.GO)();return n=>{n?e.popToast(()=>(0,l.Y)(ed.y,{text:t("Post saved"),Icon:b.A,cta:t("View now"),href:(0,ey.c8C)()})):e.popToast(()=>(0,l.Y)(ed.y,{text:t("Post unsaved"),Icon:y.A}))}}function eV(e){let{style:t,post:n,isSaved:a,labelStyle:o,position:s,onChange:c}=e,{isSaved:d,onSave:u}=ej({defaultSaved:a,post:n,isSaved:n.is_saved,trackSurface:s}),{iString:p}=(0,K.GO)();return(0,l.Y)(eQ,{state:d?"saved":void 0,style:t,icon:(0,l.Y)(E.A,{className:"icon",height:eS(t,"verbose"===o?"verbose":null),strokeWidth:eI}),noLabel:"none"===o,verboseLabel:"verbose"===o,onClick:()=>{let e=u();null==c||c({post:(0,r._)((0,i._)({},n),{is_saved:e})})},ariaPressed:d,ariaLabel:p("Save"),children:"cta"===o||"verbose"===o?p("Save"):null})}function eK(e){let{post:t,isSaved:n,onChange:a,showIcon:o}=e,{onSave:s}=ej({defaultSaved:n,post:t,isSaved:t.is_saved}),{iString:c}=(0,K.GO)(),d=t.is_saved?"var(--color-accent-fg-orange)":void 0;return(0,l.Y)(el.Dr,{leading:o?(0,l.Y)(b.A,{style:{stroke:d,fill:d}}):void 0,onClick:()=>{let e=s();null==a||a({post:(0,r._)((0,i._)({},t),{is_saved:e})})},children:c(t.is_saved?"Unsave":"Save")})}function eq(e){let t,{style:n,count:r,labelStyle:a,post:o,pub:s,isStatic:c,onClick:d,isDisabled:u,onOpenUpsellModal:p}=e,{iString:h}=(0,K.GO)(),m=(0,em.Iu)(),g=(0,$.Jd)(),f=(null!=r?r:0)>0,v=void 0!==p&&!g&&m;return t=(null==o?void 0:o.comment_url_override)?o.comment_url_override:c?"".concat(ef.T.HALF_MAGIC_COMMENTS_URL,"&utm_source=").concat(eC.VU.substack,"&utm_medium=").concat(eC.Jn.email):!m||(null==g?void 0:g.is_contributor)?(0,ey.wu9)(s,o,{comments:!0}):(0,ey.XV8)(s.subdomain,o.slug,{params:(0,i._)({comments:!0,utm_source:eC.VU.post,utm_medium:eC.Jn.web},v&&f&&{show_app_upsell:"comment"})}),(0,l.FD)(eQ,{style:n,icon:(0,l.Y)(N.A,{className:"icon",height:eS(n),strokeWidth:eI}),href:u?void 0:t,onClick:u?()=>{}:e=>{if((0,Q.u4)(Q.qY.POST_UFI_BUTTON_CLICKED,{type:"comment",post_id:o.id}),v&&!f){p(),e.preventDefault();return}d?d(e):(null==e||e.preventDefault(),window.location.href=t)},noLabel:"none"===a,className:"post-ufi-comment-button",isDisabled:u,ariaLabel:h("cta"===a?"Comment":"View comments"+" (".concat((0,e_.numberToString)(r||0),")")),children:["cta"===a&&h("Comment"),"count"===a&&(0,e_.numberToString)(r||0)]})}function eG(e){let t,{post:n,user:i,pub:r,style:a,labelStyle:o,isStatic:c,onChange:d,position:u}=e,[p,h]=(0,C.useState)(!1),m=(0,C.useCallback)(()=>{(0,Q.u4)(Q.qY.POST_SHARE_BUTTON_CLICKED,{position:u,post_id:n.id}),h(!0)},[]),{iString:g}=(0,K.GO)();t=n.share_url_override?n.share_url_override:c?n?ef.T.SHARE_URL:ef.T.SHARE_PUB_URL:"javascript:void(0)";let f="none"===o;return(0,l.FD)(l.FK,{children:[(0,l.Y)(eQ,{style:a,icon:f?(0,l.Y)(Y.A,{className:"icon",height:eS(a),strokeWidth:eI}):null,onClick:m,href:t,noLabel:"none"===o,className:s()(!f&&"no-icon"),children:"cta"===o&&g("Share")}),!c&&(0,l.Y)(W.Z,{isOpen:p,medium:"web",pub:r,user:i,post:n,onChange:d,onClose:()=>h(!1)})]})}function eJ(e){let{post:t,user:n,pub:i,onClick:r,style:a}=e,{iString:o}=(0,K.GO)();return(0,l.Y)(l.FK,{children:(0,l.Y)(eQ,{style:a,icon:(0,l.Y)(x.A,{className:"icon",height:eS(a,"verbose"),strokeWidth:eI}),onClick:()=>{(0,Q.u4)(Q.qY.RESTACK_POST_CLICKED,{restacked_publication_id:i.id,restacked_post_id:t.id,restacking_user_id:n.id,is_from_email:!1}),r()},noLabel:!1,verboseLabel:!0,title:o("Cross-Post"),children:o("Cross-post")})})}function e$(e){let{post:t,user:n,pub:i,onClick:r}=e,{iString:a}=(0,K.GO)();return(0,l.Y)(l.FK,{children:(0,l.Y)(el.Dr,{onClick:()=>{(0,Q.u4)(Q.qY.RESTACK_POST_CLICKED,{restacked_publication_id:i.id,restacked_post_id:t.id,restacking_user_id:n.id,is_from_email:!1}),r()},children:a("Cross-post")})})}function eZ(e){let{style:t,pub:n,post:i,user:r,hidePinning:a,emailSent:o,allowSendEmail:c,footerHidden:d,showRestackModal:u,canBeCrossPosted:p,onSummaryOpen:m,onToggleMenu:g,onToggleRestackModal:f}=e,v=eT({post:i,pub:n,user:r,defaultOpen:u&&p});(0,C.useEffect)(()=>{null==f||f(v.isOpen)},[f,v.isOpen]);let b=(0,l.Y)(eQ,{style:t,icon:(0,l.Y)(h.A,{className:"icon edit-icon",size:eS(t),strokeWidth:2}),noLabel:!0});return(0,l.FD)("div",{className:s()("edit-button-container","post-ufi-button","style-".concat(t)),children:[(0,l.Y)(R.D,{trigger:b,pub:n,post:i,user:r,hidePinning:a,emailSent:o,allowSendEmail:c,handleCrossPost:p?()=>{v.open(),(0,Q.u4)(Q.qY.RESTACK_POST_CLICKED,{restacked_publication_id:n.id,restacked_post_id:i.id,restacking_user_id:r.id,is_from_email:!1})}:void 0,onSummaryOpen:m,onToggleMenu:g,disabled:d}),v.modal]})}let eQ=(0,C.forwardRef)((e,t)=>{let{icon:n,children:i,state:r,style:a,onClick:o,href:c,noLabel:d,verboseLabel:u,noBorder:p,className:h,isDisabled:m,iconPosition:g="left",title:f,ariaLabel:v,ariaPressed:b}=e;return(0,l.FD)(er.Nm,{className:s()("post-ufi-button","style-".concat(a),h,r?"state-".concat(r):void 0,m?"state-disabled":void 0,i&&!d?"has-label":"no-label",p?"no-border":"with-border",u?"verbose-label":""),title:f,href:c,onClick:e=>{o&&(e.stopPropagation(),o(e))},ref:t,"aria-label":null!=v?v:f,"aria-pressed":b,children:["left"===g&&n,!d&&i&&(0,l.Y)("div",{className:"label",children:i}),"right"===g&&n]})}),eX=e=>{let{pub:t,post:n,showAuthor:i}=e;return!!(i&&t.bylines_enabled&&(0,e_.getPrintedByline)(t,n))},e0=e=>{let{pub:t,post:n,showAuthor:i,showPhoto:r,isMobileWidth:a}=e;return eX({pub:t,post:n,showAuthor:i})&&!e1({pub:t,post:n,showAuthor:i})&&!e2({pub:t,post:n,showAuthor:i,showPhoto:r})&&!a},e1=e=>{let{pub:t,post:n,showAuthor:i}=e;return eX({pub:t,post:n,showAuthor:i})&&(0,e_.getBylineUsers)(n).length>1},e2=e=>{var t;let{pub:n,post:i,showAuthor:r,showPhoto:a}=e;return!!(eX({pub:n,post:i,showAuthor:r})&&a&&(null==(t=(0,e_.getBylineUsers)(i)[0])?void 0:t.photo_url)&&n.byline_images_enabled)};function e4(e){let{post:t,showDatetime:n,isStatic:i,fromPostPage:r,showReactions:a,language:l="en"}=e,o=t.reactions?Object.values(t.reactions).reduce((e,t)=>e+t,0):0,s=r&&!i&&a&&o>=70&&o<100;return n&&s?(0,eg.A)(t.post_date).locale(l).standardDatetimeWithYear():n&&!s?(0,eg.A)(t.post_date).locale(l).standardDatetime():i?(0,eg.A)(t.post_date).locale(l).standardDate():s?(0,eg.A)(t.post_date).locale(l).standardDate({full:s}):(0,eg.A)(t.post_date).locale(l).standardDateOrTime()}function e6(e){let{pub:t,post:n,showPins:i,showAudience:r,showDate:a,showDatetime:o,showEmailSent:c,showAuthor:d,showPublicationName:u,showCrossPostedPublicationName:p}=e,h=(0,J.oY)(),m=!!(d&&t.bylines_enabled&&(0,e_.getPrintedByline)(t,n)),g=a&&n.post_date&&!n.is_draft,f=c?!!n.email_sent_at:null,{iString:v,iTemplate:b,language:y}=(0,K.GO)();return(0,l.FD)("div",{className:s()("ufi-preamble",{themed:h}),children:[p&&n.restacked_pub_name?(0,l.Y)("div",{className:"ufi-preamble-label cross-posted-pub-name",children:b(ek(),n.restacked_pub_name)}):null,c&&f&&(0,l.Y)("div",{className:"email-sent",title:v("This post was sent as an email"),children:(0,l.Y)(_.A,{className:"post-ufi-preamble-icon",size:16})}),i&&n.is_section_pinned&&(0,l.Y)("div",{className:"pinned",children:(0,l.Y)(M.A,{className:"post-ufi-preamble-icon"})}),"adhoc_email"===n.type?(0,l.Y)("div",{className:"audience-adhoc",children:(0,l.Y)(T.A,{className:"post-ufi-preamble-icon"})}):r&&(0,ev.isPaidAudience)(n.audience)&&(0,l.Y)("div",{className:"audience-lock",children:(0,l.Y)(I.A,{audience:n.audience,className:"lock-icon post-ufi-preamble-icon",size:16})}),e0({pub:t,post:n,showAuthor:m,isMobileWidth:!1})&&(0,l.Y)("div",{className:"ufi-preamble-label author",children:(0,e_.getBylineUsers)(n).length>0?(0,e_.oxfordComma)((0,e_.getBylineUsers)(n).map(e=>(0,l.Y)(l.FK,{children:(0,l.Y)(D.ProfileHoverCard,{subject:e,utmSource:"byline",trigger:(0,l.Y)("a",{href:(0,eY.gYq)(e,{noBase:ep.Z}),onClick:e=>e.stopPropagation(),children:e.name})})}))):(0,e_.getPrintedByline)(t,n)}),u&&(0,l.Y)("div",{className:"post-publication-name",children:t.name}),g&&(0,l.Y)("div",{className:"ufi-preamble-label post-date",title:(0,eg.A)(n.post_date).toISOString(),children:(0,l.Y)("time",{dateTime:(0,eg.A)(n.post_date).toISOString(),children:e4({post:n,showDatetime:o,language:y})})})]})}let e3=e=>{let{pub:t,post:n,user:i,onChange:r,postReactionToken:a,onOpenUpsellModal:o}=e;return(0,G.mJ)().getConfigFor("like_posts_enabled")&&t.community_enabled?(0,l.Y)(eR,{style:"button",post:n,pub:t,user:i,onChange:r,postReactionToken:a,onOpenUpsellModal:o}):null},e7=e=>{let{pub:t,post:n,onClick:i,onOpenUpsellModal:r}=e,a=(0,e_.showCommentsOnPost)({publication:t,post:n}),{comment_count:o}=n;return a?(0,l.Y)(eq,{post:n,pub:t,labelStyle:o>0?"count":"none",style:"button",count:o,onClick:i,onOpenUpsellModal:r}):null};function e8(e){let{hideBottomBorder:t,post:n,pub:i,user:r,onChange:a,onCommentsClick:o,showRestackModal:s=!1,showTranscriptionButton:c,onTranscriptionClick:d,postReactionToken:u,onToggleRestackModal:p,onTranscriptClick:h,position:m}=e,{iString:g}=(0,K.GO)(),f=(0,V.aZ)(),v=(0,G.mJ)(),b=(0,em.Iu)(),[y,Y]=(0,C.useState)({isOpen:!1,action:null}),_=(0,C.useMemo)(()=>{var e;let t=null==(e=n.publishedBylines)?void 0:e[0];return(null==t?void 0:t.name)&&(t.photo_url||i.logo_url)?{author:{id:t.id,name:t.name,photo_url:t.photo_url||null},pub:{subdomain:i.subdomain,name:i.name,logo_url:i.logo_url}}:null},[n.publishedBylines,i.subdomain,i.name,i.logo_url]),k=!r&&b&&!!_,S=(null==r?void 0:r.is_contributor)&&!f,{getSettingFor:I}=(0,q.Pu)(),F=!n.is_draft&&(0,eb.A)(r,{enable_restacking:!!I("enable_restacking")},n,i,!1),[D,T]=(0,C.useState)(!1),[A,E]=(0,C.useState)(!1),N=v.getConfigFor("enable_press_kit_preview_modal"),P=r&&n.videoUpload&&(0,ew.Z)(r,n,n.videoUpload),[x,L]=(0,C.useState)(!1);return(0,l.FD)(ea.pT,{className:"post-ufi",alignItems:"center",borderTop:"detail-themed",borderBottom:t?void 0:"detail-themed",justifyContent:"space-between",gap:16,flex:"grow",paddingY:16,children:[(0,l.FD)(ea.pT,{gap:8,children:[(0,l.Y)(e3,{post:n,pub:i,user:r,onChange:a,postReactionToken:u,onOpenUpsellModal:k?()=>Y({isOpen:!0,action:"like"}):void 0}),(0,l.Y)(e7,{pub:i,post:n,onClick:o,onOpenUpsellModal:k?()=>Y({isOpen:!0,action:"comment"}):void 0}),(0,l.Y)(eL,{pub:i,post:n,onChange:a,style:"button",onOpenUpsellModal:k?()=>Y({isOpen:!0,action:"restack"}):void 0}),c&&(0,l.Y)(ex,{style:"button",onClick:d})]}),(0,l.FD)(ea.pT,{gap:8,children:[N&&(0,l.Y)(er.$n,{priority:"secondary-outline",onClick:()=>E(!0),children:g("Assets")}),(0,l.FD)(l.FK,{children:[(0,l.Y)(eQ,{style:"button",onClick:()=>{L(!0)},children:g("Share")}),(0,l.Y)(W.Z,{isOpen:x,onClose:()=>L(!1),utm_campaign:"post-expanded-share",user:r,post:n,pub:i,position:m,clippingAllowed:!!P})]}),h&&(0,l.Y)(eQ,{onClick:h,style:"button",icon:(0,l.Y)(w.A,{stroke:"var(--color-fg-secondary-themed)",size:16}),children:g("Transcript")}),S?(0,l.Y)(eZ,{style:"button",pub:i,post:n,user:r,showRestackModal:s,canBeCrossPosted:F,onSummaryOpen:()=>T(!0),onToggleRestackModal:p}):(r||F)&&(0,l.Y)(eM,{post:n,pub:i,user:r,onChange:a,showRestackModal:s,canBeCrossPosted:F,onSummaryOpen:()=>T(!0),onToggleRestackModal:p})]}),(0,l.Y)(eO,{postId:n.id,isOpen:D,onClose:()=>T(!1)}),N&&(0,l.Y)(eu.r,{isOpen:A,onClose:()=>E(!1),post:n}),(0,l.Y)(j.M,{isOpen:y.isOpen,setOpen:e=>Y({isOpen:e,action:y.action}),author:null==_?void 0:_.author,pub:null==_?void 0:_.pub,action:y.action||"like",postId:n.id,postSlug:n.slug})]})}function e5(e){let{isFooter:t,readInAppText:n,customization:{showAppUpsell:a,showShare:o,showComments:c,showReactions:d,showListen:u,showSave:p,showRestack:h,showCommentRestack:m}}=e,g=!t&&(h||u||p),{iString:f}=(0,K.GO)(),v=null!=n?n:f("READ IN APP");return t||o||c||d||u||p||!h?(0,l.FD)(Z.h2,{className:t?"email-ufi-2-bottom":"email-ufi-2-top",width:"100%",children:[h&&t&&(0,l.FD)(l.FK,{children:[(0,l.Y)(e9,{}),(0,l.Y)("tr",{children:(0,l.Y)("td",{children:(0,l.FD)(Z.h2,{width:"100%",className:"email-ufi-2-row",children:[(0,l.Y)("tr",{children:(0,l.Y)("td",{width:"95%",children:o&&(0,l.FD)(Z.tR,{tableClassName:"email-button-outline-wrapper-full-width",aClassName:"email-button-outline full-width",href:ef.T.SHARE_URL,children:[(0,l.Y)(L.A,(0,i._)({},te)),(0,l.Y)("span",{className:"email-button-text",children:f("Share")})]})})}),(0,l.Y)(e9,{})]})})})]}),(0,l.Y)(e9,{}),(0,l.Y)("tr",{children:(0,l.Y)("td",{children:(0,l.Y)(Z.h2,{width:"100%",children:(0,l.FD)("tr",{children:[(0,l.Y)("td",{children:(0,l.FD)(Z.ZB,{gap:8,style:g?void 0:{margin:"0 auto"},children:[d?t?(0,l.FD)(Z.tR,{aClassName:"email-button-outline",href:ef.T.REACTION_URL,children:[(0,l.Y)(P.A,(0,i._)({},te)),(0,l.Y)("span",{className:"email-button-text",children:f("Like")})]}):(0,l.Y)(tt,{href:ef.T.REACTION_URL,children:(0,l.Y)(P.A,(0,i._)({},te))}):null,c?t?(0,l.FD)(Z.tR,{aClassName:"email-button-outline",href:"".concat(ef.T.HALF_MAGIC_COMMENTS_URL,"&utm_source=").concat(eC.VU.substack,"&utm_medium=").concat(eC.Jn.email),children:[(0,l.Y)(N.A,(0,i._)({},te)),(0,l.Y)("span",{className:"email-button-text",children:f("Comment")})]}):(0,l.Y)(tt,{href:"".concat(ef.T.HALF_MAGIC_COMMENTS_URL,"&utm_source=").concat(eC.VU.substack,"&utm_medium=").concat(eC.Jn.email),children:(0,l.Y)(N.A,(0,i._)({},te))}):null,o&&a&&(t?(0,l.FD)(Z.tR,{aClassName:"email-button-outline",href:ef.T.SHARE_URL,children:[(0,l.Y)(O.A,(0,i._)({},te)),(0,l.Y)("span",{className:"email-button-text",children:f("Share")})]}):(0,l.Y)(tt,{href:ef.T.SHARE_URL,children:(0,l.Y)(O.A,(0,i._)({},te))})),m&&(t?(0,l.FD)(Z.tR,{aClassName:"email-button-outline",href:"".concat(ef.T.RESTACK_COMMENT_URL,"&utm_source=").concat(eC.VU.substack,"&utm_medium=").concat(eC.Jn.email),children:[(0,l.Y)(B.A,(0,i._)({},te)),(0,l.Y)("span",{className:"email-button-text",children:f("Restack")})]}):(0,l.Y)(tt,{href:"".concat(ef.T.RESTACK_COMMENT_URL,"&utm_source=").concat(eC.VU.substack,"&utm_medium=").concat(eC.Jn.email),children:(0,l.Y)(B.A,(0,i._)({},te))}))]})}),(0,l.Y)("td",{align:"right",children:(0,l.FD)(Z.ZB,{gap:8,children:[o&&!a&&!t&&(0,l.FD)(Z.tR,{aClassName:"email-button-outline",href:ef.T.SHARE_URL,children:[(0,l.Y)("div",{className:"email-button-spacer"}),(0,l.Y)("span",{className:"email-button-text",children:f("Share")})]}),a&&!t&&(0,l.FD)(Z.tR,{aClassName:"email-button-outline",href:"".concat(ef.T.POST_APP_LINK_URL,"&utm_campaign=email-read-in-app"),children:[(0,l.Y)("div",{className:"email-button-spacer"}),(0,l.Y)("span",{className:"email-button-text",style:{marginRight:4},children:v}),(0,l.Y)(A.A,(0,r._)((0,i._)({},te),{className:s()("icon","text-icon")}))]})]})})]})})})}),(0,l.Y)(e9,{})]}):(0,l.Y)(Z.h2,{className:"email-ufi-2-empty",width:"100%",children:(0,l.Y)("tr",{height:1,children:(0,l.Y)("td",{height:1,style:{fontSize:0,lineHeight:0},children:"\xa0"})})})}function e9(){return(0,l.Y)("tr",{height:16,children:(0,l.Y)("td",{height:16,style:{fontSize:0,lineHeight:0},children:"\xa0"})})}let te={className:"icon",height:18,strokeWidth:1,isStatic:!0,stroke:"#808080",fill:"none"};function tt(e){let{size:t=38,href:n,children:i}=e;return(0,l.Y)(Z.h2,{width:t,children:(0,l.Y)("tr",{children:(0,l.Y)("td",{align:"center",children:(0,l.Y)("a",{className:"email-icon-button",href:n,style:{width:t},children:i})})})})}},55136:function(e,t,n){n.d(t,{LZ:()=>x,Qw:()=>D,cy:()=>P,wx:()=>F,xu:()=>E});var i=n(99851),r=n(69277),a=n(4006),l=n(32485),o=n.n(l),s=n(36119),c=n.n(s),d=n(17402),u=n(15734),p=n.n(u),h=n(97432),m=n(43427),g=n(84605),f=n(70145),v=n(34835),b=n(86500),y=n(68349),Y=n(76977),_=n(16993),w=n(81203),C=n(63136),k=n(98111),S=n(39318),I=n(82776);let F=(e,t,n)=>{let{reaction:i,reactions:r,reactor_names:a}=T(e,t,n);A(t,i,r,a)},D=(e,t)=>T(e,t,!t.reaction),T=(e,t,n)=>{let i="reaction"in t?t.reaction:void 0,{reactions:a={"❤":0},reactor_names:l=[]}=t;if(a=(0,r._)({},a),l=[...l],n&&!i){let t=a[i="❤"];a[i]=t?t+1:1,e&&e.is_public_admin&&l.push(e.name||"author")}else!n&&i&&(a["❤"]=a["❤"]?a["❤"]-1:0,e&&e.is_public_admin&&(l=l.filter(t=>t!==(e.name||"author"))),i=null);return{reaction:i,reactions:a,reactor_names:l}},A=(e,t,n,i)=>{e.reaction=t,e.reactions=n,e.reactor_names=i};function E(e,t,n,i){let r=(0,S.yRP)("/api/v1/".concat(t?"comment":"post","/").concat(e.id,"/reaction"),{token:i});return n?p().post(r).send({reaction:"❤"}):p().delete(r)}class N extends d.Component{notifyParent(e){let{reaction:t,reactions:n,reactor_names:i}=e,a=(0,r._)({},this.props.post),l=this.props.comment&&(0,r._)({},this.props.comment);A(l||a,t,n,i),this.props.onChange&&this.props.onChange({post:a,comment:l})}reactionRejected(e){(0,b.u4)(b.qY.REACTION_REJECTED,{comment_id:this.props.comment&&this.props.comment.id,post_id:this.props.post&&this.props.post.id,reason:"Not logged in",unreact:!e}),this.setState({includeModal:!0,modalOpen:!0})}render(){let e,{className:t,user:n,pub:i,comment:r,height:l,isStatic:s,post:d,buttonStyle:u,hideReactionCount:p,countInParenthesesStyle:h,iString:g}=this.props,f=r||d,v=null==f?void 0:f.reaction,b=(null==f?void 0:f.reactions)||{},y=c()(Object.values(b));return e=d&&d.reaction_url_override?d.reaction_url_override:s?k.T.REACTION_URL:"javascript:void(0)",(0,a.FD)(C.EY,{as:"span",decoration:"hover-underline",color:v?"error":"pub-secondary-text",className:t,children:[this.props.render?this.props.render({liked:v,numReactions:y>0?(0,I.numberToString)(y):null,onClick:e=>{this.react(e)}}):(0,a.Y)("a",{href:e,className:o()("like-button",{button:u,"post-meta-button":u,liked:v}),onClick:e=>this.react(e),children:(0,a.FD)(Y.pT,{gap:6,alignItems:"center",className:t,children:[s?(0,a.Y)(m.A,{ampProps:{layout:"fixed"},isStatic:!0,height:l,stroke:"var(--color-fg-secondary-themed)",fill:"transparent"}):(0,a.FD)(Y.pT,{className:"reaction-container",children:[(0,a.Y)(m.A,{className:"animation"}),!v&&(0,a.Y)(m.A,{strokeWidth:2,height:l,fill:"transparent",stroke:"var(--color-fg-secondary-themed)"}),v&&(0,a.Y)(m.A,{height:l,strokeWidth:2})]}),h?(0,a.FD)(C.EY.Meta,{color:v?"error":"pub-secondary-text",className:"like-count",children:[g(v?"Liked":"Like"),!p&&y>0?" (".concat((0,I.numberToString)(y),")"):""]}):!p&&y>0?(0,a.Y)("span",{className:"like-count",children:(0,I.numberToString)(y)}):u?(0,a.Y)("span",{className:"like-count",children:g("Like")}):null]})}),!s&&this.state.includeModal&&(0,a.Y)(x,{isOpen:this.state.modalOpen,user:n,pub:i,comment:r,react:this.react,onClose:()=>this.setState({modalOpen:!1})})]})}constructor(...e){super(...e),(0,i._)(this,"state",{includeModal:!1,modalOpen:!1}),(0,i._)(this,"react",async e=>{if(this.props.commentActionsOverride){null==e||e.preventDefault(),null==e||e.stopPropagation(),this.props.commentActionsOverride();return}if(this.props.isStatic)return;e&&(e.preventDefault(),e.stopPropagation());let t=this.props.comment||this.props.post;if(!t)return void console.warn("LikeButton: no subject");let n=!t.reaction;if(this.props.onReactedChange&&this.props.onReactedChange(n),this.props.noSelfUpdate)return;let i=await (0,y.vL)(this,"locked",async(e,t)=>{let i,r=t.comment||t.post;if(!r)return void console.warn("LikeButton: no subject");let a=E(r,!!t.comment,n,t.token);t.oauthAccessToken&&a.set("Authorization","Bearer ".concat(t.oauthAccessToken));let{reaction:l,reactions:o,reactor_names:s}=D(t.user,r);this.notifyParent({reactions:o,reaction:l,reactor_names:s});try{await a}catch(e){i=e,this.notifyParent(r)}return{error:i,reaction:l}});return i&&i.error&&(i.error.response&&401===i.error.response.statusCode?await this.reactionRejected(i.reaction):alert((0,y.uX)(i.error))),!!i&&!i.error})}}let P=(0,g.wr)((0,f.ct)(N));function x(e){let{comment:t,pub:n,user:i,isOpen:r,onClose:l,react:o}=e,{iString:s}=(0,g.GO)();return(0,a.FD)(_.aF,{isOpen:r,onClose:l,children:[(0,a.Y)(_.rQ,{title:s(t?"Subscribe to like this comment":"Subscribe to like this post"),alignItems:"center",showClose:!0,onClose:l,icon:(0,a.Y)(w.Nq,{pub:n,size:48})}),(0,a.Y)(_.cw,{children:(0,a.Y)(h.A,{user:i,pub:n,showLogin:!0,showTerms:!0,source:"like_button",onSuccess:async e=>{let t=e&&e.body&&e.body.email;e&&e.body&&e.body.prompt_to_login||!await o()?window.location.href=(0,S.a7q)({for_pub:n.subdomain,email:t}):((0,v.E)({freeSignup:!0,freeSignupEmail:t}),l())}})})]})}},15667:function(e,t,n){n.d(t,{H:()=>k,w:()=>C});var i=n(79785),r=n(4006),a=n(37946),l=n(44471),o=n(17402),s=n(84605),c=n(68349),d=n(35369),u=n(76977),p=n(16993),h=n(19832),m=n(84843),g=n(94996),f=n(63136),v=n(11587),b=n(36372),y=n(74588);function Y(){let e=(0,i._)(["Report to the "," admins"]);return Y=function(){return e},e}function _(){let e=(0,i._)(["Your report and profile will be shared with the admins of ","."]);return _=function(){return e},e}let w=["hate","private_information","plagiarism","impersonation","illegal_activity","spam","pornography","other"],C=["impersonation","spam","pornography","other"];function k(e){var t,n;let{isOpen:i,pub:C,onClose:k,onSubmit:I=()=>Promise.resolve(),canReportToAdmins:F=!1,reasons:D=w}=e,[T,A]=(0,o.useState)(null),{iString:E,iTemplate:N,language:P}=(0,s.GO)(),[x,L]=(0,o.useState)(null),[O,B]=(0,o.useState)(!1),[M,R]=(0,o.useState)(!1),[U,j]=(0,o.useState)(!F),{popToast:z}=(0,b.d)();if((0,o.useEffect)(()=>{i&&j(!F)},[i,F,D]),(0,o.useEffect)(()=>{U?R(!!T):R(!!x)},[U,T,x,D]),F&&!C)return console.error("Must supply pub if reporting to pub admins is possible"),null;let H=U?E("Report to Substack"):N(Y(),null!=(t=null==C?void 0:C.name)?t:"");return(0,r.FD)(r.FK,{children:[(0,r.FD)(p.aF,{isOpen:i,onClose:k,disableCloseOnBackdropClick:O||U,children:[(0,r.Y)(p.rQ,{title:H,icon:(0,r.Y)(m.qx,{bg:"accent-red",icon:(0,r.Y)(a.A,{stroke:"var(--color-semantic-error-fg-primary)"})}),description:(0,r.Y)(S,{reportingToSubstack:U,pub:null!=C?C:null,onReportToSubstackClicked:()=>{j(!0)}}),showClose:!0,onClose:k}),(0,r.Y)(p.cw,{children:(0,r.FD)(u.I1,{gap:20,children:[U&&(0,r.Y)(r.FK,{children:(0,r.FD)(u.I1,{gap:8,children:[(0,r.Y)(f.EY.B4,{weight:"bold",translated:!0,children:"Reason"}),(0,r.FD)(g.I,{value:null!=T?T:void 0,onChange:e=>{A(e.target.value)},children:[(0,r.Y)(g.K,{children:E("Select a reason")}),D.map(e=>(0,r.Y)("option",{value:e,children:(e=>{let{category:t,language:n="en"}=e;return(0,y.j)({category:t,language:n})})({category:e,language:P})},e))]})]})}),(0,r.FD)(u.I1,{gap:8,children:[(0,r.FD)(u.Ye,{justifyContent:"space-between",children:[U?(0,r.Y)(f.EY.B4,{weight:"bold",translated:!0,children:"Additional details"}):(0,r.Y)(f.EY.B4,{weight:"bold",translated:!0,children:"Reason"}),U&&(0,r.Y)(f.EY.B4,{color:"secondary",translated:!0,children:"Optional"})]}),(0,r.Y)(v.T,{onChange:e=>{L(e.currentTarget.value||null)},placeholder:E("Describe why you're reporting this...")})]})]})}),(0,r.Y)(p.jl,{alignButtons:"stretch",primaryButton:(0,r.Y)(d.$n,{disabled:!M,priority:"destructive",onClick:()=>{B(!0)},children:E("Submit")})})]}),(0,r.Y)(h.m,{isOpen:O,onClose:()=>{B(!1)},title:E("Submit report?"),description:U?E("Reported content will be reviewed and removed if it violates our Content Guidelines."):N(_(),null!=(n=null==C?void 0:C.name)?n:"this publication"),primaryButton:(0,r.Y)(d.$n,{priority:"destructive",onClick:async()=>{B(!1);try{await I({reportCategory:U?T:null,details:x,reportedToSubstack:U})}catch(n){console.error("could not submit report",n);let e=(0,c.uX)(n),t=e&&e.startsWith("Something went wrong")?e:"Something went wrong: ".concat(e);z(()=>(0,r.Y)(b.y,{text:t}));return}z(()=>(0,r.Y)(b.y,{text:"Your report was submitted",Icon:l.A}))},children:E("Submit report")}),secondaryButton:(0,r.Y)(d.$n,{priority:"secondary",onClick:()=>{B(!1)},children:E("Cancel")})})]})}function S(e){var t;let{reportingToSubstack:n,pub:i,onReportToSubstackClicked:a}=e;return n?(0,r.FD)(f.EY,{translated:!0,children:["Report content that violates Substack's"," ",(0,r.Y)(f.Yq,{color:"highlight",href:"https://substack.com/content",target:"_blank",rel:"noreferrer",children:"Content Guidelines"})," ","below. Your report is only viewed by our staff. Find additional reporting options and information in our"," ",(0,r.Y)(f.Yq,{color:"highlight",href:"https://support.substack.com/hc/en-us/articles/23248646000532",target:"_blank",rel:"noreferrer",children:"Standards and Enforcement Help Center"}),"."]}):(0,r.FD)(f.EY,{translated:!0,children:[(0,r.FD)(f.EY.B3,{color:"secondary",translated:!0,children:["Your report and profile will be shared with the admins of ",(0,r.Y)("strong",{children:I18N.p(null!=(t=null==i?void 0:i.name)?t:"")}),", since at Substack we believe publication owners are best able to moderate their communities."]}),(0,r.FD)(f.EY.B3,{translated:!0,color:"secondary",children:["If you believe something violates Substack's"," ",(0,r.Y)(f.Yq,{color:"highlight",href:"https://substack.com/content",target:"_blank",rel:"noreferrer",children:"Content Guidelines"}),", you can"," ",(0,r.Y)(f.Yq,{color:"highlight",onClick:()=>{a()},children:"report it to Substack"})," ","instead."]})]})}},82011:function(e,t,n){n.d(t,{L:()=>u});var i=n(79785),r=n(4006),a=n(73062),l=n(32600),o=n(84605),s=n(36372);function c(){let e=(0,i._)(["You'll no longer be notified when this author publishes."]);return c=function(){return e},e}function d(){let e=(0,i._)(["You'll be notified by email whenever this author publishes."]);return d=function(){return e},e}let u=e=>{let{authorId:t,minimize:n,className:i}=e,{popToast:u}=(0,s.d)(),{iTemplate:p}=(0,o.GO)(),{isSubscribedToAuthor:h,toggleSubscription:m}=(0,l.C)(t);return(0,r.Y)(a.i,{className:i,isSubscribed:h,minimize:n,onClick:async e=>{e.preventDefault(),e.stopPropagation(),await m(),u(()=>(0,r.Y)(s.y,{text:h?p(c()):p(d())}))}})}},20410:function(e,t,n){n.d(t,{$:()=>_});var i=n(4006),r=n(43954),a=n(45773),l=n(49436),o=n(17402),s=n(38685),c=n(72880),d=n(82528),u=n(63446),p=n(15894),h=n(32600),m=n(84605),g=n(2058),f=n(60355),v=n(97778),b=n(16074),y=n(76977),Y=n(82776);let _=e=>{var t,n,_,w,C,k,S;let{author_id_or_slug:I,authorInfo:F,posts:D,pub:T,user:A,utm:E}=e,{authorInfo:N,posts:P}=(0,v.Y)({author_id_or_slug:I,authorInfoPreload:F,postsPreload:D,pub:T}),{isSubscribedToAuthor:x,toggleSubscription:L,hasSection:O}=(0,h.C)(null!=(t=null==N?void 0:N.user_id)?t:0),{iString:B}=(0,m.GO)(),M=null!=(n=null==N?void 0:N.name)?n:"",R=null!=(_=null==N?void 0:N.bio)?_:"",U=null!=(w=null==N?void 0:N.photo_url)?w:null,j=null!=(C=null==N?void 0:N.twitter_screen_name)?C:"",z=null!=(S=null!=(k=null==N?void 0:N.email_for_display)?k:null==N?void 0:N.email)?S:"",H=(0,Y.isDefaultMarblePhoto)(U)?void 0:U;return(0,i.Y)(d.y,{belowDescription:(0,i.FD)(y.I1,{gap:16,children:[z&&(0,i.FD)(y.Ye,{alignItems:"center",gap:8,children:[(0,i.Y)(r.A,{size:16}),(0,i.Y)(p.T,{preset:"body-link",children:(0,i.Y)("a",{href:"mailto:".concat(z),children:z})})]}),j&&(0,i.FD)(y.Ye,{alignItems:"center",gap:8,children:[(0,i.Y)(s.A,{size:16}),(0,i.Y)(p.T,{preset:"body-link",children:(0,i.Y)("a",{href:"https://x.com/".concat(j),children:j})})]}),O&&(0,i.FD)(o.Fragment,{children:[(0,i.Y)(b.c,{paddingY:8}),(0,i.FD)(y.I1,{alignItems:"start",gap:16,children:[(0,i.Y)(u.v,{size:"sm",variant:"outline",onClick:L,children:x?(0,i.FD)(y.Ye,{alignItems:"center",gap:8,children:[B("Notified")," ",(0,i.Y)(a.A,{size:16})]}):(0,i.FD)(y.Ye,{alignItems:"center",gap:8,children:[B("Get Notified")," ",(0,i.Y)(l.A,{size:16})]})}),(0,i.Y)(p.T,{preset:"detail-small",children:B(x?"You'll be notified by email whenever this author publishes.":"Get notified by email whenever this author publishes.")})]})]})]}),bodyWrapperVariant:"two-middle-columns",description:null!=R?R:void 0,image:H?(0,i.Y)(c.o,{maxWidth:400,src:H,style:{maxWidth:"100%"}}):void 0,isLoading:!N,title:M,children:N&&P&&(0,i.Y)(g.M,{authorId:N.user_id,hideCommunity:!0,isPodcast:!1,newPosts:P,pub:T,renderLoading:()=>null,user:A,utm:E,children:e=>{let{posts:t}=e;return(0,i.Y)(y.I1,{gap:24,children:t.map((e,t)=>(0,i.FD)(i.FK,{children:[0!==t&&(0,i.Y)(b.c,{}),(0,i.Y)(f.R,{post:e,variant:"archive"})]}))})}})})}},19449:function(e,t,n){n.d(t,{r:()=>y,e:()=>b});var i=n(4006),r=n(84934),a=n(83628),l=n(37494),o=n(72880),s=n(82528),c=n(1842),d=n(90847),u=n(84605),p=n(68410),h=n(35369),m=n(92636),g=n(39891),f=n(18947);let v="image-sYkLIi",b={careers:{slug:"careers",title:(0,i.FD)("span",{children:["Join ",(0,i.Y)("em",{children:"The Free Press"})]}),description:(0,i.FD)("span",{children:[(0,i.Y)("em",{children:"The Free Press"})," is seeking exceptional people who share our values."]})},about:{slug:"about",title:(0,i.FD)("span",{children:["About",(0,i.Y)("br",{}),(0,i.Y)("em",{children:"The Free Press"})]}),description:"A new media company built on the ideals that were once the bedrock of American journalism."},"the-free-press-book-club":{slug:"the-free-press-book-club",title:"The Free Press Book Club",description:"Each month, one Free Press writer sits down with the author of a new, vital book. We’ve read and discussed novels, essay collections, political criticism, and more. Book club attendees get a copy of the book, an opportunity to ask questions, and to meet other Free Pressers.",image:(0,i.Y)(o.o,{alt:"The Free Press Book Club",className:v,maxWidth:540,src:(0,g.dJ)("".concat((0,m.Ew)(),"/img/thefp/fp-book-club-cover.jpg"))})},america250:{slug:"america250",title:"The Free Press Presents: America at 250",description:"\nTwo and a half centuries later, we still hold these truths to be self-evident.\n\nJoin us for a yearlong celebration of America’s 250th birthday: where we’ve come from, where we are, and where we’re going. Expect big events, small gatherings, performances, podcasts, videos, and essays from your favorite _Free Press_ contributors, and many others. Find out about all of it here, first.",image:(0,i.Y)(o.o,{alt:"America at 250",className:v,maxWidth:540,src:(0,g.dJ)("".concat((0,m.Ew)(),"/img/thefp/america250Final.png"))}),socialImage:(0,g.dJ)("".concat((0,m.Ew)(),"/img/thefp/america250SocialFinal.png"))},"community-guidelines":{slug:"community-guidelines",title:"Community Guidelines",description:""},"privacy-notice":{slug:"privacy-notice",title:"Privacy Notice",description:""},"upcoming-events":{slug:"upcoming-events",title:"Upcoming Events",description:""},faq:{slug:"faq",title:"Frequently Asked Questions",description:""}},y=e=>{var t,n,o;let{pub:m,post:g,user:v,type:y,html:Y,isAboutPage:_}=e,w=b[y],{isMobile:C}=(0,p.sM)(),{iString:k}=(0,u.GO)(),S=!!((null==v?void 0:v.is_contributor)&&(null==g?void 0:g.id)&&(null==g?void 0:g.type)==="page"),I=(0,a.Rv)(Y,"h1, h2, h3"),F="string"==typeof(null==w?void 0:w.title)?w.title:(null==g?void 0:g.title)||"";return(0,i.Y)(s.y,{aboveTitle:S&&(null==g?void 0:g.id)?(0,i.Y)(h.$n,{href:(0,f.I_)(m,g.id,{params:{back:document.location.href}}),leading:(0,i.Y)(r.A,{size:20}),localNavigation:!1,priority:"secondary",children:k("Edit")}):null,description:(null==w?void 0:w.description)||"",image:null==w?void 0:w.image,metadata:{image:null!=(t=null==w?void 0:w.socialImage)?t:void 0,twitterImage:null!=(n=null==w?void 0:w.socialImage)?n:void 0},title:(null==w?void 0:w.title)||(null==g?void 0:g.title)||"",children:(0,i.FD)("div",{className:"typography post",children:[I&&(0,i.Y)(c._,{postId:null==g?void 0:g.id,showComments:!1,title:F,toc:I,wordCount:null!=(o=null==g?void 0:g.wordcount)?o:0}),(0,i.Y)("div",{className:C?"":"container",children:(0,i.Y)(d.Z,{isCustomPage:!0,children:(0,i.Y)(l.A,{html:Y,isAboutPage:_,post:g,pub:m,user:v})})})]})})}},20905:function(e,t,n){n.d(t,{X:()=>T});var i=n(4006),r=n(17402),a=n(79909),l=n(13950),o=n(38486),s=n(44815),c=n(32485),d=n.n(c),u=n(76977);let p=e=>{let{imageUrl:t,children:n,textAlign:r="left",useFixedAspectRatio:a=!1}=e;return(0,i.Y)("div",{className:"background-XIOFVG",children:(0,i.FD)("div",{className:"container-MxDuwa",children:[(0,i.Y)("img",{alt:"Events",className:d()("headerImage-mfhwbd",a?"headerImageAspect-T8HgTk":null),src:t}),(0,i.Y)(u.I1,{alignItems:"center"===r?"center":"start",className:"content-bcrzex",justifyContent:"center",position:"relative",textAlign:r,children:n})]})})};var h=n(22884),m=n(57898),g=n(53696),f=n(19449),v=n(15894),b=n(27428),y=n(25006),Y=n(44333),_=n(68410),w=n(28528),C=n(16291),k=n(39862),S=n(41086),I=n(49807),F=n(52050);let D=e=>{let{event:t,pub:n,user:r,post:a}=e,l=t?(0,o.dN)(t.location):null;return t?(0,i.FD)(i.FK,{children:[(0,i.Y)(v.T,{color:"white",preset:"h2-serif",children:t.title}),(0,i.Y)(v.T,{color:"white",preset:"d1-sans-regular",children:t.dateTime&&"".concat((0,C.A)(t.dateTime).format("MMMM D, YYYY")," ").concat((0,C.A)(t.dateTime).format("h:mma"))}),(0,i.FD)(v.T,{color:"white",preset:"d1-sans-regular",children:[l," at ",t.place]}),(0,i.Y)(m.z,{event:t,isHeader:!0,post:a,pub:n,surface:"fp-events",user:r})]}):null},T=e=>{var t;let{pub:n,user:c,fpEventsData:d}=e,{initialSections:m}=(0,b.M)({pub:n}),{url:C}=(0,Y.zy)(),{isMobile:T}=(0,_.sM)(),A=!!(null==c?void 0:c.is_admin)&&!C.includes("hideAdmin"),[E,N]=(0,r.useState)((0,S.y)("event_id")||void 0),[P,x]=(0,r.useState)((0,S.y)("series")||void 0),{result:L,refetch:O}=(0,o.ZJ)(),B=(null==L?void 0:L.configs)||[],{result:M}=(0,o.uL)(E),R=null==M||null==(t=M.config)?void 0:t.value,U=e=>{x(void 0),N(e);let t=e?"?event_id=".concat(e):"";window.history.pushState(null,"","/events".concat(t))},{title:j,description:z}=f.e["the-free-press-book-club"],H={id:"the-free-press-book-club",title:j.toString(),imageUrl:"".concat((0,I.Ewe)(),"/img/thefp/fp-book-club-cover.jpg"),description:z.toString(),url:"/p/the-free-press-book-club"},{title:W,description:V}=f.e.america250,K=[{id:"the-free-press-presents-america-at-250",title:W.toString(),imageUrl:"".concat((0,I.Ewe)(),"/img/thefp/america250Final.png"),description:V.toString(),url:"/america250"},...m.map(e=>({id:e.slug,title:e.name,imageUrl:e.logo_url||"",description:e.description,url:(0,I.Dor)(n,{section:e})})),H],q=P?K.find(e=>e.title===k.n[P]):void 0;return(0,i.Y)(y.Eo,{pub:n,children:(0,i.Y)(w.XL,{pub:n,children:(0,i.FD)(l.DH,{children:[(null==d?void 0:d.socialPreviewImage)&&(0,i.Y)(a.Metadata,{image:(0,I.dJ9)(null==d?void 0:d.socialPreviewImage,800,{crop:"crop",height:800}),pub:n}),E&&R?(0,i.FD)("div",{children:[(0,i.Y)(p,{imageUrl:null==R?void 0:R.image,textAlign:"center",children:(0,i.Y)(D,{event:R,post:null,pub:n,user:null!=c?c:null})}),(0,i.Y)(g.r,{children:(0,i.Y)(u.I1,{paddingBottom:32,paddingTop:40,children:(0,i.Y)(s.s,{eventId:E,goToEvent:U,post:null,pub:n,surface:"fp-events",user:null!=c?c:null})})})]}):P?(0,i.FD)("div",{children:[(0,i.FD)(p,{imageUrl:(null==q?void 0:q.imageUrl)||(0,I.dJ9)("".concat((0,I.Ewe)(),"/img/thefp/events.jpg")),textAlign:"center",children:[(0,i.Y)(v.T,{color:"white",preset:"h2-serif",children:k.n[P]}),(0,i.Y)(u.Ye,{paddingBottom:40,children:(0,i.Y)(v.T,{color:"white",preset:"body",children:null==q?void 0:q.description})})]}),(0,i.Y)(g.r,{children:(0,i.Y)(u.I1,{alignSelf:"center",className:F.A.eventsContainer,maxWidth:T?480:void 0,paddingBottom:32,paddingTop:40,children:(0,i.Y)(h.y,{allEvents:B.filter(e=>e.value.series===P),goToEvent:U,isAdmin:A,post:null,pub:n,refetchEvents:O,showBackToEvents:!0,showSeries:!1,user:null!=c?c:null})})})]}):(0,i.FD)("div",{children:[(0,i.FD)(p,{imageUrl:(0,I.dJ9)("".concat((0,I.Ewe)(),"/img/thefp/events.jpg")),useFixedAspectRatio:!0,children:[(0,i.Y)(u.Ye,{alignItems:"center",width:"100%",children:(0,i.Y)(v.T,{align:T?"center":"left",color:"white",preset:"h2-serif",children:T?"The Free Press Events":"Events"})}),(0,i.FD)(u.I1,{gap:24,paddingBottom:40,children:[(0,i.Y)(v.T,{color:"white",preset:"d1-sans-regular",children:"We believe ideas are meant to be tested—debated, challenged, and sometimes turned on their head. Open dialogue isn’t a luxury; it’s essential to a healthy democracy. And the best way to have it is live and in person."}),(0,i.FD)(v.T,{color:"white",preset:"d1-sans-regular",children:["We bring together the most fascinating thinkers, writers, and provocateurs—and the readers who make it all possible. Whether it’s a high-stakes debate, a live taping of ",(0,i.Y)("em",{children:"Honestly"}),", or an election-night gathering, every ",(0,i.Y)("em",{children:"Free Press"})," event has one thing in common: the people. Curious, independent-minded, and fiercely civil, ",(0,i.Y)("em",{children:"Free Pressers"})," come ready to think hard—and have a good time doing it."]})]})]}),(0,i.Y)(g.r,{children:(0,i.Y)(u.I1,{alignSelf:"center",className:F.A.eventsContainer,maxWidth:T?480:void 0,paddingBottom:32,paddingTop:40,children:(0,i.Y)(h.y,{allEvents:B,goToEvent:U,goToSeries:e=>{N(void 0),x(e);let t=e?"?series=".concat(e):"";window.history.pushState(null,"","/events".concat(t))},isAdmin:A,post:null,pub:n,refetchEvents:O,seriesConfig:K,showSeries:!0,user:null!=c?c:null})})})]})]})})})}},77238:function(e,t,n){n.d(t,{B:()=>o});var i=n(4006),r=n(82528),a=n(73090),l=n(2058);let o=e=>{let{pub:t,user:n,newPostsForArchive:o,metadata:s,utm:c}=e;return(0,i.Y)(r.y,{bodyWrapperVariant:"two-middle-columns",metadata:s,title:"Latest",children:(0,i.Y)(l.M,{hideCommunity:!0,hideTop:!0,newPosts:null==o?void 0:o.pub,pub:t,renderLoading:()=>null,source:"archive",user:n,utm:c,children:e=>{let{posts:t}=e;return(0,i.Y)(a.R,{posts:t})}})})}},17450:function(e,t,n){n.d(t,{y:()=>ek});var i=n(69277),r=n(70408),a=n(79785),l=n(4006),o=n(97213),s=n(17402),c=n(15734),d=n.n(c),u=n(23623),p=n(79909),h=n(13950),m=n(48697),g=n(77849),f=n(63446),v=n(72102),b=n(13482),y=n(15894),Y=n(85042),_=n(68410),w=n(76977);let C=e=>{let{isMinimized:t,liveStream:n,onMaximizeChat:i}=e,{isMobile:r,isMobileLandscape:a}=(0,_.sM)(),o=(0,s.useRef)(null),{message:c,setMessage:d,loading:u,sendMessage:p}=(0,Y.M)({inputRef:o,liveStream:n}),h=async()=>{await p(),t&&i()},m=async e=>{"Enter"===e.key&&await h()},g=n.liveStreamInformation.chatAuthInfo.canSendChat;return(0,l.FD)(w.I1,{flex:"grow",children:[t&&(0,l.FD)(w.Ye,{alignItems:"center",borderBottom:"detail",borderTop:r?"detail":void 0,cursor:"pointer",justifyContent:"space-between",paddingX:24,paddingY:16,onClick:i,children:[(0,l.Y)(y.T,{preset:"d1-sans-medium",children:"Live Chat"}),(0,l.Y)(v.A,{})]}),(0,l.Y)(w.I1,{flex:r||a?void 0:"grow",paddingX:24,paddingY:r||a?24:t?16:24,children:(0,l.Y)(b.w,{ref:o,disabled:!g||u,flex:"grow",liveStream:n,placeholder:g?"Write message...":n.liveStreamInformation.chatAuthInfo.errorMessage,rows:r||a||t?1:3,style:{flexGrow:1},value:c,onChange:e=>{d(e.currentTarget.value)},onKeyDown:m,onSend:h})})]})};var k=n(75107),S=n(83804);let I=e=>{let{headerHeight:t,liveStream:n,onMinimizeChat:i}=e;return(0,l.FD)(w.I1,{flex:"grow",children:[(0,l.FD)(w.Ye,{alignItems:"center",borderBottom:"detail",cursor:"pointer",justifyContent:"space-between",paddingX:24,paddingY:t?void 0:16,style:t?{height:t}:void 0,onClick:i,children:[(0,l.Y)(y.T,{preset:"d1-sans-medium",children:"Live Chat"}),(0,l.Y)(k.A,{})]}),(0,l.Y)(w.I1,{flex:"grow",position:"relative",children:(0,l.Y)(S.lC,{liveStream:n})})]})};var F=n(3160),D=n(13589),T=n(80703),A=n(16008),E=n(66511),N=n(49807),P=n(57324);let x=e=>{let{liveStream:t,pub:n,viewerCount:a,concurrentViewerCount:o}=e,[c,d]=(0,D.Mk)(),[u,p]=(0,s.useState)(!1),{isMobile:h}=(0,_.sM)(),m=(0,l.FD)(w.I1,{gap:8,children:[(0,l.Y)(y.T,{clamp:1,preset:"h5-serif",children:t.liveStream.title}),t.liveStream.description&&(0,l.Y)(y.T,{clamp:2,preset:"d3-serif",children:t.liveStream.description})]}),g="Total: ".concat(a,"\nCurrent: ").concat(o),f=(0,l.FD)(w.Ye,{alignItems:"center",gap:8,children:[(0,l.Y)("div",{className:"liveTag-MsSGA4",children:(0,l.Y)(y.T,{preset:"detail-large",children:"Live"})}),(0,l.Y)(E.m_,{delayEnter:100,disabled:h,text:g,children:(0,l.FD)(w.Ye,{alignItems:"center",className:"viewerCount-R1kN0i",cursor:"pointer",gap:8,onClick:()=>{h&&p(!u)},children:[(0,l.Y)(F.A,{}),(0,l.Y)(y.T,{preset:"detail-small",children:a})]})})]}),v=(0,l.Y)(A.X,{shareName:t.liveStream.title,shareUrl:(0,N.QMq)({pub:n,utm_source:P.VU.liveStreamShareButton}),trackParams:{live_stream_id:t.liveStream.id},trigger:(0,l.Y)(w.Ye,(0,r._)((0,i._)({},d),{alignItems:"center",cursor:"pointer",children:(0,l.Y)(T.A,{height:24,isHovered:c,width:24})})),utmCampaign:P._9.liveStreamPermalink});return h?(0,l.FD)(w.I1,{gap:24,paddingX:28,paddingY:16,children:[(0,l.FD)(w.Ye,{alignItems:"center",gap:8,justifyContent:"space-between",children:[f,v]}),m]}):(0,l.FD)(w.Ye,{alignItems:"start",gap:24,justifyContent:"space-between",paddingX:24,paddingY:24,children:[m,(0,l.FD)(w.Ye,{alignItems:"center",gap:24,children:[f,v]})]})},L=e=>{let{user:t,subscribeUrl:n}=e;return(0,l.FD)(w.I1,{gap:40,children:[(0,l.FD)(w.I1,{alignItems:"center",gap:8,children:[(0,l.Y)(y.T,{align:"center",preset:"h4-sans-condensed",children:"Stream Ended"}),(0,l.Y)(y.T,{align:"center",preset:"d1-sans-regular",children:(null==t?void 0:t.is_subscribed)?"Thanks for watching!":"".concat((null==t?void 0:t.is_free_subscribed)?"Upgrade":"Subscribe"," to watch the next live stream")})]}),(0,l.FD)(w.I1,{alignItems:"stretch",alignSelf:"stretch",gap:8,children:[(null==t?void 0:t.is_subscribed)?(0,l.Y)(f.v,{href:"/videos",variant:"outline",children:"Watch More"}):(0,l.Y)(f.v,{href:n,native:!0,variant:"primary-accent",children:(null==t?void 0:t.is_free_subscribed)?"Upgrade":"Subscribe"}),(0,l.Y)(f.v,{href:"/",variant:"tertiary",children:"Back to Homepage"})]})]})};var O=n(75999),B=n(35369);let M=e=>{let{closeHref:t,height:n,user:i,subscribeUrl:r}=e,{isMobile:a,isMobileLandscape:o}=(0,_.sM)();return(0,l.FD)(w.Ye,{alignItems:"center",borderBottom:"detail",className:"container-j8poGw",justifyContent:"space-between",paddingLeft:24,paddingRight:16,paddingY:n?void 0:a?12:16,style:n?{height:n}:void 0,children:[(0,l.Y)(O.u,{forceMobile:a||o,height:56}),(0,l.FD)(w.Ye,{alignItems:"center",gap:16,children:[!(null==i?void 0:i.is_subscribed)&&(0,l.Y)(f.v,{"data-native":!0,href:r,size:o?"sm":a?"md":"lg",trailingIcon:"plus",variant:"primary-accent",children:(null==i?void 0:i.is_free_subscribed)?"Upgrade":"Subscribe"}),(0,l.Y)(B.K0,{href:t,priority:"quaternary",children:(0,l.Y)(m.A,{})})]})]})};var R=n(45773),U=n(84605),j=n(68349),z=n(24078),H=n(17028),W=n(16993),V=n(36372),K=n(16884),q=n(39318);function G(){let e=(0,a._)(["Subscribed to ",""]);return G=function(){return e},e}let J=e=>{let{liveStream:t,guests:n,subscriptions:i,setSubscriptions:r,isHostsModalOpen:a,setIsHostsModalOpen:o,user:s}=e,{iString:c}=(0,U.GO)();return(0,l.FD)(W.aF,{isOpen:a,onClose:()=>o(!1),children:[(0,l.Y)(W.rQ,{showClose:!0,showDivider:!0,title:c(n.length?"Hosts":"Host"),onClose:()=>o(!1)}),(0,l.Y)(W.cw,{children:(0,l.Y)(H.I1,{gap:20,children:[t,...n.map(e=>e)].map(e=>{var t,n;let{user:a,pub:o}=e,c=["free_signup","subscribed"].includes(null!=(n=null==(t=i.filter(e=>e.publication_id===(null==o?void 0:o.id)).map(e=>e.membership_state))?void 0:t[0])?n:"unsubscribed");return(0,l.Y)($,{isSubscribed:c,pub:o,setSubscriptions:r,streamingUser:a,subscriptions:i,user:s})})})})]})},$=e=>{var t,n;let{streamingUser:a,pub:o,isSubscribed:c,subscriptions:d,setSubscriptions:u,user:p}=e,{iString:h,iTemplate:m}=(0,U.GO)(),{popToast:g}=(0,V.d)(),[v,b]=(0,s.useState)([]);return(0,l.FD)(H.Ye,{alignItems:"center",gap:12,children:[(0,l.Y)(z.dm,{linkProps:{target:"_blank"},size:40,user:a,utmSource:P.VU.liveStreamHostModal}),(0,l.FD)(H.I1,{flex:"grow",children:[(0,l.Y)(Z,{streamingUser:a}),(0,l.Y)(Q,{pub:o})]}),o?(0,l.Y)(f.v,{disabled:c||v.includes(o.id)||["free_signup","subscribed"].includes(null!=(n=null==(t=d.find(e=>e.publication_id===o.id))?void 0:t.membership_state)?n:"unsubscribed"),size:"sm",variant:"primary-accent",onClick:async()=>{if(!p){window.location.href=(0,q.my9)(o,{utm_source:P.VU.liveStreamHostModal,next:document.location.href,utm_medium:P.Jn.web});return}b(e=>[...e,o.id]);try{let e=await (0,K.yc)(o.id,P.VU.liveStreamHostModal,{publication:o,user:p,openPubInNewTabAfterSubscription:!1});if(!e.didAction){e.errorMessage&&g(()=>(0,l.Y)(V.y,{text:e.errorMessage||""})),b(e=>e.filter(e=>e!==o.id));return}d.some(e=>e.publication_id===o.id)?u(e=>e.map(e=>e.publication_id===o.id?(0,r._)((0,i._)({},e),{membership_state:"free_signup"}):e)):u(e=>[...e,{id:o.id,publication_id:o.id,membership_state:"free_signup",is_founding:!1}]),g(()=>(0,l.Y)(V.y,{Icon:R.A,text:m(G(),o.name)}))}catch(e){alert((0,j.uX)(e))}b(e=>e.filter(e=>e!==o.id))},children:h(c?"Subscribed":"Subscribe")}):null]},a.id)},Z=e=>{let{streamingUser:t}=e;return(0,l.Y)(y.T,{preset:"detail-large",children:(0,l.Y)(H.Yq,{href:(0,q.gYq)(t,{utm_source:P.VU.liveStreamHostModal}),target:"_blank",children:t.name})})},Q=e=>{let{pub:t}=e;return t?(0,l.Y)(y.T,{color:"tertiary",preset:"detail-small",children:(0,l.Y)(H.Yq,{href:(0,N.$_T)(t,{forceSubdomain:!0}),target:"_blank",children:t.name})}):null};var X=n(49869),ee=n(22057),et=n(55696),en=n(92636);let ei=e=>{var t,n;let{liveStream:i,pub:r,subscribeUrl:a,user:o,isSubscribing:c,isHostsModalOpen:d,isSubscribedToAll:u,setIsHostsModalOpen:p,subscriptions:h,setSubscriptions:m,onSubscribeAll:f}=e,{isMobile:v,isMobileLandscape:b}=(0,_.sM)(),[y,k]=(0,s.useState)(v),S=!!(null==i?void 0:i.liveStream.is_rtmp)&&(null==i||null==(t=i.liveStreamGuests)?void 0:t.length)>0,[F,D]=(0,s.useState)(S),T=(0,g.V)(),A=!!T.active,{viewerCount:E,concurrentViewerCount:N}=(0,Y.p)({liveStream:i}),P={chatComposer:i?(0,l.Y)(C,{isMinimized:y,liveStream:i,onMaximizeChat:()=>{k(!1)}}):null,chatFeed:i?(0,l.Y)(I,{headerHeight:b?58:void 0,liveStream:i,onMinimizeChat:()=>k(!0)}):null,details:i?(0,l.Y)(x,{concurrentViewerCount:N,liveStream:i,pub:r,viewerCount:E}):null,header:(0,l.Y)(M,{closeHref:(0,en.$_)(r),height:b?58:void 0,subscribeUrl:a,user:o}),mainContent:i?i.liveStreamInformation.desktopPlaybackUrl?(0,l.Y)(et.u,{disableZoom:!0,handle:T,liveStream:i}):(0,l.Y)(et.A,{liveStream:i}):(0,l.Y)(L,{subscribeUrl:a,user:o}),authorOverlay:(null==i||null==(n=i.liveStreamGuests)?void 0:n.length)&&i.liveStream.is_rtmp&&F?(0,l.Y)(eo,{closeHostsOverlay:()=>D(!1),guests:i.liveStreamGuests,isSubscribing:c,liveStream:i,setIsHostsModalOpen:p,showSubscribeAllButton:!u,onSubscribeAll:f}):null,hostsModal:i&&h?(0,l.Y)(J,{guests:i.liveStreamGuests,isHostsModalOpen:d,liveStream:i,setIsHostsModalOpen:p,setSubscriptions:m,subscriptions:h,user:o}):null};return(0,l.FD)(w.I1,{bg:"primary",color:"primary",style:{height:"var(--full-height)"},children:[P.hostsModal,(0,l.Y)(g.m,{handle:T,children:(0,l.Y)(b?el:v?ea:er,{isChatMinimized:y,isFullScreen:A,livestream:i,pageElements:P})})]})},er=e=>{var t;let{isChatMinimized:n,isFullScreen:i,livestream:r,pageElements:a}=e,o=(0,s.useRef)(null),{width:c,height:d}=(0,X.w)({containerRef:o,defaultWidth:600}),u=16/9;if(null==r||null==(t=r.liveStreamInformation.aspectRatio)?void 0:t.includes(":")){let[e,t]=r.liveStreamInformation.aspectRatio.split(":").map(Number);e&&t&&(u=e/t)}let p=d*u>c?c:d*u;return(0,l.FD)(w.I1,{alignItems:"stretch",style:{height:"var(--full-height)"},children:[!i&&a.header,(0,l.FD)(w.Ye,{alignItems:"stretch",flex:"grow",children:[(0,l.FD)(w.I1,{flex:"grow",position:"relative",children:[(0,l.Y)(w.I1,{ref:o,alignItems:"center",bg:"black",inset:0,justifyContent:"center",position:"absolute",children:(0,l.Y)(w.Ye,{justifyContent:"center",position:"relative",style:{width:p},children:a.mainContent})}),a.authorOverlay&&(0,l.Y)(w.I1,{position:"absolute",style:{top:16,left:16,zIndex:10,pointerEvents:"auto",maxWidth:"90%"},children:a.authorOverlay})]}),a.chatFeed&&(0,l.Y)(w.I1,{borderLeft:"detail",style:{width:400,display:n||i?"none":void 0},children:a.chatFeed})]}),a.details&&(0,l.FD)(w.Ye,{borderTop:"detail",style:{height:164,display:i?"none":void 0},children:[(0,l.Y)(w.I1,{flex:"grow",children:a.details}),(0,l.Y)(w.I1,{borderLeft:"detail",style:{width:400},children:a.chatComposer})]})]})},ea=e=>{let{isChatMinimized:t,isFullScreen:n,pageElements:i}=e;return(0,l.FD)(w.I1,{alignItems:"stretch",style:{height:"var(--full-height)"},children:[!n&&i.header,(0,l.FD)(w.I1,{bg:"black",flex:t?"grow":void 0,justifyContent:"center",position:"relative",children:[(0,l.Y)(w.Ye,{justifyContent:"center",position:"relative",children:i.mainContent}),i.authorOverlay&&(0,l.Y)(w.I1,{position:"absolute",style:{top:16,left:16,zIndex:10,pointerEvents:"auto"},children:i.authorOverlay})]}),i.chatFeed&&(0,l.Y)(w.I1,{borderTop:"detail",flex:"grow",style:{display:t||n?"none":void 0},children:i.chatFeed}),i.details&&(0,l.FD)(w.I1,{borderTop:"detail",style:{display:n?"none":void 0},children:[t&&(0,l.Y)(w.I1,{flex:"grow",children:i.details}),i.chatComposer]})]})},el=e=>{let{pageElements:t}=e;return(0,l.Y)(w.Ye,{alignItems:"stretch",style:{height:"var(--full-height)"},children:(0,l.FD)(w.I1,{flex:"grow",position:"relative",children:[(0,l.Y)(w.I1,{bg:"black",flex:"grow",justifyContent:"center",children:(0,l.Y)(w.Ye,{position:"relative",children:t.mainContent})}),t.authorOverlay&&(0,l.Y)(w.I1,{position:"absolute",style:{top:16,left:16,zIndex:10,pointerEvents:"auto"},children:t.authorOverlay})]})})},eo=e=>{let{liveStream:t,guests:n,showSubscribeAllButton:i,isSubscribing:r,onSubscribeAll:a,setIsHostsModalOpen:o,closeHostsOverlay:s}=e;return(0,l.FD)(w.Ye,{alignItems:"center",gap:8,style:{minWidth:0,maxWidth:"100%"},children:[(0,l.Y)(m.A,{onClick:()=>s()}),(0,l.Y)(es,{guests:n,isSubscribing:r,liveStream:t,setIsHostsModalOpen:o,showSubscribeAllButton:i,onSubscribeAll:a})]})},es=e=>{var t;let{liveStream:n,guests:i,showSubscribeAllButton:r,isSubscribing:a,onSubscribeAll:o,setIsHostsModalOpen:s}=e,c=[n.user.name,...i.map(e=>e.user.name)].filter(Boolean).join(", "),d=[null==(t=n.pub)?void 0:t.name,...i.map(e=>{var t;return null==(t=e.pub)?void 0:t.name})].filter(Boolean).join(", ");return(0,l.FD)(w.Ye,{alignItems:"center",bg:"secondary",gap:16,paddingLeft:4,radius:"full",style:{minWidth:0,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",cursor:"pointer",userSelect:"none"},children:[(0,l.FD)(w.Ye,{alignItems:"center",gap:8,paddingLeft:2,style:{minWidth:0,height:40},onClick:()=>s(!0),children:[(0,l.Y)(ee.Z,{direction:"rtl",size:28,users:[n.user,...i.map(e=>e.user)]}),(0,l.FD)(w.I1,{overflow:"hidden",paddingRight:20*!r,style:{minWidth:0},children:[(0,l.Y)(y.T,{color:"primary",preset:"detail-large",style:{fontWeight:500},whiteSpace:"nowrap",children:c}),(0,l.Y)(y.T,{color:"tertiary",preset:"detail-small",style:{opacity:.7,lineHeight:"16px"},whiteSpace:"nowrap",children:d})]})]}),r&&o?(0,l.Y)(f.v,{disabled:a,size:"sm",style:{marginRight:8},variant:"primary-accent",onClick:o,children:"Subscribe"}):null]})};var ec=n(22240),ed=n(73090),eu=n(64703),ep=n(16074);let eh=e=>{var t;let{livestreamPageData:n,pub:i,subscribeUrl:r,user:a}=e,{scheduledLiveStreams:o,pastLiveStreamPosts:s,pastLiveStreamSectionId:c}=n,d=null!=(t=i.sections.find(e=>e.id===c))?t:null;return(0,l.FD)(w.I1,{bg:"primary",color:"primary",style:{height:"var(--full-height)"},children:[(0,l.Y)(M,{closeHref:(0,N.$_T)(i),subscribeUrl:r,user:a}),(0,l.Y)(w.I1,{flex:"grow",overflow:"auto",paddingX:28,paddingY:40,children:(0,l.FD)(w.I1,{className:"container-sckr5Y",gap:24,children:[(0,l.Y)(ec.L,{children:"Upcoming livestreams"}),0===o.length?(0,l.Y)(y.T,{preset:"h4-sans-condensed",children:"No upcoming livestreams"}):o.map((e,t)=>(0,l.FD)(l.FK,{children:[0!==t&&(0,l.Y)(ep.c,{}),(0,l.Y)(eu.k,{liveStream:e,trackingSurface:"livestream-page"})]})),(0,l.Y)(ep.c,{}),(0,l.Y)(ec.L,{children:"Past livestreams"}),(0,l.Y)(ed.R,{posts:s}),d&&(0,l.Y)(f.v,{href:(0,N.Dor)(i,{section:d}),variant:"outline",children:"Watch more"})]})})]})};var em=n(97432),eg=n(6641);let ef={wrapper:"wrapper-JFyjIy",prompt:"prompt-LfHufc",subscribeButton:"subscribeButton-Nj91ga",input:"input-PZFqCj"},ev=e=>{let{isOpen:t,pub:n,subscribeUrl:i,user:r,audience:a}=e;return(0,l.Y)(eg.S,{hideCloseButton:!0,isOpen:t,children:(0,l.FD)(w.I1,{gap:24,children:[(0,l.FD)(w.I1,{gap:16,children:[(0,l.Y)(y.T,{align:"center",preset:"h5-sans",children:"only_founding"===a?"Unlock Premium Livestream Access":"Unlock Livestream Access"}),(0,l.Y)(y.T,{align:"center",preset:"d2-serif",children:"only_founding"===a?"This livestream is exclusively for our Premium subscribers. Upgrade to Premium now to get access to the conversation in real time and to our live chat":"only_free"===a?"This livestream is a benefit for our subscribers. Sign up below to gain access.":"We’re proud to offer livestreams as an exclusive benefit for our paid subscribers. Sign up to watch live events and never miss a moment."})]}),(0,l.FD)(w.I1,{alignItems:"center",gap:16,children:["only_free"===a?(0,l.Y)(em.A,{className:ef.wrapper,inputClassName:ef.input,inputWrapperClassName:ef.inputWrapper,placeholder:"ENTER YOUR EMAIL",promptClassName:ef.prompt,pub:n,separateInputAndSubmitButton:!0,source:P.VU.publicationLiveStream,submitButtonText:"Sign up for free",subscribeButtonClassName:ef.subscribeButton,user:r,onSuccess:()=>{location.reload()}}):(0,l.Y)(f.v,{href:i,native:!0,children:(null==r?void 0:r.is_free_subscribed)?"Upgrade Today":"Subscribe Today"}),(0,l.FD)(w.Ye,{alignItems:"center",gap:16,children:[(0,l.Y)(y.T,{preset:"caption",children:"only_free"===a?"Already have an account?":"only_founding"===a?"Already a premium subscriber?":"Already a subscriber?"}),(0,l.Y)(y.T,{as:"a",color:"accent",href:(0,q.eV6)(n,{isSignInAttempt:!0}),preset:"caption",children:"only_free"===a?"Sign in":"Switch accounts"})]})]}),(0,l.Y)(w.I1,{alignItems:"center",children:(0,l.Y)(f.v,{href:(0,q.$_T)(n),size:"sm",variant:"tertiary",children:"Back to Homepage"})})]})})};var eb=n(60986),ey=n(94729),eY=n(28528);function e_(){let e=(0,a._)(["Subscribed to "," and ",""]);return e_=function(){return e},e}function ew(){let e=(0,a._)(["Subscribed to ",", ",", and ",""]);return ew=function(){return e},e}function eC(){let e=(0,a._)(["Subscribed to ",", and ",""]);return eC=function(){return e},e}let ek=e=>{var t,n,i;let{liveStream:r,livestreamPageData:a,pub:o,user:c}=e,{activeLiveStream:m}=(0,eb.u)({preloadedLiveStream:r,pub:o}),[g,f]=(0,s.useState)(null!=a?a:null),[v,b]=(0,s.useState)(!1),[y,Y]=(0,s.useState)(!1),{subscriptions:_,isSubscribedToAll:w,setSubscriptions:C,onSubscribeAll:k}=eS({liveStream:m,user:c,existingSubscriptions:(null!=(n=null==a?void 0:a.subscriptions)?n:[]).map(e=>{var t;return{id:e.id,publication_id:e.publication_id,membership_state:null!=(t=e.membership_state)?t:"unsubscribed",is_founding:e.is_founding}}),setIsSubscribing:b,setIsHostsModalOpen:Y}),S=(0,q.my9)(o,{simple:!0,next:document.location.href,utm_source:P.VU.publicationLiveStream,utm_medium:P.Jn.web,utm_content:null!=(i=null==m||null==(t=m.liveStream)?void 0:t.id)?i:null}),I=(null==m?void 0:m.liveStream.status)==="active"&&!(null==m?void 0:m.liveStreamInformation.desktopPlaybackUrl),F=g&&!m;return(0,s.useEffect)(()=>{let e=async()=>(await d().get("/livestream/data")).body;a||e().then(f)},[a]),(0,l.Y)(eY.XL,{pub:o,user:c,children:(0,l.Y)("div",{className:"the-free-press-theme",children:(0,l.FD)(h.DH,{children:[(0,l.Y)(p.Metadata,{image:(0,q.dJ9)("https://substack.com/img/thefp/livestream_preview.jpg",600,{crop:"crop",height:600}),pub:o}),(0,l.Y)(ev,{audience:null==m?void 0:m.liveStream.audience,isOpen:I,pub:o,subscribeUrl:S,user:c}),(0,l.Y)(u.a,{children:F?(0,l.Y)(eh,{livestreamPageData:g,pub:o,subscribeUrl:S,user:c}):(0,l.Y)(ei,{isHostsModalOpen:y,isSubscribedToAll:w,isSubscribing:v,liveStream:m,pub:o,setIsHostsModalOpen:Y,setSubscriptions:C,subscribeUrl:S,subscriptions:_,user:c,onSubscribeAll:k})})]})})})},eS=e=>{var t;let{liveStream:n,user:a,existingSubscriptions:c,setIsSubscribing:d,setIsHostsModalOpen:u}=e,[p,h]=(0,s.useState)(c),m=null!=(t=null==n?void 0:n.liveStreamGuests)?t:[],g=[null==n?void 0:n.pub,...m.map(e=>e.pub)].filter(e=>!!e).every(e=>{var t,n;return["free_signup","subscribed"].includes(null!=(n=null==(t=p.find(t=>t.publication_id===(null==e?void 0:e.id)))?void 0:t.membership_state)?n:"unsubscribed")}),{iString:f,iTemplate:v}=(0,U.GO)(),{popToast:b}=(0,V.d)(),y=async()=>{var e,t;if(!a)return void u(!0);let s=[null==n||null==(e=n.pub)?void 0:e.id,...m.map(e=>{var t;return null==(t=e.pub)?void 0:t.id})].filter(e=>void 0!==e),c=s.filter(e=>!p.find(t=>t.publication_id===e));if(c.length){d(!0);try{let{subscriptionResults:e}=await (0,ey.x6)("/api/v1/bulk_signup",{method:"POST",json:{publications:c,source:P.VU.liveStreamPermalink}});if(e.every(e=>e.requires_confirmation))return void b(()=>(0,l.Y)(V.y,{text:f("Check your email to confirm subscription")}));if(e.some(e=>!e.didSignup))return void b(()=>(0,l.Y)(V.y,{text:f("Unable to subscribe to all publications")}));h(e=>s.map(t=>{let n=e.find(e=>e.publication_id===t);return n?(0,r._)((0,i._)({},n),{membership_state:"free_signup"}):{id:t,publication_id:t,membership_state:"free_signup",is_founding:!1}}));let a=[null==n?void 0:n.pub,...m.map(e=>e.pub)].filter(e=>e&&c.includes(e.id)).map(e=>null==e?void 0:e.name).filter(e=>void 0!==e),d=0===a.length?"":1===a.length&&a[0]?"Subscribed to ".concat(a[0]):2===a.length&&a[0]&&a[1]?v(e_(),a[0],a[1]):3===a.length&&a[0]&&a[1]&&a[2]?v(ew(),a[0],a[1],a[2]):v(eC(),a.slice(0,-1).join(", "),null!=(t=a[a.length-1])?t:"");b(()=>(0,l.Y)(V.y,{Icon:o.A,text:d}))}catch(e){b(()=>(0,l.Y)(V.y,{text:(0,j.uX)(e)}))}d(!1)}};return{subscriptions:p,isSubscribedToAll:g,setSubscriptions:h,onSubscribeAll:y}}},19397:function(e,t,n){n.d(t,{F:()=>v});var i=n(69277),r=n(70408),a=n(4006),l=n(32485),o=n.n(l),s=n(13589),c=n(72880),d=n(63446),u=n(15894),p=n(17306),h=n(68410),m=n(16074),g=n(76977);let f={container:"container-F6lwXo",itemImage:"itemImage-xOyOyH",itemImageHoverOverlay:"itemImageHoverOverlay-Q1cWQy",itemImageMobile:"itemImageMobile-Q0peCf",itemBodyMobile:"itemBodyMobile-pajlxB"},v=e=>{let{hasMarkdownDescriptions:t,hideViewAllCta:n,items:i,showDescriptionOnMobile:r,viewAllLabel:l="View all episodes",justifyViewAllLabel:o="center",applyHoverOnTitle:s=!0}=e,{isMobile:c}=(0,h.sM)();return(0,a.Y)("div",{children:c?(0,a.Y)(g.I1,{gap:24,children:i.map((e,i)=>(0,a.FD)(a.FK,{children:[0!==i&&(0,a.Y)(m.c,{}),(0,a.Y)(b,{applyHoverOnTitle:s,hasMarkdownDescriptions:t,hideViewAllCta:n,item:e,justifyViewAllLabel:o,showDescriptionOnMobile:r,viewAllLabel:l})]}))}):(0,a.Y)("div",{className:f.container,children:i.map(e=>(0,a.Y)(b,{applyHoverOnTitle:s,hasMarkdownDescriptions:t,hideViewAllCta:n,item:e,justifyViewAllLabel:o,viewAllLabel:l}))})})},b=e=>{let{hasMarkdownDescriptions:t,hideViewAllCta:n,item:l,showDescriptionOnMobile:m,viewAllLabel:v,justifyViewAllLabel:b="center",applyHoverOnTitle:y=!0}=e,{isMobile:Y}=(0,h.sM)(),[_,w]=(0,s.Mk)(),{markdownProps:C}=(0,p.$)(l.description),k=t?(0,a.Y)(u.T,(0,r._)((0,i._)({},C),{clamp:3,preset:"d3-serif"})):(0,a.Y)(u.T,{clamp:3,preset:"d3-serif",children:l.description});return(0,a.Y)("a",{href:l.url,style:{textDecoration:"none"},children:Y?(0,a.FD)(g.Ye,{gap:24,children:[(0,a.Y)(g.I1,{className:f.itemImageMobile,flex:"auto",children:l.imageUrl&&(0,a.Y)(c.o,{className:f.itemImage,maxWidth:100,src:l.imageUrl})}),(0,a.FD)(g.I1,{className:f.itemBodyMobile,gap:8*!!m,justifyContent:m?"start":"space-between",children:[(0,a.Y)(u.T,{preset:"h5-serif",children:l.title}),m&&l.description&&k,!n&&(0,a.Y)(d.v,{justifyContent:b,size:"md",trailingIcon:"chevron-right",variant:"tertiary",children:v})]})]}):(0,a.FD)(g.I1,{className:f.itemContainer,cursor:"pointer",gap:16,children:[l.imageUrl&&(0,a.FD)(g.I1,(0,r._)((0,i._)({},w),{position:"relative",children:[(0,a.Y)(c.o,{className:f.itemImage,maxWidth:350,src:l.imageUrl}),(0,a.Y)("div",{className:o()({[f.itemImageHoverOverlay]:_})})]})),(0,a.FD)(g.I1,{gap:8,children:[(0,a.Y)(u.T,(0,r._)((0,i._)({},y?w:{}),{color:_?"accent":"primary",preset:"h5-serif",children:l.title})),k,!n&&(0,a.Y)(d.v,{justifyContent:b,size:"md",trailingIcon:"chevron-right",variant:"tertiary",width:"auto",children:v})]})]})})}},13612:function(e,t,n){n.d(t,{f:()=>p});var i=n(4006),r=n(33031),a=n.n(r),l=n(73869),o=n(82528),s=n(19397),c=n(77124),d=n(74894),u=n(39318);let p=e=>{let{pub:t,user:n}=e,{ids:r}=(0,c.q)({pub:t}),p=(0,d.Zu)(t).filter(e=>!!e.sectionId),h=a()(p,e=>{var t;return r.indexOf(null!=(t=e.sectionId)?t:-1)}).map(e=>{var n;return{title:e.podcastTitle,imageUrl:e.artUrl,description:e.description,url:(0,u.t6y)({pub:t,section:e.sectionId&&null!=(n=t.sections.find(t=>t.id===e.sectionId))?n:null,addBase:!1})}});return(0,i.Y)(o.y,{actions:(0,i.Y)(l.m,{pub:t,sectionType:"podcast",user:null!=n?n:null}),description:(0,i.FD)(i.FK,{children:["Stories you won’t hear anywhere else, conversations with the most fascinating people in the country, and deeper looks into the most talked-about stories of the day. At ",(0,i.Y)("em",{children:"The Free Press"}),", nothing is off-limits. Listen to our flagship podcast ",(0,i.Y)("em",{children:"Honestly with Bari Weiss"}),", straight talk about raising kids with Professor Emily Oster, and our series with J.K. Rowling, where we cover everything from book bans to debates on gender."]}),title:"Podcasts",children:(0,i.Y)(s.F,{hasMarkdownDescriptions:!0,items:h})})}},73090:function(e,t,n){n.d(t,{C:()=>p,R:()=>u});var i=n(4006),r=n(56778),a=n(60355),l=n(16074),o=n(76977),s=n(57820),c=n(92636),d=n(39891);let u=e=>{let{isEvents:t,posts:n}=e;return(0,i.Y)(o.I1,{gap:24,children:n.map((e,n)=>(0,i.FD)(i.FK,{children:[0!==n&&(t?(0,i.FD)(o.Ye,{alignItems:"center",gap:24,paddingY:16,children:[(0,i.Y)(o.Ye,{flex:"grow",children:(0,i.Y)(l.c,{})}),(0,i.Y)("img",{src:(0,d.dJ)("".concat((0,c.Ew)(),"/img/thefp/fp-stars.svg"),154)}),(0,i.Y)(o.Ye,{flex:"grow",children:(0,i.Y)(l.c,{})})]}):(0,i.Y)(l.c,{})),(0,i.Y)(a.R,{post:e,variant:t?"event-page":"archive"})]}))})},p=e=>{let{isLoading:t,noMorePosts:n,posts:a,onLoadMore:l}=e;return(0,i.FD)(o.I1,{gap:24,children:[(0,i.Y)(u,{posts:a}),t&&(0,i.Y)(o.Ye,{justifyContent:"center",children:(0,i.Y)(s.y$,{})}),!!a.length&&!t&&!n&&(0,i.Y)(r.A,{threshold:0,onVisible:()=>{l()}})]})}},81249:function(e,t,n){n.d(t,{o:()=>a});var i=n(4006),r=n(82528);let a=()=>(0,i.FD)(r.y,{description:(0,i.FD)("span",{children:["The Free Press reads. A lot. We're constantly running reviews, excerpts, and columns from our favorite authors.",(0,i.Y)("br",{}),(0,i.Y)("br",{}),"When we mention a book on our site, we make sure to link to it so that you can get the book, and go deeper. Of course, we mention tons of books: old ones, new ones, ones we agree with, ones we can't stand. You'll find them all below. When you purchase them through our site, we may earn an affiliate commission."]}),title:"What We’re Reading",children:[(0,i.FD)("div",{children:[(0,i.Y)("script",{"data-list-slug":"pick-of-the-month","data-type":"list",src:" https://bookshop.org/widgets.js "}),(0,i.Y)("script",{"data-list-slug":"previous-picks-of-the-month","data-type":"list",src:"https://bookshop.org/widgets.js"}),(0,i.Y)("script",{"data-list-slug":"reader-recommendations","data-type":"list",src:"https://bookshop.org/widgets.js"}),(0,i.Y)("script",{"data-list-slug":"politics-the-free-press","data-type":"list",src:"https://bookshop.org/widgets.js"})]}),(0,i.Y)("div",{class:"bookshop__slider",children:(0,i.Y)("script",{"data-list-slug":"culture-the-free-press","data-type":"list",src:"https://bookshop.org/widgets.js"})}),(0,i.Y)("div",{class:"bookshop__slider",children:(0,i.Y)("script",{"data-list-slug":"history-the-free-press","data-type":"list",src:"https://bookshop.org/widgets.js"})}),(0,i.Y)("div",{class:"bookshop__slider",children:(0,i.Y)("script",{"data-list-slug":"science-medicine","data-type":"list",src:"https://bookshop.org/widgets.js"})}),(0,i.Y)("div",{class:"bookshop__slider",children:(0,i.Y)("script",{"data-list-slug":"tech-the-free-press","data-type":"list",src:"https://bookshop.org/widgets.js"})}),(0,i.Y)("div",{class:"bookshop__slider",children:(0,i.Y)("script",{"data-list-slug":"memoir-biography-the-free-press","data-type":"list",src:"https://bookshop.org/widgets.js"})}),(0,i.Y)("div",{class:"bookshop__slider",children:(0,i.Y)("script",{"data-list-slug":"parenting-the-free-press","data-type":"list",src:"https://bookshop.org/widgets.js"})}),(0,i.Y)("div",{class:"bookshop__slider",children:(0,i.Y)("script",{"data-list-slug":"religion-the-free-press","data-type":"list",src:"https://bookshop.org/widgets.js"})})]})},76442:function(e,t,n){n.d(t,{A:()=>ea});var i=n(4006),r=n(99862),a=n(17402),l=n(87677),o=n(69277),s=n(70408),c=n(32641),d=n(63446),u=n(25006),p=n(35369),h=n(4016);let m=e=>{let{variant:t,children:n}=e,r=(0,c._)(e,["variant","children"]),a=(0,u.df)();return(0,h.lu)({pub:a})?"outline"===t?(0,i.Y)(d.v,(0,s._)((0,o._)({variant:"outline"},r),{children:n})):(0,i.Y)(d.v,(0,s._)((0,o._)({},r),{children:n})):"outline"===t?(0,i.Y)(p.$n,(0,s._)((0,o._)({priority:"secondary"},r),{children:n})):(0,i.Y)(p.$n,(0,s._)((0,o._)({},r),{children:n}))};var g=n(41880),f=n(72812),v=n(76977);let b="fullHeight-fzWhjy",y=e=>{let{label:t,content:n,onSave:r,gap:l=16,onEdit:o,isLoading:s=!1}=e,[c,d]=(0,a.useState)(!1),[u,p]=(0,a.useState)(n);return(0,i.Y)(v.I1,{className:"editRowContent-Q3ex6r",gap:l,children:(0,i.FD)(v.pT,{alignItems:"end",className:b,gap:8,justifyContent:"space-between",children:[(0,i.FD)(v.pT,{className:"".concat(b," ").concat("contentWrapper-IH9YEj"),direction:"column",gap:c?8:16,justifyContent:"space-between",children:[(0,i.Y)(g.WZ,{children:t}),(0,i.Y)(g.vC,{className:"content-LYcGXJ",children:c?(0,i.Y)(f.B,{className:"input-CUQULH",size:"sm",type:"text",value:u,onChange:e=>p(e.target.value)}):n})]}),(0,i.Y)(m,{disabled:s,size:"sm",style:{height:"40px"},variant:"outline",onClick:()=>{c?(null==r||r(u),d(!1)):o?o():d(!0)},children:c?"Save":"Edit"})]})})};var Y=n(31793),_=n(6641),w=n(15894),C=n(46271),k=n(55200),S=n(68349),I=n(39318);let F="clickable-QzUIvj",D="actionItem-Th40ya",T=e=>{let{href:t,text:n}=e;return(0,i.Y)(g.Oy,{className:"actionLink-ovC95f",href:t,children:n})},A=()=>(0,i.FD)(v.I1,{gap:24,paddingTop:16,children:[(0,i.Y)(v.pT,{gap:4,children:(0,i.FD)(g.eo,{children:["For email delivery issues, ",(0,i.Y)(T,{href:"/account/email-test",text:"click here"}),"."]})}),(0,i.Y)(v.pT,{gap:4,children:(0,i.FD)(g.eo,{children:["For support, ",(0,i.Y)(T,{href:(0,I.RPh)(),text:"click here"}),"."]})}),(0,i.Y)(v.pT,{gap:4,children:(0,i.FD)(g.eo,{children:["To permanently delete your Substack account, go to your"," ",(0,i.Y)(T,{href:"/account?utm_source=user-menu",text:"Substack Settings"}),"."]})})]}),E=()=>{var e;let{name:t,updateName:n,email:r,updateEmail:o,isSendingReset:s,handlePasswordChange:c}=(0,Y.E)(),d=(0,C.Jd)(),[u,p]=(0,a.useState)(!1),[h,f]=(0,a.useState)(null),[b,T]=(0,a.useState)(!1),A=async e=>{f({email:e,confirm:e}),p(!0)},E=async()=>{h&&(await o(h.email,h.confirm),p(!1),f(null))},N=()=>{p(!1),f(null)},P=(null==d?void 0:d.subscription_first_payment_at)?new Date(d.subscription_first_payment_at).getFullYear():"";return(0,i.FD)(v.I1,{style:{width:"100%",flexGrow:1},children:[(0,i.FD)("div",{children:[(0,i.Y)(g.$E,{children:"Account Settings"}),(0,i.Y)(g.u0,{children:P?(0,i.FD)(i.FK,{children:["You've supported independent journalism since ",P,"."]}):(0,i.Y)(i.FK,{children:"Manage your account settings and preferences."})})]}),(0,i.Y)(g.Rm,{}),(0,i.FD)(v.I1,{children:[(0,i.FD)(v.pT,{alignItems:"center",justifyContent:"space-between",paddingBottom:24,children:[(0,i.Y)(g.U2,{children:"Profile"}),(0,i.Y)(w.T,{as:"a",className:"viewProfile-u5hCP0",href:(0,k.l)(d),preset:"detail-small",children:"VIEW PROFILE"})]}),(0,i.FD)(v.pT,{gap:16,children:[(0,i.Y)("img",{alt:"Profile",src:null!=(e=null==d?void 0:d.photo_url)?e:"",style:{width:48,height:48}}),(0,i.Y)(y,{content:t,label:"Name",onSave:n})]})]}),(0,i.Y)(g.Ne,{}),(0,i.Y)(y,{content:r,label:"Email",onSave:A}),(0,i.Y)(g.Ne,{}),(0,i.Y)(y,{content:"••••••••••••••••",isLoading:s,label:"Password",onEdit:()=>{c().then(e=>{let{success:t}=e;t&&(T(!0),setTimeout(()=>T(!1),2e4))})}}),b&&(0,i.Y)(v.pT,{paddingTop:8,children:(0,i.Y)(g.eo,{children:"Password reset email sent. Please check your inbox."})}),(0,i.Y)(g.Rm,{}),(0,i.FD)(v.I1,{children:[(0,i.Y)(g.U2,{children:"Account Actions"}),(0,i.FD)(v.pT,{alignItems:"center",className:"".concat(F," ").concat(D),justifyContent:"space-between",paddingTop:16,onClick:()=>(0,S.V2)((0,I.bgT)()),children:[(0,i.Y)(w.T,{preset:"list-item-menu",children:"Sign out"}),(0,i.Y)(l.A,{size:20})]}),(0,i.Y)(g.Ne,{}),(0,i.FD)(v.pT,{alignItems:"center",className:"".concat(F," ").concat(D),justifyContent:"space-between",onClick:()=>{c()},children:[(0,i.Y)(w.T,{preset:"list-item-menu",children:"Change password"}),(0,i.Y)(l.A,{size:20})]}),(0,i.Y)(g.Ne,{})]}),u&&(0,i.Y)(_.S,{isOpen:u,onClose:N,children:(0,i.FD)(v.I1,{gap:32,paddingBottom:0,children:[(0,i.FD)("div",{children:[(0,i.Y)(g.$E,{paddingBottom:16,children:"Change Email Address"}),(0,i.Y)(w.T,{preset:"d2-serif",children:"You will be signed out after changing your email address. You will need to sign in again with your new email address."})]}),(0,i.FD)(v.pT,{gap:16,justifyContent:"space-between",children:[(0,i.Y)(m,{variant:"outline",onClick:N,style:{flex:1},children:"CANCEL"}),(0,i.Y)(m,{onClick:E,style:{flex:1,backgroundColor:"#f55"},children:"CONTINUE"})]})]})})]})};var N=n(75107),P=n(8149),x=n(24777);let L=e=>{let{name:t,imgUrl:n,checked:r=!0,onToggle:a}=e;return(0,i.FD)(v.pT,{alignItems:"center",justifyContent:"space-between",children:[(0,i.FD)(v.pT,{alignItems:"center",gap:16,children:[n&&(0,i.Y)(v.pT,{as:"div",bg:"tertiary",height:32,width:32,children:(0,i.Y)("img",{alt:t,src:n})}),(0,i.Y)(w.T,{preset:"lg-preview-byline",children:t})]}),(0,i.Y)(x.A,{checked:r,onChange:e=>null==a?void 0:a(e)})]})},O=e=>{let{title:t,newsletters:n,isExpanded:r,onToggle:a,onSelectAll:l,areAllSelected:o}=e;return(0,i.FD)(v.I1,{gap:0,width:"100%",children:[(0,i.FD)(v.pT,{alignItems:"center",className:"sectionHeader-Z3zoO8",justifyContent:"space-between",paddingBottom:24,role:"button",tabIndex:0,onClick:a,children:[(0,i.Y)(g.U2,{children:t}),(0,i.Y)(N.A,{className:"".concat("chevron-NOVYNS"," ").concat(r?"expanded-Tjjigv":""),size:24})]}),(0,i.Y)(P.N,{open:r,children:r&&(0,i.FD)(i.FK,{children:[(0,i.FD)(v.pT,{alignItems:"center",justifyContent:"space-between",children:[(0,i.Y)(g.n1,{children:"SELECT ALL"}),(0,i.Y)(x.A,{checked:o,onChange:e=>l(e)})]}),(0,i.Y)(g.Ne,{}),n.map((e,t)=>(0,i.FD)("div",{children:[(0,i.Y)(L,{checked:e.selected,imgUrl:e.logoUrl||"",name:e.name,onToggle:t=>e.onToggle(t)}),t<n.length-1&&(0,i.Y)(g.Ne,{})]},e.sectionId))]})})]})},B=()=>{let{newsletters:e}=(0,Y.E)(),[t,n]=(0,a.useState)({fromTheFreePress:!0,featured:!0,topic:!0,video:!0}),r=e=>{n(t=>(0,s._)((0,o._)({},t),{[e]:!t[e]}))},l=e=>e.length>0&&e.every(e=>e.selected);return(0,i.FD)(v.I1,{children:[(0,i.Y)(g.$E,{children:"Your Newsletters"}),(0,i.Y)(g.u0,{children:"Manage the email notifications you receive from us to personalize your experience."}),(0,i.Y)(g.Rm,{}),(0,i.Y)(O,{areAllSelected:l(e.fromTheFreePress.newsletters),isExpanded:t.fromTheFreePress,newsletters:e.fromTheFreePress.newsletters,title:e.fromTheFreePress.name,onSelectAll:t=>e.updateNewsletterGroup("fromTheFreePress",t),onToggle:()=>r("fromTheFreePress")}),(0,i.Y)(g.Rm,{}),(0,i.Y)(O,{areAllSelected:l(e.featured.newsletters),isExpanded:t.featured,newsletters:e.featured.newsletters,title:e.featured.name,onSelectAll:t=>e.updateNewsletterGroup("featured",t),onToggle:()=>r("featured")}),(0,i.Y)(g.Rm,{}),(0,i.Y)(O,{areAllSelected:l(e.topic.newsletters),isExpanded:t.topic,newsletters:e.topic.newsletters,title:e.topic.name,onSelectAll:t=>e.updateNewsletterGroup("topic",t),onToggle:()=>r("topic")}),(0,i.Y)(g.Rm,{}),(0,i.Y)(O,{areAllSelected:l(e.video.newsletters),isExpanded:t.video,newsletters:e.video.newsletters,title:e.video.name,onSelectAll:t=>e.updateNewsletterGroup("video",t),onToggle:()=>r("video")}),(0,i.Y)(g.Rm,{}),(0,i.FD)(v.pT,{justifyContent:"space-between",alignItems:"center",children:[(0,i.FD)(w.T,{preset:"lg-preview-byline",children:["Unsubscribe from all ",(0,i.Y)("em",{children:"Free Press"})," emails"]}),(0,i.Y)(d.v,{variant:"primary-accent",size:"sm",onClick:()=>e.unsubscribeFromAllEmails(),children:"Unsubscribe"})]})]})};var M=n(56458),R=n(46009),U=n(57324);let j=e=>{let{podcast:t}=e;return(0,i.FD)(v.pT,{alignItems:"center",justifyContent:"space-between",paddingY:12,children:[(0,i.FD)(v.pT,{alignItems:"center",gap:16,children:[(0,i.Y)("div",{className:"podcastLogo-AAT5j_",style:{backgroundImage:t.logoUrl?"url(".concat(t.logoUrl,")"):void 0}}),(0,i.Y)(w.T,{preset:"lg-preview-byline",children:t.name})]}),(0,i.Y)(d.v,{href:t.setupUrl,"data-native":!0,size:"sm",variant:"outline",children:"SET UP"})]})},z=()=>{let e=(0,u.df)(),t=(0,C.Jd)(),[n,r]=(0,a.useState)([]),[l,o]=(0,a.useState)(!0);return((0,a.useEffect)(()=>{if(!e)return;let n=[],i=(0,M.th)(e);i&&i.length>0&&i.forEach(i=>{let r=(0,R.lL)({pub:e,section:i});r.title&&n.push({id:i.id,name:r.title,description:r.description||void 0,logoUrl:r.artUrl||void 0,setupUrl:(0,I.wpu)(e,{section:i,noSection:!1,addBase:!0,user:t,startAtSubscribeFlow:!t||!t.is_free_subscribed,params:{utm_source:U.VU.account}})})}),r(n),o(!1)},[e,t]),l)?(0,i.Y)(v.I1,{width:"100%",children:(0,i.Y)(w.T,{preset:"h4-sans-condensed",children:"Loading podcast feeds..."})}):0===n.length?(0,i.FD)(v.I1,{width:"100%",children:[(0,i.Y)(g.$E,{children:"Subscriber Podcast Feeds"}),(0,i.Y)(g.u0,{children:"No podcast feeds are currently available."})]}):(0,i.FD)(v.I1,{width:"100%",children:[(0,i.Y)(g.$E,{children:"Subscriber Podcast Feeds"}),(0,i.Y)(g.u0,{children:"Free Press podcasts are available anywhere. Select which shows you'd like to subscribe to, in your app of choice, below."}),(0,i.Y)(g.Rm,{}),(0,i.Y)(v.pT,{direction:"column",children:n.map((e,t)=>(0,i.FD)("div",{children:[(0,i.Y)(j,{podcast:e}),t!==n.length-1&&(0,i.Y)(g.Ne,{})]},e.id))})]})};var H=n(45773),W=n(49092),V=n(13022),K=n(12501),q=n(44333),G=n(89129),J=n(49807),$=n(82776);let Z=e=>{let{children:t}=e;return(0,i.FD)(v.pT,{alignItems:"center",gap:16,children:[(0,i.Y)(H.A,{size:24,style:{flexShrink:0}}),(0,i.Y)(w.T,{preset:"list-item-menu",children:t})]})},Q=()=>{let{path:e}=(0,q.zy)(),t=(0,q.lq)(),n=new URLSearchParams(window.location.search),r="true"===n.get("open_change_plan"),[o,s]=(0,a.useState)(!0),[c,p]=(0,a.useState)(r),f=(0,C.Jd)(),b=(0,u.df)(),{plan:y,totalAmount:_,currency:k,isLifetime:F,isComped:D,giftCount:T}=(0,Y.E)(),{result:A}=(0,K.st)({pathname:"/api/v1/subscription",auto:!!(null==f?void 0:f.is_subscribed)}),E=null==f?void 0:f.is_subscribed;(0,a.useEffect)(()=>{r&&(n.delete("open_change_plan"),t("".concat(e,"?").concat(n.toString()),!1))},[r]);let{intro:P,benefits:x}=E?f.is_founding?{intro:"As a premium subscriber to The Free Press, you get:",benefits:["Full access to all articles, investigations, and columnists, including Niall Ferguson, Coleman Hughes, Matti Friedman, and Martin Gurri","Access to the thriving comments section and the Free Press community","Text to speech and PDF-to-prints on every article","Video recordings of Honestly with Bari Weiss","First chance to purchase tickets for live Free Press events and subscriber-only discounts","Four off-the-record town halls with Bari each year","Two annual gift subscriptions","One item of merch each year (this year is TGIF socks!)","Supports the mission by sponsoring subscriptions for those who can't afford one, subsidizing free stories, and keeping the lights on"]}:{intro:"As a paid subscriber to The Free Press, you get:",benefits:["Full access to all articles, investigations, and columnists, including Niall Ferguson, Coleman Hughes, Matti Friedman, and Martin Gurri","Access to the thriving comments section and the Free Press community","Text to speech and PDF-to-prints on every article","Video recordings of Honestly with Bari Weiss","First chance to purchase tickets for live Free Press events and subscriber-only discounts"]}:{intro:"As a free subscriber to The Free Press, you get:",benefits:["The Front Page","Occasional free articles"]};return(0,i.FD)(v.I1,{width:"100%",children:[(0,i.FD)("div",{children:[(0,i.Y)(g.$E,{children:"Your Subscription"}),(0,i.Y)(g.u0,{children:E?f.is_founding?"You’re a premium subscriber!":"You’re a paid subscriber!":"You’re a free subscriber!"})]}),(0,i.Y)(g.Rm,{}),(0,i.FD)(v.I1,{gap:24,children:[(0,i.Y)(g.U2,{children:"Subscription"}),(0,i.FD)("div",{children:[(0,i.FD)(v.pT,{direction:"column",gap:16,children:[(0,i.Y)(g.n1,{children:"STATUS"}),(0,i.Y)(w.T,{preset:"list-item-menu",children:(()=>{if(!E)return"Free subscription";if(F)return"Lifetime membership";if(!A)return"";let e=null==f?void 0:f.subscription_expiry;if(!e)return"";let t=(0,G.a)(e,{stripeSub:{cancel_at_period_end:A.cancel_at_period_end,status:A.status,billing:A.is_invoiced?"send_invoice":void 0}});return"Billing period renews ".concat(t.format("M/D/YYYY"))})()})]}),(0,i.Y)(g.Ne,{}),(0,i.FD)(v.pT,{alignItems:"center",justifyContent:"space-between",children:[(0,i.FD)(v.pT,{direction:"column",gap:16,children:[(0,i.Y)(g.n1,{children:"PLAN"}),(0,i.Y)(w.T,{preset:"list-item-menu",children:(()=>{if(!E)return"Free";if(F)return"Lifetime membership";if(f.is_subscribed&&(D||!f.subscription_first_payment_at))return f.is_founding?"Comped (Premium)":"Comped (Paid)";if(!y||!_||!k)return"";let e=y.interval||"year";return"".concat((0,$.centsToPriceString)(_,k)," per ").concat(e)})()})]}),!F&&(0,i.Y)(m,{size:"sm",variant:"outline",onClick:()=>{if(E)p(!0);else{if(!b)return;let e=(0,I.eV6)(b,{user:f,addBase:!0,params:{utm_source:U.VU.account}});(0,S.V2)(e,{local_navigation:!1})}},children:E?"Change":"Upgrade"})]})]})]}),(0,i.Y)(g.Rm,{}),(0,i.FD)(v.I1,{gap:24,children:[(0,i.FD)(v.pT,{alignItems:"center",className:"expandable-UB3Kke",justifyContent:"space-between",onClick:()=>s(!o),children:[(0,i.Y)(g.U2,{children:"What's Included"}),o?(0,i.Y)(N.A,{size:20}):(0,i.Y)(l.A,{size:20})]}),o&&(0,i.FD)(v.I1,{gap:16,children:[(0,i.Y)(w.T,{preset:"list-item-menu",children:P}),(0,i.Y)(g.Ne,{}),x.map((e,t)=>(0,i.Y)(Z,{children:e},t))]})]}),E&&(0,i.FD)(i.FK,{children:[(0,i.Y)(g.Rm,{}),(0,i.FD)(v.I1,{children:[(0,i.Y)(g.U2,{paddingBottom:24,children:"Gift Subscriptions"}),T>0?(0,i.FD)(i.FK,{children:[(0,i.Y)(w.T,{preset:"list-item-menu",children:"Gift Independent Journalism."}),(0,i.Y)(g.Ne,{}),(0,i.FD)(v.pT,{alignItems:"center",justifyContent:"space-between",children:[(0,i.FD)(v.pT,{direction:"column",gap:16,children:[(0,i.Y)(g.n1,{children:"YOUR BALANCE"}),(0,i.Y)(w.T,{preset:"lg-preview-byline",children:"".concat(T," Annual Subscription").concat(1!==T?"s":"")})]}),(0,i.Y)(d.v,{href:f&&(0,V.Ay)("enable_founding_gifts")?(0,h.eh)({user:f}):b?(0,J.jED)({pub:b}):"/account/gifts",localNavigation:!1,size:"sm",variant:"outline",children:"SEND GIFT"})]})]}):(0,i.Y)(i.FK,{children:(0,i.FD)(v.pT,{alignItems:"center",justifyContent:"space-between",children:[(0,i.FD)(w.T,{preset:"list-item-menu",children:["Know someone who’d love ",(0,i.Y)("span",{style:{fontStyle:"italic"},children:"The Free Press"}),"?"]}),(0,i.Y)(d.v,{href:f&&(0,V.Ay)("enable_founding_gifts")?(0,h.eh)({user:f}):"/subscribe?gift=true",localNavigation:!1,size:"sm",variant:"outline",children:"SEND GIFT"})]})})]})]}),(0,i.Y)(g.Rm,{}),E&&(0,i.FD)(i.FK,{children:[(0,i.FD)(v.pT,{alignItems:"center",className:"clickable-U5bOwj",justifyContent:"space-between",paddingBottom:8,onClick:()=>{if(!b)return;let e=(0,I._nG)(b,{addBase:!0,params:{utm_source:U.VU.account}});(0,S.V2)(e,{local_navigation:!1})},children:[(0,i.Y)(w.T,{preset:"list-item-menu",children:"Cancel subscription"}),(0,i.Y)(l.A,{size:20})]}),(0,i.Y)(g.Ne,{})]}),E&&b&&A&&(0,i.Y)(W.Z,{isOpen:c,sub:A,pub:b,onClose:()=>p(!1)})]})};var X=n(68410);let ee="tab-zPdpGg",et=()=>{let e=(0,u.df)(),t=(0,C.Jd)();return(0,i.FD)(v.pT,{className:"upgradeBanner-qujPvE",gap:8,justifyContent:"space-between",alignItems:"center",children:[(0,i.Y)(w.T,{preset:"lg-preview-byline",align:"center",children:"You're a free subscriber"}),(0,i.Y)(d.v,{variant:"primary-accent",size:"md",onClick:()=>((e,t)=>{if(!e)return;let n=(null==t?void 0:t.is_subscribed)?(0,I.RF$)({utm_source:U.VU.account}):(0,I.eV6)(e,{user:t,addBase:!0,params:{utm_source:U.VU.account}});(0,S.V2)(n,{local_navigation:!1})})(e,t),children:"Upgrade to paid"})]})},en=()=>{let[e,t]=(0,a.useState)("account"),{isMobile:n}=(0,X.sM)(),r=(0,C.Jd)(),l=(null==r?void 0:r.is_free_subscribed)&&!(null==r?void 0:r.is_subscribed);return(0,a.useEffect)(()=>{let e=()=>{let e=new URLSearchParams(window.location.search).get("tab");e&&["account","subscription","newsletters","podcastFeeds"].includes(e)&&t(e)};e(),window.addEventListener("popstate",e);let n=setInterval(e,100);return()=>{window.removeEventListener("popstate",e),clearInterval(n)}},[]),(0,i.FD)(v.pT,{className:"tabContainer-ZyUff9",direction:n?"column":"row",children:[(0,i.Y)(v.pT,{alignItems:n?"stretch":"start",className:"tabMenu-TPrBTB",direction:n?"row":"column",children:[{id:"account",label:"Account"},{id:"subscription",label:"Subscription"},{id:"newsletters",label:"Newsletters"},{id:"podcastFeeds",label:"Podcast Feeds"}].map(n=>(0,i.Y)(d.v,{className:e===n.id?"".concat(ee," ").concat("selectedTab-h46kjj"):ee,variant:"tertiary",onClick:()=>{var e;let i;return t(e=n.id),void((i=new URL(window.location.href)).searchParams.set("tab",e),window.history.pushState({},"",i))},children:n.label},n.id))}),(0,i.FD)("div",{className:"tabContent-Q4YhmV",children:[l&&(0,i.Y)(et,{}),"account"===e&&(0,i.Y)(E,{}),"subscription"===e&&(0,i.Y)(Q,{}),"newsletters"===e&&(0,i.Y)(B,{}),"podcastFeeds"===e&&(0,i.Y)(z,{}),["account","subscription"].includes(e)&&(0,i.Y)(A,{})]})]})};var ei=n(13950),er=n(85478);let ea=()=>{let e=(0,er.mJ)(),t=(0,C.Jd)(),n=e.getConfigFor("enable_account_settings_revamp");return((0,a.useEffect)(()=>{t?n||(0,r.route)("/account"):(0,r.route)("/login")},[t,n]),t&&n)?(0,i.Y)("div",{className:"the-free-press-theme",children:(0,i.Y)(ei.DH,{children:(0,i.Y)(en,{})})}):null}},13482:function(e,t,n){n.d(t,{w:()=>f,X:()=>g});var i=n(69277),r=n(70408),a=n(32641),l=n(4006),o=n(32485),s=n.n(o),c=n(49500),d=n(17402),u=n(15894),p=n(35369),h=n(76977),m=n(7244);let g=(0,d.forwardRef)((e,t)=>{var{className:n,value:o}=e,c=(0,a._)(e,["className","value"]);return(0,l.Y)(u.T,(0,r._)((0,i._)({},c),{as:"textarea",className:s()(n,"textarea-Ohqcz2"),innerRef:t,preset:"list-item-menu",value:o}))}),f=(0,d.forwardRef)((e,t)=>{var{className:n,flex:o,liveStream:d,onSend:u}=e,f=(0,a._)(e,["className","flex","liveStream","onSend"]);return(0,l.FD)(h.I1,{flex:o,position:"relative",children:[(0,l.Y)(g,(0,r._)((0,i._)({},f),{ref:t,className:s()(n,"textareaWithIcon-kncL3t")})),(0,l.FD)(h.Ye,{className:"iconContainer-aheBDP",position:"absolute",children:[(0,l.Y)(m.s,{liveStream:d}),(0,l.Y)(p.K0,{priority:"quaternary",onClick:()=>{u()},children:(0,l.Y)(c.A,{})})]})]})})},56455:function(e,t,n){n.d(t,{m:()=>a});var i=n(4006),r=n(13950);let a=e=>{let{children:t}=e;return(0,i.Y)("div",{className:"the-free-press-theme",children:(0,i.Y)(r.DH,{children:t})})}},42032:function(e,t,n){n.d(t,{E:()=>W});var i=n(69277),r=n(70408),a=n(4006),l=n(17402),o=n(15734),s=n.n(o),c=n(13950),d=n(73869),u=n(53696),p=n(73090),h=n(98695),m=n(23623),g=n(63446),f=n(7903),v=n(15894),b=n(60250),y=n(87677),Y=n(49869),_=n(68410),w=n(95294),C=n(49807),k=n(69706);let S=892/346,I=k.B7,F=510/892,D=e=>{let{currentIndex:t,posts:n,pub:i,setCurrentIndex:r}=e,{isMobile:o}=(0,_.sM)(),s=(0,l.useRef)(null),{width:c}=(0,Y.w)({containerRef:s}),d=o?c-56:c*F,[u,p]=(0,l.useState)({currentIndex:t,targetIndex:null,stage:null,direction:null}),h=!!u.stage,m=e=>{let{targetIndex:n,direction:i}=e;p({currentIndex:t,targetIndex:n,stage:"prepare",direction:i}),requestAnimationFrame(()=>{p({currentIndex:t,targetIndex:n,stage:"animate",direction:i}),setTimeout(()=>{r(n)},150),setTimeout(()=>{p({currentIndex:n,targetIndex:null,stage:null,direction:null})},300)})},g=()=>{h||m({targetIndex:(t+n.length-1)%n.length,direction:"previous"})},f=()=>{h||m({targetIndex:(t+1)%n.length,direction:"next"})};return(0,a.FD)("div",{ref:s,className:"outerContainer-_EB7WB",style:{height:o?(c-56)/I:c/S},children:[(0,a.Y)("div",{className:"innerTrack-Kj4zL_",children:n.map((e,t)=>{let r=T({animationState:u,panelIndex:t,numPanels:n.length}),l=o?N({panelOffset:r,imageWidth:d}):E({panelOffset:r,containerWidth:c,imageWidth:d}),s="animate"===u.stage?"all ".concat(300,"ms ease"):"none";return(0,a.Y)("a",{className:"panel-Y2mj7O",href:(0,C.wu9)(i,e,{noBase:!0}),style:{width:d,transform:"translateY(-50%) translateX(".concat(l.translate,"px) scale(").concat(l.scale,")"),display:l.display,transition:s,opacity:l.opacity},onClick:e=>{0!==r&&(e.preventDefault(),e.stopPropagation(),1===r?f():g())},children:(0,a.Y)(w.D,{className:"videoPostImage-dwXmpQ",disableVideoHover:!0,disableVideoHoverFade:!0,imageAspectRatio:16/9,imageWidth:1e3,isBelowTheFold:!1,post:e,videoPlayIconVariant:"red-circle"})},e.id)})}),(0,a.Y)("div",{className:"previousBackground-l9aBt9",onClick:g,children:(0,a.Y)(b.A,{size:o?18:32,stroke:"white",strokeWidth:1.5})}),(0,a.Y)("div",{className:"nextBackground-_36RTD",onClick:f,children:(0,a.Y)(y.A,{size:o?18:32,stroke:"white",strokeWidth:1.5})})]})},T=e=>{let{animationState:t,panelIndex:n,numPanels:i}=e,{currentIndex:r,targetIndex:a,stage:l,direction:o}=t,s=A({from:"animate"===l?null!=a?a:0:r,to:n,size:i});return null===l?[-1,0,1].includes(s)?s:null:[-1,0,1].includes(s)?s:"prepare"===l?"next"===o?2:-2:"next"===o?-2:2},A=e=>{let{from:t,to:n,size:i}=e,r=(n-t+i)%i;return r>i/2&&(r-=i),r},E=e=>{let{panelOffset:t,containerWidth:n,imageWidth:i}=e;return null===t?{translate:0,scale:0,display:"none",opacity:0}:{translate:.5*n-.5*i+t*(.5*i+.3*i+24),scale:0===t?1:.6,display:"block",opacity:0===t?1:.5}},N=e=>{let{panelOffset:t,imageWidth:n}=e;return null===t?{translate:0,scale:0,display:"none",opacity:0}:{translate:28+t*(n+14),scale:1,display:"block",opacity:0===t?1:.5}};var P=n(76977);let x=e=>{var t,n;let{hasActiveLiveStream:i,posts:r,pub:o,user:s}=e,{isMobile:c,isDesktop:d}=(0,_.sM)(),[p,h]=(0,l.useState)(0),g=69+(i&&!d?62:0),f=null==r?void 0:r[p],b=(null==f?void 0:f.section_id)&&null!=(n=null==(t=o.sections)?void 0:t.find(e=>e.id===f.section_id))?n:null;return(0,a.Y)(m.a,{children:(0,a.Y)("div",{className:"header-MeQvZM",style:{paddingTop:g,marginTop:-g},children:(0,a.Y)(P.I1,{paddingY:c?40:64,children:(0,a.Y)(u.r,{children:c?(0,a.FD)(P.I1,{children:[(0,a.Y)(P.I1,{paddingBottom:20,children:(0,a.Y)(v.T,{color:"white",preset:"h1-serif",children:"Video Series"})}),(0,a.Y)(P.I1,{paddingBottom:36,children:(0,a.Y)(D,{currentIndex:p,posts:r?r.slice(0,4):[],pub:o,setCurrentIndex:h})}),(0,a.Y)(P.I1,{children:f&&(0,a.Y)(L,{isMobile:!0,post:f,pub:o,section:b,user:s})})]}):(0,a.FD)(P.I1,{gap:16,children:[(0,a.Y)(v.T,{color:"white",preset:"h1-serif",children:"Videos"}),(0,a.FD)("div",{className:"headerContents-XMY0rT",children:[(0,a.Y)(P.I1,{children:f&&(0,a.Y)(L,{isMobile:!d,post:f,pub:o,section:b,user:s})}),(0,a.Y)(D,{currentIndex:p,posts:r?r.slice(0,4):[],pub:o,setCurrentIndex:h})]})]})})})})})},L=e=>{let{post:t,pub:n,section:i,user:r,isMobile:l}=e,o=(0,C.wu9)(n,t,{noBase:!0});return(0,a.FD)(P.I1,{gap:16,children:[(0,a.FD)(P.I1,{gap:12,children:[i?(0,a.FD)(P.Ye,{alignItems:"end",justifyContent:"space-between",position:"relative",children:[(0,a.Y)(v.T,{as:"a",href:(0,C.Dor)(n,{section:i}),preset:"d2-serif",children:i.name}),(0,a.Y)(f.S,{isPodcastOrVideo:!0,minimize:l,pub:n,section:i,user:r})]}):(0,a.Y)(v.T,{preset:"d2-serif",children:"\xa0"}),(0,a.FD)(P.I1,{borderBottom:"detail",borderTop:"detail",gap:12,paddingBottom:16,paddingTop:12,children:[(0,a.Y)(v.T,{as:"a",clamp:2,href:o,preset:"h5-serif",children:t.title}),(0,a.Y)(v.T,{clamp:3,preset:"d3-serif",children:t.description})]})]}),(0,a.Y)(P.Ye,{justifyContent:"start",children:(0,a.Y)(g.v,{href:o,trailingIcon:"chevron-right",variant:"tertiary",children:"Watch Now"})})]})};var O=n(72880),B=n(95691),M=n(16074),R=n(57324);let U=e=>{let{pub:t,user:n}=e,{initialSections:i}=(0,B.P)({pub:t});return(0,a.Y)(P.I1,{gap:24,children:i.map((e,i)=>(0,a.FD)(a.FK,{children:[0!==i&&(0,a.Y)(M.c,{}),(0,a.Y)(j,{pub:t,section:e,user:n})]}))})},j=e=>{let{pub:t,section:n,user:i}=e,{isMobile:r}=(0,_.sM)(),l=(0,C.Dor)(t,{section:n}),o=(0,C.eV6)(t,{addBase:!0,user:i,params:{next:document.location.href,utm_medium:R.Jn.web,utm_source:R.VU.videosPage}});return(0,a.FD)(P.Ye,{className:"sectionContainer-g1nief",gap:r?24:40,children:[n.logo_url&&(0,a.Y)(P.I1,{as:"a",flex:"auto",href:l,children:(0,a.Y)(O.o,{className:"sectionImage-OVlQ8l",maxWidth:300,src:n.logo_url})}),(0,a.FD)(P.I1,{gap:8*!r,overflow:"hidden",children:[(0,a.Y)(v.T,{as:"a",clamp:1,className:"sectionTitle-Aad7Bm",href:l,preset:"h5-serif",children:n.name}),(0,a.Y)(P.I1,{flex:r?void 0:"grow",paddingBottom:r?16:8,children:(0,a.Y)(v.T,{as:"a",clamp:3,href:l,preset:"d3-serif",children:n.description})}),!(null==i?void 0:i.is_subscribed)&&(0,a.FD)(P.Ye,{gap:8,children:[(0,a.Y)(v.T,{preset:"sm-preview-byline",children:"Free with Ads"}),(0,a.Y)(v.T,{as:"a",color:"accent",href:o,preset:"sm-preview-byline",children:"Listen Ad-Free"})]})]})]})};var z=n(60986),H=n(28528);let W=e=>{var t;let{activeLiveStream:n,pub:o,user:m,videoPageData:g}=e,{isMobile:f}=(0,_.sM)(),{activeLiveStream:v}=(0,z.u)({pub:o,preloadedLiveStream:n}),[b,y]=(0,l.useState)(!1),[Y,w]=(0,l.useState)((null!=(t=null==g?void 0:g.recentPosts.length)?t:0)<7),[C,k]=(0,l.useState)("latest"),[S,I]=(0,l.useState)(null!=g?g:null),F=null!=S?S:g,{recentPosts:D}=null!=F?F:{};(0,l.useEffect)(()=>{let e=async()=>{let e=await s().get("/videos/data");return e.body.recentPosts.length<7?w(!0):w(!1),e.body};if(g){var t;w((null!=(t=null==g?void 0:g.recentPosts.length)?t:0)<7),I(g)}else e().then(I)},[g]);let T=async()=>{var e;y(!0);let{body:t}=await s().get("/videos/data").query({offset:null!=(e=null==D?void 0:D.length)?e:0,limit:7});I(e=>(0,r._)((0,i._)({},e),{recentPosts:[...e?e.recentPosts:[],...t.recentPosts]})),t.recentPosts.length<7&&w(!0),y(!1)};return(0,a.Y)(H.XL,{pub:o,children:(0,a.Y)(c.DH,{children:(0,a.FD)(P.I1,{children:[(0,a.Y)(x,{hasActiveLiveStream:!!v,posts:null!=D?D:null,pub:o,user:m}),(0,a.Y)(u.r,{children:(0,a.Y)("div",{className:"bodyContents-ivBy3X",children:(0,a.FD)(P.I1,{gap:40,paddingY:40,children:[(0,a.FD)(P.Ye,{justifyContent:"center",position:"relative",children:[(0,a.Y)(h.p,{activeTabId:C,tabs:[{title:"Latest Videos",id:"latest"},{title:"All Series",id:"series"}],onClick:k}),"series"===C&&!f&&(0,a.Y)(P.Ye,{position:"absolute",style:{right:0,top:0},children:(0,a.Y)(d.m,{pub:o,sectionType:"video",user:null!=m?m:null})})]}),"latest"===C&&D&&(0,a.Y)(p.C,{isLoading:b,noMorePosts:Y,posts:D,onLoadMore:T}),"series"===C&&(0,a.Y)(U,{pub:o,user:m})]})})})]})})})}},94125:function(e,t,n){n.d(t,{w:()=>C});var i=n(4006),r=n(83673),a=n.n(r),l=n(38970),o=n.n(l),s=n(72102),c=n(17402),d=n(73869),u=n(82528),p=n(82011),h=n(63446),m=n(19397),g=n(15894),f=n(1918),v=n(8149),b=n(76977),y=n(39318),Y=n(72032);let _="letters@thefp.com",w="tips@thefp.com",C=e=>{let{pub:t,user:n}=e,{ids:r}=(0,f.i)({pub:t}),l=o()(t.authorPagesInfo,"user_id"),[C,k]=(0,c.useState)(!0),[S,I]=(0,c.useState)(!0),F=e=>{var n;let r=l[e];return r?{title:(0,i.FD)(b.Ye,{alignItems:"center",justifyContent:"space-between",paddingRight:32*!!r.primary_section_id,position:"relative",children:[(0,i.Y)(g.T,{preset:"h5-serif",children:r.name}),!!r.primary_section_id&&(0,i.Y)(p.L,{authorId:r.user_id,minimize:!0})]}),imageUrl:r.photo_url,description:r.bio,url:null!=(n=(0,y.cxh)({userId:r.user_id,pub:t}))?n:""}:null},D=a()(r.filter(e=>{var t;return!!(null==(t=l[e])?void 0:t.primary_section_id)}).map(F)),T=a()(r.filter(e=>{var t;return!(null==(t=l[e])?void 0:t.primary_section_id)}).map(F)),A=D.length>0;return(0,i.Y)(u.y,{actions:(0,i.Y)(d.m,{pub:t,sectionType:"who-we-are",user:null!=n?n:null}),description:(0,i.FD)(i.FK,{children:["If you have a letter to the editor, commenting on one of our stories, write to"," ",(0,i.Y)("a",{href:"mailto:".concat(_),rel:"noopener noreferrer",target:"_blank",children:_}),".",(0,i.Y)("br",{}),"To share a tip about story going on in your neighborhood or institution, write to"," ",(0,i.Y)("a",{href:"mailto:".concat(w),rel:"noopener noreferrer",target:"_blank",children:w}),"."]}),hideDivider:A,title:"Who We Are",children:(0,i.FD)(b.I1,{gap:40,children:[A&&(0,i.FD)(i.FK,{children:[(0,i.FD)(b.I1,{gap:8,children:[(0,i.FD)(b.Ye,{alignItems:"center",justifyContent:"space-between",children:[(0,i.Y)(g.T,{preset:"h4-sans-condensed",children:"Columnists"}),(0,i.Y)(h.v,{variant:"accordion",onClick:()=>{k(!C)},children:(0,i.Y)(s.A,{className:"".concat(Y.A.caret," ").concat(C?"":Y.A.collapsed),height:36,width:36})})]}),(0,i.Y)("div",{className:Y.A.thickRule})]}),(0,i.Y)(v.N,{open:C,children:(0,i.Y)(m.F,{applyHoverOnTitle:!1,hasMarkdownDescriptions:!0,items:D,justifyViewAllLabel:"start",showDescriptionOnMobile:!0,viewAllLabel:"Read more"})}),(0,i.FD)(b.I1,{gap:8,children:[(0,i.FD)(b.Ye,{alignItems:"center",justifyContent:"space-between",children:[(0,i.Y)(g.T,{preset:"h4-sans-condensed",children:"Staff Writers and Editors"}),(0,i.Y)(h.v,{variant:"accordion",onClick:()=>{I(!S)},children:(0,i.Y)(s.A,{className:"".concat(Y.A.caret," ").concat(S?"":Y.A.collapsed),height:36,width:36})})]}),(0,i.Y)("div",{className:Y.A.thickRule})]})]}),(0,i.Y)(v.N,{open:S,children:(0,i.Y)(m.F,{applyHoverOnTitle:!1,hasMarkdownDescriptions:!0,items:T,justifyViewAllLabel:"start",showDescriptionOnMobile:!0,viewAllLabel:"Read more"})})]})})}},91315:function(e,t,n){n.d(t,{V:()=>W});var i=n(4006),r=n(32485),a=n.n(r),l=n(75107),o=n(87677),s=n(17402),c=n(13950),d=n(72880),u=n(44815),p=n(22884);let h={coverImage:"coverImage-lDa1UL",headerImage:"headerImage-YvCrC1",datetimeInput:"datetimeInput-W3o29e",formLabel:"formLabel-YcWPTP",columnLabel:"columnLabel-FiYzFV",tabs:"tabs-pvo6fW",carouselSection:"carouselSection-o6Vatv",viewAll:"viewAll-G3ryYO",activeIndicator:"activeIndicator-QrOuU6",body:"body-jM2qDJ",header:"header-qyY_LG",section:"section-eGkqMh",overviewContent:"overviewContent-woD8Go",storyFilters:"storyFilters-TUKs8u",filterDrawer:"filterDrawer-xiacDR",halfWidth:"halfWidth-Kvs4D8",fullWidth:"fullWidth-huxevk",link:"link-d7W3vi",presentingSponsorItem:"presentingSponsorItem-iRdcBr",logoImage:"logoImage-n6AJcY",sponsorsSection:"sponsorsSection-sBBwhX",presentingSponsors:"presentingSponsors-IdhPjQ",associateSponsorItem:"associateSponsorItem-JmCeIG",associateSponsors:"associateSponsors-E6uJdd",eventSponsors:"eventSponsors-QajGni",accentText:"accentText-PJoM9f",clearAll:"clearAll-PlzbdB",grid2:"grid2-Qn3XQs",radioButton:"radioButton-xrh_v2",contentBlock:"contentBlock-ZJEFvK",thickDivider:"thickDivider-nMBiD6",subscribeButton:"subscribeButton-y1jTFS",authorCard:"authorCard-rbBteZ",eventCard:"eventCard-kqvX4w",eventsPreview:"eventsPreview-iW8fgn",manifesto:"manifesto-pnC01w",keepReading:"keepReading-zXEd47",gridContentWide:"gridContentWide-qDAfp5"},m=e=>{let{isAdmin:t,user:n,post:r,pub:a,eventId:l,goToEvent:o,refetchEvents:s,allEvents:c}=e,d=c.filter(e=>e.value.isA250);if(l){let e=d.find(e=>e.key===l);return(0,i.Y)("div",{className:h.body,children:(0,i.Y)(u.s,{eventData:e,eventId:l,goToEvent:o,post:r,pub:a,surface:"fp-america250",user:n})})}return(0,i.Y)("div",{className:h.body,children:(0,i.Y)(p.y,{allEvents:d,eventKeyPrefix:"event-",goToEvent:o,isA250:!0,isAdmin:t,post:r,pub:a,refetchEvents:s,showSeries:!1,user:n})})};var g=n(76977);let f=e=>{let{imageUrl:t,isEventPage:n,children:r}=e;return(0,i.Y)("div",{className:a()(n?"backgroundAlternate-_7s7DT":"background-TS_gqR"),children:(0,i.FD)("div",{className:a()(n?"containerAlternate-WGXWZq":"container-yxf71B"),children:[(0,i.Y)("img",{className:a()(n?"headerImageAlternate-Arp7Tv":"headerImage-Y8cPSt"),src:t}),(0,i.Y)(g.I1,{alignItems:"center",className:a()(n?"contentAlternate-Z6mfO4":"content-iscROM"),justifyContent:"center",position:"relative",textAlign:"center",children:r})]})})};var v=n(15894),b=n(52050);let y=e=>{let{sponsor:t}=e;return(0,i.FD)("a",{className:h.presentingSponsorItem,href:t.sponsorLink,target:"_blank",children:[(0,i.Y)("img",{alt:t.name,className:h.logoImage,src:t.imageUrl}),(0,i.Y)(v.T,{preset:"h6-sans",children:t.name})]})},Y=e=>{let{sponsor:t}=e;return(0,i.Y)("a",{className:h.associateSponsorItem,href:t.sponsorLink,target:"_blank",children:(0,i.Y)("img",{alt:t.name,className:h.logoImage,src:t.imageUrl})})},_=()=>(0,i.FD)("div",{className:h.body,children:[(0,i.FD)(g.Ye,{className:"".concat(b.A.gridContainer," ").concat(h.sponsorsSection),children:[(0,i.Y)("div",{children:(0,i.Y)(v.T,{className:h.header,preset:"st3",children:"PRESENTING SPONSORS"})}),(0,i.Y)(g.I1,{children:(0,i.Y)("div",{className:h.presentingSponsors,children:[{name:"Uber",imageUrl:"https://www.grapheine.com/wp-content/uploads/uber-logo.jpg",sponsorLink:"#"},{name:"Uber",imageUrl:"https://www.grapheine.com/wp-content/uploads/uber-logo.jpg",sponsorLink:"#"},{name:"Uber",imageUrl:"https://www.grapheine.com/wp-content/uploads/uber-logo.jpg",sponsorLink:"#"},{name:"Uber",imageUrl:"https://www.grapheine.com/wp-content/uploads/uber-logo.jpg",sponsorLink:"#"}].map(e=>(0,i.Y)(y,{sponsor:e},e.name))})})]}),(0,i.FD)(g.Ye,{className:"".concat(b.A.gridContainer," ").concat(h.sponsorsSection),children:[(0,i.Y)("div",{children:(0,i.Y)(v.T,{className:h.header,preset:"st3",children:"ASSOCIATE SPONSORS"})}),(0,i.Y)(g.I1,{children:(0,i.Y)("div",{className:h.associateSponsors,children:[{name:"Uber",imageUrl:"https://www.grapheine.com/wp-content/uploads/uber-logo.jpg",sponsorLink:"#"},{name:"Uber",imageUrl:"https://www.grapheine.com/wp-content/uploads/uber-logo.jpg",sponsorLink:"#"},{name:"Uber",imageUrl:"https://www.grapheine.com/wp-content/uploads/uber-logo.jpg",sponsorLink:"#"},{name:"Uber",imageUrl:"https://www.grapheine.com/wp-content/uploads/uber-logo.jpg",sponsorLink:"#"},{name:"Uber",imageUrl:"https://www.grapheine.com/wp-content/uploads/uber-logo.jpg",sponsorLink:"#"},{name:"Uber",imageUrl:"https://www.grapheine.com/wp-content/uploads/uber-logo.jpg",sponsorLink:"#"},{name:"Uber",imageUrl:"https://www.grapheine.com/wp-content/uploads/uber-logo.jpg",sponsorLink:"#"},{name:"Uber",imageUrl:"https://www.grapheine.com/wp-content/uploads/uber-logo.jpg",sponsorLink:"#"},{name:"Uber",imageUrl:"https://www.grapheine.com/wp-content/uploads/uber-logo.jpg",sponsorLink:"#"},{name:"Uber",imageUrl:"https://www.grapheine.com/wp-content/uploads/uber-logo.jpg",sponsorLink:"#"}].map(e=>(0,i.Y)(Y,{sponsor:e},e.name))})})]}),(0,i.FD)(g.Ye,{className:b.A.gridContainer,children:[(0,i.Y)("div",{children:(0,i.Y)(v.T,{className:h.header,preset:"st3",children:"PARTNERSHIPS"})}),(0,i.FD)(g.I1,{children:[(0,i.Y)(v.T,{preset:"h5-serif",style:{fontWeight:600,marginBottom:16},children:"Interested in sponsorship or advertising partnerships?"}),(0,i.FD)(v.T,{preset:"detail-small",style:{fontWeight:700},children:["Reach out to us at"," ",(0,i.Y)("a",{href:"mailto:partnerships@thefp.com",style:{color:"#f2312c"},children:"partnerships@thefp.com"})]})]})]})]});var w=n(57456),C=n(63446),k=n(68410),S=n(60355),I=n(16074),F=n(95477);let D=["all","videos","podcasts","articles"],T=()=>{let{isMobile:e}=(0,k.sM)(),[t,n]=(0,s.useState)("all"),[r,l]=(0,s.useState)(0),{result:o,hasMore:c}=(0,w.t)(r,20),d="all"===t?o:null==o?void 0:o.filter(e=>"podcast"===e.type&&!!e.podcast_url&&"podcasts"===t||"podcast"===e.type&&!!e.video_upload_id&&"videos"===t||"newsletter"===e.type&&"articles"===t||!1);return(0,i.Y)("div",{className:h.body,children:(0,i.FD)(g.Ye,{className:b.A.gridContainer,children:[(0,i.FD)(g.I1,{children:[(0,i.Y)(v.T,{className:h.header,preset:"st3",children:"STORIES"}),(0,i.Y)(v.T,{className:h.columnLabel,preset:"detail-large",children:"FILTER BY"}),e?(0,i.Y)(g.Ye,{className:h.storyFilters,gap:12,children:D.map(e=>(0,i.Y)(C.v,{className:a()(t===e?h.checked:""),variant:t===e?"outline":"inactive",onClick:()=>n(e),children:e.toUpperCase()},e))}):(0,i.Y)(g.I1,{gap:24,children:D.map(e=>(0,i.FD)(g.Ye,{gap:8,onClick:()=>n(e),children:[(0,i.Y)(F.s,{checked:t===e,name:"story-filter",theme:"dark",value:e}),(0,i.Y)(v.T,{preset:"detail-small",children:e.toUpperCase()})]},e))})]}),(0,i.FD)(g.I1,{className:h.section,gap:24,children:[null==d?void 0:d.map((e,t)=>(0,i.FD)(g.I1,{children:[(0,i.Y)(S.R,{post:e,variant:"archive"}),t<d.length-1&&(0,i.Y)(I.c,{paddingTop:24})]},e.id)),c&&(0,i.Y)(C.v,{onClick:()=>l(r+20),children:"Load More"})]})]})})};var A=n(38486),E=n(14739),N=n(57898),P=n(53696),x=n(25006),L=n(44333),O=n(68349),B=n(28528),M=n(16291),R=n(39318),U=n(9036);let j=e=>{let{isAdmin:t,isMobile:n,user:r,pub:c,goToTab:d,allEvents:u}=e,{result:p}=(0,w.t)(0,3),[m,f]=(0,s.useState)(!1),y=u.filter(e=>"published"===e.value.status&&e.value.dateTime&&new Date(e.value.dateTime)>new Date&&e.value.isA250).slice(0,3),Y=(null==y?void 0:y.length)===1;return(0,i.FD)(g.I1,{className:h.body,gap:24,children:[(0,i.FD)(g.Ye,{className:b.A.gridContainer,children:[(0,i.Y)(v.T,{className:h.header,preset:"st3",children:"Manifesto"}),(0,i.FD)(g.I1,{className:a()(h.manifesto,h.section),gap:12,children:[(0,i.Y)(v.T,{preset:"body",children:"America is turning 250. And we’re throwing a yearlong celebration of the greatest country on Earth."}),(0,i.Y)(v.T,{preset:"body",children:"The greatest? Yes. The greatest. "}),(0,i.Y)(v.T,{preset:"body",children:"We realize that’s not a popular thing to say these days. Americans have a way of taking this country for granted: A recent Gallup poll shows that American pride has reached a new low. And the world at large, which is wealthier and freer than it has ever been in history, thanks to American power and largesse, often resents us."}),(0,i.Y)(v.T,{preset:"body",children:" We get it. "}),(0,i.FD)(v.T,{preset:"body",children:["As journalists, we spend most of our time finding problems, exposing them. It’s what the job calls for."," "]}),(0,i.Y)(v.T,{preset:"body",children:"But if you only focus on the negatives, you get a distorted view of reality. As America hits this milestone birthday, it’s the perfect moment to step back and look closely at where we actually are—and the reality of life in America today compared to other times and places. That reality is pretty spectacular."}),!m&&(0,i.FD)(v.T,{className:h.keepReading,color:"accent",preset:"detail-large",onClick:()=>f(!0),children:["KEEP READING ",(0,i.Y)(l.A,{})]}),m&&(0,i.FD)(i.FK,{children:[(0,i.FD)(v.T,{preset:"body",children:[" ","Could Thomas Jefferson and the men gathered in Philadelphia who wrote down the words that made our world—We hold these truths to be self-evident, that all men are created equal, that they are endowed by their Creator with certain unalienable Rights, that among these are Life, Liberty and the pursuit of Happiness—ever have imagined what their declaration of independence would bring?"]}),(0,i.FD)(v.T,{preset:"body",children:[" ","The Constitution. The end of slavery—and the defeat of Hitler. Astonishing wealth and medical breakthroughs. Silicon Valley. The most powerful military in the world. The moon landing. Hollywood. The Hoover Dam. The Statue of Liberty (a gift from France). Actual liberation (a thing we gave France). Humphrey Bogart and Tom Hanks. Josephine Baker and Beyonc\xe9 Knowles. Hot dogs. Corn dogs. American Chinese food. American Italian food. The Roosevelts and the Kennedys. The Barrymores and the Fondas. Winston Churchill (his mom was from Brooklyn). The Marshall Plan and Thurgood Marshall. Star Wars. Missile defense shields. Baseball. Football. The military-industrial complex. Freedom of religion. UFO cults. Television. The internet. The pill. The Pope. The automobile, the airplane, and AI. Jazz and the blues. The polio vaccine and GLP-1s. The UFC and Dolly Parton."]}),(0,i.Y)(v.T,{preset:"body",children:" The list goes on because it’s really, truly endless."}),(0,i.Y)(v.T,{preset:"body",children:"Ours is a country where you can hear 800 languages spoken in New York City, drive two hours, and end up among the Amish in Pennsylvania. We are 342 million people, from California to New York Island, gathered together as one."}),(0,i.Y)(v.T,{preset:"body",children:"Each of those 342 million will tell you that ours is not a perfect country. But we suspect most of them would agree that their lives would not be possible without it."}),(0,i.FD)(v.T,{preset:"body",children:["So for the next 12 months, we’re going to toast to our freedoms. And we’re doing it the"," ",(0,i.Y)("em",{children:"Free Press"})," way: by delving into all of it—the bad and the good and the great, the strange and the wonderful and the wild."]})]})]})]}),(0,i.Y)(I.c,{}),(0,i.FD)(g.Ye,{className:b.A.gridContainer,children:[(0,i.Y)(v.T,{className:a()(h.upcomingEventsHeader,h.header),preset:"st3",children:"UPCOMING EVENTS"}),(0,i.FD)(g.I1,{className:a()(b.A.gridContentWide,h.section),children:[(0,i.FD)(v.T,{className:h.viewAll,color:"accent",preset:"detail-large",onClick:()=>d("events",void 0,!0),children:["View All ",(0,i.Y)(o.A,{})]}),(0,i.Y)(g.Ye,{className:a()(h.eventsPreview,!n&&Y?"desktop":void 0),gap:40,children:null==y?void 0:y.map(e=>(0,i.Y)(E.L,{eventConfig:e,goToEvent:e=>d("events",e,!0),hideIcons:!1,isAdmin:t,isMobile:n,pub:c,showSeries:!1,surface:"fp-america250",user:r},e.key))})]})]}),(0,i.Y)(I.c,{}),(0,i.FD)(g.Ye,{className:b.A.gridContainer,children:[(0,i.Y)(v.T,{className:h.header,preset:"st3",children:"STORIES"}),(0,i.FD)(g.I1,{className:a()(b.A.gridContentWide,h.section),children:[(0,i.FD)(v.T,{className:h.viewAll,color:"accent",preset:"detail-large",onClick:()=>d("stories",void 0,!0),children:["View All ",(0,i.Y)(o.A,{})]}),(0,i.Y)(g.pT,{className:h.overviewContent,direction:n?"column":"row",gap:40,children:null==p?void 0:p.map(e=>(0,i.Y)(S.R,{post:e,variant:n?"archive":"square"},e.id))})]})]})]})},z=e=>{let{activeTabId:t,tabs:n,onClick:r}=e;return(0,i.Y)(g.Ye,{children:n.map(e=>{let n=e.id===t;return(0,i.FD)(g.Ye,{cursor:"pointer",padding:16,position:"relative",role:"button",onClick:()=>{r(e.id)},children:[(0,i.Y)(v.T,{preset:"detail-large",children:e.title}),n&&(0,i.Y)("div",{className:h.activeIndicator})]})})})},H=e=>{let{event:t,pub:n,user:r,post:a}=e,l=t?(0,A.dN)(t.location):null;return t?(0,i.FD)(i.FK,{children:[(0,i.Y)(v.T,{color:"white",preset:"h2-serif",children:t.title}),(0,i.Y)(v.T,{color:"white",preset:"d1-sans-regular",children:t.dateTime&&"".concat((0,M.A)(t.dateTime).format("MMMM D, YYYY")," ").concat((0,M.A)(t.dateTime).format("h:mma"))}),(0,i.FD)(v.T,{color:"white",preset:"d1-sans-regular",children:[l," at ",t.place]}),(0,i.Y)(N.z,{event:t,isHeader:!0,post:a,pub:n,surface:"fp-america250",user:r})]}):null},W=e=>{var t;let{pub:n,user:r}=e,{isMobile:a}=(0,k.sM)(),{url:l}=(0,L.zy)(),o=(0,U.m)(l),[u,p]=(0,s.useState)(null!=(t=o.tab)?t:"overview"),[b,y]=(0,s.useState)(o.eventId),Y=(null==r?void 0:r.is_admin)&&!l.includes("hideAdmin"),{result:C,refetch:S}=(0,A.ZJ)(),I=(null==C?void 0:C.configs)||[],F=b?I.find(e=>e.key===b):void 0,D=null==F?void 0:F.value,E=(0,w.i)(null==D?void 0:D.postSlug);(0,s.useEffect)(()=>{var e;p(null!=(e=o.tab)?e:"overview"),y(o.eventId)},[l]);let N=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];p(e),y(t);let i=new URL(window.location.href),r=new URLSearchParams(i.search);r.set("tab",e),t?r.set("eventId",t):r.delete("eventId"),n?(0,O.V2)("".concat(i.pathname,"?").concat(r)):(0,O.dJ)("".concat(i.pathname,"?").concat(r))},M="events"===u&&b;return(0,i.Y)(x.Eo,{pub:n,children:(0,i.Y)(B.XL,{pub:n,children:(0,i.FD)(c.DH,{children:[(0,i.Y)(f,{imageUrl:M?(null==D?void 0:D.image)||"":(0,R.dJ9)("".concat((0,R.Ewe)(),"/img/thefp/").concat(a?"america250Mobile.png":"america250Final.png")),isEventPage:!!M,children:M?(0,i.Y)(i.FK,{children:(0,i.Y)(H,{event:D,post:E,pub:n,user:r})}):(0,i.FD)(i.FK,{children:[(0,i.Y)(v.T,{color:"white",preset:"h4-sans-condensed",style:{maxWidth:a?"400px":"312px"},children:"THE FREE PRESS PRESENTS"}),(0,i.Y)(d.o,{className:h.headerImage,maxWidth:a?250:400,src:(0,R.dJ9)("".concat((0,R.Ewe)(),"/img/thefp/americaAt250.png"))}),(0,i.Y)(v.T,{color:"white",preset:"d1-sans-regular",children:"An unprecedented series of premium events, conversations, and experiences celebrating America’s 250th."})]})}),(0,i.Y)(g.Ye,{className:h.tabs,justifyContent:"center",children:(0,i.Y)(z,{activeTabId:u,tabs:[{title:"Overview",id:"overview"},{title:"Events",id:"events"},{title:"Stories",id:"stories"}],onClick:e=>{e&&N(e)}})}),(0,i.Y)(P.r,{children:(0,i.Y)(g.I1,{alignSelf:"center",className:h.eventsContainer,gap:40,maxWidth:a?480:void 0,paddingBottom:64,children:(0,i.Y)(g.I1,{gap:32,children:(()=>{switch(u){case"overview":return(0,i.Y)(j,{allEvents:I,goToTab:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return N(e,t,n)},isAdmin:!!Y,isMobile:a,pub:n,user:r});case"events":return(0,i.Y)(m,{allEvents:(null==C?void 0:C.configs)||[],eventId:b,goToEvent:e=>N("events",e,!0),isAdmin:!!Y,post:E,pub:n,refetchEvents:S,user:r});case"stories":return(0,i.Y)(T,{});case"sponsors":return(0,i.Y)(_,{});default:return null}})()})})})]})})})}},57456:function(e,t,n){n.d(t,{i:()=>l,t:()=>a});var i=n(17402),r=n(12501);let a=function(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,[a,l]=(0,i.useState)([]),[o,s]=(0,i.useState)(!0),c=(0,r.st)({pathname:"/api/v1/archive",query:{sort:"new",limit:n,offset:e,post_tag_id:"d4bbb715-5635-4137-8f5f-aaf89ed80ca9"},auto:!0,deps:[e]});return(0,i.useEffect)(()=>{!o&&c.isLoading?s(!0):!c.isLoading&&o&&c.result&&(l(e=>[...e,...c.result||[]]),s(!1))},[c.result,c.isLoading]),{result:a,hasMore:!c.isLoading&&(null==(t=c.result)?void 0:t.length)===n}},l=e=>{let t=(0,r.st)({pathname:"/api/v1/posts/".concat(e),query:{preview:!0},auto:!1});return(0,i.useEffect)(()=>{e&&t.refetch()},[e]),e?t.result:null}},14739:function(e,t,n){n.d(t,{L:()=>Y});var i=n(69277),r=n(70408),a=n(4006),l=n(32485),o=n.n(l),s=n(32307),c=n(76069),d=n(72880),u=n(57456),p=n(38486),h=n(57898),m=n(15894),g=n(17306),f=n(76977),v=n(16291),b=n(39862);let y={eventCard:"eventCard-uFRmX6",eventCardHeader:"eventCardHeader-uVMduR",eventCardTitle:"eventCardTitle-HyD3H8",eventActions:"eventActions-UyJo9k",eventTypes:"eventTypes-DizLQi",eventDescription:"eventDescription-MzE2D1",typeTag:"typeTag-dtvX8u","in-person":"in-person-bGFEFa",inPerson:"in-person-bGFEFa",livestream:"livestream-EzMp0v",actionButton:"actionButton-CdUeYP",deleteButton:"deleteButton-EwTebW",eventStatusLabel:"eventStatusLabel-Jeu7Gn",eventCardBottom:"eventCardBottom-HEIxGW",coverImage:"coverImage-EDvboy",eventSeriesLink:"eventSeriesLink-VmrOOC"},Y=e=>{let{eventConfig:t,hideIcons:n,goToEvent:l,goToSeries:Y,onEdit:_,onDelete:w,user:C,pub:k,isAdmin:S,isMobile:I,surface:F,showSeries:D}=e,T=(0,u.i)(t.value.postSlug),{markdownProps:A}=(0,g.$)(t.value.description);return(0,a.FD)("div",{className:y.eventCard,onClick:()=>l(t.key),children:[S&&_&&w&&(0,a.FD)("div",{className:y.eventActions,children:[(0,a.Y)("button",{className:y.actionButton,onClick:e=>{e.stopPropagation(),_(t)},children:"Edit"}),(0,a.Y)("button",{className:"".concat(y.actionButton," ").concat(y.deleteButton),onClick:e=>{e.stopPropagation(),w(t.key)},children:"Delete"}),(0,a.Y)("span",{className:y.eventStatusLabel,children:t.value.status})]}),(0,a.Y)(d.o,{className:y.coverImage,maxWidth:310,src:t.value.placeholderImage,onClick:()=>l(t.key)}),(0,a.FD)(f.I1,{className:y.eventCardHeader,gap:8,onClick:()=>l(t.key),children:[(0,a.Y)(m.T,{className:y.eventCardTitle,preset:"h4-sans-condensed",children:t.value.title}),D&&I&&t.value.series&&(0,a.Y)(m.T,{className:y.eventSeriesLink,color:"accent",preset:"detail-small",onClick:()=>t.value.series&&(null==Y?void 0:Y(t.value.series)),children:b.n[t.value.series]}),(0,a.FD)(f.I1,{gap:8,children:[(0,a.FD)(m.T,{color:"tertiary",preset:"detail-small",children:[!n&&(0,a.Y)(s.A,{size:16}),t.value.dateTime&&(0,v.A)(t.value.dateTime).format("MMMM D, YYYY")]}),(0,a.FD)(m.T,{color:"tertiary",preset:"detail-small",children:[!n&&(0,a.Y)(c.A,{size:16})," ",(0,p.dN)(t.value.location)]})]}),(0,a.Y)(f.pT,{className:y.eventTypes,direction:I?"column":"row",children:(Array.isArray(t.value.type)?t.value.type:[t.value.type]).map(e=>(0,a.Y)("span",{className:o()(y.typeTag,y[e.toString()]),children:(0,a.Y)(m.T,{preset:"detail-large",children:e})}))})]}),(0,a.FD)(f.I1,{className:y.eventCardBottom,onClick:e=>e.stopPropagation(),children:[(0,a.FD)(f.I1,{gap:8,children:[D&&!I&&t.value.series&&(0,a.Y)(m.T,{className:y.eventSeriesLink,color:"accent",preset:"detail-small",onClick:()=>t.value.series&&(null==Y?void 0:Y(t.value.series)),children:b.n[t.value.series]}),(0,a.Y)(m.T,(0,r._)((0,i._)({},A),{clamp:3,className:y.eventDescription,preset:"body"}))]}),(0,a.Y)(h.z,{event:t.value,isHeader:!1,post:T,pub:k,surface:F,user:C})]})]})}},44815:function(e,t,n){n.d(t,{s:()=>F});var i=n(69277),r=n(70408),a=n(4006),l=n(32485),o=n.n(l),s=n(87677),c=n(60250),d=n(72880),u=n(57456),p=n(38486),h=n(57898),m=n(82011),g=n(15894),f=n(32600),v=n(17306),b=n(11574),y=n(68410),Y=n(60355),_=n(16074),w=n(76977),C=n(16291),k=n(52050);let S=e=>{let{author:t,isMobile:n}=e,l=parseInt(t.id,10),{hasSection:o}=(0,f.C)(l),{markdownProps:c}=(0,v.$)(null==t?void 0:t.bio);return(0,a.FD)(w.I1,{className:k.A.authorCard,gap:8,children:[(0,a.FD)(w.pT,{direction:n?"row":"column",gap:8,children:[(null==t?void 0:t.imageUrl)&&(0,a.Y)(d.o,{maxWidth:n?90:310,src:null==t?void 0:t.imageUrl,width:n?90:"100%"}),(0,a.FD)(w.I1,{gap:8,justifyContent:"end",position:n?void 0:"relative",children:[(0,a.Y)(g.T,{preset:"h5-serif",children:null==t?void 0:t.name}),(0,a.Y)(g.T,{preset:"detail-large",children:null==t?void 0:t.role}),o&&(0,a.Y)(m.L,{authorId:l,className:k.A.subscribeButton,minimize:!n})]})]}),(0,a.Y)(g.T,(0,r._)((0,i._)({},c),{preset:"d3-serif"})),(null==t?void 0:t.handle)&&(0,a.FD)(g.T,{as:"a",className:k.A.link,href:"/w/".concat(t.handle),preset:"detail-large",children:["READ MORE ",(0,a.Y)(s.A,{})]})]},t.id)},I=e=>{let{event:t,post:n,isMobile:i}=e,r=(null==t?void 0:t.dateTime)&&new Date(t.dateTime)<new Date&&(null==t?void 0:t.postSlug);return n?(0,a.FD)(a.FK,{children:[(0,a.FD)(w.I1,{gap:40,children:[r&&(0,a.Y)(g.T,{preset:"st3",children:"IN CASE YOU MISSED IT..."}),(0,a.Y)(w.Ye,{className:i?"":k.A.halfWidth,children:(0,a.Y)(Y.R,{post:n,variant:i?"archive":"square"},n.id)})]}),(0,a.Y)(_.c,{paddingY:64})]}):null},F=e=>{var t,n;let{eventId:l,pub:s,user:m,post:f,goToEvent:Y,eventData:F,surface:D}=e,{isMobile:T}=(0,y.sM)(),{result:A}=(0,p.uL)(l),{result:E}=(0,u.t)(0,5),N=(null==F?void 0:F.value)||(null==A||null==(t=A.config)?void 0:t.value),{markdownProps:P}=(0,v.$)(null==N?void 0:N.description),x=null==N?void 0:N.speakers;return F||A?N?(0,a.FD)(a.FK,{children:[(0,a.FD)(w.Ye,{className:k.A.gridContainer,gap:40,children:[(0,a.FD)(w.I1,{gap:24,children:[(0,a.FD)(g.T,{className:k.A.link,preset:"detail-large",onClick:()=>Y(),children:[(0,a.Y)(c.A,{})," BACK TO EVENTS"]}),(0,a.Y)(g.T,{preset:"st3",children:N.title}),(0,a.FD)(w.I1,{children:[(0,a.Y)(g.T,{preset:"d2-serif",children:N.dateTime&&(0,C.A)(N.dateTime).format("MMMM D, YYYY")}),(0,a.Y)(g.T,{preset:"d2-serif",children:N.dateTime&&(0,C.A)(N.dateTime).format("h:mma")}),(0,a.FD)(g.T,{preset:"d2-serif",children:[(0,p.dN)(N.location)," at ",N.place]})]}),(0,a.Y)(w.Ye,{gap:8,children:(Array.isArray(N.type)?N.type:[N.type]).map(e=>(0,a.Y)("span",{className:o()(k.A.typeTag,k.A[e.toString()]),children:(0,a.Y)(g.T,{preset:"detail-large",children:e})},e.toString()))}),(0,a.Y)(h.z,{event:N,isDetailView:!0,isHeader:!1,post:f,pub:s,surface:D,user:m}),T&&(0,a.Y)(_.c,{paddingTop:24})]}),(0,a.FD)(w.I1,{children:[(0,a.Y)(g.T,(0,r._)((0,i._)({},P),{preset:"body"})),(0,a.Y)(_.c,{paddingY:T?40:64}),!!(null==x?void 0:x.length)&&(0,a.FD)(a.FK,{children:[(0,a.FD)(w.I1,{gap:24,children:[(0,a.Y)(g.T,{preset:"st3",children:"PRESENTING"}),(0,a.Y)(w.pT,{className:k.A.speakerContainer,direction:T?"column":"row",gap:40,children:null==x?void 0:x.map((e,t)=>(0,a.Y)(S,{author:e,isMobile:T},t))})]}),(0,a.Y)(_.c,{paddingY:T?40:64})]}),(0,a.Y)(I,{event:N,isMobile:T,post:f}),!!N.sponsors.length&&(0,a.FD)(a.FK,{children:[(0,a.FD)(w.I1,{gap:24,children:[(0,a.Y)(g.T,{preset:"st3",children:"SPONSORS"}),(0,a.Y)("div",{className:k.A.eventSponsors,children:null==(n=N.sponsors)?void 0:n.map((e,t)=>(0,a.Y)("a",{href:null==e?void 0:e.sponsorLink,style:{textDecoration:"none"},target:"_blank",children:(0,a.FD)(w.I1,{gap:16,children:[(null==e?void 0:e.imageUrl)&&(0,a.Y)(d.o,{maxWidth:T?90:310,src:null==e?void 0:e.imageUrl,width:T?90:void 0}),(0,a.Y)(g.T,{preset:"h6-sans",children:e.name})]},t)}))})]}),(0,a.Y)(_.c,{paddingY:T?40:64})]}),(0,a.FD)(w.I1,{gap:16,children:[(0,a.Y)(g.T,{preset:"h5-serif",children:"Interested in sponsorship or advertising partnerships?"}),(0,a.FD)(g.T,{preset:"detail-large",children:["REACH OUT TO US AT ",(0,a.Y)("span",{className:k.A.accentText,children:"PARTNERSHIPS@THEFP.COM"})]})]}),!T&&(0,a.Y)(_.c,{paddingBottom:80,paddingTop:64})]})]}),!T&&(0,a.Y)("div",{className:k.A.contentBlock,children:(0,a.Y)(b.$,{headerVariant:"align-right",posts:E,title:"More from The Free Press",variant:"large-in-middle"})})]}):(0,a.FD)(w.Ye,{className:k.A.gridContainer,children:[(0,a.Y)(w.I1,{children:(0,a.Y)(g.T,{preset:"st3",children:"Event Not Found"})}),(0,a.Y)(w.I1,{children:(0,a.Y)(g.T,{preset:"body",children:"The requested event could not be found."})})]}):(0,a.FD)(w.Ye,{className:k.A.gridContainer,children:[(0,a.Y)(w.I1,{children:(0,a.Y)(g.T,{preset:"st3",children:"Loading..."})}),(0,a.Y)(w.I1,{children:(0,a.Y)(g.T,{preset:"body",children:"Loading event details..."})})]})}},22884:function(e,t,n){n.d(t,{y:()=>W});var i=n(4006),r=n(32485),a=n.n(r),l=n(72102),o=n(60250),s=n(17402),c=n(17988),d=n(69277),u=n(70408),p=n(63446),h=n(6641),m=n(13482),g=n(15894),f=n(12501),v=n(68349),b=n(60322),y=n(21258),Y=n(49045),_=n(48535),w=n(76977),C=n(84270),k=n(60141),S=n(36372),I=n(44289),F=n(39862),D=n(52050);let T=e=>{let{label:t,children:n}=e;return(0,i.FD)(w.I1,{gap:12,children:[(0,i.Y)(g.T,{color:"primary",preset:"body",children:t}),n]})},A=e=>{let{children:t,onRemove:n}=e;return(0,i.FD)(w.I1,{gap:16,padding:16,style:{border:"1px solid var(--color-detail)",borderRadius:"8px",backgroundColor:"var(--color-secondary)"},children:[n&&(0,i.Y)(w.Ye,{justifyContent:"end",children:(0,i.Y)(p.v,{size:"sm",variant:"outline",onClick:n,children:"Remove"})}),t]})},E=e=>{let{children:t}=e;return(0,i.Y)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},children:t})},N=[{value:"",label:"None"},...Object.entries(F.n).map(e=>{let[t,n]=e;return{label:n,value:t}})],P=e=>{var t;let{pub:n,isOpen:r,isA250Page:a=!1,onClose:l,onEventCreated:o,editingEvent:c=null}=e,F=(0,S.d)(),P=!!c,[x,L]=(0,s.useState)(()=>c?(0,u._)((0,d._)({},c.value),{speakers:c.value.speakers||[],sponsors:c.value.sponsors||[],dateTime:new Date(c.value.dateTime)}):{title:"",description:"",placeholderImage:"",dateTime:new Date,place:"",image:"",location:"",ticketLink:"",postSlug:"",speakers:[],sponsors:[],type:["in-person"],isA250:a}),[O,B]=(0,s.useState)(!1),{refetch:M}=(0,f.st)({pathname:"/api/v1/islands/client/config",auto:!1,method:"PUT"}),{refetch:R}=(0,f.st)({pathname:"/api/v1/islands/client/config",auto:!1,method:"PUT"});(0,s.useEffect)(()=>{c?L((0,u._)((0,d._)({},c.value),{speakers:c.value.speakers||[],sponsors:c.value.sponsors||[],dateTime:new Date(c.value.dateTime)})):L({title:"",description:"",placeholderImage:"",dateTime:new Date,place:"",image:"",location:"",ticketLink:"",postSlug:"",speakers:[],sponsors:[],type:["in-person"],isA250:a})},[c]);let U=async e=>{e.preventDefault(),B(!0);try{let e=(0,d._)({},x);if(P&&c)await R({query:{key:c.key},json:{value:e}}),F.popToast(()=>(0,i.Y)(S.y,{text:"Event updated successfully!"}));else{let t="event-".concat((()=>{let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t="";for(let n=0;n<10;n++)t+=e.charAt(Math.floor(Math.random()*e.length));return t})());await M({query:{key:t},json:{value:e}}),F.popToast(()=>(0,i.Y)(S.y,{text:"Event created successfully!"}))}l(),o()}catch(t){let e=P?"updating":"creating";F.popToast(()=>(0,i.Y)(S.y,{text:"Error ".concat(e," event: ").concat((0,v.uX)(t))}))}finally{B(!1)}},j=(e,t,n)=>{L((0,u._)((0,d._)({},x),{speakers:x.speakers.map((i,r)=>r===e?(0,u._)((0,d._)({},i),{[t]:n}):i)}))},z=(null==(t=n.authorPagesInfo)?void 0:t.filter(e=>[...I.q,"byline"].includes(e.role)).filter(e=>!x.speakers.find(t=>t.id===e.user_id.toString())))||[],H=(e,t)=>{L((0,u._)((0,d._)({},x),{sponsors:x.sponsors.map(n=>n.name===e.name?t:n)}))};return(0,i.Y)(h.S,{isOpen:r,width:600,onClose:l,children:(0,i.FD)(w.I1,{className:D.A.modal,gap:24,paddingBottom:24,children:[(0,i.Y)(g.T,{preset:"h4-sans-condensed",children:P?"Edit Event":"Add New Event"}),(0,i.Y)("form",{onSubmit:U,children:(0,i.FD)(w.I1,{gap:20,children:[(0,i.Y)(C.z,{options:[{value:"draft",label:"Draft"},{value:"published",label:"Published"}],value:x.status||"draft",onChange:e=>{L((0,u._)((0,d._)({},x),{status:e}))}}),(0,i.Y)(k.A,{label:"Title",value:x.title||"",onChange:e=>L((0,u._)((0,d._)({},x),{title:e}))}),(0,i.Y)(T,{label:"Description",children:(0,i.Y)(m.X,{placeholder:"Event description...",value:x.description||"",onChange:e=>L((0,u._)((0,d._)({},x),{description:e.target.value}))})}),(0,i.Y)(T,{label:"Date & Time",children:(0,i.Y)(_.ZZ,{value:x.dateTime,onChange:e=>L((0,u._)((0,d._)({},x),{dateTime:new Date(e.currentTarget.value)}))})}),(0,i.Y)(k.A,{label:"Place/Venue",placeHolder:"The Empire State Building",value:x.place||"",onChange:e=>L((0,u._)((0,d._)({},x),{place:e}))}),(0,i.Y)(k.A,{label:"Location",placeHolder:"20 W 34th St., New York, NY",value:x.location||"",onChange:e=>L((0,u._)((0,d._)({},x),{location:e}))}),(0,i.Y)(T,{label:"Event Type",children:(0,i.Y)(y.K,{options:[{value:"in-person",label:"In Person"},{value:"livestream",label:"Livestream"}],value:x.type||["in-person"],onChange:e=>L((0,u._)((0,d._)({},x),{type:e}))})}),(0,i.Y)(k.A,{label:"Main Image URL",value:x.image||"",onChange:e=>L((0,u._)((0,d._)({},x),{image:e}))}),(0,i.Y)(k.A,{label:"Thumbnail Image URL",value:x.placeholderImage||"",onChange:e=>L((0,u._)((0,d._)({},x),{placeholderImage:e}))}),(0,i.Y)(k.A,{label:"Ticket Link",placeHolder:"https://...",value:x.ticketLink||"",onChange:e=>L((0,u._)((0,d._)({},x),{ticketLink:e}))}),(0,i.FD)(T,{label:"Additional Options",children:[(0,i.FD)(w.Ye,{alignItems:"center",gap:8,children:[(0,i.Y)(b.S,{checked:!!x.isSoldOut,onChange:e=>L((0,u._)((0,d._)({},x),{isSoldOut:e}))}),(0,i.Y)(g.T,{preset:"body",children:"Is Sold Out"})]}),(0,i.FD)(w.Ye,{alignItems:"center",gap:8,children:[(0,i.Y)(b.S,{checked:!!x.isPostponed,onChange:e=>L((0,u._)((0,d._)({},x),{isPostponed:e}))}),(0,i.Y)(g.T,{preset:"body",children:"Is Postponed"})]}),(0,i.FD)(w.Ye,{alignItems:"center",gap:8,children:[(0,i.Y)(b.S,{checked:!!x.isCanceled,onChange:e=>L((0,u._)((0,d._)({},x),{isCanceled:e}))}),(0,i.Y)(g.T,{preset:"body",children:"Is Canceled"})]}),(0,i.FD)(w.Ye,{alignItems:"center",gap:8,children:[(0,i.Y)(b.S,{checked:!!x.isA250,onChange:e=>L((0,u._)((0,d._)({},x),{isA250:e}))}),(0,i.Y)(g.T,{preset:"body",children:"Is America 250 Event"})]})]}),(0,i.Y)(k.A,{label:"Associated Post Slug",placeHolder:"Post slug",value:x.postSlug||"",onChange:e=>L((0,u._)((0,d._)({},x),{postSlug:e}))}),(0,i.Y)(k.A,{label:"LiveStream Id",placeHolder:"",value:x.liveStreamId||"",onChange:e=>L((0,u._)((0,d._)({},x),{liveStreamId:e}))}),(0,i.Y)(T,{label:"Speakers",children:(0,i.FD)(w.I1,{gap:16,children:[x.speakers.map((e,t)=>(0,i.FD)(A,{onRemove:()=>{L((0,u._)((0,d._)({},x),{speakers:x.speakers.filter((e,n)=>n!==t)}))},children:[(0,i.FD)(E,{children:[(0,i.Y)(k.A,{label:"Name",value:e.name,onChange:e=>j(t,"name",e)}),(0,i.Y)(k.A,{label:"Role",value:e.role,onChange:e=>j(t,"role",e)})]}),(0,i.FD)(E,{children:[(0,i.Y)(k.A,{label:"Handle",value:e.handle||"",onChange:e=>j(t,"handle",e)}),(0,i.Y)(k.A,{label:"Image URL",value:e.imageUrl||"",onChange:e=>j(t,"imageUrl",e)})]}),(0,i.Y)(k.A,{label:"Bio",value:e.bio||"",onChange:e=>j(t,"bio",e)})]},t)),(0,i.FD)(w.I1,{gap:8,children:[(0,i.Y)(g.T,{color:"primary",preset:"body",children:"Add Speaker"}),(0,i.Y)(Y.Z,{options:z.map(e=>({value:e.user_id,label:e.name})),placeholder:"Search and select a publication user...",value:null,onChange:e=>{e&&(e=>{var t;let i=null==(t=n.authorPagesInfo)?void 0:t.find(t=>t.user_id===e);if(i&&!x.speakers.find(t=>t.id===e.toString())){let t={id:e.toString(),name:i.name,role:"",handle:i.handle||void 0,bio:i.bio||void 0,imageUrl:i.photo_url||void 0,isCustom:!1};L((0,u._)((0,d._)({},x),{speakers:[...x.speakers,t]}))}})(e)}})]})]})}),(0,i.Y)(T,{label:"Sponsors",children:(0,i.FD)(w.I1,{gap:16,children:[x.sponsors.map((e,t)=>(0,i.FD)(A,{onRemove:()=>{var t;return t=e.name,void L((0,u._)((0,d._)({},x),{sponsors:x.sponsors.filter(e=>{let{name:n}=e;return n!==t})}))},children:[(0,i.FD)(E,{children:[(0,i.Y)(k.A,{label:"Name",value:e.name,onChange:t=>H(e,(0,u._)((0,d._)({},e),{name:t}))}),(0,i.Y)(k.A,{label:"Image URL",value:e.imageUrl,onChange:t=>H(e,(0,u._)((0,d._)({},e),{imageUrl:t}))})]}),(0,i.Y)(k.A,{label:"Sponsor Link",placeHolder:"https://...",value:e.sponsorLink||"",onChange:t=>H(e,(0,u._)((0,d._)({},e),{sponsorLink:t}))})]},t)),(0,i.Y)(p.v,{variant:"outline",onClick:()=>{L((0,u._)((0,d._)({},x),{sponsors:[...x.sponsors,{name:"New Sponsor",imageUrl:"",sponsorLink:""}]}))},children:"Add Sponsor"})]})}),(0,i.Y)(T,{label:"Series",children:(0,i.Y)(C.z,{options:N,value:x.series||"",onChange:e=>L((0,u._)((0,d._)({},x),{series:e}))})}),(0,i.FD)(w.Ye,{gap:16,justifyContent:"end",children:[(0,i.Y)(p.v,{disabled:O,variant:"outline",onClick:l,children:"Cancel"}),(0,i.Y)(p.v,{disabled:O,type:"submit",variant:"primary",children:O?P?"Updating...":"Creating...":P?"Update Event":"Add Event"})]})]})})]})})};var x=n(38486),L=n(14739),O=n(89490),B=n(16074);let M=e=>{let{filterValue:t,onChangeDate:n,eventDates:r}=e;return(0,i.Y)(w.pT,{className:D.A.filterDrawer,direction:"column",gap:16,children:Object.entries(r).map(e=>(0,i.FD)(w.I1,{alignItems:"start",gap:8,children:[(0,i.Y)(g.T,{color:"tertiary",preset:"detail-large",children:e[0]}),(0,i.Y)("div",{className:D.A.gridDrawer,children:e[1].map(r=>{var a;let l="".concat(e[0],"-").concat(r);return(0,i.FD)(w.Ye,{gap:8,children:[(0,i.Y)(b.S,{checked:!!(null==(a=t.dates)?void 0:a.includes(l)),name:l,onChange:e=>n(e,l)}),(0,i.Y)(g.T,{align:"left",preset:"detail-small",whiteSpace:"normal",onClick:()=>{var e;return n(!(null==(e=t.dates)?void 0:e.includes(l)),l)},children:r})]},l)})})]},e[0]))})},R=e=>{let{eventLocations:t,filterValue:n,onChangeLocation:r}=e;return(0,i.Y)(w.I1,{className:D.A.filterDrawer,gap:8,children:(0,i.Y)(w.I1,{gap:8,children:t.map(e=>{var t;return(0,i.FD)(w.Ye,{alignItems:"center",gap:8,children:[(0,i.Y)(b.S,{checked:!!(null==(t=n.locations)?void 0:t.includes(e)),name:e,onChange:t=>r(t,e)}),(0,i.Y)(g.T,{align:"left",preset:"detail-small",whiteSpace:"normal",onClick:()=>{var t;return r(!(null==(t=n.locations)?void 0:t.includes(e)),e)},children:e})]},e)})})})},U=e=>{var t,n;let{filterValue:r,onChangeType:a}=e;return(0,i.Y)("div",{className:D.A.filterDrawer,children:(0,i.FD)("div",{className:D.A.gridDrawer,children:[(0,i.FD)(w.Ye,{alignItems:"center",gap:8,children:[(0,i.Y)(b.S,{checked:!!(null==(t=r.types)?void 0:t.includes("in-person")),name:"IN-PERSON",onChange:e=>a(e,"in-person")}),(0,i.Y)(g.T,{align:"left",preset:"detail-small",whiteSpace:"normal",children:"IN-PERSON"})]}),(0,i.FD)(w.Ye,{alignItems:"center",gap:8,children:[(0,i.Y)(b.S,{checked:!!(null==(n=r.types)?void 0:n.includes("livestream")),name:"LIVESTREAM",onChange:e=>a(e,"livestream")}),(0,i.Y)(g.T,{align:"left",preset:"detail-small",whiteSpace:"normal",children:"LIVESTREAM"})]})]})})},j=e=>{let{eventSeries:t,filterValue:n,onChangeSeries:r}=e;return(0,i.Y)(w.I1,{className:D.A.filterDrawer,gap:8,children:(0,i.Y)(w.I1,{gap:8,children:t.map(e=>{var t;return(0,i.FD)(w.Ye,{alignItems:"center",gap:8,children:[(0,i.Y)(b.S,{checked:!!(null==(t=n.series)?void 0:t.includes(e)),name:e,onChange:t=>r(t,e)}),(0,i.Y)(g.T,{align:"left",preset:"detail-small",whiteSpace:"normal",onClick:()=>{var t;return r(!(null==(t=n.series)?void 0:t.includes(e)),e)},children:F.n[e]})]},e)})})})},z=e=>{let{filter:t,openFilters:n,isMobile:r,numberOfFilters:o,setOpenFilters:s,children:c}=e,d=n.includes(t);return(0,i.Y)(p.v,{className:D.A.filterButton,variant:"accordion",children:(0,i.FD)(w.I1,{className:D.A.filterButton,children:[(0,i.FD)(w.Ye,{className:a()(D.A.filterLabel,d?D.A.isOpen:""),justifyContent:"space-between",onClick:()=>{s(n.includes(t)?n.filter(e=>e!==t):r?[t]:[...n,t])},children:[(0,i.FD)(g.T,{color:d?"accent":"tertiary",preset:"detail-large",children:[t.toUpperCase(),o>0&&" (".concat(o,")")]}),(0,i.Y)(l.A,{className:"".concat(D.A.caret," ").concat(d?"":D.A.collapsed),height:36,width:36})]}),d&&(0,i.Y)("div",{className:D.A.filterInput,children:c})]})})},H=e=>{let{seriesConfig:t,goToSeries:n,isMobile:r}=e;return(0,i.FD)(i.FK,{children:[(0,i.Y)(O.az,{className:a()(D.A.thickDivider,D.A.gridContainer)}),(0,i.FD)(w.Ye,{className:a()(D.A.gridContainer,D.A.minusPadding),gap:40,children:[(0,i.Y)(w.I1,{className:D.A.eventFilterSidebar,gap:24*!r,paddingTop:24*!!r,children:(0,i.Y)(g.T,{preset:"st3",children:"EVENT SERIES"})}),(0,i.Y)(w.Ye,{className:a()(D.A.gridContentWide),gap:16,overflowX:"auto",children:null==t?void 0:t.map(e=>(0,i.FD)(w.I1,{className:D.A.seriesItem,gap:8,width:r?200:300,onClick:()=>null==n?void 0:n(e.id),children:[(0,i.Y)("img",{alt:"Logo for ".concat(e.title),src:e.imageUrl}),(0,i.Y)(g.T,{preset:"h5-sans",children:e.title}),(0,i.Y)(g.T,{clamp:3,preset:"body",children:e.description})]},e.title))})]})]})},W=e=>{var t,n,r,a;let{isAdmin:l,user:d,pub:u,goToEvent:h,goToSeries:m,refetchEvents:b,allEvents:y,seriesConfig:Y,showSeries:_=!1,showBackToEvents:C=!1,isA250:k=!1}=e,I=(0,c.useMediaQuery)({query:"only screen and (max-width: 834px)"}),F=(0,c.useMediaQuery)({query:"only screen and (max-width: 768px)"}),[T,A]=(0,s.useState)(!1),[E,N]=(0,s.useState)(null),O=(0,S.d)(),{refetch:W}=(0,f.st)({pathname:"/api/v1/islands/client/config",auto:!1,method:"DELETE"}),V=(0,s.useMemo)(()=>y.map(e=>e.value),[y]),{openFilters:K,filterValue:q,eventLocations:G,eventDates:J,eventSeries:$,setOpenFilters:Z,onChangeDate:Q,onChangeLocation:X,onChangeType:ee,onChangeSeries:et,resetFilters:en}=(0,x.dB)(V),ei=e=>{N(e),A(!0)},er=async e=>{if(confirm("Are you sure you want to delete this event?"))try{await W({query:{key:e}}),O.popToast(()=>(0,i.Y)(S.y,{text:"Event deleted successfully!"})),b()}catch(e){O.popToast(()=>(0,i.Y)(S.y,{text:"Error deleting event: ".concat((0,v.uX)(e))}))}},ea=(0,x.qb)(y,q,!!l),el=ea.filter(e=>new Date(e.value.dateTime)>new Date),eo=(0,s.useMemo)(()=>{let e=ea.filter(e=>new Date(e.value.dateTime)<new Date);return e.sort((e,t)=>new Date(t.value.dateTime).getTime()-new Date(e.value.dateTime).getTime()),e.slice(0,5)},[ea]);return(0,i.FD)(i.FK,{children:[C&&F&&(0,i.FD)(g.T,{className:D.A.link,preset:"detail-large",onClick:()=>h(),children:[(0,i.Y)(o.A,{})," BACK TO ALL EVENTS"]}),F&&(0,i.FD)(w.I1,{className:D.A.gridElement,gap:40,children:[(0,i.Y)(g.T,{preset:"st3",children:"Upcoming Events"}),(0,i.Y)(g.T,{preset:"detail-large",children:"Filter by"})]}),(0,i.FD)(w.Ye,{className:D.A.gridContainer,gap:40,paddingTop:F?24:32,children:[(0,i.FD)(w.I1,{className:D.A.eventFilterSidebar,gap:24*!F,children:[C&&!F&&(0,i.FD)(g.T,{className:D.A.link,preset:"detail-large",onClick:()=>h(),children:[(0,i.Y)(o.A,{})," BACK TO ALL EVENTS"]}),l&&(0,i.Y)(w.Ye,{paddingTop:12,children:(0,i.Y)(p.v,{variant:"primary",onClick:()=>A(!0),children:"Add Event"})}),!F&&(0,i.FD)(w.Ye,{justifyContent:"space-between",children:[(0,i.Y)(g.T,{preset:"detail-large",children:"Filter By"}),(0,i.Y)(g.T,{className:D.A.clearAll,color:"tertiary",preset:"detail-large",onClick:()=>{Z([]),en()},children:"Clear All"})]}),(0,i.FD)("div",{className:D.A.eventFiltersContainer,children:[(0,i.FD)(w.pT,{className:D.A.eventFilters,direction:F?"row":"column",children:[(0,i.Y)(z,{filter:"date",isMobile:F,numberOfFilters:(null==(t=q.dates)?void 0:t.length)||0,openFilters:K,setOpenFilters:Z,children:!F&&(0,i.Y)(M,{eventDates:J,filterValue:q,onChangeDate:Q})}),!F&&(0,i.Y)(B.c,{className:D.A.fullWidth}),(0,i.Y)(z,{filter:"location",isMobile:F,numberOfFilters:(null==(n=q.locations)?void 0:n.length)||0,openFilters:K,setOpenFilters:Z,children:!F&&(0,i.Y)(R,{eventLocations:G,filterValue:q,onChangeLocation:X})}),!F&&(0,i.Y)(B.c,{className:D.A.fullWidth}),(0,i.Y)(z,{filter:"type",isMobile:F,numberOfFilters:(null==(r=q.types)?void 0:r.length)||0,openFilters:K,setOpenFilters:Z,children:!F&&(0,i.Y)(U,{filterValue:q,onChangeType:ee})}),!F&&(0,i.Y)(B.c,{className:D.A.fullWidth}),_&&(0,i.Y)(z,{filter:"series",isMobile:F,numberOfFilters:(null==(a=q.series)?void 0:a.length)||0,openFilters:K,setOpenFilters:Z,children:!F&&(0,i.Y)(j,{eventSeries:$,filterValue:q,onChangeSeries:et})})]}),F&&K.includes("date")&&(0,i.Y)(M,{eventDates:J,filterValue:q,onChangeDate:Q}),F&&K.includes("location")&&(0,i.Y)(R,{eventLocations:G,filterValue:q,onChangeLocation:X}),F&&K.includes("type")&&(0,i.Y)(U,{filterValue:q,onChangeType:ee}),F&&_&&K.includes("series")&&(0,i.Y)(j,{eventSeries:$,filterValue:q,onChangeSeries:et})]})]}),(0,i.FD)(w.I1,{className:D.A.gridContentWide,children:[el.length>0&&(0,i.FD)(w.I1,{className:I?"":"desktop",gap:24,children:[!F&&(0,i.Y)(g.T,{preset:"st3",children:"Upcoming Events"}),el.map((e,t)=>(0,i.FD)(i.FK,{children:[(0,i.Y)(L.L,{eventConfig:e,goToEvent:h,goToSeries:m,hideIcons:!I,isAdmin:l,isMobile:I,pub:u,showSeries:_,surface:"fp-events",user:d,onDelete:er,onEdit:ei},e.key),t<el.length-1&&(0,i.Y)(B.c,{paddingY:8})]}))]}),eo.length>0&&(0,i.FD)(w.I1,{className:I?"":"desktop",gap:24,children:[el.length>0&&(0,i.Y)("div",{className:D.A.thickDivider}),(0,i.Y)(g.T,{preset:"st4",children:"Past Events"}),eo.map((e,t)=>(0,i.FD)(i.FK,{children:[(0,i.Y)(L.L,{eventConfig:e,goToEvent:h,goToSeries:m,hideIcons:!I,isAdmin:l,isMobile:I,pub:u,showSeries:_,surface:"fp-events",user:d,onDelete:er,onEdit:ei},e.key),t<eo.length-1&&(0,i.Y)(B.c,{paddingY:8})]}))]})]}),l&&(0,i.Y)(P,{editingEvent:E,isA250Page:k,isOpen:T,pub:u,onClose:()=>{A(!1),N(null)},onEventCreated:()=>{b()}})]}),_&&!!(null==Y?void 0:Y.length)&&(0,i.Y)(H,{goToSeries:m,isMobile:F,seriesConfig:Y})]})}},57898:function(e,t,n){n.d(t,{z:()=>h});var i=n(4006),r=n(17402),a=n(22076),l=n(63446),o=n(15894),s=n(12501),c=n(76977),d=n(49807);let u="getTicketsHeaderWrapper-SZWsSS",p="addToCalendar-Ly6tvS",h=e=>{var t;let{pub:n,post:h,event:m,user:g,isHeader:f,isDetailView:v,surface:b}=e,{result:y,refetch:Y}=(0,s.st)({pathname:"/api/v1/live_stream/".concat(m.liveStreamId),auto:!1}),_=null==y||null==(t=y.activeLiveStream)?void 0:t.liveStream,w=f?"getTicketsHeader-x8EjLy":"getTicketsButton-kg7NHY";if((0,r.useEffect)(()=>{m.liveStreamId&&Y()},[m.liveStreamId]),m.isCanceled)return(0,i.Y)(l.v,{className:w,disabled:!0,variant:"outline",children:"CANCELED"});if(m.isPostponed)return(0,i.Y)(l.v,{className:w,disabled:!0,variant:"outline",children:"POSTPONED"});if(m.dateTime&&new Date(m.dateTime)<new Date){if(m.liveStreamId)return(0,i.Y)(l.v,{className:w,href:"".concat((0,d.$_T)(n),"/live-stream/").concat(m.liveStreamId),target:"_blank",variant:"outline",children:"Watch Recording"});else if(null==h?void 0:h.videoUpload)return(0,i.Y)(l.v,{className:w,href:(0,d.wu9)(n,h),target:"_blank",variant:"outline",children:"Watch Recording"})}else if(m.ticketLink&&!m.isSoldOut)return(0,i.FD)(c.I1,{className:f?u:"",children:[(0,i.Y)(l.v,{className:w,href:m.ticketLink,target:"_blank",variant:f?"outline":"primary",children:"Get Tickets"}),v&&_&&(0,i.Y)(a.n,{liveStream:_,trackingSurface:b,trigger:(0,i.Y)("div",{className:p,children:(0,i.Y)(l.v,{className:w,variant:"outline",children:"ADD LIVESTREAM TO CALENDAR"})})})]});else if(m.liveStreamId)return(null==g?void 0:g.is_subscribed)?(0,i.FD)(c.I1,{className:f?u:"",children:[m.isSoldOut&&(0,i.Y)(o.T,{align:"center",color:"tertiary",preset:"detail-small",children:"This event is sold out"}),_&&(0,i.Y)(a.n,{liveStream:_,trackingSurface:b,trigger:(0,i.Y)("div",{className:p,children:(0,i.Y)(l.v,{className:w,variant:f?"outline":"primary",children:"ADD LIVESTREAM TO CALENDAR"})})})]}):(0,i.FD)(c.I1,{className:f?u:"",children:[m.isSoldOut&&(0,i.Y)(o.T,{align:"center",color:"tertiary",preset:"detail-small",children:"This event is sold out"}),(0,i.Y)(l.v,{className:w,href:(0,d.eV6)(n),target:"_blank",variant:f?"outline":"primary",children:"GET LIVESTREAM ACCESS"})]});else if(m.isSoldOut)return(0,i.Y)(l.v,{className:w,disabled:!0,variant:"outline",children:"SOLD OUT"});return null}},38486:function(e,t,n){n.d(t,{ZJ:()=>s,dB:()=>d,dN:()=>o,qb:()=>u,uL:()=>c});var i=n(69277),r=n(70408),a=n(17402),l=n(12501);let o=e=>{let t=e.split(",");if(3===t.length){var n;return(null==(n=t[1])?void 0:n.trim())||""}return e},s=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"event-",{result:t,refetch:n}=(0,l.st)({pathname:"/api/v1/islands/client/config",query:{prefix:e},auto:!0,deps:[]});return{result:t,refetch:n}},c=e=>{let{result:t}=(0,l.st)({pathname:"/api/v1/islands/client/config",query:{key:e},auto:!0,deps:[e],skip:!e});return{result:e?t:null}},d=e=>{let[t,n]=(0,a.useState)([]),[l,s]=(0,a.useState)({}),[c,d]=(0,a.useState)([]),[u,p]=(0,a.useState)({}),[h,m]=(0,a.useState)([]);return(0,a.useEffect)(()=>{if(e.length>0){d([...new Set(e.map(e=>e.location?o(e.location):""))]);let t={};e.forEach(e=>{if(e.dateTime){let n=new Date(e.dateTime),i=n.getFullYear().toString(),r=n.toLocaleString("default",{month:"long"});t[i]||(t[i]=[]),t[i].includes(r)||t[i].push(r)}}),p(t),m([...new Set(e.map(e=>e.series).filter(e=>void 0!==e))])}},[e]),{openFilters:t,filterValue:l,eventLocations:c,eventDates:u,eventSeries:h,setOpenFilters:n,onChangeDate:(e,t)=>{s(n=>{let a=n.dates||[];return(0,r._)((0,i._)({},n),{dates:e?[...a,t]:a.filter(e=>e!==t)})})},onChangeLocation:(e,t)=>{s(n=>{let a=n.locations||[];return(0,r._)((0,i._)({},n),{locations:e?[...a,t]:a.filter(e=>e!==t)})})},onChangeType:(e,t)=>{s(n=>{let a=n.types||[];return(0,r._)((0,i._)({},n),{types:e?[...a,t]:a.filter(e=>e!==t)})})},onChangeSeries:(e,t)=>{s(n=>{let a=n.series||[];return(0,r._)((0,i._)({},n),{series:e?[...a,t]:a.filter(e=>e!==t)})})},resetFilters:()=>{s({})}}},u=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e;return n||(i=i.filter(e=>"published"===e.value.status)),t.locations&&t.locations.length>0&&(i=i.filter(e=>{var n;return!!e.value.location&&(null==(n=t.locations)?void 0:n.includes(o(e.value.location)))})),t.dates&&t.dates.length>0&&(i=i.filter(e=>{var n;if(!e.value.dateTime)return!1;let i=new Date(e.value.dateTime),r=i.getFullYear().toString(),a=i.toLocaleString("default",{month:"long"}),l="".concat(r,"-").concat(a);return null==(n=t.dates)?void 0:n.includes(l)})),t.types&&t.types.length>0&&(i=i.filter(e=>{var n;let i=Array.isArray(e.value.type)?e.value.type:[e.value.type];return null==(n=t.types)?void 0:n.some(e=>i.includes(e))})),t.series&&t.series.length>0&&(i=i.filter(e=>{var n;return e.value.series&&(null==(n=t.series)?void 0:n.includes(e.value.series))})),i.sort((e,t)=>{let n=new Date(e.value.dateTime),i=new Date(t.value.dateTime);return n.getTime()-i.getTime()}),i}},65479:function(e,t,n){n.d(t,{o:()=>W});var i=n(4006),r=n(17402),a=n(17988),l=n(13950),o=n(53696),s=n(15894),c=n(69277),d=n(70408),u=n(60250),p=n(87677),h=n(99862),m=n(13589),g=n(72880),f=n(63446),v=n(68410),b=n(60355),y=n(76977),Y=n(49807);let _="titleLink-En3yx0",w=e=>{let{description:t,posts:n,pub:r,sections:l,title:o,url:s}=e,{isMobile:c}=(0,v.sM)(),d=(0,a.useMediaQuery)({query:"only screen and (min-width: 743px) and (max-width: 899px)"});if(l&&n)throw Error("FPIntroCarousel cannot have both sections and posts");return!d&&c?(0,i.Y)(k,{description:t,posts:n,pub:r,sections:l,title:o,url:s}):(0,i.Y)(C,{description:t,posts:n,pub:r,sections:l,title:o,url:s})},C=e=>{let{description:t,posts:n,pub:a,sections:l,title:o,url:c}=e,d=(0,r.useMemo)(()=>{var e;return null!=(e=null!=n?n:l)?e:[]},[n,l]),[h,m]=(0,r.useState)(()=>d.map((e,t)=>t)),[g,v]=(0,r.useState)(!1),[Y,w]=(0,r.useState)(0),[C,k]=(0,r.useState)(!1),I=(0,r.useRef)(null),F=[,,,].fill(h.map(e=>d[e]).filter(Boolean)).flat(),D=324*d.length,T=(0,r.useCallback)(()=>{g||(v(!0),w(-1),setTimeout(()=>{w(0),m(e=>{let t=[...e],n=t.pop();return void 0!==n&&t.unshift(n),t}),v(!1)},300))},[g]),A=(0,r.useCallback)(()=>{g||(v(!0),w(1),setTimeout(()=>{w(0),m(e=>{let t=[...e],n=t.shift();return void 0!==n&&t.push(n),t}),v(!1)},300))},[g]);return(0,r.useEffect)(()=>{let e=I.current;if(!e)return;let t=null,n=e=>{let n=Math.abs(e.deltaX)>Math.abs(e.deltaY)||e.shiftKey,i=Math.abs(e.deltaX)>0;if((n||i&&Math.abs(e.deltaY)<2*Math.abs(e.deltaX))&&e.preventDefault(),n&&n){if(g||t)return;let n=e.deltaX||e.deltaY;if(10>Math.abs(n))return;n>0?A():n<0&&T(),t=setTimeout(()=>{t=null},1e3)}};return e.addEventListener("wheel",n,{passive:!1}),()=>{e.removeEventListener("wheel",n),t&&clearTimeout(t)}},[g,T,A]),(0,r.useEffect)(()=>{if(!C)return;let e=e=>{"ArrowLeft"===e.key?(e.preventDefault(),T()):"ArrowRight"===e.key&&(e.preventDefault(),A())};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[C,T,A]),(0,i.FD)(y.Ye,{gap:24,style:{alignItems:"stretch"},children:[(0,i.FD)(y.I1,{justifyContent:"space-between",style:{minWidth:240,maxWidth:310,flexShrink:0},children:[(0,i.FD)(y.I1,{gap:16,children:[c?(0,i.Y)(s.T,{as:"a",className:_,href:c,preset:"st3",children:o}):(0,i.Y)(s.T,{preset:"st3",children:o}),(0,i.Y)(s.T,{preset:"body",children:t})]}),(0,i.FD)(y.Ye,{justifyContent:"space-between",children:[(0,i.Y)(f.v,{className:_,size:"lg",variant:"tertiary",onClick:T,children:(0,i.Y)(u.A,{size:32,strokeWidth:1})}),(0,i.Y)(f.v,{className:_,size:"lg",variant:"tertiary",onClick:A,children:(0,i.Y)(p.A,{size:32,strokeWidth:1})})]})]}),(0,i.Y)("div",{ref:I,className:"carouselContainer-h0k1wv",style:{flex:1},onMouseEnter:()=>k(!0),onMouseLeave:()=>k(!1),children:(0,i.Y)("div",{className:"carouselTrack-LROA1y",style:{overflow:"hidden"},children:(0,i.FD)(y.Ye,{gap:24,style:{transform:"translateX(".concat(-(D+324*Y),"px)"),transition:0!==Y?"transform 0.3s ease-in-out":"none"},children:[n&&F.map((e,t)=>(0,i.Y)("div",{style:{width:300,flexShrink:0},children:(0,i.Y)(b.R,{post:e,titlePreset:"h5-sans",variant:"square"})},"post-".concat(t))),l&&F.map((e,t)=>(0,i.Y)("div",{style:{width:300,flexShrink:0},children:(0,i.Y)(S,{pub:a,section:e})},"section-".concat(t)))]})})})]})},k=e=>{var t;let{description:n,posts:r,sections:a,title:l,pub:o,url:c}=e,d=201*(null!=(t=null!=r?r:a)?t:[]).length-16;return(0,i.FD)(y.I1,{gap:16,children:[(0,i.FD)(y.I1,{gap:8,children:[c?(0,i.Y)(s.T,{as:"a",className:_,href:c,preset:"st3",children:l}):(0,i.Y)(s.T,{preset:"st3",children:l}),(0,i.Y)(s.T,{preset:"body",children:n})]}),(0,i.Y)("div",{className:"mobileScrollContainer-vr1ryM",children:(0,i.FD)(y.Ye,{gap:16,style:{width:d},children:[null==r?void 0:r.map(e=>(0,i.Y)("div",{style:{width:185},children:(0,i.Y)(b.R,{post:e,titlePreset:"h5-sans",variant:"square"})},e.id)),null==a?void 0:a.map(e=>(0,i.Y)("div",{style:{width:185},children:(0,i.Y)(S,{pub:o,section:e})},e.id))]})})]})},S=e=>{let{pub:t,section:n}=e,[a,l]=(0,m.Mk)(),o=(0,r.useCallback)(()=>{(0,h.route)((0,Y.Dor)(t,{section:n}))},[n,t]);return(0,i.FD)(y.I1,(0,d._)((0,c._)({gap:8,onClick:o},l),{style:{cursor:"pointer"},children:[n.logo_url&&(0,i.Y)(g.o,{alt:n.name,className:"sectionLogo-gK1870",imageIsFixedWidth:!0,maxWidth:300,src:n.logo_url,useRetinaSizing:!0}),(0,i.Y)(s.T,{color:a?"accent":"primary",preset:"h5-sans",children:n.name})]}))};var I=n(39318);let F=()=>{let{isMobile:e}=(0,v.sM)(),t=(0,r.useCallback)(()=>{window.scrollTo({top:window.innerHeight,behavior:"smooth"})},[]);return(0,i.FD)(y.I1,{alignItems:"center",className:"container-jez8Y9",gap:e?16:40,justifyContent:"center",paddingY:40,style:{height:"calc(var(--full-height) - ".concat(69,"px)")},children:[(0,i.FD)(y.I1,{alignItems:"center",gap:e?16:24,style:{flex:"1 1 auto",minHeight:0},children:[(0,i.Y)("div",{className:"intro-Yvh6eZ",children:"An introduction to"}),(0,i.Y)("img",{alt:"The Free Press",className:"logo-zLbeFo",src:(0,I.dJ9)("".concat((0,I.Ewe)(),"/img/thefp/thefp-intro-logo.svg"))})]}),(0,i.Y)(f.v,{trailingIcon:"chevron-down",variant:"red-text",onClick:t,children:"Keep Reading"})]})};var D=n(65812),T=n(68349),A=n(22092),E=n(57324);let N="container-NehaVk",P="containerInner-ntGWZj",x=e=>{let{pub:t,user:n,onRegister:a}=e,[l,o]=(0,r.useState)(!1);return l?(0,i.Y)(y.I1,{className:N,children:(0,i.Y)("div",{className:P,children:(0,i.FD)(y.I1,{alignItems:"center",gap:16,children:[(0,i.Y)(s.T,{color:"white",preset:"h6-sans",style:{paddingTop:46},children:"WELCOME TO THE FREE PRESS"}),(0,i.Y)(s.T,{align:"center",color:"white",preset:"body",style:{maxWidth:"330px",paddingBottom:46},children:"You’ll now get our stories delivered straight to your inbox."})]})})}):(0,i.Y)(y.I1,{className:N,children:(0,i.Y)("div",{className:P,children:(0,i.FD)(y.I1,{alignItems:"center",gap:16,children:[(0,i.Y)(s.T,{color:"white",preset:"h6-sans",children:"SUBSCRIBE TO THE FREE PRESS"}),(0,i.Y)("div",{className:"emailFormWrapper-JpcLKh",children:(0,i.Y)(D.A,{allowEmptyInput:!0,preset:"accent",pub:t,submitButtonText:"sign up for free",user:n,utmSource:E.VU.freePressIntroPage,onSuccess:e=>{var n,i,r;(null==e||null==(n=e.body)?void 0:n.email)&&"admin@example.com"!==e.body.email&&((null==e||null==(i=e.body)?void 0:i.prompt_to_login)||(null==e||null==(r=e.body)?void 0:r.requires_confirmation)?(0,T.V2)((0,A._)(t,{isSignInAttempt:!0,next:document.location.href,email:e.body.email})):(o(!0),a()))}})}),(0,i.Y)(s.T,{color:"white",preset:"detail-small",children:"Already have an account?"}),(0,i.Y)("a",{className:"whiteSignInLink-INYUOp",href:(0,I.my9)(t,{isSignInAttempt:!0}),children:(0,i.Y)(s.T,{color:"white",preset:"detail-small",children:"Sign in"})})]})})})};var L=n(59307);let O="videoWrapper-gU8vC5",B="smallScreenVideo-UKN5BQ",M="playButton-elyoq5",R=()=>{let{isMobile:e}=(0,v.sM)(),t=(0,a.useMediaQuery)({query:"only screen and (min-width: 743px) and (max-width: 899px)"}),[n,l]=(0,r.useState)(!1),o=(0,r.useRef)(null),c=()=>{var e;l(!0),null==(e=o.current)||e.play()},d=()=>{o.current&&(o.current.paused?(o.current.play(),l(!0)):(o.current.pause(),l(!1)))},u="https://substack-post-media.s3.us-east-1.amazonaws.com/public/assets/the-fp/fp-intro-square.mp4",p="https://substack-post-media.s3.us-east-1.amazonaws.com/public/assets/the-fp/fp-intro-square-still-2.png",h="See what we’re all about";return!t&&e?(0,i.FD)(y.I1,{children:[(0,i.Y)(s.T,{preset:"st3",children:h}),(0,i.Y)(y.I1,{className:"mobileContainer-qor88J",children:(0,i.FD)("div",{className:O,onClick:d,children:[(0,i.Y)("video",{ref:o,className:B,playsInline:!0,poster:"https://substack-post-media.s3.us-east-1.amazonaws.com/public/assets/the-fp/fp-intro-vertical-still-2.png",preload:"metadata",onPause:()=>l(!1),onPlay:()=>l(!0),children:(0,i.Y)("source",{src:"https://substack-post-media.s3.us-east-1.amazonaws.com/public/assets/the-fp/fp-intro-vertical.mp4",type:"video/mp4"})}),!n&&(0,i.Y)("div",{className:M,onClick:e=>{e.stopPropagation(),c()},children:(0,i.Y)(L.A,{fill:"var(--color-utility-white)",height:40,stroke:"none"})})]})})]}):t?(0,i.FD)(y.I1,{gap:16,children:[(0,i.Y)(s.T,{preset:"st3",children:h}),(0,i.FD)("div",{style:{position:"relative"},onClick:d,children:[(0,i.Y)("video",{ref:o,className:B,playsInline:!0,poster:p,preload:"metadata",onPause:()=>l(!1),onPlay:()=>l(!0),children:(0,i.Y)("source",{src:u,type:"video/mp4"})}),!n&&(0,i.Y)("div",{className:M,onClick:e=>{e.stopPropagation(),c()},children:(0,i.Y)(L.A,{fill:"var(--color-utility-white)",height:40,stroke:"none"})})]})]}):(0,i.FD)(y.Ye,{gap:24,style:{alignItems:"stretch"},children:[(0,i.Y)(y.I1,{justifyContent:"space-between",style:{minWidth:240,maxWidth:310,flexShrink:0},children:(0,i.Y)(s.T,{preset:"st3",children:h})}),(0,i.FD)("div",{className:O,onClick:d,children:[(0,i.Y)("video",{ref:o,className:"video-E02_Ms",playsInline:!0,poster:p,preload:"metadata",onPause:()=>l(!1),onPlay:()=>l(!0),children:(0,i.Y)("source",{src:u,type:"video/mp4"})}),!n&&(0,i.Y)("div",{className:M,onClick:e=>{e.stopPropagation(),c()},children:(0,i.Y)(L.A,{fill:"var(--color-utility-white)",height:40,stroke:"none"})})]})]})};var U=n(28528),j=n(16074),z=n(92636),H=n(39891);let W=e=>{let{pageData:t,pub:n,user:c,showSubscribeCta:d}=e,{isMobile:u}=(0,v.sM)(),p=(0,a.useMediaQuery)({query:"only screen and (min-width: 743px) and (max-width: 899px)"}),[h,m]=(0,r.useState)(!1),[g,f]=(0,r.useState)(!1);return(0,i.Y)(U.XL,{pub:n,user:c,children:(0,i.Y)(l.DH,{children:(0,i.FD)(o.r,{children:[(0,i.Y)(F,{}),(0,i.FD)(y.I1,{alignSelf:"center",gap:u?40:64,paddingBottom:u?40:64,paddingTop:24,style:{maxWidth:p?560:u?330:659},children:[(0,i.FD)(y.I1,{gap:24,children:[(0,i.Y)(s.T,{preset:"body",children:"Whether you’ve been reading us since the beginning, or this is the first time you’re hearing of The Free Press: welcome."}),(0,i.Y)(s.T,{preset:"body",children:"The Free Press is built on the ideals that once were the bedrock of American journalism: honesty, doggedness, and fierce independence. We make sense of the world as it actually is—with the quality once expected from the legacy press, but the fearlessness of the new."}),(0,i.Y)(s.T,{preset:"body",children:"You won’t agree with everything we run, and that’s the point. We’re a Free Press for free people."})]}),(0,i.FD)(y.Ye,{alignItems:"center",gap:24,paddingY:16,style:{width:"100%"},children:[(0,i.Y)(j.c,{flex:"grow"}),(0,i.Y)("img",{alt:"stars",src:(0,H.dJ)("".concat((0,z.Ew)(),"/img/thefp/fp-stars.svg"),154),style:{height:15,width:"auto",flexShrink:0}}),(0,i.Y)(j.c,{flex:"grow"})]})]}),(0,i.FD)(y.I1,{gap:u?40:64,paddingBottom:u?40:64,children:[t.slice(0,3).map(e=>(0,i.Y)(w,{description:e.sectionDescription,posts:e.posts,pub:n,sections:e.sections,title:e.sectionTitle,url:e.sectionUrl},e.sectionTitle)),d&&!g&&(0,i.Y)(x,{pub:n,user:c,onRegister:()=>{m(!0)}}),t.slice(3,6).map(e=>(0,i.Y)(w,{description:e.sectionDescription,posts:e.posts,pub:n,sections:e.sections,title:e.sectionTitle,url:e.sectionUrl},e.sectionTitle)),t.slice(6).map(e=>(0,i.Y)(w,{description:e.sectionDescription,posts:e.posts,pub:n,sections:e.sections,title:e.sectionTitle,url:e.sectionUrl},e.sectionTitle)),(0,i.Y)(R,{})]}),d&&!h&&(0,i.Y)(x,{pub:n,user:c,onRegister:()=>{f(!0)}})]})})})}},57753:function(e,t,n){n.d(t,{Ip:()=>a,Q3:()=>r,ek:()=>i});let i=["black","brightOrange","brightBlue","darkGreen","darkOrange","lightGray","mediumBlue","mediumGreen","mediumOrange","mediumPurple","mediumRed","mediumYellow","offWhite"],r={black:{hex:"#161613",invertTextColors:!0},brightOrange:{hex:"#f74701",invertTextColors:!1},brightBlue:{hex:"#0366F3",invertTextColors:!0},darkGreen:{hex:"#3A564B",invertTextColors:!0},darkOrange:{hex:"#d37735",invertTextColors:!1},lightGray:{hex:"#bebdb8",invertTextColors:!1},mediumBlue:{hex:"#005591",invertTextColors:!0},mediumGreen:{hex:"#2db750",invertTextColors:!0},mediumOrange:{hex:"#f69227",invertTextColors:!1},mediumPurple:{hex:"#5358C8",invertTextColors:!0},mediumRed:{hex:"#f2312c",invertTextColors:!0},mediumYellow:{hex:"#F3C82E",invertTextColors:!1},offWhite:{hex:"#f6f4ef",invertTextColors:!1}},a=["cbs_news","cbsnews","paramount"]},36233:function(e,t,n){n.d(t,{Ay:()=>m,Oq:()=>p});var i=n(4006),r=n(17402),a=n(86500),l=n(94729),o=n(58418),s=n(16291),c=n(82776);let d=function(e){let{timeout:t=5e3,className:n="",dismissable:a=!1,beforeDismiss:l=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0;o=o||document.body;let s=document.createElement("div");s.setAttribute("id","toast"),s.setAttribute("role","alert"),n&&s.classList.add(n),o.appendChild(s);let c=()=>{l&&l(),s.classList.remove("in"),setTimeout(()=>{s.remove()},500)};(0,r.render)([(0,i.Y)("p",{children:e}),a&&(0,i.Y)("a",{className:"dismiss",onClick:c,children:"Dismiss"})],s),setTimeout(()=>{s.classList.add("in")}),a||setTimeout(c,t)},u=e=>{let{children:t,className:n,dismissKey:i,dismissDurationInSeconds:r,beforeDismiss:a,container:l}=e,[s,c]=(0,o.A)(i,r,a);if(!s)return d(t,{className:n,beforeDismiss:c,dismissable:!0},l)},p=e=>{let{user:t,pub:n,container:r}=e;return t&&n&&t.is_subscribed?(0,i.Y)(h,{pub:n,container:r}):null},h=e=>{let{pub:t,container:n}=e,[o,d]=(0,r.useState)(null);return((0,r.useEffect)(()=>{(0,l.x6)("/api/v1/subscription").then(e=>d(e)).catch(e=>{console.error("Failed to fetch subscription data: ",e)})},[]),(e=>{if(e&&e.cardExpiresAt){let t=(0,s.A)(e.expiry).subtract(c.GRACE_PERIOD_DAYS,"day"),n=(0,s.A)(e.cardExpiresAt),i=(0,s.A)().add(12,"day");return n.isBefore(t)&&t.isBefore(i)}return!1})(o))?(0,i.FD)(u,{className:"urgent",dismissKey:"card-expiring-toast.dismissed",dismissDurationInSeconds:+c.WEEK_IN_SECONDS,beforeDismiss:()=>{(0,a.u4)(a.qY.CARD_EXPIRED_WARNING_DISMISSED,{type:"toast"})},container:n,children:["Your credit card is expiring soon."," ",(0,i.Y)("a",{href:"/account/billing","data-native":!0,onClick:()=>{(0,a.u4)(a.qY.UPDATE_EXPIRED_CARD_LINK_CLICKED,{type:"toast"})},children:"Update your card"})," before you lose access to ".concat(t.name),"."]}):null},m=d},45197:function(e,t,n){n.d(t,{Ay:()=>K,qE:()=>ee});var i=n(69277),r=n(70408),a=n(32641),l=n(4006),o=n(32485),s=n.n(o),c=n(89230),d=n(44080),u=n(81143),p=n(17402),h=n(82519),m=n(2929),g=n(68058),f=n(92707),v=n(92170),b=n(44512),y=n(40554),Y=n(13950),_=n(51419),w=n(52820),C=n(62668),k=n(84605),S=n(97640),I=n(85478),F=n(86500),D=n(55200),T=n(44333),A=n(68349),E=n(68410),N=n(24078),P=n(15040),x=n(35369),L=n(76977),O=n(88774),B=n(63136),M=n(11510),R=n(39318),U=n(80856),j=n(49807),z=n(57324),H=n(72285);let W=z.VU.userMenu,V="https://support.substack.com/hc/en-us/?utm_source=".concat(W);function K(e){var{user:t,pub:n}=e,o=(0,a._)(e,["user","pub"]);let{iString:c}=(0,k.GO)(),d=(0,p.useContext)(C.d),u=(0,M.Iu)(),{getExperimentVariant:h,exposeExperiment:m}=(0,w.Wk)(),g=(0,T.W5)("/p/:slug"),{webviewPlatform:f}=(0,_.eG)(),v=(null==g?void 0:g.slug)||null,b=h("web_view_get_app"),y=u&&!t&&!!f&&v&&b;if((0,p.useEffect)(()=>{y&&m("web_view_get_app")},[y,m]),t)return(0,l.Y)(q,(0,r._)((0,i._)({},o),{user:t,pub:n}));if(y&&"control"!==b){let e=(0,R.XV8)(null==n?void 0:n.subdomain,v,{source:z.VU.navbarSignIn,redirect:"app-store"}),t=c("treatment_get_app"===b?"Get app":"Sign in");return(0,l.Y)(x.$n,{priority:"tertiary",size:u?"sm":"md",className:s()({"force-desktop":d}),onClick:()=>{if((0,F.u4)(F.qY.NAV_BAR_CTA_CLICKED,{type:"web_view_get_app",variant:b}),"treatment_deep_link"===b){let e=(0,R.a7q)({for_pub:null==n?void 0:n.subdomain});setTimeout(()=>{(0,A.V2)(e)},3e3)}(0,A.V2)(e)},children:t})}return(0,l.Y)(x.$n,{href:(0,R.a7q)({for_pub:null==n?void 0:n.subdomain}),priority:"tertiary",size:u?"sm":"md",className:s()({"force-desktop":d}),"data-native":!0,children:c("Sign in")})}function q(e){var t,n,{user:o,pub:s}=e,d=(0,a._)(e,["user","pub"]);let{isMobile:u}=(0,E.sM)(),{getConfigFor:p}=(0,I.mJ)(),h=null!=(t=p("use_theme_editor_v2"))&&t,m=null!=(n=p("use_theme_editor_v3"))&&n,g=(!u||h||m)&&o.photo_url?(0,l.Y)(G,{user:o}):(0,l.Y)(x.K0,{priority:"tertiary",size:"sm",children:(0,l.Y)(c.A,{size:20})});return(0,l.Y)(J,(0,r._)((0,i._)({},d),{user:o,pub:s,trigger:g}))}let G=(0,p.forwardRef)((e,t)=>{var{user:n}=e,o=(0,a._)(e,["user"]);let{isMobile:s}=(0,E.sM)();return(0,l.Y)(x.Nm,(0,r._)((0,i._)({},o),{resetCss:!0,position:"relative",className:H.A.avatarButton,showFocus:!0,animate:!0,radius:"full",ref:t,children:(0,l.Y)(P.Ex,{priority:"secondary",theme:"default",fillIcon:!0,placement:"bottom-right",content:(0,l.Y)(h.A,{size:14}),children:(0,l.Y)(N.eu,{user:n,size:s?32:40,"aria-hidden":!0})})}))});function J(e){let{trigger:t,user:n,pub:i,enableCustomerServiceMode:r,disableCustomerServiceMode:a,freeSignup:o}=e,{iString:s}=(0,k.GO)(),{activityUnreadCount:c}=(0,S.Vd)(),{onOpen:d,onClose:u}=(0,Y.xF)(),p=e=>()=>{(0,F.u4)(e)};return(0,l.FD)(O.W1,{trigger:t,onOpen:()=>{(0,F.u4)(F.qY.USER_MENU_OPENED),d()},onClose:()=>{(0,F.u4)(F.qY.USER_MENU_DISMISSED),u()},"aria-label":s("More options"),children:[(0,l.Y)($,{user:n}),(0,l.FD)(O.H9,{children:[(0,l.Y)(O.Dr,{href:(0,R.oT5)({urlParams:{utm_source:W}}),onClick:p(F.qY.USER_MENU_FEED_CLICKED),leading:(0,l.Y)(f.A,{size:20}),"data-native":!0,children:s("Home")}),(0,l.Y)(O.Dr,{href:(0,R.q$g)({utm_source:W}),onClick:p(F.qY.USER_MENU_READER_CLICKED),leading:(0,l.Y)(v.A,{size:20}),"data-native":!0,children:s("Subscriptions")}),(0,l.Y)(O.Dr,{href:(0,j.ehp)(),onClick:p(F.qY.USER_MENU_CHAT_CLICKED),leading:(0,l.Y)(g.A,{size:20}),"data-native":!0,children:s("Chat")}),(0,l.Y)(O.Dr,{href:(0,R.M)({utm_source:W}),onClick:p(F.qY.USER_MENU_ACTIVITY_CLICKED),leading:(0,l.Y)(m.A,{size:20}),"data-native":!0,children:(0,l.FD)(L.pT,{flex:"grow",justifyContent:"space-between",children:[s("Activity"),c>0&&(0,l.Y)(y.T,{className:"indicator-badge",count:c})]})}),(0,l.Y)(O.Dr,{href:(0,R.U4Y)(),onClick:p(F.qY.USER_MENU_DISCOVER_CLICKED),leading:(0,l.Y)(b.A,{size:20}),"data-native":!0,children:s("Explore")})]}),(0,l.Y)(Z,{freeSignup:null!=o&&o,pub:null!=i?i:null,user:n}),(0,l.Y)(Q,{pub:null!=i?i:null}),!n.reader_installed_at&&(0,l.Y)(O.H9,{children:(0,l.Y)(O.Dr,{href:(0,R.DS2)({utm_campaign:z._9.appMarketing,utm_content:z.fL.userMenuLink}),priority:"accent","data-native":!0,children:s("Get the app")})}),(0,l.Y)(X,{enableCustomerServiceMode:r,disableCustomerServiceMode:a,pub:null!=i?i:null,user:n}),(0,l.Y)(ee,{pub:null!=i?i:null})]})}let $=e=>{let{user:t}=e,{iString:n}=(0,k.GO)(),i=(0,D.l)(t,{utm_source:W}),r="",a="";return t&&(r=(null==t?void 0:t.profile_set_up_at)&&t.name?t.name:t.email,a=(null==t?void 0:t.profile_set_up_at)?t.handle?"@".concat(t.handle):null:n("Set up your profile")),(0,l.Y)(O.Dr,{href:i,onClick:()=>(0,F.u4)(F.qY.USER_MENU_PROFILE_CLICKED),"data-native":!0,children:(0,l.FD)(L.pT,{gap:12,alignItems:"center",children:[(0,l.Y)(N.eu,{size:40,user:null!=t?t:void 0,"aria-hidden":!0}),(0,l.FD)(L.I1,{flex:"grow",children:[(0,l.Y)(B.EY.B4,{weight:"semibold",children:r}),a&&(0,l.Y)(B.EY.B4,{color:"secondary",children:a})]})]})})},Z=e=>{let{freeSignup:t,user:n,pub:i}=e,{iString:r}=(0,k.GO)(),a=i&&(t||n&&(n.is_subscribed||n.is_free_subscribed)),o=!!(null==n?void 0:n.subdomain),s=n?(0,R.yRA)(n,{params:{utm_source:z.VU.substack}}):void 0;return o||a?(0,l.FD)(O.H9,{children:[a&&(0,l.Y)(O.Dr,{href:(0,R.yRP)("/account",{utm_source:W}),onClick:()=>(0,F.u4)(F.qY.USER_MENU_MANAGE_SUBSCRIPTION_CLICKED),priority:"secondary","data-native":!0,children:r("Manage subscription")}),o&&s&&(0,l.Y)(O.Dr,{priority:"secondary",href:s,"data-native":!0,trailing:(0,l.Y)(d.A,{}),children:r("Dashboard")})]}):null},Q=e=>{let{pub:t}=e,{iString:n}=(0,k.GO)();return(0,l.FD)(O.H9,{children:[(0,l.Y)(O.Dr,{href:(0,R.tFi)({utm_source:W}),onClick:()=>(0,F.u4)(F.qY.USER_MENU_ACCOUNT_SETTINGS_CLICKED),priority:"secondary","data-native":!0,children:n("Settings")}),(0,l.Y)(O.Dr,{href:V,priority:"secondary",children:n("Support")}),(0,l.Y)(O.Dr,{href:(0,R.bgT)({utm_source:W,for_pub:null==t?void 0:t.subdomain}),priority:"secondary","data-native":!0,children:n("Sign out")})]})},X=e=>{let{disableCustomerServiceMode:t,enableCustomerServiceMode:n,pub:i,user:r}=e;return(null==r?void 0:r.is_global_admin)&&(n||t)?(0,l.FD)(O.H9,{children:[n&&(0,l.Y)(O.Dr,{priority:"secondary",onClick:n,trailing:(0,l.Y)(u.A,{}),"data-native":!0,children:"Enter support mode"}),t&&(0,l.Y)(O.Dr,{priority:"secondary",onClick:t,trailing:(0,l.Y)(u.A,{}),"data-native":!0,children:"Exit support mode"}),i&&(0,l.Y)(O.Dr,{priority:"secondary",href:"".concat((0,j.$_T)({subdomain:"admin"}),"/publications/").concat(i.id),trailing:(0,l.Y)(u.A,{}),"data-native":!0,children:"Open in Underground"})]}):null},ee=e=>{let{pub:t}=e,{iString:n}=(0,k.GO)();return(0,l.Y)(O.H9,{children:(0,l.Y)(B.EY.B4,{size:12,color:"secondary",children:(0,l.FD)(L.pT,{gap:12,padding:8,className:"footer",children:[(0,l.Y)(B.Yq,{href:(0,R.DNs)(null,{params:{utm_source:W}}),"data-native":!0,children:n("About")}),(0,l.Y)(B.Yq,{href:(0,U._)({pub:t,utm_source:W}),children:n("Privacy")}),(0,l.Y)(B.Yq,{href:(0,U.Ru)({pub:t,utm_source:W}),children:n("Terms")}),(0,l.Y)(B.Yq,{href:(0,U.iQ)({utm_source:W}),children:n("Data")}),(0,l.Y)(B.Yq,{href:(0,U.an)({utm_source:W}),children:n("Accessibility")})]})})})}},41873:function(e,t,n){n.d(t,{A:()=>I,b:()=>F});var i=n(99851),r=n(69277),a=n(70408),l=n(4006),o=n(32485),s=n.n(o),c=n(17402),d=n(68414),u=n(59307),p=n(13505),h=n(86500),m=n(13022),g=n(17186),f=n(68349),v=n(89490),b=n(35369),y=n(13348),Y=n(91392),_=n(39318),w=n(9036),C=n(82776),k=n(18012);let S={hls:"application/x-mpegURL",mp4:"video/mp4"};class I extends c.Component{componentDidMount(){if(this._initHlsjs(),null===f.dO||void 0===f.dO||f.dO.on("play",this.onGlobalPlay),"undefined"!=typeof window&&(document.addEventListener("keydown",this.onGlobalKeyDown,!1),window.addEventListener("beforeunload",this.onBeforeUnload,!1)),this.player&&(this.player.volume=1,this.player.addEventListener("loadedmetadata",this.onLoadedMetadata),this.player.addEventListener("loadeddata",this.onLoadedData),this.player.addEventListener("canplay",this.onCanPlay),this.player.addEventListener("play",this.onPlay),this.player.addEventListener("pause",this.onPause),this.player.addEventListener("ended",this.onEnded),this.player.addEventListener("timeupdate",this.onTimeUpdate),this.player.addEventListener("waiting",this.onWaiting),this.player.addEventListener("playing",this.onPlaying),this.player.addEventListener("contextmenu",this.onContextMenu),this.player.addEventListener("click",this.onUserInteraction),this.player.addEventListener("mouseover",this.onUserInteraction),this.player.addEventListener("mousedown",this.onUserInteraction),this.player.addEventListener("touchstart",this.onUserInteraction),this.player.addEventListener("seeked",this.onSeeked)),this.onTimeUpdate(),window&&window._preloads.mux_env_key&&!(window._preloads.disabledCookies||[]).includes(Y.HY.MUX_DATA)){let{entityType:e}=this.getEntityKeyAndType();n.e("25505").then(n.t.bind(n,21624,23)).then(t=>{var n;let i=t.default||t;i.monitor(this.player,{Hls:this.hlsModule,hlsjs:this.hls,debug:!1,data:{env_key:window._preloads.mux_env_key,player_name:null!=(n=this.props.surface)?n:"substack",player_init_time:i.utils.now(),video_id:this.props.mediaUpload.id,video_stream_type:e}})})}}componentWillUnmount(){this.setPlaybackRestoreLocation(),this.lastTimeUpdate=null,null===f.dO||void 0===f.dO||f.dO.off("play",this.onGlobalPlay),"undefined"!=typeof window&&(document.removeEventListener("keydown",this.onGlobalKeyDown,!1),window.removeEventListener("beforeunload",this.onBeforeUnload,!1)),this.player&&(this.player.removeEventListener("loadedmetadata",this.onLoadedMetadata),this.player.removeEventListener("loadeddata",this.onLoadedData),this.player.removeEventListener("canplay",this.onCanPlay),this.player.removeEventListener("play",this.onPlay),this.player.removeEventListener("pause",this.onPause),this.player.removeEventListener("ended",this.onEnded),this.player.removeEventListener("timeupdate",this.onTimeUpdate),this.player.removeEventListener("waiting",this.onWaiting),this.player.removeEventListener("playing",this.onPlaying),this.player.removeEventListener("contextmenu",this.onContextMenu),this.player.removeEventListener("click",this.onUserInteraction),this.player.removeEventListener("mouseover",this.onUserInteraction),this.player.removeEventListener("mousedown",this.onUserInteraction),this.player.removeEventListener("touchstart",this.onUserInteraction)),this.onVideoReachEnd({resetTime:!1,triggerCallback:!1,track:!1}),null!=this.hls&&this.hls.destroy()}componentDidUpdate(e,t){var n,i,a;if((this.props.noPreview!==e.noPreview||this.props.noControls!==e.noControls||this.props.noKeyboardShortcuts!==e.noKeyboardShortcuts||this.props.mediaUpload.id!==e.mediaUpload.id)&&(this._initHlsjs(),this.resetDurationTracking()),!this.state.playing&&"number"==typeof this.state.waiting&&"number"!=typeof t.waiting){let{useHLSJS:e,browserCanPlayHLS:t,HLSerrored:n}=this.state;this.track(h.qY.VIDEO_BUFFERING_STARTED,{use_hlsjs:e,browser_can_play_hls:t,hls_errored:n})}if(!this.state.playing||t.playing||this.state.waiting||"number"!=typeof t.waiting||this.track(h.qY.VIDEO_BUFFERING_COMPLETED,{buffering_duration:Date.now()-t.waiting}),this.state.playing&&!(null==(n=this.player)?void 0:n.ended)&&Math.floor(this.state.currentTime)!==Math.floor(t.currentTime)&&Math.floor(this.state.currentTime)%5==0&&(this.trackMedia(h.qY.MEDIA_PLAYBACK_CONTINUED),this.props.mediaUpload.post_id&&this.state.duration&&(!this.props.surface||"post"===this.props.surface)&&(!this.props.videoType||"post"===this.props.videoType)&&!this.props.isClip)){let e=Math.min(Math.max(0,this.state.currentTime/this.state.duration),1);(0,p.AG)(this.props.mediaUpload.post_id,"video",e)}if(!this.state.playing&&t.playing&&(null==(i=this.player)?void 0:i.ended)&&this.trackMedia(h.qY.MEDIA_PLAYBACK_COMPLETED),this.props.mediaUpload.id&&(0,m.Ay)("use_preloaded_player_sources")&&(this.props.mediaUpload.id!==e.mediaUpload.id||!(null==(a=Object.keys(this.state.sources))?void 0:a.length))){let e=async e=>fetch((0,_.oRR)("/api/v1/video/upload/".concat(this.props.mediaUpload.id,"/src.json"),{type:e})).then(e=>e.json()).then(t=>({[e]:t.src}));Promise.all(["hls"].map(t=>e(t))).then(e=>{let t=e.reduce((e,t)=>(0,r._)({},e,t),{});this.setState({sources:t})})}}getPlaybackLocationKey(){return"".concat("video:playback_location:").concat(this.props.mediaUpload.id)}shouldShowNativeVideoControls(){let{noControls:e,noPreview:t}=this.props,{previewHidden:n,showControls:i}=this.state;return i&&!e&&!(!t&&!n)}getPlaybackRestoreLocation(){if(this.playbackEnabled()&&this.props.restorePlaybackLocation&&this.props.mediaUpload.duration&&this.props.mediaUpload.duration>240){let e=(0,g.xm)(this.getPlaybackLocationKey());if((null==e?void 0:e.currentTime)>5&&null!==this.props.duration&&void 0!==this.props.duration&&this.props.duration-e.currentTime>60){let t=3*(Date.now()-e.watchedAt>60),n=Math.max(0,e.currentTime-t);if(n)return n}}return null}setPlaybackRestoreLocation(){var e;this.playbackEnabled()&&(null==(e=this.player)?void 0:e.currentTime)&&(0,g.X3)(this.getPlaybackLocationKey(),{currentTime:this.player.currentTime,watchedAt:Date.now()})}onPreviewClick(e){var t,n,i,r,a;let l=!(0,f.nr)()||!this.shouldShowNativeVideoControls();if((this.props.stopPropagation||l)&&(e.preventDefault(),e.stopPropagation()),null==(t=this.player)||t.setAttribute("data-user-changed-playback","true"),this.state.previewHidden){l&&((null==(n=this.player)?void 0:n.paused)?this.player.play():null==(i=this.player)||i.pause());return}if(!this.href()){if(!this.playbackEnabled())return void this.onClickNonPlayableVideo();this.state.attemptingToPlay?(this.lastTimeUpdate=null,this.setState({attemptingToPlay:!1,autoPlay:!1}),null==(r=this.player)||r.pause(),this.previewHiddingTimeout&&clearTimeout(this.previewHiddingTimeout)):(this.setState({attemptingToPlay:!0}),null==(a=this.player)||a.play(),this.previewHiddingTimeout=window.setTimeout(()=>this.setState({previewHidden:!0}),3e3))}}track(e){var t,n,i,r;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=this.props.communityPostEmbedPostId||this.props.mediaUpload.post_id,o=this.props.mediaUpload.user_id;(0,h.u4)(e,Object.assign({post_id:l,video_user_id:o,community_post_id:this.props.communityPostId,media_upload_id:this.props.mediaUpload.id,live_stream_id:this.props.liveStreamId,current_time:this.state.currentTime?Math.floor(this.state.currentTime):0,duration:this.state.duration?Math.floor(this.state.duration):0,is_clip:null!=(n=this.props.isClip)&&n,surface:this.props.surface,is_preview:null!=(i=this.props.usePreview)&&i,muted:null!=(r=null==(t=this.player)?void 0:t.muted)&&r,video_type:this.props.videoType,display:(0,f.aS)()?"fullscreen":document.pictureInPictureElement?"pip":"inline"},a))}trackMedia(e){var t,n,i,l,o,s,c,d;let u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{mediaUpload:p,videoType:m,surface:g,primaryEntityKey:v,primaryEntityType:b,contentType:y,feedItemTrackingParameters:Y}=this.props,_=null!=y?y:m?null!=(i=({communityCommentReply:"communityComment","video-embed":"embed"})[m])?i:m:"unknown",{entityKey:w,entityType:C}=this.getEntityKeyAndType(),k=Array.from(null!=(l=null==(t=this.player)?void 0:t.textTracks)?l:[]),S=k.length>0,I=this.isShowingCaptionsElsewhere||k.some(e=>["subtitles","captions"].includes(e.kind)&&"showing"===e.mode);(0,h.u4)(e,(0,r._)((0,a._)((0,r._)({},Y),{media_type:"video",video_upload_id:p.id,src_video_upload_id:p.src_media_upload_id,content_type:_,primary_entity_key:String(null!=v?v:w),primary_entity_type:null!=b?b:C,entity_key:String(w),entity_type:C,publication_id:p.publication_id,surface:g,display:(0,f.aS)()?"fullscreen":document.pictureInPictureElement?"pip":"inline",muted:null!=(o=null==(n=this.player)?void 0:n.muted)&&o,captions_enabled:S?I:null,autoplay:this.state.autoPlay&&!this.state.failedAutoplay,is_preview:null!=(s=this.props.usePreview)&&s,current_time:Math.floor(null!=(c=this.state.currentTime)?c:0),duration:Math.floor(null!=(d=this.state.duration)?d:0),duration_played:Math.floor(this.state.durationPlayed),duration_played_id:this.state.durationPlayedId}),u))}render(){var e;let t=this.props,n=null!=(e=this.state)?e:{},{height:i,width:r}=(0,C.videoPlayerDimensions)(t.mediaUpload,{isStatic:!1}),a=s()("video-player",{"video-player-clip":t.isClipping,"video-player-with-background":!t.omitBackgroundColor},t.videoPlayerClassName);return(0,l.Y)(D,{className:s()(t.className,{"with-preview":!n.previewHidden,"full-width":r>=960,"video-player-wrapper-clip":t.isClipping,"video-player-with-background":!t.omitBackgroundColor}),linkClassName:a,href:this.href(),width:r,height:i,onClick:this.onPreviewClick,style:t.style,liveStreamId:t.liveStreamId,children:this.renderPlayer(this.props,this.state)})}renderPlayer(e,t){let{hidePlayButton:n,mediaUpload:i,noPreview:r,renderPlayButton:a,renderOverlay:o,startMuted:s,videoClassName:d,liveStreamId:p,loop:h,thumbnailUrl:g,noPictureInPicture:v=!1}=e,{autoPlay:Y,attemptingToPlay:w,previewHidden:C,useHLSJS:I,browserCanPlayHLS:F,HLSerrored:D,failedAutoplay:E,playing:N}=t,P=!this.playbackEnabled(),x=this.getBaseVideoSrc(),L=[];L=p?["hls"]:F?["hls","mp4"]:I?[]:(0,f.m0)()?["hls","mp4"]:D?["mp4"]:["hls","mp4"];let O=(0,f.rr)(),B=!!(0,m.Ay)("use_preloaded_player_sources")&&O,M=Y&&!E&&this.playbackEnabled(),R=g||"".concat((0,_.H10)(i),"?refresh=").concat(i.updated_at),U=this.shouldShowNativeVideoControls();return[this.playbackEnabled()&&"undefined"!=typeof window&&(0,l.Y)("video",{ref:this.assignPlayer,controls:U,controlsList:"nodownload",autoPlay:M,poster:R,muted:s,loop:h,className:d,playsInline:O,disablePictureInPicture:v,crossOrigin:"anonymous",children:B?Object.entries(this.state.sources).map((e,t)=>{let[n,i]=e;return(0,l.Y)("source",{src:i,type:S[n],onError:t===Object.keys(this.state.sources).length-1?this.onAllSourcesFailed:void 0},"".concat(n,"_").concat(t))}):L.map((e,t)=>(0,l.Y)("source",{src:(0,_.oRR)(x,{type:e}),type:S[e],onError:t===L.length-1?this.onAllSourcesFailed:void 0},"".concat(e,"_").concat(t)))}),o&&(0,l.Y)("div",{className:k.A.previewOverlay,children:o({isPlaying:N,getCurrentTimeInSeconds:()=>this.state.currentTime})}),!r&&!C&&!n&&(0,l.FD)(c.Fragment,{children:[P&&(0,l.Y)(T,{mediaUpload:i,thumbnailUrl:R}),!a&&(0,l.Y)(A,{children:this.cta()?(0,l.Y)(b.Bj,{href:this.href(),loading:w&&this.playbackEnabled(),"aria-label":"play",leading:(0,l.Y)(u.A,{height:16,width:16,style:{stroke:"none",fill:"white"}}),children:this.cta()}):(0,l.Y)(y.ro,{isPlaying:!1,href:this.href(),size:72,loading:w&&this.playbackEnabled()})}),a&&(0,l.Y)(A,{children:a()})]})]}isChromeWithBrokenNativeHLS(){var e;if("undefined"==typeof navigator)return!1;let t=null==(e=navigator.userAgentData)?void 0:e.brands;if(!t)return!1;let n=t.find(e=>"Google Chrome"===e.brand);return n&&parseInt(n.version)>=141}_initHlsjs(){let e=!!(this.player&&this.player.canPlayType("application/vnd.apple.mpegurl"));if(e&&!(0,f.m0)()&&!this.isChromeWithBrokenNativeHLS()){this.setState({browserCanPlayHLS:e}),this.autoPlayVideo();return}n.e("9234").then(n.bind(n,40137)).then(e=>{this._initHlsjsWrapped(e.default)})}autoPlayVideo(){if(this.state.autoPlay&&this.player){let e=new IntersectionObserver(t=>{t.forEach(t=>{if(e.unobserve(t.target),t.isIntersecting&&this.player){var n;this.player.muted=null!=(n=this.props.startMuted)&&n,this.player.play().catch(e=>{console.error("Unable to autoplay prior to user interaction with the dom.",e),this.setState({failedAutoplay:!0,attemptingToPlay:!1}),this.player&&(this.player.muted=!0,this.player.play().then(()=>{var e,t;null==(e=(t=this.props).onAutoplayMuted)||e.call(t)}).catch(e=>{console.error("Unable to autoplay prior to user interaction with the dom when muted.",e),this.setState({failedAutoplay:!0,attemptingToPlay:!1})}))})}})},{threshold:.5});e.observe(this.player)}}_initHlsjsWrapped(e){let t=this,n=e.isSupported();if(!e.isSupported()){this.setState({useHLSJS:n}),this.autoPlayVideo();return}null!=this.hls&&this.hls.destroy();let i=new e((0,r._)({enableWorker:!1},{}));null!=this.player&&i.attachMedia(this.player);let a=this.getBaseVideoSrc("hls");i.on(e.Events.MEDIA_ATTACHED,()=>{i.loadSource(a),i.on(e.Events.MANIFEST_PARSED,()=>{this.autoPlayVideo()})}),i.on(e.Events.ERROR,function(n,r){if(r.fatal)switch(r.type){case e.ErrorTypes.NETWORK_ERROR:var a;t.setState({useHLSJS:!1}),null==(a=t.hls)||a.destroy(),i.startLoad();break;case e.ErrorTypes.MEDIA_ERROR:i.recoverMediaError();break;default:this._initHlsjs()}}),this.hls=i,this.hlsModule=e}constructor(e,t){var n,l;super(e,t),n=this,(0,i._)(this,"player",null),(0,i._)(this,"previewHiddingTimeout",null),(0,i._)(this,"lastTimeUpdate",null),(0,i._)(this,"_accumulatedDurationPlayed",0),(0,i._)(this,"containerRef",(0,c.createRef)()),(0,i._)(this,"isShowingCaptionsElsewhere",!1),(0,i._)(this,"assignPlayer",e=>{this.player=e}),(0,i._)(this,"resetDurationTracking",()=>{this.lastTimeUpdate=null,this.setState({durationPlayed:0,durationPlayedId:(0,d.v4)()})}),(0,i._)(this,"onLoadedMetadata",()=>{this.state.playbackRestoreLocation&&(this.player&&(this.player.currentTime=this.state.playbackRestoreLocation),this.previewHiddingTimeout=window.setTimeout(()=>this.setState({playbackRestoreLocation:null,previewHidden:!0}),3e3))}),(0,i._)(this,"onLoadedData",()=>{this.state.playbackRestoreLocation&&(this.previewHiddingTimeout&&clearTimeout(this.previewHiddingTimeout),this.setState({playbackRestoreLocation:null,previewHidden:!0}))}),(0,i._)(this,"onCanPlay",()=>{this.onTimeUpdate()}),(0,i._)(this,"onPlay",()=>{null===f.dO||void 0===f.dO||f.dO.emit("play",this),this.setState({playing:!0}),this.lastTimeUpdate=Date.now(),this.trackMedia(h.qY.MEDIA_PLAYBACK_STARTED)}),(0,i._)(this,"onPause",()=>{var e;this.setPlaybackRestoreLocation(),this.lastTimeUpdate=null,this.setState({playing:!1,waiting:!1,previewHidden:!this.props.showPreviewWhenPaused&&this.state.previewHidden}),(null==(e=this.player)?void 0:e.ended)||this.trackMedia(h.qY.MEDIA_PLAYBACK_PAUSED),this.player&&this.player.currentTime>this.player.duration-.1&&this.onVideoReachEnd()}),(0,i._)(this,"onEnded",()=>{this.lastTimeUpdate=null,this.setState({playing:!1,waiting:!1,previewHidden:!this.props.showPreviewWhenPaused&&this.state.previewHidden}),this.trackMedia(h.qY.MEDIA_PLAYBACK_PAUSED),this.onVideoReachEnd()}),(0,i._)(this,"onTimeUpdate",()=>{if(!this.player||!isFinite(this.player.duration))return;let e=this.player.currentTime,t=Date.now();if(this.state.playing&&null!==this.lastTimeUpdate){let e=(t-this.lastTimeUpdate)/1e3;e>0&&e<1&&(this._accumulatedDurationPlayed=(this._accumulatedDurationPlayed||0)+e,this._accumulatedDurationPlayed>=1&&(this.setState(e=>({durationPlayed:e.durationPlayed+this._accumulatedDurationPlayed})),this._accumulatedDurationPlayed=0))}this.lastTimeUpdate=t,(this.props.duration||this.state.duration===this.player.duration)&&this.state.currentTime===e?this.setState({waiting:!1}):this.setState({duration:this.props.duration||this.player.duration,currentTime:e,waiting:!1})}),(0,i._)(this,"onWaiting",()=>{this.lastTimeUpdate=null,this.setState({waiting:Date.now()})}),(0,i._)(this,"onPlaying",()=>{this.previewHiddingTimeout&&clearTimeout(this.previewHiddingTimeout),this.lastTimeUpdate=Date.now(),this.setState({playing:!0,waiting:!1,previewHidden:!0,attemptingToPlay:!1,autoPlay:!1,hasPlayed:!0})}),(0,i._)(this,"onSeeked",()=>{this.lastTimeUpdate=Date.now(),this.trackMedia(h.qY.MEDIA_SEEKED)}),(0,i._)(this,"onVideoReachEnd",function(){let{resetTime:e=!0,triggerCallback:t=!0,track:i=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n.lastTimeUpdate=null,n.player&&!n.player.paused&&n.player.pause(),n.state.previewHidden&&n.setState({previewHidden:!1,attemptingToPlay:!1,hasReachedEnd:!0}),e&&n.player&&!(0,f.gI)()&&!n.props.doNotResetOnEnd&&(n.player.currentTime=0),(0,f.Eh)(),(0,f.wp)(),n.props.onFinishVideo&&t&&n.props.onFinishVideo(),i&&n.trackMedia(h.qY.MEDIA_PLAYBACK_COMPLETED)}),(0,i._)(this,"onContextMenu",e=>{e.preventDefault()}),(0,i._)(this,"onUserInteraction",()=>{this.state.showControls||this.setState({showControls:!0})}),(0,i._)(this,"onAllSourcesFailed",()=>{var e,t;console.info("Failed to load all video sources, falling back to preview image"),this.setState((0,a._)((0,r._)({},this.props.liveStreamId?{}:{previewHidden:!1,attemptingToPlay:!1,autoPlay:!1}),{allSourcesFailed:!0})),null==(e=(t=this.props).onPlaybackFailed)||e.call(t)}),(0,i._)(this,"onBeforeUnload",()=>{this.setPlaybackRestoreLocation(),this.state.previewHidden&&this.setState({previewHidden:!1,attemptingToPlay:!1}),this.player&&!this.player.paused&&this.player.pause()}),(0,i._)(this,"onGlobalPlay",e=>{this!==e&&this.player&&!this.player.paused&&this.player.pause()}),(0,i._)(this,"onGlobalKeyDown",e=>{var t;this.props.noKeyboardShortcuts||e.metaKey||e.altKey||e.ctrlKey||document.activeElement!==document.body||!this.player||(!((null!=(t=null===f.dO||void 0===f.dO?void 0:f.dO.listenerCount("play"))?t:0)>1)||!this.player.paused)&&("f"===e.key?(0,f.aS)()?(0,f.Eh)()&&e.preventDefault():((0,f.gK)(this.player)&&e.preventDefault(),this.player.paused&&this.player.play()):" "!==e.key||(0,f.aS)()?"ArrowRight"===e.key?this.player.currentTime+5>this.player.duration?this.onVideoReachEnd():(this.player.currentTime+=5,this.state.previewHidden||this.setState({previewHidden:!0,attemptingToPlay:!1})):"ArrowLeft"===e.key&&(this.player.currentTime-=5):(e.preventDefault(),this.player.paused?this.player.play():this.player.pause()))}),(0,i._)(this,"getEntityKeyAndType",()=>{let{mediaUpload:e,communityPostId:t,entityKey:n,entityType:i}=this.props;return n?{entityKey:n,entityType:i}:t?{entityKey:t,entityType:"community_post"}:e.post_id?{entityKey:String(e.post_id),entityType:"post"}:{entityKey:n,entityType:i}}),(0,i._)(this,"getBaseVideoSrc",e=>{var t;let n={token:this.props.reaction_token,override_publication_id:null==(t=this.props.pub)?void 0:t.id,preview:this.props.usePreview};return e&&(n.type=e),(0,_.oRR)("/api/v1/video/upload/".concat(this.props.mediaUpload.id,"/src"),n)}),(0,i._)(this,"hls",null),(0,i._)(this,"hlsModule",void 0),(0,i._)(this,"cta",()=>""),(0,i._)(this,"href",()=>this.props.href),(0,i._)(this,"playbackEnabled",()=>!0),(0,i._)(this,"onClickNonPlayableVideo",()=>{});const o="undefined"!=typeof window?(0,w.m)(window.location.href):{};let s=null;o.timestamp?s=parseInt(o.timestamp):o.t&&(s=parseInt(o.t));const u=null!==s&&!isNaN(s);u||(0,f.qm)("timestamp");const p=u?s:this.getPlaybackRestoreLocation();this.state={playbackRestoreLocation:p,currentTime:0,waiting:!0,duration:null!=(l=e.mediaUpload.duration)?l:null,autoPlay:e.autoPlay,playing:!1,attemptingToPlay:e.autoPlay,previewHidden:null!==p&&p>0,showControls:!1,hasPlayed:!1,hasReachedEnd:!1,browserCanPlayHLS:!1,useHLSJS:!0,HLSerrored:!1,allSourcesFailed:!1,failedAutoplay:!1,sources:{},durationPlayed:0,durationPlayedId:(0,d.v4)()},this.onPreviewClick=this.onPreviewClick.bind(this)}}function F(e){let{className:t,mediaUpload:n,href:i}=e;return(0,l.Y)(D,(0,a._)((0,r._)({},(0,C.videoPlayerDimensions)(n,{isStatic:!0})),{className:s()(t,"video-player-with-background","is-static"),linkClassName:"video-player-with-background",href:i,children:(0,l.Y)(T,{mediaUpload:n,testId:"video-player-static-preview-image",isStatic:!0})}))}function D(e){let{className:t,linkClassName:n,width:i,height:r,href:a,onClick:o,children:c,style:d,liveStreamId:u}=e,p={paddingBottom:"".concat(Math.min(u?56.25:60,100*r/i).toFixed(4),"%")};return(0,l.Y)("div",{className:s()(t,"video-player-wrapper",i>=960&&"full-width"),onClick:o,role:"region","aria-label":"Video player",style:d,children:(0,l.Y)(a?"a":"div",{className:s()("video-player",n),href:a,style:p,children:c})})}function T(e){let{mediaUpload:t,thumbnailUrl:n,testId:i,isStatic:r}=e;return(0,l.Y)("img",{className:"video-player-preview",width:550,src:n||(0,_.Pzx)(t,{isStatic:r}),"data-component-name":"VideoPlayer-PreviewImg","data-testid":i})}let A=(0,v.I4)({position:"absolute",className:s()(k.A.buttonContainer,"video-player-button")})},69324:function(e,t,n){n.d(t,{Ku:()=>u,yl:()=>h});var i=n(4006),r=n(83673),a=n.n(r),l=n(6411),o=n.n(l),s=n(17402),c=n(12501),d=n(21398);function u(){return(0,s.useContext)(p)}let p=(0,s.createContext)({open:()=>void 0,isOpen:!1});function h(e){let{children:t,load:r,useLocalNavigation:l}=e,[u,h]=(0,s.useState)(!1),[m,g]=(0,s.useState)(!1),f=(0,c.st)({pathname:"/api/v1/search/suggestions_v2",auto:m,deps:[m]}),v=f.result?a()([f.result.featuredTopic,...f.result.suggestedSearches]):[];(0,s.useEffect)(()=>{if(!r)return;let e=e=>{e.preventDefault(),h(!0),g(!0)};return o().bind(["/","command+k"],e),()=>{o().unbind(["/",e]),o().unbind(["command+k",e])}},[r]);let b=(0,s.useMemo)(()=>({open:()=>{r&&(h(!0),g(!0))},isOpen:u}),[r,u]);return r?(0,i.FD)(p.Provider,{value:b,children:[t,(0,i.Y)(d.Ic,{module:"@/frontend/substack/GlobalSearch",resolve:e=>e.GlobalSearch,onRequest:()=>Promise.all([n.e("75381"),n.e("84921"),n.e("94950")]).then(n.bind(n,88737)),isOpen:u,onClose:()=>h(!1),useLocalNavigation:l,suggestedSearches:v})]}):(0,i.Y)(i.FK,{children:t})}},82936:function(e,t,n){n.d(t,{Hv:()=>Y,_N:()=>y,bd:()=>_,hU:()=>k,uL:()=>C});var i=n(79785),r=n(4006),a=n(63122),l=n(40972),o=n(17402),s=n(84605),c=n(46271),d=n(94729);n(12501);var u=n(68349),p=n(88774),h=n(36372);function m(){let e=(0,i._)([""," muted"]);return m=function(){return e},e}function g(){let e=(0,i._)([""," unmuted"]);return g=function(){return e},e}function f(){let e=(0,i._)([""," blocked"]);return f=function(){return e},e}function v(){let e=(0,i._)([""," unblocked"]);return v=function(){return e},e}let b=(0,o.createContext)({result:{mutes:[],blocks:[],blocked:[]},refetch:async()=>null,isBlockingUser:()=>!1,isMutedByUser:()=>!1,isBlockedByUser:()=>!1});function y(e){let{isBlockingUser:t,isBlockedByUser:n}=(0,o.useContext)(b);return e?n(e)?"blocking":t(e)?"blocked":null:null}function Y(e){let{isBlockingUser:t,isBlockedByUser:n,isMutedByUser:i}=(0,o.useContext)(b);return e?i(e)?"muting":n(e)?"blocking":t(e)?"blocked":null:null}function _(e,t){let{surface:n,noteId:i,onClick:y}=t,{iString:_,iTemplate:w}=(0,s.GO)(),C=(0,c.Jd)(),k=!!(C&&e&&C.id!==e.id),S=(0,o.useContext)(b),I=Y(null==e?void 0:e.id),F=(0,h.d)(),D=async()=>{if(e){try{await (0,d.x6)("/api/v1/blocks/".concat(e.id),{method:"POST",json:{type:"mute",surface:n,noteId:i}})}catch(e){F.popToast(()=>(0,r.Y)(h.y,{text:(0,u.uX)(e)}));return}S.refetch(),F.popToast(()=>(0,r.Y)(h.y,{text:w(m(),e.name||"User"),Icon:a.A})),null==y||y("mute")}},T=async()=>{if(e){try{await (0,d.x6)("/api/v1/blocks/".concat(e.id),{method:"DELETE",query:{surface:n,noteId:i}})}catch(e){F.popToast(()=>(0,r.Y)(h.y,{text:(0,u.uX)(e)}));return}S.refetch(),F.popToast(()=>(0,r.Y)(h.y,{text:w(g(),e.name||"User"),Icon:a.A})),null==y||y("unmute")}},A=async()=>{if(e){try{await (0,d.x6)("/api/v1/blocks/".concat(e.id),{method:"POST",json:{type:"block",surface:n,noteId:i}})}catch(e){F.popToast(()=>(0,r.Y)(h.y,{text:(0,u.uX)(e)}));return}S.refetch(),F.popToast(()=>(0,r.Y)(h.y,{text:w(f(),e.name||"User"),Icon:l.A})),null==y||y("block")}},E=async()=>{if(e){try{await (0,d.x6)("/api/v1/blocks/".concat(e.id),{method:"DELETE",query:{surface:n,noteId:i}})}catch(e){F.popToast(()=>(0,r.Y)(h.y,{text:(0,u.uX)(e)}));return}S.refetch(),F.popToast(()=>(0,r.Y)(h.y,{text:w(v(),e.name||"User"),Icon:l.A})),null==y||y("unblock")}},N=[];return k&&("blocking"!==I&&N.push((0,r.Y)(p.Dr,{leading:(0,r.Y)(a.A,{}),priority:"destructive",onClick:"muting"===I?T:D,children:_("muting"===I?"Unmute":"Mute")})),N.push((0,r.Y)(p.Dr,{leading:(0,r.Y)(l.A,{}),priority:"destructive",onClick:"blocking"===I?E:A,children:_("blocking"===I?"Unblock":"Block")}))),N}b.displayName="UserBlockContext";let w=(0,o.createContext)(!1);function C(e){let{muteFree:t=!0,children:n}=e;return(0,r.Y)(w.Provider,{value:t,children:n})}function k(){return(0,o.useContext)(w)}w.displayName="MuteFreeZone"},94794:function(e,t,n){n.d(t,{QR:()=>l,aZ:()=>o});var i=n(4006),r=n(17402);let a=(0,r.createContext)(null);function l(e){let{crossPost:t=null,children:n}=e;return(0,i.Y)(a.Provider,{value:t,children:n})}function o(){return(0,r.useContext)(a)}a.displayName="CrossPostContext"},19672:function(e,t,n){n(4006),n(4169),n(63558),n(43510),n(84605),n(30230),n(35369),n(76977),n(48625)},30230:function(e,t,n){n.d(t,{Al:()=>h,X$:()=>p,_z:()=>u});var i=n(20347),r=n(3849),a=n(69277),l=n(70408),o=n(4006),s=n(33727),c=n(82100),d=n(97515);function u(e){let{children:t}=e;return(0,o.Y)(s.Z,{padding:16,gap:20,elevated:!1,children:t})}function p(e){let{isDragging:t,dragProps:n,children:i}=e;return(0,o.Y)(c.Q,{padding:16,gap:20,isDragging:t,dragProps:n,elevated:!1,children:i})}function h(e){var t=(0,i._)({},(0,r._)(e));return(0,o.Y)(d.p,(0,l._)((0,a._)({},t),{padding:4}))}n(1140)},21003:function(e,t,n){n.d(t,{x:()=>d});var i=n(4006),r=n(32485),a=n.n(r);n(83673);var l=n(38221),o=n.n(l);n(63375),n(17402),n(15734),n(99070),n(52077),n(84605),n(19672),n(56463),n(95064),n(39598),n(26289),n(86500),n(68349),n(98394),n(89490),n(35369),n(76977),n(22602);var s=n(63136);n(65842),n(36372),n(66511),n(39318),n(82776),n(92967);var c=n(38610);o()((e,t,n,i)=>{e.current.resetAfterIndex(t,!0),n(i)});let d=e=>{let{searchTerm:t,rowIndex:n,isFocused:r,text:l}=e,o=RegExp("(".concat(t,")"),"gi"),d=l.split(o);return(0,i.Y)(s.EY.B3,{padding:2,color:"primary","data-chunk-index":n,className:c.A.text,children:d.map(e=>{var t;return e.match(o)?(0,i.Y)("span",{className:a()(c.A.searchResult,{[null!=(t=c.A.isFocused)?t:"undefined"]:r}),children:e}):e})})}},95064:function(e,t,n){n.d(t,{IS:()=>k,Of:()=>C,Qj:()=>S});var i=n(4006),r=n(38221),a=n.n(r),l=n(69843),o=n.n(l),s=n(98445),c=n(48697),d=n(72102),u=n(75107),p=n(17402),h=n(44518),m=n(84605);n(77441);var g=n(86500),f=n(68410),v=n(35369),b=n(76977);n(88774);var y=n(63136),Y=n(17836);n(16291),n(50874),n(82776);var _=n(38610);let w=(0,p.createContext)({isSearching:!1,items:[],setIsSearching:()=>void 0,setItems:()=>void 0,focusedItemStart:null,setFocusedItemStart:()=>void 0,filteredItems:[],searchTerm:null,setSearchTerm:()=>void 0,hasFiltered:!1}),C=e=>{let{children:t}=e,[n,r]=(0,p.useState)(!1),[a,l]=(0,p.useState)([]),[o,s]=(0,p.useState)(null),[c,d]=(0,p.useState)(null),{filteredItems:u,setQuery:m,hasFiltered:g}=(0,h.S)({items:a,getKeys:e=>[e.text],sortFunc:(e,t)=>e.start-t.start});return(0,p.useEffect)(()=>{var e,t;s(null!=(t=null==(e=u[0])?void 0:e.start)?t:null)},[u]),(0,i.Y)(w.Provider,{value:{isSearching:n,setIsSearching:r,items:a,setItems:l,focusedItemStart:o,setFocusedItemStart:s,filteredItems:u,hasFiltered:g,searchTerm:c,setSearchTerm:e=>{d(e),m(e)}},children:t})},k=()=>(0,p.useContext)(w),S=e=>{let{postId:t,closeAlwaysVisible:n=!0}=e,{iString:r}=(0,m.GO)(),{isMobile:l}=(0,f.sM)(),h=(0,p.useRef)(null),{setSearchTerm:w,setIsSearching:C,hasFiltered:S,filteredItems:I,setFocusedItemStart:F,focusedItemStart:D,searchTerm:T}=k();(0,p.useEffect)(()=>{!T&&h.current&&(h.current.value="")},[T]);let A=I.findIndex(e=>e.start===D),E=()=>{let e=A+1>=I.length?0:A+1,t=I[e];o()(t)?console.warn("nextItem not found at index ".concat(e)):F(t.start)},N=()=>{w(""),C(!1),(0,g.u4)(g.qY.TRANSCRIPTION_SEARCH_CANCELLED,{post_id:t})};return(0,i.FD)(b.Ye,{gap:8,justifyContent:"space-between",alignItems:"center",className:_.A.searchForm,children:[(0,i.Y)(Y.c,{ref:h,leftIcon:(0,i.Y)(b.Ye,{children:(0,i.Y)(s.A,{size:16})}),rightIcon:(0,i.Y)(b.Ye,{cursor:"pointer",onClick:N,children:T||n?(0,i.Y)(c.A,{size:16}):null}),placeholder:r("Search"),onChange:a()(e=>{w(e.target.value),(0,g.u4)(g.qY.TRANSCRIPTION_SEARCHED,{post_id:t})},100),onKeyDown:e=>{"Enter"===e.key&&E(),"Escape"===e.key&&N()}}),S&&(0,i.Y)(b.Ye,{gap:8,paddingRight:8*!!l,children:(0,i.FD)(b.Ye,{alignItems:"center",gap:8,children:[(0,i.Y)(y.EY.B4,{paddingLeft:l?4:16,className:_.A.resultsValue,color:"primary",weight:"semibold",children:"".concat(A+1," / ").concat(I.length)}),(0,i.FD)(b.Ye,{children:[(0,i.Y)(v.K0,{priority:"tertiary",size:"sm",onClick:()=>{let e=A-1<0?I.length-1:A-1,t=I[e];o()(t)?console.warn("lastItem not found at index ".concat(e)):F(t.start)},children:(0,i.Y)(d.A,{size:20})}),(0,i.Y)(v.K0,{priority:"tertiary",size:"sm",onClick:E,children:(0,i.Y)(u.A,{size:20})})]})]})})]})}},56463:function(e,t,n){n(4006),n(76977)},51498:function(e,t,n){n.d(t,{B:()=>F,R:()=>D});var i=n(4006),r=n(48697),a=n(54718),l=n(44471),o=n(17402),s=n(94090),c=n(82936),d=n(84605),u=n(46271),p=n(27749),h=n(75840),m=n(86500),g=n(12501),f=n(35369),v=n(16074),b=n(76977),y=n(88774),Y=n(16993),_=n(63136),w=n(11587),C=n(504),k=n(70515),S=n(66874);let I=["Not interesting","Slop","Clickbait","Spam","Shilling","Political","Rude","Other..."];function F(e){let{item:t,author:n,comment:r,post:a,onCancel:l}=e,o=(0,p.PK)(),d=(0,h.T)(),m=(0,u.Jd)(),f=!1;if("comment"==t.type&&r&&m){var v;let e=(0,k.$f)(r),n=null==(v=t.parentComments)?void 0:v.find(t=>(null==t?void 0:t.id)===e);f=(null==n?void 0:n.user_id)===m.id}let b=[...(0,c.bd)(n,{surface:o,noteId:t.entity_key,onClick(e){(0,C.Qb)(t,o,e,{tabId:d})}}),(0,s.a2)({publication:t.publication,post:a,comment:r,item:t})],y=(0,g.st)({pathname:"/api/v1/note/".concat(t.entity_key,"/hide"),method:"DELETE"}),Y=async()=>{y.refetch(),l()};return f?(0,i.Y)(A,{moreMenuItems:b,onUndo:Y}):(0,i.Y)(P,{item:t,moreMenuItems:b,onUndo:Y})}function D(e){let{onDismiss:t,item:n}=e,{iString:a}=(0,d.GO)(),l=(0,p.PK)(),o=(0,h.T)(),s=(0,g.st)({pathname:"/api/v1/note/".concat(n.entity_key,"/hide"),method:"POST",json:{tabId:o,surface:l}}),c=async()=>{s.refetch(),t()};return(0,i.Y)(f.K0,{priority:"quaternary",size:"xs",color:"secondary",onClick:c,className:S.A.dismissButton,"aria-label":a("Hide note"),width:16,children:(0,i.Y)(r.A,{height:16,width:16})})}function T(e){let{moreMenuItems:t,onUndo:n}=e,{iString:r}=(0,d.GO)();return(0,i.FD)(b.Ye,{gap:4,alignItems:"center",children:[(0,i.Y)(y.W1,{trigger:(0,i.Y)(f.K0,{priority:"quaternary",size:"sm","aria-label":r("More options"),children:(0,i.Y)(a.A,{size:16})}),children:t}),(0,i.Y)(f.$n,{priority:"secondary",size:"sm",onClick:n,children:r("Undo")})]})}function A(e){let{moreMenuItems:t,onUndo:n}=e,r=(0,d.GO)().iString;return(0,i.Y)(b.VP,{children:(0,i.FD)(b.Ye,{alignItems:"center",justifyContent:"space-between",children:[(0,i.Y)(_.EY.B3,{children:r("This reply has been removed and is no longer visible in the thread.")}),(0,i.Y)(T,{moreMenuItems:t,onUndo:n})]})})}function E(e){let{onClose:t,item:n}=e,{iString:r}=(0,d.GO)(),a=(0,p.PK)(),[l,s]=(0,o.useState)("");return(0,i.FD)(i.FK,{children:[(0,i.Y)(Y.cw,{children:(0,i.Y)(w.T,{value:l,onChange:e=>s(e.currentTarget.value),placeholder:r("Tell us why...")})}),(0,i.Y)(Y.jl,{alignButtons:"stretch",primaryButton:(0,i.Y)(f.$n,{priority:"primary",onClick:()=>{(0,m.u4)(m.qY.NOTE_HIDDEN_FEEDBACK_SUBMITTED,{otherFeedbackText:l,note_id:n.entity_key,surface:a}),t()},children:r("Submit")})})]})}function N(e){let{isOpen:t,item:n,onClose:r}=e,{iString:a}=(0,d.GO)();return(0,i.FD)(Y.aF,{isOpen:t,onClose:r,children:[(0,i.Y)(Y.rQ,{title:a("Why do you want to see less of this?"),showClose:!0,onClose:r}),(0,i.Y)(E,{onClose:r,item:n})]})}function P(e){let{item:t,moreMenuItems:n,onUndo:r}=e,a=(0,p.PK)(),{iString:s}=(0,d.GO)(),[c,u]=(0,o.useState)(!1),[h,g]=(0,o.useState)(!1);return(0,i.FD)(b.VP,{gap:20,children:[(0,i.FD)(b.Ye,{justifyContent:"space-between",alignItems:"center",children:[(0,i.FD)(b.VP,{gap:4,children:[(0,i.Y)(_.EY.B3,{children:s("We'll show you less like this.")}),(0,i.Y)(_.EY.B4,{color:"secondary",children:s("Please tell us why below")})]}),(0,i.Y)(T,{moreMenuItems:n,onUndo:r})]}),(0,i.FD)(b.VP,{gap:20,paddingX:16,children:[(0,i.Y)(v.c,{}),c?(0,i.FD)(b.Ye,{gap:8,alignItems:"center",justifyContent:"center",children:[(0,i.Y)(l.A,{size:16}),(0,i.Y)(_.EY.B4,{children:s("Thank you for your feedback.")})]}):(0,i.Y)(b.Ye,{gap:16,wrap:"wrap",children:I.map(e=>(0,i.Y)(f.$n,{priority:"secondary",size:"sm",onClick:()=>{"Other..."===e?g(!0):((0,m.u4)(m.qY.NOTE_HIDDEN_FEEDBACK_SUBMITTED,{Reason:e,note_id:t.entity_key,surface:a}),u(!0))},children:s(e)},e))})]}),(0,i.Y)(N,{isOpen:h,item:t,onClose:()=>g(!1)})]})}},80520:function(e,t,n){n.d(t,{N:()=>v});var i=n(4006),r=n(46110),a=n(17402),l=n(22857),o=n(84605),s=n(27749),c=n(2675),d=n(75840),u=n(35369),p=n(76977),h=n(16993),m=n(63136),g=n(504),f=n(44307);function v(e){let{item:t,pub:n,post:l}=e,[s,c]=(0,a.useState)(!1),{iString:d}=(0,o.GO)();return(0,i.FD)(i.FK,{children:[(0,i.Y)(u.K0,{priority:"quaternary",size:"sm",className:f.A.moreButton,onClick:()=>c(!0),children:(0,i.Y)(r.A,{size:16})}),(0,i.FD)(h.aF,{isOpen:s,onClose:()=>c(!1),width:440,children:[(0,i.Y)(h.rQ,{icon:(0,i.Y)(r.A,{size:20}),title:d("Auto-generated clip"),showClose:!0,onClose:()=>c(!1)}),(0,i.Y)(h.cw,{children:(0,i.Y)(p.I1,{gap:16,children:(0,i.Y)(m.EY.B3,{children:d("Substack automatically selected this clip for you from the full video below.")})})}),(0,i.Y)(h.jl,{primaryButton:(0,i.Y)(b,{item:t,pub:n,post:l,onClose:()=>c(!1)}),secondaryButton:(0,i.Y)(u.$n,{priority:"secondary",onClick:()=>c(!1),children:d("Done")})})]})]})}let b=e=>{let{item:t,pub:n,post:r,onClose:p}=e,{iString:h}=(0,o.GO)(),m=(0,c.vZ)({post:r,publication:n}),f=(0,s.PK)(),v=(0,a.useContext)(d.P);return(0,i.Y)(l.q,{children:(0,i.Y)(u.$n,{priority:"primary",onClick:e=>{(0,g.Qb)(t,f,"watch_full_episode",{tabId:v}),m(e),p()},children:h("View Full Episode")})})}},27332:function(e,t,n){n.d(t,{GZ:()=>Z,Iz:()=>V,LY:()=>x,M6:()=>W,X6:()=>J,j6:()=>N,jS:()=>B,l8:()=>M,qv:()=>$,wF:()=>R});var i=n(69277),r=n(70408),a=n(4006),l=n(75107),o=n(84565);n(58050);var s=n(84605),c=n(85478),d=n(46271);n(95282);var u=n(27749),p=n(51498),h=n(80520),m=n(77405),g=n(25859),f=n(58292),v=n(89490),b=n(35369),y=n(76977),Y=n(88774),_=n(63136),w=n(92028),C=n(504),k=n(83629),S=n(85050),I=n(16884),F=n(49095),D=n(16291),T=n(75914),A=n(49807),E=n(57324);let N=["post_like","post_restack","comment_like"],P=["search","note-related","profile","publication","permalink"];function x(e){let{author:t,post:n,comment:r,onClick:l,utm_content:s,publication:d,item:p,allowHide:h=!1,timestamp:m,hideSubscribeCta:g,onDismiss:f}=e,v=(0,u.PK)(),b=m||(null==r?void 0:r.date)||(null==n?void 0:n.post_date),y=P.includes(v),Y=!!(0,c.mJ)().getConfigFor("feed_item_source_debug_mode"),_="treatment"===(0,o.NQ)().getExperimentVariant("web_gutterless_feed")&&"permalink"!==v&&"post-discussion"!==v,w={author:t,post:n,comment:r,onClick:l,utm_content:s,publication:d,item:p,allowHide:h,effectiveTimestamp:b,feedItemSourceDebugMode:Y,showDebugDot:Y&&p&&"trackingParameters"in p,shouldShowSubscribe:!g&&t&&p&&!y,onDismiss:f};return _?(0,a.Y)(L,(0,i._)({},w)):(0,a.Y)(O,(0,i._)({},w))}function L(e){let{author:t,post:n,comment:i,onClick:r,utm_content:l,publication:o,item:s,allowHide:c,effectiveTimestamp:d,feedItemSourceDebugMode:u,showDebugDot:p,shouldShowSubscribe:g}=e;return(0,a.FD)(y.VP,{flex:"grow",minWidth:0,children:[(0,a.FD)(y.pT,{gap:8,alignItems:"center",justifyContent:"space-between",children:[(0,a.Y)(R,{user:t,onClick:r,utm_content:l}),(0,a.FD)(y.ov,{height:20,children:[s&&(0,T.tL)(s,i)&&"post"===s.type&&n&&o&&(0,a.Y)(h.N,{item:s,pub:o,post:n}),(0,a.Y)(m.s,{publication:o,post:n,comment:i,item:s,allowHide:c,size:"xs"})]})]}),(0,a.FD)(y.pT,{gap:4,alignItems:"center",flex:"grow",minWidth:0,children:[d&&(0,a.Y)(V,{timestamp:d,comment:i}),u&&s&&(0,a.Y)(K,{item:s,showEntityKey:!0,showDebugDot:null!=p&&p}),g&&(0,a.Y)(U,{author:t,item:s,comment:null!=i?i:void 0,post:null!=n?n:void 0,publication:null!=o?o:void 0})]})]})}function O(e){let{author:t,post:n,comment:i,onClick:r,utm_content:l,publication:o,item:s,allowHide:c,effectiveTimestamp:u,feedItemSourceDebugMode:g,showDebugDot:f,shouldShowSubscribe:v,onDismiss:b}=e,Y=(0,d.Jd)(),_=Y&&b&&t.id!==Y.id&&((null==s?void 0:s.type)==="post"||(null==s?void 0:s.type)==="comment");return(0,a.FD)(J,{children:[(0,a.FD)($,{children:[(0,a.Y)(R,{user:t,onClick:r,utm_content:l}),u&&(0,a.Y)(V,{timestamp:u,comment:i}),g&&s&&(0,a.Y)(K,{item:s,showEntityKey:!0,showDebugDot:null!=f&&f})]}),v&&(0,a.Y)(U,{author:t,item:s,comment:null!=i?i:void 0,post:null!=n?n:void 0,publication:null!=o?o:void 0}),s&&(0,T.tL)(s,i)&&"post"===s.type&&n&&o&&(0,a.Y)(h.N,{item:s,pub:o,post:n}),(0,a.FD)(y.pT,{maxHeight:20,gap:6,alignItems:"center",children:[(0,a.Y)(m.s,{publication:o,post:n,comment:i,item:s,allowHide:c}),_&&(0,a.Y)(p.R,{onDismiss:b,item:s})]})]})}function B(e){let{user:t,setTargetUser:n,eligibleTargetUsers:i,targetUser:r}=e;return(0,a.Y)(J,{children:(0,a.Y)($,{children:(0,a.Y)(Y.W1,{trigger:(0,a.Y)(b.$n,{priority:"quaternary",size:"sm",color:"primary",trailing:(0,a.Y)(l.A,{size:16}),children:(0,a.Y)(M,{user:null!=r?r:t})}),children:i.map(e=>(0,a.Y)(Y.Dr,{onClick:()=>{e.id===t.id?n(null):n(e)},children:e.name},e.id))})})})}function M(e){let{user:t}=e;return(0,a.Y)(J,{children:(0,a.FD)($,{children:[(0,a.Y)(_.EY,{as:"span",weight:"medium",children:t.name}),(0,a.Y)(F.UserStatusSymbols,{status:t.status,userId:t.id,size:"xs"})]})})}function R(e){let{user:t,onClick:n,utm_content:i}=e;return(0,a.Y)(a.FK,{children:(0,a.FD)(_.EY.B3,{as:"span",weight:"medium",children:[(0,a.Y)(g.yp,{user:t,onClick:n,utm_source:E.VU.substackFeedItem,utm_content:i,children:t.name})," ",(0,a.Y)(F.UserStatusSymbols,{tier:t.bestseller_tier,status:t.status,userId:t.id,inline:!0,size:"xs"})]})})}function U(e){let{author:t,comment:n,post:i,item:r,permalink:l,publication:s}=e,{finalPublication:c,isSubscribed:d,showCta:p,handleClick:h,currentUser:m}=Z({targetUser:t,item:r,comment:n,post:i,publication:s}),g=(0,u.PK)(),f="treatment"===(0,o.NQ)().getExperimentVariant("web_gutterless_feed")&&"permalink"!==g&&"post-discussion"!==g;return(!m||m.id!==t.id)&&c&&p?(0,a.Y)(l?H:f?j:z,{isSubscribed:d,onClick:h}):null}function j(e){let{isSubscribed:t,onClick:n}=e,{iString:i}=(0,s.GO)();return(0,a.FD)(a.FK,{children:[(0,a.Y)(_.EY.B5,{as:"span",color:"secondary",children:"\xb7"}),(0,a.Y)(_.EY.B4,{as:"span",children:(0,a.Y)(w.Q,{color:t?"secondary":"accent",onClick:n,decoration:"hover-underline",children:i(t?"Subscribed":"Subscribe")})})]})}function z(e){let{isSubscribed:t,onClick:n}=e,{iString:i}=(0,s.GO)();return(0,a.Y)(b.$n,{priority:t?"quaternary":"tertiary-accent",size:"xs",onClick:n,children:i(t?"Subscribed":"Subscribe")})}function H(e){let{isSubscribed:t,onClick:n}=e,{iString:i}=(0,s.GO)();return(0,a.Y)(b.$n,{priority:t?"quaternary":"primary",size:"sm",onClick:n,children:i(t?"Subscribed":"Subscribe")})}let W=new Intl.DateTimeFormat(void 0,{dateStyle:"medium",timeStyle:"short"});function V(e){let{timestamp:t,comment:n,post:i,publication:r}=e;return(0,a.Y)(g.Yq,{href:n?(0,A.Zgx)(n,{noBase:k.Z}):i?(0,A.q$n)(r,i):void 0,color:"secondary",title:W.format((0,D.A)(t).toDate()),children:(0,a.Y)(f.iE,{timestamp:t})})}function K(e){let{item:t,showEntityKey:n,showDebugDot:i}=e;return(0,a.FD)(y.pT,{flex:"grow",gap:4,alignItems:"center",justifyContent:"end",children:[n&&(0,a.Y)(q,{item:t}),i&&(0,a.Y)(G,{item:t})]})}function q(e){let{item:t}=e;return"entity_key"in t?(0,a.Y)(_.EY.B4,{as:"span",color:"secondary",children:t.entity_key}):null}function G(e){var t;let n,i,{item:r}=e,{iString:l}=(0,s.GO)(),o=null==(t=r.trackingParameters)?void 0:t.item_source;return o?"model"===o?(n="accent-green",i="Model"):o.includes("db")?(n="accent-blue",i="DB"):o.includes("new-user")?(n="accent-purple",i="New user"):o.includes("topic-injection")?(n="accent-orange",i="Topic injection"):o.includes("trending")?(n="accent-red",i="Trending"):(n="tertiary",i="Other"):(n="accent-yellow",i="No source info"),(0,a.Y)("span",{children:(0,a.Y)(v.az,{height:8,width:8,radius:"full",bg:n,color:"secondary",title:l(i)})})}let J=(0,v.I4)((0,r._)((0,i._)({},_.nS),{display:"flex",minWidth:0,gap:8,alignItems:"center",height:20}));(0,v.I4)((0,r._)((0,i._)({},_.nS),{display:"flex",minWidth:0,gap:12,alignItems:"center"}));let $=(0,v.I4)({display:"flex",flex:"grow",minWidth:0,gap:8,alignItems:"center"});function Z(e){var t,n;let{targetUser:i,item:r,comment:a,post:l,publication:o}=e,s=(0,d.Jd)(),c=(0,u.PK)(),p=a?"comment":l?"post":void 0,h=null!=(n=null!=(t=null==a?void 0:a.id)?t:null==l?void 0:l.id)?n:0,m=p?(0,A.Vvu)(h,p):void 0,g=null!=o?o:null==i?void 0:i.primary_publication,f=(0,S.s)({surface:"substack-feed-item"})(g),v=(0,I.Zm)({user:i,publicationId:null==g?void 0:g.id,publicationName:null==g?void 0:g.name,subscriptionSource:"substack-feed-item",sourceNoteId:m});return{finalPublication:g,isSubscribed:v.isSubscribed,showCta:v.showCta,handleClick:e=>{r&&(0,C.Qb)(r,c,"subscribe"),!s&&g?f(e):v.isSubscribed?v.unsubscribe(e):v.subscribe(e)},currentUser:s}}},15557:function(e,t,n){n.d(t,{o:()=>o});var i=n(4006),r=n(13950),a=n(76977),l=n(21398);function o(){return(0,i.Y)(l.Ic,{module:"../feed/PublicationPage",onRequest:()=>n.e("56071").then(n.bind(n,54874)),resolve:e=>e.PublicationFeedPage,whileLoading:(0,i.Y)(s,{})})}function s(){return(0,i.Y)(r.DH,{children:(0,i.Y)(a.pT,{bg:"primary",style:{minHeight:800}})})}},25859:function(e,t,n){n.d(t,{NY:()=>Y,RC:()=>w,Yq:()=>C,yp:()=>_});var i=n(69277),r=n(70408),a=n(32641),l=n(4006),o=n(32485),s=n.n(o);n(17402);var c=n(27437),d=n(84777),u=n(84605),p=n(46271),h=n(72343),m=n(99662),g=n(63136),f=n(83629),v=n(83357),b=n(28700),y=n(4438);function Y(e){var{user:t,utm_source:n,utm_content:o,ellipsis:s,useYou:c,onClick:d}=e,h=(0,a._)(e,["user","utm_source","utm_content","ellipsis","useYou","onClick"]);let{iString:m}=(0,u.GO)(),g=(0,p.Jd)(),f=(null==t?void 0:t.id)||(null==t?void 0:t.user_id)||0,v=c&&(null==g?void 0:g.id)===f?m("You"):"name"in t?t.name:m("User");return(0,l.Y)(_,(0,r._)((0,i._)({user:t,utm_source:n,utm_content:o,ellipsis:s,onClick:d},h),{children:v}))}function _(e){var{user:t,utm_source:n,utm_content:o,children:s,onClick:d,ellipsis:u}=e,p=(0,a._)(e,["user","utm_source","utm_content","children","onClick","ellipsis"]);let h=(0,r._)((0,i._)({},t),{id:t.author_id||t.user_id||t.id,name:t.user_profile_name||t.author_name||t.name,handle:(null==t?void 0:t.handle)||(null==t?void 0:t.author_handle)});return(0,l.Y)(c.ProfileHoverCard,{subject:h,utmSource:"feed",trigger:(0,l.Y)(C,(0,r._)((0,i._)({href:(0,b.gY)(t,{noBase:f.Z}),campaign:n||o?{source:n,content:o}:void 0,onClick:d,showBack:!0,ellipsis:u,className:p.className,target:(0,m.y)()?"_blank":void 0},p),{children:s}))})}function w(e){var{publication:t,utm_source:n,utm_content:o,children:s,onClick:c,ellipsis:u}=e,p=(0,a._)(e,["publication","utm_source","utm_content","children","onClick","ellipsis"]);return(0,l.Y)(d.m,{pubId:t.id,utmSource:"feed",trigger:(0,l.Y)(C,(0,r._)((0,i._)({href:"".concat(t.base_url,"/"),campaign:n||o?{source:n,content:o}:void 0,onClick:c,ellipsis:u,className:p.className,target:(0,m.y)()?"_blank":void 0},p),{children:s}))})}function C(e){var{weight:t,color:n,decoration:o="hover-underline",ellipsis:c,native:d,className:u,campaign:p}=e,m=(0,a._)(e,["weight","color","decoration","ellipsis","native","className","campaign"]);let f=m.href,b=null==f?void 0:f.match(/^([a-z]+:)?\/\//),Y=null!=d?d:b&&!(null==f?void 0:f.startsWith(document.location.origin));return Y&&p&&f&&(f=(0,h.P)(f,p)),(0,l.Y)(g.EY,{as:"span",ellipsis:c,weight:t,color:n,decoration:o,children:Y?(0,l.Y)("a",(0,r._)((0,i._)({},m),{"data-native":!0,href:f,className:s()(u,y.A.link)})):(0,l.Y)(v.N,(0,r._)((0,i._)({},m),{href:f,campaign:p,className:s()(u,y.A.link)}))})}},96503:function(e,t,n){n.d(t,{C:()=>l});var i=n(4006),r=n(17402),a=n(36372);function l(){let e=(0,a.d)();return(0,r.useEffect)(()=>{let t=new URL(location.toString());t.searchParams.get("founding-member-confirmation")&&(t.searchParams.delete("founding-member-confirmation"),history.replaceState({},"",t),e.popToast(()=>(0,i.Y)(a.y,{text:"You upgraded to a founding tier subscription. Thank you!"})))},[]),null}},88377:function(e,t,n){n.d(t,{J:()=>i});let i=(0,n(17402).createContext)("preact-router")},53594:function(e,t,n){function i(e,t){return e&&"rgba(".concat(e.join(","),",").concat(t,")")}n.d(t,{Vu:()=>a,iL:()=>i,p4:()=>r});let r=e=>{var t,n;let{palette:r,colorKey:a="DarkMuted",defaultColor:l="var(--color-dark-bg-secondary)",bgColor:o="var(--color-dark-bg-secondary)"}=e;if(!r&&!l)return null;let s=null!=(n=i(null==r||null==(t=r[a])?void 0:t.rgb,.75))?n:l;return{background:"linear-gradient(180deg, ".concat(s,", ").concat(s,"), ").concat(o)}},a=e=>{var t,n,r,a,l,o;let{palette:s,defaultColor:c="var(--color-dark-bg-primary)",bgColor:d="var(--color-dark-bg-primary)"}=e;if(!s&&!c)return null;let u=null!=(a=i(null==s||null==(t=s.Muted)?void 0:t.rgb,.75))?a:c,p=null!=(l=i(null==s||null==(n=s.DarkMuted)?void 0:n.rgb,.75))?l:c,h=null!=(o=i(null==s||null==(r=s.DarkVibrant)?void 0:r.rgb,.75))?o:c;return{background:"linear-gradient(135deg, ".concat(u,", ").concat(p,", ").concat(h,"), ").concat(d),backgroundSize:"400% 400%"}}},3142:function(e,t,n){n.d(t,{J:()=>a,_:()=>r});var i=n(17402);function r(){let e=e=>{var t,n;"https://embed.bsky.app"===e.origin?function(e){if(!e.data.id||!e.data.height)return;let t=document.querySelector('[data-bluesky-id="'.concat(e.data.id,'"]'));t&&(t.style.height="".concat(e.data.height,"px"))}(e):("3pc.supported"===e.data||"3pc.unsupported"===e.data)&&("3pc.supported"===e.data&&Array.from(document.getElementsByClassName("tiktok-wrap outer")).forEach(e=>{var t,n;let i=e.querySelector(".tiktok-iframe");if(!i)return;i.classList.add("visible"),null==(t=e.querySelector(".tiktok-wrap.static"))||t.classList.add("hidden");let r=e.querySelector(".fallback-failure");null==r||r.classList.add("no-border");try{let e=i.contentDocument||(null==(n=i.contentWindow)?void 0:n.document);(null==e?void 0:e.readyState)=="complete"&&(null==r||r.classList.add("visible"))}catch(e){}i.onload=()=>{null==r||r.classList.add("visible")},i.onerror=()=>{null==r||r.classList.add("visible")},i.onabort=()=>{null==r||r.classList.add("visible")}}),null==(n=Array.from(document.getElementsByClassName("third-party-cookie-check-iframe")))||null==(t=n.forEach)||t.call(n,e=>e.remove()))};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}}function a(){(0,i.useEffect)(r,[])}},66714:function(e,t,n){n.d(t,{X:()=>s});var i=n(69277),r=n(70408),a=n(17402),l=n(94729),o=n(68349);let s=e=>{let{mediaUploadId:t}=e,[n,s]=(0,a.useState)(null),[c,d]=(0,a.useState)(!0),[u,p]=(0,a.useState)(null),h=async()=>{try{let e=await (0,l.x6)("/api/v1/video/upload/".concat(t));s((0,r._)((0,i._)({},e),{updated_at:new Date})),d(!1)}catch(e){console.error("Failed to load media upload:",e),p((0,o.uX)(e)),d(!1)}};return(0,a.useEffect)(()=>{t?h():(s(null),d(!1))},[t,u]),{mediaUpload:n,loading:c,error:u,refetch:h}}},74049:function(e,t,n){n.d(t,{P:()=>m,k:()=>h});var i=n(4006),r=n(7350),a=n.n(r),l=n(17402),o=n(15734),s=n.n(o),c=n(84605),d=n(86500),u=n(36372),p=n(57324);let h=e=>{let t=(0,u.d)(),{iString:n}=(0,c.GO)(),[r,o]=(0,l.useState)(0),h=a()(e=>{o(e)},100),m=(0,l.useCallback)(async()=>{var t,n;let i,r,a=!e.live_stream_id||(null==(t=e.liveStream)?void 0:t.is_rtmp)?"original":"mp4",l="/api/v1/video/upload/".concat(e.id,"/src.json?type=").concat(a),{body:{src:c}}=await s().get(l),u=await fetch(c),m=null==(n=u.body)?void 0:n.getReader(),g=u.headers.get("Content-Length");if(!m||!g)throw Error("Failed to read the response body or content length is missing.");let f=parseInt(g),v=0,b=[];do{let e=await m.read();i=e.done,(r=e.value)&&(b.push(r),h((v+=r.length)/f*100))}while(!i);let y=new Blob(b),Y=window.URL.createObjectURL(y),_=document.createElement("a");_.href=Y,_.download="undefined"!==e.name&&e.name?e.name:"original.webm",_.target="_blank",_.rel="noopener noreferrer",_.style.display="none",document.body.appendChild(_),_.click(),document.body.removeChild(_),(0,d.u4)(d.qY.VIDEO_CLIP_DOWNLOAD_BUTTON_CLICKED,{name:"download",post_id:e.post_id,utm_campaign:p._9.substackClips,utm_medium:p.Jn.web,media_upload_id:e.id}),setTimeout(()=>o(0),200)},[e]);return{startDownload:()=>{o(0),m(),t.popToast(()=>(0,i.Y)(u.y,{text:n("Download started, do not close the window until download is completed")}))},downloadPercentage:r}},m=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"original",i="/api/v1/video/upload/".concat(e.id,"/src.json?type=").concat(n),{body:{src:r},status:a}=await s().get(i);if(a>=400){let e="there was an error generating the pre-signed url of the original source";throw console.warn(e),Error(e)}let l=await fetch(r);if(l.status>=400){let e="there was an error downloading the original source";throw console.warn(e),Error(e)}let o=await l.blob(),c=window.URL.createObjectURL(o),u=document.createElement("a");u.href=c,u.download=t?"".concat(t,".mp4"):"".concat(e.name),u.target="_blank",u.rel="noopener noreferrer",u.style.display="none",document.body.appendChild(u),u.click(),document.body.removeChild(u),(0,d.u4)(d.qY.VIDEO_CLIP_DOWNLOAD_BUTTON_CLICKED,{name:"download",post_id:e.post_id,utm_campaign:p._9.substackClips,utm_medium:p.Jn.web,media_upload_id:e.id})}},92476:function(e,t,n){n.d(t,{AF:()=>p,II:()=>m,V:()=>f,n6:()=>g});var i=n(69277),r=n(70408),a=n(13022),l=n(45947),o=n(16291),s=n(56262),c=n(39318),d=n(82776),u=n(57324);function p(e){let{name:t,url:n,description:r,potentialAction:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return void 0===a&&(a={"@type":"SearchAction",name:"Search ".concat(e.name),target:"".concat(e.base_url).concat((0,c.Xt9)(e),"?utm_source=").concat(u.VU.google,"&sort=search&search={search_term_string}"),"query-input":"required name=search_term_string"}),{"@context":"https://schema.org","@type":"WebSite",name:t||e.name,publisher:(0,i._)({"@type":"Organization",name:e.name,url:e.base_url},e.logo_url?{logo:{"@type":"ImageObject",url:e.logo_url}}:{},e.twitter_screen_name?{sameAs:["https://twitter.com/".concat(e.twitter_screen_name)]}:{}),url:n||e.base_url,mainEntityOfPage:{"@type":"WebPage",url:n||e.base_url},description:r||e.hero_text,potentialAction:a}}function h(e){var t,n,a,l;return(0,i._)((0,r._)((0,i._)({"@type":"Organization",name:e.name,url:(0,c.$_T)(e),description:e.hero_text},e.rankingDetailFreeIncludedOrderOfMagnitude&&{interactionStatistic:{"@type":"InteractionCounter",name:"Subscribers",interactionType:"https://schema.org/SubscribeAction",userInteractionCount:e.rankingDetailFreeIncludedOrderOfMagnitude}}),{identifier:"pub:".concat(e.id)}),e.logo_url&&{logo:{"@type":"ImageObject",url:e.logo_url,contentUrl:(0,c.dJ9)(null!=(t=e.logo_url)?t:""),thumbnailUrl:(0,c.dJ9)(null!=(n=e.logo_url)?n:"",128,{height:128})},image:{"@type":"ImageObject",url:e.logo_url,contentUrl:(0,c.dJ9)(null!=(a=e.logo_url)?a:""),thumbnailUrl:(0,c.dJ9)(null!=(l=e.logo_url)?l:"",128,{height:128})}},e.twitter_screen_name&&{sameAs:["https://twitter.com/".concat(e.twitter_screen_name)]})}function m(e,t){var n,u;let p=(0,d.getBylineUsers)(t),m=h(e),g=(0,a.Ay)("add_section_and_tag_metadata"),f={likes:t.reaction_count,comments:t.comment_count,reposts:t.restacks},v=(0,l.b)(f,{includeViews:!1});return(0,i._)((0,r._)((0,i._)({"@context":"https://schema.org","@type":"NewsArticle",url:(0,c.wu9)(e,t),mainEntityOfPage:(0,c.wu9)(e,t),headline:t.search_engine_title||t.social_title||t.title,description:t.search_engine_description||t.description,image:t.cover_image?[{"@type":"ImageObject",url:t.cover_image}]:[],datePublished:(0,o.A)(t.post_date).format("YYYY-MM-DDTHH:mm:ssZ"),dateModified:(0,o.A)(t.post_date).format("YYYY-MM-DDTHH:mm:ssZ"),isAccessibleForFree:!(0,s.isPaidAudience)(t.audience)},t.post_paywall_content_for_google&&{hasPart:[{"@type":"WebPageElement",isAccessibleForFree:!0,cssSelector:".available-content"},{"@type":"WebPageElement",isAccessibleForFree:!1,cssSelector:".paywall-content"}]}),{author:p.length>0?p.map(e=>(0,i._)({"@type":"Person",name:e.name,url:(0,c.gYq)(e),description:e.bio,identifier:"user:".concat(e.id)},e.twitter_screen_name&&{sameAs:["https://twitter.com/".concat(e.twitter_screen_name)]},e.photo_url&&{image:{"@type":"ImageObject",contentUrl:(0,c.dJ9)(e.photo_url),thumbnailUrl:(0,c.dJ9)(e.photo_url,128,{height:128})}})):m,publisher:m}),g&&{articleSection:null==(n=t.section)?void 0:n.name,keywords:null==(u=t.postTags)?void 0:u.map(e=>e.slug)},v&&{interactionStatistic:v})}function g(e){return(0,i._)({"@context":"https://schema.org","@type":"Person",image:(null==e?void 0:e.photo_url)&&(0,c.dJ9)(e.photo_url),name:"".concat(null==e?void 0:e.name),url:e&&(0,c.gYq)(e),jobTitle:null==e?void 0:e.bio,description:null==e?void 0:e.bio},(null==e?void 0:e.twitter_screen_name)?{sameAs:["https://twitter.com/".concat(e.twitter_screen_name)]}:{})}function f(e,t,n,r){let{usePreview:a}=r,l=(0,d.getBylineUsers)(t),s=h(e);return(0,i._)({"@context":"https://schema.org","@type":"VideoObject",name:t.search_engine_title||t.social_title||t.title,description:t.search_engine_description||t.description,thumbnailUrl:(0,c.H10)(n),uploadDate:(0,o.A)(t.post_date).format("YYYY-MM-DDTHH:mm:ssZ"),contentUrl:(0,c.oRR)("".concat((0,c.$_T)(e),"/api/v1/video/upload/").concat(n.id,"/src"),{preview:a,override_publication_id:e.id,type:"mp4"}),publisher:s,author:l.length>0?l.map(e=>(0,i._)({"@type":"Person",name:e.name,url:(0,c.gYq)(e),description:e.bio,identifier:"user:".concat(e.id)},e.twitter_screen_name&&{sameAs:["https://twitter.com/".concat(e.twitter_screen_name)]},e.photo_url&&{image:{"@type":"ImageObject",contentUrl:(0,c.dJ9)(e.photo_url),thumbnailUrl:(0,c.dJ9)(e.photo_url,128,{height:128})}})):s},n.duration&&{duration:"PT".concat(Math.floor(n.duration),"S")})}},43528:function(e,t,n){n.d(t,{Os:()=>s,cz:()=>o,tL:()=>d});var i=n(94729),r=n(12501),a=n(68349),l=n(41086);function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=e||(0,l.y)("selection");let{isLoading:n,error:i,result:a}=(0,r.st)({pathname:"/api/v1/post_selection/".concat(e),auto:!!e,deps:[e]});return{isLoading:n,error:i,postSelection:null!=a?a:null,highlightSelection:()=>{a&&c(a,t)}}}async function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=e||(0,l.y)("selection");let n=null;try{n=await (0,i.x6)("/api/v1/post_selection/".concat(e))}catch(e){console.error("could not fetch post selection",e)}n&&c(n,t)}function c(e){var t,n;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(i.ignoreSafari&&(0,a.nr)()||!e.text)return;let r=(null!=(n=null==(t=/^[^.]+\./.exec(e.text))?void 0:t[0])?n:e.text).replace(/\.+$/g,"");if(!r)return;let l="#:~:text=".concat(encodeURIComponent(r));history.replaceState({},document.title,l),document.location.replace(l)}async function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=e||(0,l.y)("imgSelection");let n=null;try{n=(await (0,i.x6)("/api/v1/post_selection/image/".concat(e))).selection}catch(t){console.error("Couldn't find post image selection with id ".concat(e),t)}n&&function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(n.ignoreSafari&&(0,a.nr)())&&e.img_src){for(let n of document.getElementsByTagName("img"))if(n.src===e.img_src){t=n;return}t&&t.scrollIntoView()}}(n,t)}},93946:function(e,t,n){n.d(t,{Ac:()=>d,Mv:()=>s,TZ:()=>p,Zq:()=>c,nr:()=>u});var i=n(4006),r=n(17402),a=n(84605),l=n(67734),o=n(82776);let s=(e,t)=>{var n,i,l;let o="undefined"!=typeof window&&null!=(l=null==(i=window._preloads)||null==(n=i.pub)?void 0:n.language)?l:"en";(0,r.render)((0,r.createElement)(a.Pz,{language:o,children:e}),t)},c=e=>e.podcast_url&&e.podcast_duration>0?"podcast":e.videoUpload&&e.videoUpload.duration&&e.videoUpload.duration>0?"video":"thread"===e.type?"thread":"newsletter",d=function(e){let t,n,r,a,s,{currency:c,totalAmount:d,discount:u,quantity:p=1,trial_end_override:h,noTrial:m=!1,recurring:g=!0,isGroupSubscription:f=!1,isUnlimitedGroupSubscription:v=!1,language:b="en"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{iString:y,iPlural:Y}=I18N.i(b);if(c||(c=e.currency),void 0!==d)t=d;else{let n=(0,l.id)(e,c);if(void 0===n){var _;c=e.currency,n=null!=(_=e.amount)?_:0}t=n*p}let w=(0,o.centsToPriceString)(t,c);if(u&&!u.loading&&!u.error&&(u.percent_off||u.amount_off)){let e;u.percent_off?e=Math.round(t*(1-(u.percent_off_precise||u.percent_off)/100)):u.amount_off&&(e=Math.max(0,t-u.amount_off)),n=(0,o.centsToPriceString)(e,c)}let C=n||w;e.is_bitcoin?("month"===e.interval&&(r=Y("%2/1 month","%2/%1 months",e.interval_count,C)),"week"===e.interval&&(r=Y("%2/1 week","%2/%1 weeks",e.interval_count,C)),"day"===e.interval&&(r=Y("%2/1 day","%2/%1 days",e.interval_count,C)),"year"===e.interval&&(r=Y("%2/1 year","%2/%1 years",e.interval_count,C))):e&&g&&!f&&!v?("month"===e.interval&&(r=Y("%2 per month","%2 per %1 months",e.interval_count,C)),"week"===e.interval&&(r=Y("%2 per week","%2 per %1 weeks",e.interval_count,C)),"day"===e.interval&&(r=Y("%2 per day","%2 per %1 days",e.interval_count,C)),"year"===e.interval&&(r=Y("%2 per year","%2 per %1 years",e.interval_count,C))):!e||g||f||v?e&&g&&f&&!v?("month"===e.interval&&(r=Y("%2 for one month per person","%2 for %1 months per person",e.interval_count,C)),"week"===e.interval&&(r=Y("%2 for one week per person","%2 for %1 weeks per person",e.interval_count,C)),"day"===e.interval&&(r=Y("%2 for one day per person","%2 for %1 days per person",e.interval_count,C)),"year"===e.interval&&(r=Y("%2 for one year per person","%2 for %1 years per person",e.interval_count,C))):e&&g&&f&&v&&("month"===e.interval&&(r=Y("%2 for one month for unlimited seats","%2 for %1 months for unlimited seats",e.interval_count,C)),"week"===e.interval&&(r=Y("%2 for one week for unlimited seats","%2 for %1 weeks for unlimited seats",e.interval_count,C)),"day"===e.interval&&(r=Y("%2 for one day for unlimited seats","%2 for %1 days for unlimited seats",e.interval_count,C)),"year"===e.interval&&(r=Y("%2 for one year for unlimited seats","%2 for %1 years for unlimited seats",e.interval_count,C))):("month"===e.interval&&(r=Y("%2 for one month","%2 for %1 months",e.interval_count,C)),"week"===e.interval&&(r=Y("%2 for one week","%2 for %1 weeks",e.interval_count,C)),"day"===e.interval&&(r=Y("%2 for one day","%2 for %1 days",e.interval_count,C)),"year"===e.interval&&(r=Y("%2 for one year","%2 for %1 years",e.interval_count,C)));let k=Math.max(0,"trial_period_days"in e&&e.trial_period_days||0,u&&u.trial_period_days||0,h?Math.ceil((h-Date.now()/1e3)/60/60/24):0);if(!m&&k>0&&(a=Y("1 day free trial","%1 day free trial",k)),u&&n&&g&&"forever"!==u.duration){let t="once"===u.duration?1:u.duration_in_months/("year"===e.interval?12:1)*e.interval_count;"month"===e.interval&&(s=Y("for first month","for first %1 months",t)),"week"===e.interval&&(s=Y("for first week","for first %1 weeks",t)),"day"===e.interval&&(s=Y("for first day","for first %1 days",t)),"year"===e.interval&&(s=Y("for first year","for first %1 years",t))}return u&&u.loading?(0,i.FD)(i.FK,{children:[r," ",(0,i.FD)("span",{className:"discount-price",children:[" (",y("coupon loading"),")"]})]}):u&&u.error?(0,i.FD)(i.FK,{children:[r," ",(0,i.FD)("span",{className:"discount-price error",children:[" (",y("coupon invalid or expired"),")"]})]}):n?(0,i.FD)(i.FK,{children:[(0,i.Y)("span",{className:"crossed-out",children:w})," ",(0,i.FD)("span",{className:"discount-price",children:[r," ",s?"(".concat(s,") "):"",a]})]}):(0,i.FD)(i.FK,{children:[r," ",a]})};async function u(e){let{timeout:t=5e3}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=document.createElement("video");n.volume=0;let i=!1,r=Promise.race([new Promise(e=>{n.onloadedmetadata=()=>{n.onloadedmetadata=null,n.duration===1/0?(n.currentTime=Number.MAX_SAFE_INTEGER,n.ontimeupdate=()=>{n.ontimeupdate=null,i=!0,e(n.duration),n.currentTime=0}):e(n.duration)},n.onerror=t=>{i=!0;let n=null;"string"==typeof t?n=t:t.target&&"error"in t.target&&(n=t.target.error),e({is_error:!0,err:n})}}),new Promise(e=>{setTimeout(()=>{i||e({is_error:!0,err:Error("Blob duration fetching timed out")})},t)})]);try{n.src="string"==typeof e||"string"==typeof e?e:window.URL.createObjectURL(e)}catch(e){return{is_error:!0,err:e}}return r}let p=e=>{try{return new URL(e),!0}catch(e){return!1}}},38093:function(e,t,n){n.d(t,{Q:()=>b,Z:()=>v});var i=n(69277),r=n(4006),a=n(32485),l=n.n(a),o=n(42216),s=n(17402),c=n(84605),d=n(94729),u=n(89490),p=n(8149),h=n(76977),m=n(20500),g=n(63136),f=n(24311);function v(e){let{email:t,redirect:n,forPub:a,onIsAttemptingLoginChange:l}=e,[c,u]=(0,s.useState)(""),[h,m]=(0,s.useState)(!1),[g,f]=(0,s.useState)(!1),[v,b]=(0,s.useState)(!1),C=async()=>{m(!0),l&&l(!0);try{let[e]=await Promise.all([(0,d.x6)("/api/v1/email-otp-login/complete",{method:"POST",json:{code:c,email:t,redirect:n,for_pub:a}}),new Promise(e=>setTimeout(e,250))]);window.location.href=e.redirect}catch(e){e instanceof d.fk&&"login_guard_challenge"===e.body.type&&b(!0),m(!1),l&&l(!1),f(!0),u("")}};return t?(0,r.FD)(_,{children:[(0,r.Y)(o.wE,{autoFocus:!0,maxLength:6,pattern:o.UO,onChange:e=>{u(e),e.length&&f(!1)},onComplete:C,value:c,render:e=>{let{slots:t}=e;return(0,r.Y)(w,{children:t.map((e,t)=>(0,r.Y)(y,(0,i._)({disabled:h},e),t))})}}),(0,r.Y)(p.N,{open:!!g,children:(0,r.Y)(Y,{suspiciousLogin:v})})]}):null}function b(e){let{onComplete:t,error:n,isLoading:a}=e,[l,d]=(0,s.useState)(""),{iString:u}=(0,c.GO)();return(0,r.FD)(_,{children:[(0,r.Y)(o.wE,{autoFocus:!0,maxLength:6,pattern:o.UO,onChange:e=>{d(e)},onComplete:e=>{a||t(e)},value:l,disabled:a,render:e=>{let{slots:t}=e;return(0,r.Y)(w,{children:t.map((e,t)=>(0,r.Y)(y,(0,i._)({disabled:a},e),t))})}}),n&&(0,r.Y)(m.yn,{style:{textAlign:"center"},children:u("You entered an incorrect code. Please try again.")})]})}function y(e){let{char:t,isActive:n,disabled:i}=e;return(0,r.Y)(h.fI,{justifyContent:"center",alignItems:"center",width:36,height:40,className:l()(f.A.input,n&&f.A.focus,i&&f.A.disabled),children:(0,r.Y)(g.EY.B2,{textAlign:"center",children:t||""})})}function Y(e){let{suspiciousLogin:t}=e,{iString:n}=(0,c.GO)(),i=n(t?"Please check your email for instructions to complete signing in.":"You entered an incorrect code. Please try again.");return(0,r.Y)(m.yn,{style:{textAlign:"center"},children:i})}let _=(0,u.I4)({display:"flex",direction:"column",alignItems:"center",gap:8}),w=(0,u.I4)({display:"flex",direction:"row",justifyContent:"center",alignItems:"center",gap:8})},55376:function(e,t,n){n.d(t,{wI:()=>N});var i=n(79785),r=n(4006),a=n(418),l=n(16079),o=n(17402),s=n(15734),c=n.n(s),d=n(84605),u=n(92538),p=n(5646),h=n(12387),m=n(24078),g=n(89490),f=n(35369),v=n(76977),b=n(20500),y=n(16993),Y=n(84843),_=n(57820),w=n(94996),C=n(81929),k=n(63136),S=n(16291);function I(){let e=(0,i._)(["Ban or suspend ",""]);return I=function(){return e},e}function F(){let e=(0,i._)(["Prevent this person from commenting on your publication in the future."]);return F=function(){return e},e}function D(){let e=(0,i._)(["Ban ",""]);return D=function(){return e},e}function T(){let e=(0,i._)(["Previously banned "," time(s), last on ",""]);return T=function(){return e},e}function A(){let e=(0,i._)([""," is permanently banned."]);return A=function(){return e},e}function E(){let e=(0,i._)([""," is banned until ","."]);return E=function(){return e},e}let N=e=>{var t,n,i,a;let{comment:l,onReply:s,onBan:c,onClose:d}=e,{sub:p,loading:h,bans:m,bansHistory:g,error:f,submitBan:v}=B(l,c),b=(0,u.n)(),Y=null==(t=b[1])?void 0:t[0],[_,w]=(0,o.useState)(Y),[C,k]=(0,o.useState)("visible"),I=!!l||h,F=null!=(a=null==(i=b.find(e=>{let[t]=e;return t===_}))||null==(n=i[1])?void 0:n.toLowerCase())?a:"",D=m.filter(e=>(0,S.A)(e.expiry).isAfter((0,S.A)()));return(0,r.FD)(y.aF,{isOpen:I,onClose:d,children:[0===D.length&&(0,r.Y)(P,{comment:l,sub:p,bans:m,bansHistory:g,loading:h,error:f,selectedExpiry:_,setSelectedExpiry:w,selectedCommentVisibility:C,setSelectedCommentVisibility:k,expiryText:F,onClose:d,submitBan:v}),D.length>0&&(0,r.Y)(O,{comment:l,bans:m,onClose:d,onReply:()=>{s&&l&&(s(l.id),d())}})]})},P=e=>{var t,n;let{comment:i,sub:a,bans:l,bansHistory:o,loading:s,error:c,selectedExpiry:h,setSelectedExpiry:g,selectedCommentVisibility:Y,setSelectedCommentVisibility:S,expiryText:T,onClose:A,submitBan:E}=e,{iString:N,iTemplate:P}=(0,d.GO)(),O=(0,u.n)(),B=(0,p.T)();return(0,r.FD)(r.FK,{children:[(0,r.Y)(y.rQ,{showClose:!0,onClose:A,title:P(I(),null!=(t=null==i?void 0:i.name)?t:"user"),showDivider:!0,alignItems:"center",icon:(0,r.Y)(m.eu,{photoUrl:null!=(n=null==i?void 0:i.photo_url)?n:void 0,size:56}),description:(0,r.FD)(v.VP,{alignItems:"center",gap:8,children:[(null==a?void 0:a.is_subscribed)&&(0,r.Y)(C.vw,{priority:"secondary",children:N("Paid subscriber")}),(0,r.Y)(k.EY,{children:P(F())})]})}),(0,r.Y)(y.cw,{children:(0,r.FD)(v.VP,{gap:20,children:[(0,r.Y)(L,{bans:l,bansHistory:o}),c&&(0,r.Y)(b.yn,{children:N("An error occurred. Please try again.")}),s&&(0,r.Y)(_.y$,{padding:32,alignItems:"center",justifyContent:"center"}),!s&&(0,r.FD)(r.FK,{children:[(0,r.FD)(x,{children:[(0,r.Y)(k.EY.B3,{weight:"semibold",children:N("Ban duration")}),(0,r.FD)(w.I,{name:"expiry",value:h,onChange:e=>{g(e.target.value)},children:[(0,r.Y)(w.K,{children:N("Select a duration")}),O.map(e=>{let[t,n]=e;return(0,r.Y)("option",{value:t,children:null==n?void 0:n.replace(/^For /,"")})})]})]}),(0,r.FD)(x,{children:[(0,r.Y)(k.EY.B3,{weight:"semibold",children:N("Delete comments")}),(0,r.FD)(w.I,{name:"comment_visibility",value:Y,onChange:e=>{S(e.target.value)},children:[(0,r.Y)(w.K,{children:N("Select whether to delete comments")}),B.map(e=>{let[t,n]=e;return(0,r.Y)("option",{value:t,children:n})})]})]})]})]})}),(0,r.Y)(y.jl,{direction:"column",showDivider:!0,primaryButton:(0,r.Y)(f.$n,{priority:"destructive",onClick:()=>E(h,Y),children:P(D(),T)})})]})},x=(0,g.I4)({display:"flex",justifyContent:"space-between",alignItems:"center"}),L=e=>{let{bans:t,bansHistory:n}=e,{iTemplate:i}=(0,d.GO)();if(!t[0])return null;let l=n.length?n.length:t.filter(e=>e.user_id).length;return(0,r.Y)(h.F,{title:i(T(),l,(0,S.A)(t[0].start).standardDatetimeWithYear()),Icon:a.A,showClose:!1})},O=e=>{var t,n;let{comment:i,bans:a,onClose:o,onReply:s}=e,{iString:c,iTemplate:u}=(0,d.GO)(),p=a.find(e=>e.user_id),h=p&&(0,S.A)(p.expiry).isAfter((0,S.A)().add(100,"years"))?u(A(),null!=(t=null==i?void 0:i.name)?t:"This user"):u(E(),null!=(n=null==i?void 0:i.name)?n:"This user",(0,S.A)(null==p?void 0:p.expiry).standardDatetimeWithYear());return p?(0,r.FD)(r.FK,{children:[(0,r.Y)(y.rQ,{title:h,alignItems:"center",icon:(0,r.Y)(Y.qx,{icon:(0,r.Y)(l.A,{})}),showClose:!0,onClose:o,description:c("We recommend leaving a reply to tell them why they are banned, and to let other readers know what kinds of comments are not acceptable.")}),(0,r.Y)(y.q1,{}),(0,r.Y)(y.jl,{direction:"column",primaryButton:(0,r.Y)(f.$n,{priority:"primary-mono",onClick:s,children:c("Leave a reply")})})]}):null},B=(e,t)=>{let[n,i]=(0,o.useState)(null),[r,a]=(0,o.useState)(!1),[l,s]=(0,o.useState)([]),[d,u]=(0,o.useState)([]),[p,h]=(0,o.useState)(null),m=async(n,i)=>{a(!0);try{var r;if(!e)throw Error("comment undefined, cannot submitBan");let o=await c().post("/api/v1/comment_ban/".concat(e.id)).send({user_id:e.user_id,expiry:n,commentVisibility:i});"visible"!==i&&document.location.reload(),(r=o.body.bans).forEach(e=>{-1==r.findIndex(t=>t.id===e.id)&&r.push(e)}),s(r),a(!1),t&&t(e,l)}catch(e){console.error("Failed to submit ban",e),h(!0)}a(!1)};return(0,o.useEffect)(()=>{(async()=>{if(e){a(!0),s([]),u([]),h(null),i(null);try{var t;let[n,r]=await Promise.all([c().get("/api/v1/user/".concat(e.user_id,"/bans")),c().get("/api/v1/moderation/publications/".concat(e.publication_id,"/users/").concat(e.user_id,"/bans")).query({type:"comment",limit:20})]),a=n.body;s(a.bans),i(a.sub),u(null!=(t=r.body.data)?t:[])}catch(e){console.error("Failed to get bans:",e),h(!0)}a(!1)}})()},[e]),{sub:n,loading:r,bans:l,bansHistory:d,error:p,submitBan:m,setLoading:a,setError:h}}},10728:function(e,t,n){n.d(t,{h:()=>_});var i=n(4006),r=n(32485),a=n.n(r),l=n(38970),o=n.n(l),s=n(33031),c=n.n(s),d=n(13950),u=n(72880),p=n(84605),h=n(74894),m=n(68410),g=n(12592),f=n(35369),v=n(16074),b=n(76977),y=n(63136),Y=n(39318);let _=e=>{let{pub:t}=e,{iString:n}=(0,p.GO)(),r=o()(t.sections,"id"),l=c()((0,h.Zu)(t),"podcastTitle");return(0,i.Y)("div",{className:a()("page","typography"),children:(0,i.Y)(g.c,{children:(0,i.FD)(b.I1,{gap:24,children:[(0,i.Y)(y.EY.H2,{children:n("Podcasts")}),(0,i.Y)(b.I1,{gap:24,children:l.map((e,n)=>{var a,l;let o=null!=(l=r[null!=(a=e.sectionId)?a:"undefined"])?l:null;return(0,i.FD)(i.FK,{children:[0!==n&&(0,i.Y)(v.c,{}),(0,i.Y)(w,{podcastForDisplay:e,pub:t,section:o})]})})})]})})})},w=e=>{let{podcastForDisplay:t,pub:n,section:r}=e,{iString:a}=(0,p.GO)(),{isMobile:l}=(0,m.sM)(),o=(0,Y.t6y)({pub:n,section:r});return(0,i.Y)(d.DH,{children:(0,i.FD)(b.Ye,{gap:24,children:[(0,i.Y)(b.I1,{width:l?140:180,flex:"auto",children:t.artUrl&&(0,i.Y)("a",{href:o,children:(0,i.Y)(u.o,{className:"image-QMta6W",imageIsFixedWidth:!0,maxWidth:l?140:180,src:t.artUrl,useRetinaSizing:!0})})}),(0,i.FD)(b.I1,{gap:12,children:[(0,i.FD)(b.I1,{gap:8,children:[(0,i.Y)(y.EY.H3,{as:"a",href:o,children:t.podcastTitle}),(0,i.Y)(y.EY.B3,{children:t.description})]}),(0,i.Y)("div",{children:(0,i.Y)(f.$n,{href:o,priority:"secondary",size:"sm",children:a("See episodes")})})]})]})})}},88559:function(e,t,n){n.d(t,{Q:()=>F});var i=n(4006),r=n(32485),a=n.n(r),l=n(65892),o=n(17402),s=n(73090),c=n(84605),d=n(12501),u=n(11574),p=n(77433),h=n(68410),m=n(17028),g=n(84270),f=n(16993),v=n(4016);let b=e=>{let{isShowsEpisodePage:t,posts:n,title:r,user:c,postTags:d,selectedPostTagId:g,postId:f,postTheme:v}=e,{isMobile:b}=(0,h.sM)(),[Y,_]=(0,o.useState)(!1);return(0,i.Y)(m.pT,{className:a()({"container-Q5omP8":!t,"containerForShows-FydmKs":t}),children:t?(0,i.FD)(m.I1,{gap:24,children:[(0,i.Y)(p.M,{title:r,titlePreset:"st1",variant:"align-right"}),(0,i.Y)(s.R,{posts:n})]}):(0,i.FD)(i.FK,{children:[(null==c?void 0:c.is_admin)&&!b&&(0,i.Y)("div",{className:"editButtonContainer-O6BQ51",children:(0,i.Y)(m.K0,{priority:"primary-mono",size:"sm",onClick:()=>{_(!0)},children:(0,i.Y)(l.A,{size:16})})}),(0,i.Y)(u.$,{headerVariant:"align-right",posts:n,title:r,variant:"large-in-middle"}),(0,i.Y)(y,{currentPostTagId:g,isOpen:Y,postId:f,postTags:d,postTheme:v,user:c,onClose:()=>_(!1)})]})})},y=e=>{let{user:t,isOpen:n,onClose:r,postTags:a,currentPostTagId:l,postId:s,postTheme:u}=e,{isMobile:p}=(0,h.sM)(),{iString:v}=(0,c.GO)(),[b,y]=(0,o.useState)(l),{refetch:Y,error:_}=(0,d.st)({pathname:"/api/v1/post/".concat(s,"/theme"),method:"PATCH"});if(p||!(null==t?void 0:t.is_admin))return null;let w=()=>{y(l),r()},C=async()=>{await Y({json:{header_variant:u.header_variant,featured_post_tag_id:b}}),_||window.location.reload()},k=null==a?void 0:a.map(e=>({value:e.id,label:e.name}));return(0,i.FD)(f.aF,{disableCloseOnBackdropClick:!0,isOpen:n,onClose:w,children:[(0,i.Y)(f.rQ,{showClose:!0,title:v("Choose a tag to feature"),onClose:r}),(0,i.Y)(f.cw,{children:(0,i.Y)(g.z,{options:k,value:b,onChange:e=>y(e)})}),(0,i.Y)(f.jl,{primaryButton:(0,i.Y)(m.$n,{disabled:l===b,onClick:C,children:v("Save")}),secondaryButton:(0,i.Y)(m.$n,{priority:"secondary",onClick:w,children:v("Cancel")})})]})};var Y=n(2058),_=n(93800),w=n(76977),C=n(63136);let k=()=>{let{isMobile:e}=(0,h.sM)();return(0,i.Y)(w.I1,{paddingX:8*!e,paddingBottom:8,children:(0,i.Y)(w.I1,{borderBottom:"detail-themed",paddingBottom:8,children:(0,i.Y)(C.EY,{className:"title-lJNKDo",children:"Latest"})})})};var S=n(89490),I=n(56458);let F=e=>{var t;let{delayFirstLoad:n,filterPostsPredicate:r,isBelowTheFold:a,isShowsEpisodePageForTheFP:l,maxPosts:o,pub:s,search:d,sort:u,sortTabs:p,source:m,user:g,post:f}=e,{isMobile:y}=(0,h.sM)(),{iString:w}=(0,c.GO)(),C=(0,v.lu)({pub:s}),F=(0,v.S2)({pub:s}),D=null==(t=s.sections)?void 0:t.find(e=>e.id===f.section_id),T=l&&(null==D?void 0:D.is_podcast)||D&&!!f.videoUpload&&l,A=(e=>{var t,n,i,r,a,l,o;let{post:s,pub:c,showPodcastEpisodesOnly:d}=e;if(!s||!(0,v.lu)({pub:c}))return;if(d)return{featuredSectionId:null!=(r=s.section_id)?r:void 0,title:"More Episodes"};let{postTheme:u}=s;if(null==u?void 0:u.featured_post_tag_id){let e=null==s||null==(a=s.postTags)?void 0:a.find(e=>{let{id:t}=e;return t===(null==u?void 0:u.featured_post_tag_id)});return e?{featuredPostTagId:null==u?void 0:u.featured_post_tag_id,title:"More in ".concat(e.name)}:void 0}if(s.section_id&&(s.section_name||(null==(t=s.section)?void 0:t.name)))return{featuredSectionId:s.section_id,title:"More in ".concat(null!=(o=s.section_name)?o:null==(l=s.section)?void 0:l.name)};let p=new Set(null==(n=s.publishedBylines)?void 0:n.map(e=>e.name)),h=null==(i=s.postTags)?void 0:i.find(e=>{let{name:t,hidden:n}=e;return!n&&!p.has(t)});if(h)return{featuredPostTagId:null==h?void 0:h.id,title:"More in ".concat(null==h?void 0:h.name)}})({post:f,pub:s,showPodcastEpisodesOnly:T});return(0,i.Y)(S.az,{paddingY:24,style:y?void 0:{marginLeft:-8,marginRight:-8},"aria-label":w("Top Posts Footer"),role:"region",children:(0,i.Y)(Y.M,{delayFirstLoad:n,filterPostsPredicate:r,hideCommunity:F,hideTop:F,isBelowTheFold:a,isPodcast:T,maxPosts:o,pub:s,search:d,sort:(null==A?void 0:A.featuredPostTagId)?"new":u,sortTabs:p,source:m,user:g,postTagId:null==A?void 0:A.featuredPostTagId,sectionId:null==A?void 0:A.featuredSectionId,postId:f.id,renderTabs:F?()=>(0,i.Y)(k,{}):void 0,children:e=>{let{posts:t,linkToComments:n,onClickPost:r}=e;if(C){var a;return(0,i.Y)(b,{isShowsEpisodePage:l,postId:f.id,postTheme:f.postTheme,selectedPostTagId:null==A?void 0:A.featuredPostTagId,posts:t,title:null!=(a=null==A?void 0:A.title)?a:"Top posts",user:g,postTags:null==f?void 0:f.postTags})}return(0,i.Y)(_.m,{hideImages:(0,I.$P)({pub:s}),linkToComments:n,posts:t,variant:"two-column-list",onClickPost:r})}})})}},2684:function(e,t,n){n.d(t,{u:()=>m});var i=n(4006),r=n(32485),a=n.n(r),l=n(17402),o=n(73815),s=n(12592),c=n(35369),d=n(76977),u=n(63136),p=n(39318),h=n(39891);let m=e=>{let{pub:t,user:n,freeSignupEmail:r,redemptionLink:m}=e,g=null==n?void 0:n.is_subscribed,f=(null==n?void 0:n.is_free_subscribed)||!!r,v=(0,l.useMemo)(()=>{if(!n)return"";try{let e=new URL(m);return e.searchParams.set("email",n.email),e.toString()}catch(e){return""}},[m,n]);return(0,i.Y)("div",{className:a()("page","typography"),children:(0,i.Y)(o.Z,{children:(0,i.Y)(s.c,{children:(0,i.FD)(d.I1,{gap:32,alignItems:"center",textAlign:"center",children:[(0,i.Y)("img",{style:{width:300},src:(0,h.dJ)("/img/a24/A24_logo.png",600)}),g?(0,i.FD)(i.FK,{children:[(0,i.FD)(u.EY.B1,{children:["Your subscription to ",t.name," includes a 3-month subscription to AAA24, an exciting new streaming service by A24. To redeem your membership, please visit:"]}),(0,i.Y)(c.$n,{priority:"primary",localNavigation:!1,href:v,children:"BECOME A MEMBER"})]}):f?(0,i.FD)(i.FK,{children:[(0,i.FD)(u.EY.B1,{children:["Paid subscribers to ",t.name," have access to a 3-month subscription to AAA24, an exciting new streaming service by A24."]}),(0,i.Y)(c.$n,{priority:"primary",localNavigation:!1,href:(0,p.my9)(t,{utm_source:"a24_landing_page",next:"/a24"}),children:"Upgrade"})]}):(0,i.FD)(i.FK,{children:[(0,i.FD)(u.EY.B1,{children:["Paid subscribers to ",t.name," have access to a 3-month subscription to AAA24, an exciting new streaming service by A24."]}),(0,i.Y)(c.$n,{priority:"primary",localNavigation:!1,href:(0,p.my9)(t,{utm_source:"a24_landing_page",next:"/a24"}),children:"Subscribe"})]})]})})})})}},30226:function(e,t,n){n.d(t,{A:()=>x});var i=n(69277),r=n(4006),a=n(32485),l=n.n(a),o=n(98188),s=n(17402),c=n(17988),d=n(15734),u=n.n(d),p=n(7358),h=n(79909),m=n(37494),g=n(13950),f=n(79391),v=n(19449),b=n(56778),y=n(86500),Y=n(56804),_=n(1459),w=n(68349),C=n(24078),k=n(35369),S=n(76977),I=n(81203),F=n(63136),D=n(4016),T=n(39318),A=n(57324);let E=e=>{let{pub:t,user:n,freeSignup:i,freeSignupEmail:a}=e,o="enabled"===t.payments_state&&(null==n?void 0:n.is_free_subscribed)&&!(null==n?void 0:n.is_subscribed)?"paid_upsell":"free_upsell";return(0,s.useEffect)(()=>{(0,y.u4)(y.qY.ABOUT_PAGE_END_CTA_RENDERED,{pub_id:t.id,type:o})},[]),(0,r.FD)(r.FK,{children:[(0,r.Y)(b.A,{onVisible:()=>{(0,y.u4)(y.qY.ABOUT_PAGE_END_CTA_SEEN,{pub_id:t.id,type:o})}}),(0,r.FD)(S.I1,{alignItems:"center",gap:16,padding:24,className:l()("container-QYwuRw","end-cta-container"),children:[t.author_photo_url?(0,r.Y)(C.eu,{photoUrl:t.author_photo_url,size:64}):t.logo_url?(0,r.Y)(I.Nq,{logoUrl:t.logo_url,size:64,radius:"sm"}):null,(0,r.FD)(S.I1,{alignItems:"center",children:[(0,r.FD)(F.EY.H2,{lineHeight:30,align:"center",color:"pub-primary-text",children:["Subscribe to ",t.name]}),t.hero_text&&(0,r.Y)(F.EY.Meta,{size:12,className:"heroText-vjETGo",align:"center",color:"pub-secondary-text",children:t.hero_text})]}),(0,r.Y)(f.A,{pub:t,user:n,freeSignup:i,freeSignupEmail:a,isStatic:!1,source:"about-page-end-cta"})]})]})};function N(e){let{pub:t,user:n,freeSignup:i,freeSignupEmail:a,subscribeContent:l}=e;return"string"!=typeof l?(0,r.FD)("div",{className:"content-about-silhouette",children:[(0,r.Y)("div",{className:"content-about-silhouette-line"}),(0,r.Y)("div",{className:"content-about-silhouette-line"}),(0,r.Y)("div",{className:"content-about-silhouette-line"}),(0,r.Y)("div",{className:"content-about-silhouette-line"}),(0,r.Y)("div",{className:"content-about-silhouette-line"})]}):(0,r.Y)("div",{className:"content-about",children:(0,r.Y)(m.A,{html:l,pub:t,user:n,freeSignup:i,freeSignupEmail:a,isAboutPage:!0})})}function P(e){let{pub:t,people:n}=e,i=(0,c.useMediaQuery)({maxWidth:540}),a=i?[[]]:[[],[]];for(let e=0;e<n.length;++e){let t=n[e];if(t){var l;null==(l=a[i?0:e%2])||l.push(t)}}return(0,r.Y)("div",{className:"content-people",children:a.map(e=>(0,r.Y)("div",{className:"people-column",children:e.map(e=>(0,r.Y)("div",{className:"content-person",onClick:n=>(0,Y.o)(n,(0,T.laT)(e,t,{utm_source:A.VU.aboutPage}),{native:!0}),children:(0,r.Y)(p.a,{subject:e,utmSource:"about-page"})}))}))})}class x extends s.Component{async componentDidMount(){this.loadPeople(),this.loadAbout()}async loadAbout(){if(""!==this.state.subscribeContent)try{let{body:e}=await u().get("/api/v1/publication/subscribe_content");this.setState({subscribeContent:e})}catch(e){console.error("Failed to load about content:",e)}}async loadPeople(){if(!this.state.people)try{let e=(await u().get("/api/v1/publication/users/ranked").query({public:!0})).body;this.setState({people:e})}catch(e){console.error("Failed to load people:",e)}}render(){var e;let{pub:t,user:n,freeSignup:a,freeSignupEmail:l,metadata:s}=this.props,{subscribeContent:c,people:d}=null!=(e=this.state)?e:{};if((0,D.lu)({pub:t})&&c)return(0,r.Y)(v.r,{pub:t,user:n||void 0,type:"about",html:c,isAboutPage:!0});let u=(0,D.S2)({pub:t}),p=(!n||!(0,_.e)(n,t))&&function(e){if("undefined"==typeof window)return!0;let t=document.createElement("div");t.innerHTML=e;for(let e=t.childNodes.length-1;e>=0;e--){let n=t.childNodes[e];if((0,w.nB)(n,"button-wrapper")||(0,w.nB)(n,"subscription-widget-wrap"))return!1}return!0}(c);return(0,r.Y)(g.DH,{children:(0,r.FD)("div",{className:"page typography about-page post",children:[s&&(0,r.Y)(h.Metadata,(0,i._)({},s)),(0,r.FD)("div",{className:"container",children:[(null==n?void 0:n.is_contributor)&&(0,r.Y)(k.$n,{priority:"secondary-outline",href:(0,T.yRP)("/publish/settings/edit",{title:"About page",bodyField:"subscribe_content",redirect:document.location.href}),localNavigation:!1,leading:(0,r.Y)(o.A,{size:20}),children:"Edit page"}),(0,r.Y)("div",{className:"about-content-wrap",children:(0,r.Y)(N,{pub:t,user:n,freeSignup:a,freeSignupEmail:l,subscribeContent:c})}),p?(0,r.Y)(E,{pub:t,user:n,freeSignup:a,freeSignupEmail:l}):null,!u&&(null!=d?d:[]).length>0&&(0,r.FD)(S.I1,{gap:24,children:[(0,r.Y)("h3",{className:"about-page-section-title",children:"People"}),(0,r.Y)(P,{pub:t,people:d})]})]})]})})}constructor(e,t){super(e,t),this.state={subscribeContent:e.subscribeContent,people:e.people}}}},30466:function(e,t,n){n.d(t,{A:()=>p});var i=n(69277),r=n(4006),a=n(32485),l=n.n(a),o=n(79909),s=n(13950),c=n(2058),d=n(93800),u=n(56458);function p(e){var t,n;let{children:a,title:p,pub:h,user:m,sort:g,search:f,newPostsForArchive:v,topPostsForArchive:b,communityPostsForArchive:y,searchPosts:Y,slug:_,isPodcast:w,metadata:C}=e,k=!!(null==h?void 0:h.theme),S=null==(t=h.sections)?void 0:t.find(e=>e.slug===_),I=null!=(n=null==S?void 0:S.id)?n:w?"pubPodcast":"pub",F=null==v?void 0:v[I],D=null==b?void 0:b[I],T=null==y?void 0:y[I];return(0,r.FD)(s.DH,{children:[C&&(0,r.Y)(o.Metadata,(0,i._)({},C)),(0,r.Y)("div",{className:l()("archive-page typography","container-b1BW1a",{"use-theme-bg":k}),children:(0,r.FD)("div",{className:"container",children:[p&&(0,r.Y)("h2",{children:p}),(0,r.Y)(c.M,{communityPosts:T,isPodcast:w,newPosts:F,pub:h,search:f,searchPosts:Y,sectionId:null==S?void 0:S.id,showMonthDividers:!0,sort:g,source:"archive",topPosts:D,user:m,variant:"list",children:e=>{let{posts:t,linkToComments:n,onClickPost:i}=e;return(0,r.Y)(d.m,{hideImages:(0,u.$P)({pub:h}),linkToComments:n,posts:t,variant:"two-column-list",onClickPost:i})}}),a]})})]})}},93564:function(e,t,n){n.d(t,{Jk:()=>$,Nm:()=>J,iQ:()=>K,o6:()=>q});var i=n(99851),r=n(69277),a=n(79785),l=n(4006),o=n(17402),s=n(15734),c=n.n(s),d=n(67616),u=n(34746),p=n(30653),h=n(13950),m=n(55136),g=n(58398),f=n(61193),v=n(77481),b=n(58997),y=n(84605),Y=n(85478),_=n(73684),w=n(86500),C=n(68349),k=n(17096),S=n(56878),I=n(12010),F=n(47570),D=n(93354),T=n(36757),A=n(87087),E=n(73957),N=n(76977),P=n(63136),x=n(36372),L=n(56007),O=n(11510),B=n(4016),M=n(56262),R=n(39318),U=n(41086),j=n(82776),z=n(70515);function H(){let e=(0,a._)(["Comments on this "," are for "," subscribers"]);return H=function(){return e},e}class W extends o.Component{async componentDidMount(){var e;let{iString:t}=this.props;if((0,C.cH)(this.onWindowVisibilityChange),this.props.publication.community_enabled||this.props.inline?await this.loadPost():document.location.href="./",null==(e=this.props.matches)?void 0:e.feedCommentUrl){let e=this.props.matches.feedCommentUrl,n=new URL(location.toString());n.searchParams.delete("feedCommentUrl"),history.replaceState({},"",n),this.props.popToast(()=>(0,l.Y)(x.y,{text:t("Note Shared."),cta:t("View now"),href:e}))}}componentWillUnmount(){(0,C.Gr)(this.onWindowVisibilityChange),clearInterval(this.loadTimeout)}async componentDidUpdate(e,t){if(e.slug!==this.props.slug||t.sort!==this.state.sort){let e=this.props.post&&this.props.post.slug===this.props.slug;await (0,C.wb)(this,{post:e?this.props.post:null,comments:[]}),await this.loadPost()}else if(this.state.post&&this.state.comments&&!this.commentsViewed&&!this.state.loading){let e=0;(0,z.WD)(this.state.comments,()=>{e++}),this.state.post.comment_count!==e&&(this.state.post.comment_count=e,this.setState({post:this.state.post}),this.props.onChange&&this.props.onChange({post:this.state.post}))}}queueRefresh(){if(!this.commentsViewed&&this.state.comments&&this.state.post){this.commentsViewed=!0;let{post:e}=this.state;(0,w.u4)(w.qY.COMMENTS_VIEWED,{post_id:e.id,comment_count:this.state.comments.length}),this.props.publication.community_enabled&&!("thread"===e.type||(0,j.canSeeComments)(this.props.user,e))&&(0,w.u4)(w.qY.COMMENT_PAYWALL_SHOWN,{post_id:e.id,post_type:e.type}),"thread"===e.type&&this.props.user&&Promise.resolve(c().post("/api/v1/posts/".concat(e.id,"/seen")))}clearTimeout(this.loadTimeout),"undefined"!=typeof window&&(this.loadTimeout=window.setTimeout(()=>this.loadPost(),3e4))}async loadPost(){let e;if(this.state.comments&&!(0,C.Tf)())return;clearTimeout(this.loadTimeout),this.setState({loading:!0});let t=this.state.comments&&this.state.comments.length>0;this.state.comments&&(e=null,(0,z.WD)(this.state.comments,t=>{!t.deleted&&t.date&&(!e||t.date>e)&&(e=t.date)}));try{let t=this.props.slug,n=this.state.sort,i={token:this.props.post_reaction_token||"",all_comments:!0,sort:n,last_comment_at:e};this.state.post&&this.props.commentId&&(i.comment_id=this.props.commentId);let r=await c().get(this.state.post?"/api/v1/post/".concat(this.state.post.id,"/comments"):"/api/v1/posts/".concat(t)).query(i);if(this.setState({loading:!1}),t!==this.props.slug||n!==this.state.sort)return;let a=this.state.sort;!this.state.post&&r.body.default_comment_sort&&(a=r.body.default_comment_sort);let l=r.body.comments,o=this.state.comments;if(!this.state.post||!o||l){let e=o&&l?(0,D.t)(o,l):null!=l?l:[];await (0,C.wb)(this,{post:this.state.post||r.body,comments:e,sort:a})}}catch(e){console.error("Failed to load post:",e),400===e.statusCode&&await (0,C.wb)(this,{notAllowedToFetchComments:!0}),this.setState({loading:!1})}!t&&this.state.comments&&this.state.comments.length>0&&(0,C.H7)(),(0,C.Tf)()&&this.queueRefresh(),this.triggerShareOnLoad()}onSortSelected(e){var t,n;this.setState({sort:e}),(0,w.u4)(w.qY.COMMENTS_SORTED,{post_id:null==(t=this.state.post)?void 0:t.id,post_type:null==(n=this.state.post)?void 0:n.type,sort:e})}triggerShareOnLoad(){"share"===(0,U.y)("action")&&(window.history.replaceState({},document.title,(0,R.oRR)({action:null})),this.setState({shareModalOpen:!0,shareModalMedium:"email"}))}_isPub(e){let{publication:t}=this.props;return(null==t?void 0:t.subdomain)===e}render(){var e;let{slug:t,user:n,freeSignup:i,freeSignupEmail:r,publication:a,post_reaction_token:o,inline:s,commentId:c,selectionFromQuery:u,imgSelectionFromQuery:p,freeTrialCoupon:f,show_reaction_upsell:v,bannedFromNotes:y,iString:Y}=this.props,{sort:w,post:C,comments:F,notAllowedToFetchComments:D,reactionSigninComment:T}=null!=(e=this.state)?e:{};if(!C||!a.community_enabled)return s&&C?(0,l.Y)("div",{className:"container",children:(0,l.Y)(J,{post:C})}):(0,l.Y)("div",{className:"comments-page",children:(0,l.Y)("div",{className:"container",children:(0,l.Y)(b.D,{})})});let N=(0,B.lu)({pub:a}),P=a.community_enabled&&C&&"none"!==C.write_comment_permissions,x=D||P&&!(0,j.canSeeComments)(n,C),L=async(e,t)=>$({user:n,reactionToken:o,comments:F,id:e,reacted:t,setComments:e=>this.setState({comments:e}),onNeedsSignin:e=>{let{comment:t}=e;this.setState({reactionSigninComment:t})}});return(0,l.Y)(h.DH,{children:(0,l.FD)("div",{className:"comments-page",children:[c&&(null==F?void 0:F[0])?(0,l.Y)(_.j,{comment:F[0],post:C,publication:a}):(0,l.Y)(E.PostMetaTags,{post:C,publication:a,isCommentPage:!this.props.inline,selection:u,imgSelection:p}),(0,l.Y)(g.Z,{isOpen:!!this.state.shareModalOpen,onClose:()=>this.setState({shareModalOpen:!1,shareModalMedium:void 0}),user:n,pub:a,post:C,reaction_token:o,comments:F,commentId:c,medium:this.state.shareModalMedium||"web"}),!s&&!c&&(0,l.Y)("div",{className:"container",children:(0,l.Y)(b.X,{pub:a,post:Object.assign({},C,{comment_url_override:(0,R.wu9)(a,C,{comments:!0})}),user:n,freeSignup:i,freeSignupEmail:r,hidden:!(0,j.isUUID)(t)&&C.hidden,truncated:"thread"!==C.type,post_reaction_token:o,onChange:e=>this.setState(null!=e?e:{}),showUnsubscribeNotice:!0,gap:0,showShare:!1,children:(0,l.Y)("div",{className:"full-container-border"})})}),x&&(0,l.Y)(G,{freeSignup:i,freeSignupEmail:r,freeTrialCoupon:f,inline:s,post:C,publication:a,user:n}),"thread"===C.type||(0,j.canSeeComments)(n,C)?(0,l.FD)("div",{className:"container",children:[!s&&F&&(0,l.Y)(q,{comments:F,post:C,sort:w,notAllowedToFetchComments:D,commentId:c,publication:a,handleSort:e=>this.onSortSelected(e),useFreePressTheme:N}),F&&F.length>0&&!P&&(0,l.Y)(J,{post:C}),P&&(0,l.Y)(S.g,{user:n,freeSignup:i,freeSignupEmail:r,pub:a,post:C,token:o,autoFocus:(0,A.Wn)(),onSuccess:e=>this.setState({comments:[e].concat(F)}),bannedFromNotes:y}),c&&F&&(0,l.Y)("a",{className:"return-to-thread-link",href:(0,R.wu9)(a,C,{comments:!0,commentId:c,highlightComment:!0}),children:Y("⭠ Return to thread")}),F||D?F.length>0?[(0,l.Y)("div",{className:"comment-list-container",ref:this.scrollRef,children:(0,l.Y)(k.Wh,{user:n,freeSignup:i,freeSignupEmail:r,pub:a,post:C,comments:F,reaction_token:o,depth:0,collapseAtDepth:s?10:F.length>3&&"most_recent_first"===w?k.ko:k.cQ,onChange:this.onChange,pageSize:s||this._isPub("astralcodexten")?k.Gs:"thread"===C.type?k.WR:k.yQ,scrollRef:this.scrollRef,retainUserCollapseState:!0,updateCommentReacted:this.updateCommentReacted,noRestack:!0},C.id)})]:null:[(0,l.Y)(I.U,{}),(0,l.Y)(I.U,{})]]}):null,T&&(0,l.Y)(m.LZ,{isOpen:!0,comment:T,pub:a,user:n,react:()=>L(T.id,!0),onClose:()=>this.setState({reactionSigninComment:null})}),v?(0,l.Y)(d.Cv,{user:n,pub:a,post:C}):null,this.state.upsellModalOpen&&(0,l.Y)(V,{isOpen:this.state.upsellModalOpen,onClose:()=>this.setState({upsellModalOpen:!1}),action:"comment",post:C,pub:a})]})})}constructor(e,t){let n;super(e,t),(0,i._)(this,"scrollRef",void 0),(0,i._)(this,"loadTimeout",void 0),(0,i._)(this,"commentsViewed",void 0),(0,i._)(this,"onWindowVisibilityChange",()=>{(0,C.Tf)()?setTimeout(()=>{this.loadPost()},100):clearTimeout(this.loadTimeout)}),(0,i._)(this,"onChange",e=>{this.setState({comments:(0,T.f)(this.state.comments,e)})}),(0,i._)(this,"updateCommentReacted",(e,t)=>{let{user:n,post_reaction_token:i}=this.props,{comments:r}=this.state;$({user:n,reactionToken:i,comments:r,id:e,reacted:t,setComments:e=>this.setState({comments:e}),onNeedsSignin:e=>{let{comment:t}=e;this.setState({reactionSigninComment:t})}})}),e.post&&e.post.slug===e.slug&&(n=e.post);const r=e.sort||n&&n.default_comment_sort||e.publication.default_comment_sort||"best_first",a=e.initialComments;this.scrollRef=(0,o.createRef)();const l="undefined"!=typeof window?(0,U.y)("show_app_upsell"):null;this.state={post:n,sort:r,comments:a,loading:!1,reactionSigninComment:null,upsellModalOpen:"comment"===l}}}function V(e){let{isOpen:t,onClose:n,action:i,post:r,pub:a}=e,s=(0,O.Iu)(),c=(0,o.useMemo)(()=>{var e;let t=null==(e=r.publishedBylines)?void 0:e[0];return(null==t?void 0:t.name)&&(t.photo_url||a.logo_url)?{author:{id:t.id,name:t.name,photo_url:t.photo_url||null},pub:{subdomain:a.subdomain,name:a.name,logo_url:a.logo_url}}:null},[r.publishedBylines,a.subdomain,a.name,a.logo_url]);return t&&s&&c?(0,l.Y)(p.M,{isOpen:!0,setOpen:n,author:c.author,pub:c.pub,action:i,postId:r.id,postSlug:r.slug}):null}let K=(0,Y.P_)((0,L.Ho)((0,y.wr)(W))),q=e=>{let{comments:t,post:n,sort:i,notAllowedToFetchComments:r,commentId:a,publication:o,handleSort:s,useFreePressTheme:c=!1,commentCount:d,disableMobileBottomSheet:u}=e,{iString:p,iPlural:h}=(0,y.GO)(),m=null!=d?d:n.comment_count;return c?(0,l.Y)(f.W,{comments:t,post:n,publication:o,notAllowedToFetchComments:r,handleSort:s,sort:i,disableMobileBottomSheet:u}):(0,l.FD)(N.Ye,{alignItems:"center",justifyContent:"space-between",paddingY:8,children:[(0,l.Y)(P.EY.B1,{color:"primary",weight:"bold",children:t.length>0?h("1 Comment","%1 Comments",m):p("Comments")}),t.length>1&&!r&&!a&&(0,l.Y)(F.D,{currentSort:i,isLoading:!t,handleSort:s,pub:o,disableMobileBottomSheet:u})]})},G=e=>{let{freeSignup:t,freeSignupEmail:n,freeTrialCoupon:i,inline:r,post:a,publication:o,user:s}=e,{iTemplate:c,iString:d}=(0,y.GO)();return(0,B.lu)({pub:o})?(0,l.Y)(v.n,{publication:o,post:a,user:s,freeSignupEmail:n,showHeader:!r}):(0,l.Y)("div",{className:"container",children:(0,l.Y)(u.pU,{user:s,freeSignupEmail:n,freeSignup:t,publication:o,post:a,title:c(H(),"podcast"===a.type?"episode":"post",(0,M.isFoundingAudience)(a.audience)?"founding":"paid"),reauthenticationTitle:d("To see the comments, please re-authenticate."),coupon:i})})},J=e=>{let{post:t}=e,{iString:n}=(0,y.GO)();return(0,l.Y)("div",{className:"locked-comments",children:n("adhoc_email"===t.type?"Commenting has been turned off for this email":"Commenting has been turned off for this post")})};async function $(e){let{user:t,reactionToken:n,comments:i,id:a,reacted:l,setComments:o,onNeedsSignin:s}=e,c=(0,A.pU)(a,i);if(!c)return;let d=(0,r._)({},c);(0,m.wx)(t,d,l),o((0,A.cx)(i.slice(0),d));try{await (0,m.xu)(d,!0,l,n)}catch(e){var u;if((0,m.wx)(t,d,!l),o((0,A.cx)(i.slice(0),(0,r._)({},d))),(null==(u=e.response)?void 0:u.statusCode)!==401)return void alert((0,C.uX)(e));await s({comment:d})}}},38304:function(e,t,n){n.d(t,{Jk:()=>r.Jk,Nm:()=>r.Nm,PG:()=>a.PG,cx:()=>a.cx,gi:()=>i.g,iQ:()=>r.iQ});var i=n(56878);n(17096);var r=n(93564);n(12010);var a=n(87087)},53130:function(e,t,n){n.d(t,{m:()=>D});var i=n(99851),r=n(4006),a=n(32485),l=n.n(a),o=n(83673),s=n.n(o),c=n(17402),d=n(15734),u=n.n(d),p=n(6212),h=n(13950),m=n(56778),g=n(94794),f=n(84565),v=n(53989),b=n(85478),y=n(86500),Y=n(3142),_=n(68349),w=n(73957),C=n(88559),k=n(76977),S=n(79564),I=n(39318),F=n(41086);class D extends c.Component{async componentDidMount(){(0,_.H7)(),this.cleanEmbedResizeListener=(0,Y._)(),this.state.post||await this.loadPost(),this.triggerShareOnLoad(),this.fillEmbeddedEmailInputs()}componentWillUnmount(){var e;null==(e=this.cleanEmbedResizeListener)||e.call(this)}async componentDidUpdate(){this.state.embeddedEmailInputsFilled||this.fillEmbeddedEmailInputs()}async loadPost(){if(this.setState({embeddedEmailInputsFilled:!1}),this.props.post)this.setState({post:this.props.post},()=>(0,_.H7)());else try{let e=await u().get("/api/v1/cross-posts/".concat(this.props.post_id));await (0,_.wb)(this,{post:e.body.post,introText:e.body.intro_text,crossPostedPub:e.body.crossPostedPub,crossPostingByLine:e.body.crossPostingByLine,userWithCrossPostedPubContext:e.body.userWithCrossPostedPubContext,crossPostedPublicationSettings:e.body.crossPostedPublicationSettings,crossPostedSiteConfig:e.body.crossPostedSiteConfig}),(0,_.H7)()}catch(e){console.error("Failed to load post:",e),alert((0,_.uX)(e))}}triggerShareOnLoad(){"share"===(0,F.y)("action")&&(window.history.replaceState({},document.title,(0,I.oRR)({action:null})),this.post&&this.post.triggerShare({fromEmail:!0}))}render(){var e,t;let{freeSignup:n,freeSignupEmail:i,publication:a}=this.props,{post:o,user:c,introText:d,crossPostedPub:u,crossPostingByLine:f,userWithCrossPostedPubContext:y,crossPostedPublicationSettings:Y,crossPostedSiteConfig:_}=null!=(e=this.state)?e:{},I=(null==o?void 0:o.type)==="podcast",F=["video","podcast"].includes(null!=(t=null==o?void 0:o.type)?t:"");return u?(0,r.Y)("div",{children:(0,r.Y)(h.DH,{children:(0,r.FD)("div",{className:l()("single-post-container"),children:[(0,r.Y)("div",{className:l()({container:!I}),children:(0,r.FD)("div",{className:"single-post",children:[(0,r.Y)(w.PostMetaTags,{post:o,publication:a}),o&&Y&&_?(0,r.Y)(v.Fm,{settings:Y,children:(0,r.Y)(b.eE,{siteConfigs:_,children:(0,r.Y)(g.QR,{crossPost:{crossPostedPub:u},children:F?(0,r.Y)(S.H,{ref:this.assignPost,user:y,post:o,pub:u,freeSignup:n,freeSignupEmail:i,paywall:!1,noTitleLink:!0,onChange:e=>this.setState(null!=e?e:{}),fromPostPage:!0,crossPostInfo:{introText:d,crossPostedPub:u,crossPostingByLine:f,userWithCrossPostedPubContext:y}}):(0,r.Y)(p.L4,{ref:this.assignPost,user:y,post:o,pub:u,freeSignup:n,freeSignupEmail:i,paywall:!1,noTitleLink:!0,onChange:e=>this.setState(null!=e?e:{}),fromPostPage:!0,crossPostInfo:{introText:d,crossPostedPub:u,crossPostingByLine:f,userWithCrossPostedPubContext:y}})})})}):(0,r.Y)(p.DZ,{pub:a})]})}),a.has_posts&&o?(0,r.Y)(k.Ye,{justifyContent:"center",borderTop:"detail",paddingTop:8,children:(0,r.Y)("div",{className:"single-post-section",children:(0,r.FD)("div",{className:"container",children:[(0,r.Y)(m.A,{onVisible:()=>{this.onVisible("Top Posts Footer")}}),(0,r.Y)(C.Q,{user:c,freeSignup:n,freeSignupEmail:i,pub:a,maxPosts:3,filterPostsPredicate:e=>e.id!==(null==o?void 0:o.id),stateInUrl:!0,sortTabs:e=>{if(this.context.getConfigFor("related_posts_enabled")){let t=e.findIndex(e=>"related"===e.id);if(-1!==t)return s()([e[t]].concat(e.filter((e,n)=>n!==t)))}let t=e.findIndex(e=>"top"===e.id);return -1!==t?s()([e[t]].concat(e.filter((e,n)=>n!==t))):null},delayFirstLoad:1e3,source:"post",isBelowTheFold:!0,post:o})]})})}):null]})})}):(0,r.Y)("div",{})}constructor(e,t){super(e,t),(0,i._)(this,"cleanEmbedResizeListener",void 0),(0,i._)(this,"post",void 0),(0,i._)(this,"assignPost",e=>{this.post=e}),(0,i._)(this,"onVisible",e=>{let t="".concat(e," Seen");!this.state.post||this.state[t]||(this.setState({[t]:!0}),(0,y.u4)(t,{post_id:this.state.post.id,post_audience:this.state.post.audience,post_type:this.state.post.type}))}),(0,i._)(this,"fillEmbeddedEmailInputs",()=>{var e;let t=document.querySelectorAll('article.post input[type="email"]'),n=(null==(e=this.state.user)?void 0:e.email)||this.props.freeSignupEmail;n&&t.forEach(e=>e.value=n),this.setState({embeddedEmailInputsFilled:!0})});const{user:n}=e;e.post?this.state={post:e.post,user:n,introText:e.introText,crossPostedPub:e.crossPostedPub,crossPostingByLine:e.crossPostingByLine,userWithCrossPostedPubContext:e.userWithCrossPostedPubContext,crossPostedPublicationSettings:e.crossPostedPublicationSettings,crossPostedSiteConfig:e.crossPostedSiteConfig}:this.state={user:n}}}(0,i._)(D,"contextType",f.Ke)},67728:function(e,t,n){n.d(t,{A:()=>_});var i=n(99851),r=n(4006),a=n(32485),l=n.n(a),o=n(17402),s=n(91370),c=n(34206),d=n(9266),u=n(79391),p=n(85478),h=n(1683),m=n(68349),g=n(35369),f=n(63136),v=n(39318),b=n(80856),y=n(49807),Y=n(57324);class _ extends o.Component{componentDidMount(){(0,m.NN)((0,v.dJ9)("/img/substack_wordmark.png",200));let e=this.props.freeSignupEmail||this.props.user&&this.props.user.email;if(e&&this.emailInput)this.emailInput.value=e;else if(!(0,m.rr)()){var t;null==(t=this.emailInput)||t.focus()}}onPrepareData(e){!this.props.pub.plans&&this.context.getConfigFor("no_embed_redirect")||this.subscribeWindow||(this.subscribeWindow=window.open("about:blank","_blank"))}onSignup(e){this.setState({freeSignup:!0,freeSignupEmail:e.body.email}),this.subscribeWindow&&(this.subscribeWindow.location=(0,y.eV6)(this.props.pub,{addBase:!0,params:{just_signed_up:!0,skip_redirect_check:!0,utm_medium:Y.Jn.web,utm_source:Y.VU.embed,freeSignupEmail:e.body.email}}))}onError(e){if(this.subscribeWindow){try{this.subscribeWindow.close()}catch(e){console.error("Failed to close subscribe window:",e)}this.subscribeWindow=null}}render(){var e;let{pub:t,user:n,no_border:i}=this.props,{freeSignup:a,freeSignupEmail:o,loading:p,success:y}=null!=(e=this.state)?e:{},_=o||n&&n.email;return(0,r.FD)("div",{className:"embed-page ".concat(i?"no-border":""),children:[(0,r.FD)("div",{className:"embed-page-inner",children:[t.logo_url&&(0,r.Y)("a",{href:"".concat(t.base_url,"/"),target:"_blank",children:(0,r.Y)("img",{className:"publication-logo",src:(0,v.dJ9)(t.logo_url,170,{quality:"auto:best"}),alt:"Logo"})}),(0,r.Y)("h1",{className:"publication-name".concat(t.logo_url?"":" no-logo"),children:(0,r.Y)("a",{href:"".concat(t.base_url,"/"),target:"_blank",children:(0,r.Y)(s.A,{text:t.name})})}),!!t.hero_text&&(0,r.Y)("p",{className:"publication-tagline",children:(0,r.Y)(s.A,{text:t.hero_text})}),(0,r.Y)("div",{className:"publication-meta",children:(0,r.Y)(s.A,{text:(0,d.Be)(t,{includePrice:!1,includeBadge:!0,rankingDetailOverrideText:t.rankingDetailFreeSubscriberCount,includeRankingDetail:!!t.rankingDetailFreeSubscriberCount})})}),t.invite_only?(0,r.FD)(c.Ay,{className:"subscription-request-form",ref:this.assignForm,noInlineErrors:!0,action:(0,v.yRP)("/api/v1/subscription/request"),noJsAction:(0,v.yRP)("/api/v1/subscription/request",{nojs:!0}),onSuccess:()=>this.setState({success:!0}),onError:e=>{this.setState({loading:!1}),alert((0,m.uX)(e,"Failed to request a subscription"))},children:[(0,r.Y)("input",{type:"hidden",name:"first_url",value:h.R9}),(0,r.Y)("input",{type:"hidden",name:"first_referrer",value:h.b7}),(0,r.Y)("input",{type:"hidden",name:"current_url",value:h.AT}),(0,r.Y)("input",{type:"hidden",name:"current_referrer",value:h.uC}),(0,r.Y)("input",{type:"hidden",name:"first_session_url",value:h.K0}),(0,r.Y)("input",{type:"hidden",name:"first_session_referrer",value:h.OG}),!!_&&(0,m.o7)(),(0,r.FD)("div",{className:"sideBySideWrap",children:[(0,r.Y)("input",{className:l()(y?"secondary":"primary"),type:"email",name:"email",ref:this.assignEmailInput,readOnly:!!(_||p),disabled:!!(p||y||_),placeholder:"Type your email…"}),(0,r.Y)(g.$n,{priority:y?"secondary":"primary",type:"submit",disabled:!!(p||y),onClick:()=>{this.setState({loading:!0})},children:y?"Requested":"Subscribe"})]}),(0,r.Y)("div",{id:"error-container"})]}):(0,r.Y)(u.A,{source:"embed",pub:t,user:n,freeSignup:a,freeSignupEmail:o,forceEmailInput:!0,onPrepareData:e=>this.onPrepareData(e),onSignup:e=>this.onSignup(e),onError:e=>this.onError(e)}),(0,r.Y)("div",{className:"embed-tos",children:(0,r.FD)(f.EY.B4,{color:"pub-secondary-text",size:12,lineHeight:16,align:"center",children:["By subscribing you agree to"," ",(0,r.Y)("a",{className:"tos-text",target:"_blank",rel:"noopener",href:(0,b.Ru)({pub:t,utm_source:"embed_publication"}),children:"Substack's Terms of Use"}),", ",(0,r.Y)("a",{className:"tos-text",target:"_blank",rel:"noopener",href:(0,b._)({pub:t,utm_source:"embed_publication"}),children:"our Privacy Policy"})," ","and"," ",(0,r.Y)("a",{className:"tos-text",target:"_blank",rel:"noopener",href:(0,b.iQ)({utm_source:"embed_publication"}),children:"our Information collection notice"})]})}),(n||a)&&(0,r.Y)("p",{className:"sign-out-block",children:(0,r.Y)("span",{className:"account-info-logout",children:(0,r.Y)("a",{href:(0,v.bgT)({redirect:document.location.href,for_pub:t.subdomain}),"data-native":!0,children:"Sign out"})})})]}),(0,r.Y)("a",{href:"".concat((0,v.Ewe)(),"/?utm_source=").concat(Y.VU.embed,"&utm_content=").concat(t.subdomain),target:"_blank",children:(0,r.Y)("img",{ref:this.assignImg,className:"substack-watermark",src:(0,v.dJ9)("/img/substack_wordmark.black.png",200),onMouseEnter:()=>{this.img&&(this.img.src=(0,v.dJ9)("/img/substack_wordmark.png",200))},onMouseLeave:()=>{this.img&&(this.img.src=(0,v.dJ9)("/img/substack_wordmark.black.png",200))},alt:"Substack"})})]})}constructor(e,t){super(e,t),(0,i._)(this,"emailInput",void 0),(0,i._)(this,"subscribeWindow",void 0),(0,i._)(this,"form",void 0),(0,i._)(this,"img",void 0),(0,i._)(this,"assignEmailInput",e=>{this.emailInput=e}),(0,i._)(this,"assignForm",e=>{this.form=e}),(0,i._)(this,"assignImg",e=>{this.img=e}),this.state={freeSignup:e.freeSignup,freeSignupEmail:e.freeSignupEmail,success:!1}}}(0,i._)(_,"contextType",p.W8)},80083:function(e,t,n){n.d(t,{A:()=>d});var i=n(4006),r=n(17402),a=n(15734),l=n.n(a),o=n(99070),s=n(68349),c=n(9036);let d=e=>{var t,n;let{pub:a,slug:d}=e,[u,p]=(0,r.useState)(null);(0,r.useEffect)(()=>{!async function(){try{let e=await l().get("/api/v1/posts/".concat(d));p(e.body)}catch(e){console.error("Failed to load post:",e),404===e.status?alert("Post not found"):alert((0,s.uX)(e))}}()},[d]);let h=!1;return"undefined"!=typeof window&&(h="1"===(null!=(t=(0,c.m)(window.location.href).autoplay)?t:"0")),u?(0,i.Y)(o.A,{feature:"Audio",pub:a,post:u,src:u.podcast_url,autoPlay:h,metricsPost:u,isFancy:!0,showCTAs:!0,mediaUpload:null!=(n=u.podcastUpload)?n:void 0,trackingProps:{surface:"external",contentType:"post",entityType:"post",entityKey:u.id}}):(0,i.Y)("div",{className:"loading-container"})}},46887:function(e,t,n){n.d(t,{A:()=>r});var i=n(4006);function r(){return(0,i.Y)("div",{className:"embed-test-page",children:(0,i.Y)("iframe",{style:{border:"1px solid #EEE",background:"white"},width:"480",height:"320",src:"/embed",frameBorder:"0",scrolling:"no"})})}},78368:function(e,t,n){n.d(t,{A:()=>p});var i=n(4006),r=n(17402),a=n(15734),l=n.n(a),o=n(41873),s=n(68349),c=n(68410),d=n(13348),u=n(9036);let p=e=>{var t,n;let{pub:a,slug:p}=e,[h,m]=(0,r.useState)(null),{isMobile:g}=(0,c.sM)();(0,r.useEffect)(()=>{!async function(){try{let e=await l().get("/api/v1/posts/".concat(p));m(e.body)}catch(e){console.error("Failed to load post:",e),404===e.status?alert("Post not found"):alert((0,s.uX)(e))}}()},[p]);let f=!1;return"undefined"!=typeof window&&(f="1"===(null!=(t=(0,u.m)(window.location.href).autoplay)?t:"0")),(null==h?void 0:h.videoUpload)?(0,i.Y)("div",{className:"video-player-embed-container",children:(0,i.Y)(o.A,{mediaUpload:h.videoUpload,pub:a,autoPlay:f,videoType:"video-embed",renderPlayButton:()=>(0,i.Y)(d.ro,{isPlaying:!1,size:g?40:56}),contentType:"embed",entityType:"post",entityKey:null!=(n=null==h?void 0:h.id)?n:"unknown",surface:"external"})}):(0,i.Y)("div",{className:"loading-container"})}},27179:function(e,t,n){n.d(t,{A:()=>h});var i=n(4006),r=n(17402),a=n(69277),l=n(70408),o=n(97731);let s=e=>(0,i.Y)(o.A,(0,l._)((0,a._)({},e),{name:"ChevronIcon",svgParams:{height:24,width:24,stroke:"#666666",viewBox:"0 0 24 24"},children:(0,i.Y)("path",{d:"M9.88507 18.9609L15.8851 12.9609L9.88507 6.96094",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})),c=e=>(0,i.FD)(o.A,(0,l._)((0,a._)({},e),{name:"DownloadIcon",svgParams:{height:32,width:32},children:[(0,i.Y)("rect",{width:"32",height:"32",rx:"6",fill:e.fill||"black"}),(0,i.Y)("path",{d:"M23.5 18.5V21.8333C23.5 22.2754 23.3244 22.6993 23.0118 23.0118C22.6993 23.3244 22.2754 23.5 21.8333 23.5H10.1667C9.72464 23.5 9.30072 23.3244 8.98816 23.0118C8.67559 22.6993 8.5 22.2754 8.5 21.8333V18.5",stroke:e.stroke||"white",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,i.Y)("path",{d:"M11.8333 14.3335L16 18.5002L20.1667 14.3335",stroke:e.stroke||"white",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,i.Y)("path",{d:"M16 18.5V8.5",stroke:e.stroke||"white",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})),d=e=>(0,i.FD)(o.A,(0,l._)((0,a._)({},e),{name:"PanelsIcon",svgParams:{height:32,width:32},children:[(0,i.Y)("rect",{width:"32",height:"32",rx:"6",fill:"black"}),(0,i.Y)("rect",{x:"7.19995",y:"7.2002",width:"8.49554",height:"11.8938",rx:"0.424777",fill:"white"}),(0,i.Y)("rect",{opacity:"0.7",x:"7.19995",y:"19.603",width:"8.49554",height:"6.79643",rx:"0.424777",fill:"white"}),(0,i.Y)("path",{opacity:"0.7",d:"M16.2048 7.62497C16.2048 7.39037 16.395 7.2002 16.6296 7.2002H20.4526C23.737 7.2002 26.3995 9.8627 26.3995 13.1471C26.3995 16.4314 23.737 19.094 20.4526 19.094H16.6296C16.395 19.094 16.2048 18.9038 16.2048 18.6692V7.62497Z",fill:"white"})]}));var u=n(39318),p=n(82776);function h(e){var t;let{file:n="undefined"!=typeof window&&"file"in window._preloads&&(null==(t=window._preloads)?void 0:t.file)||{},pub:a}=e,[l,o]=(0,r.useState)(null);return(0,r.useEffect)(()=>{(async()=>{if(!n.fileKey){let e=await fetch("/api/v1/file/entry/".concat(window.location.pathname.split("/").pop()));e.redirected&&(window.location.href=e.url),o(await e.json())}})()},[n.fileKey]),(0,i.Y)(m,{file:l||n,pub:a})}function m(e){var t,n,r,a;let{file:l,pub:o}=e;if(!l.id)return(0,i.Y)("div",{className:"page",children:(0,i.FD)("div",{className:"container",children:[(0,i.Y)("h3",{children:"Read Now"}),(0,i.Y)("div",{className:"popup-container",children:(0,i.Y)("div",{className:"overlay"})})]})});let h=null==(n=l.file_key)||null==(t=n.split(".").pop())?void 0:t.toUpperCase(),m=(0,p.numberToHumanFileSize)(l.num_bytes),g=(r=null!=h?h:"","".concat(null==(a=l.title)?void 0:a.toLowerCase().replace(/\s/g,"_"),".").concat(r.toLowerCase()));return(0,i.Y)("div",{className:"page",children:(0,i.FD)("div",{className:"container",children:[(0,i.FD)("span",{className:"table-list-title",children:[(0,i.Y)("h3",{children:"Read Now"}),(0,i.Y)("a",{className:"file-sidebar-header-button",href:"".concat((0,u.$_T)(o),"/p/").concat(l.post_id),children:"Back"})]}),(0,i.FD)("div",{className:"table-list",children:[(0,i.FD)("div",{className:"table-list-row table-list-header",children:[(0,i.Y)("img",{className:"table-list-thumbnail ".concat(l.thumbnail&&-1===l.thumbnail.indexOf("/img/attachment_icon.svg")?"":"default"),src:l.thumbnail||"".concat((0,u.$_T)(o),"/img/attachment_icon.svg")}),(0,i.FD)("div",{className:"table-list-col",children:[(0,i.Y)("div",{className:"table-list-h1",children:l.title||"Unknown File"}),(0,i.FD)("div",{className:"table-list-h2",children:[m," ∙ ",h," File"]})]})]}),(0,i.FD)("a",{className:"table-list-row table-list-item",href:"".concat((0,u.$_T)(o),"/api/v1/file/panels/").concat(l.file_key),children:[(0,i.Y)(d,{}),(0,i.FD)("span",{className:"table-list-grow",children:[(0,i.Y)("div",{className:"table-list-h1",children:"Open in Panels"}),(0,i.Y)("div",{className:"table-list-h2",children:"Comic reader for iOS"})]}),(0,i.Y)(s,{stroke:"#666",strokeWidth:0,isStatic:!0})]}),(0,i.FD)("a",{className:"table-list-row table-list-item",download:g,href:"".concat((0,u.$_T)(o),"/api/v1/file/").concat(l.file_key),children:[(0,i.Y)(c,{}),(0,i.FD)("span",{className:"table-list-grow",children:[(0,i.Y)("div",{className:"table-list-h1",children:"Download file"}),(0,i.Y)("div",{className:"table-list-h2",children:g})]}),(0,i.Y)(s,{stroke:"#666",strokeWidth:0,isStatic:!0})]})]})]})})}},54077:function(e,t,n){n.d(t,{A:()=>d});var i=n(99851),r=n(4006),a=n(17402),l=n(15734),o=n.n(l),s=n(5109),c=n(68349);class d extends a.Component{componentDidMount(){this.props.user||(0,c.jL)()}render(){var e;let{pub:t,post:n,user:i,freeSignup:a,freeSignupEmail:l,inviteToPost:o,primaryEligiblePublications:c,switchAccountRedirectUrl:d}=this.props,{error:u}=null!=(e=this.state)?e:{};if(u)return(0,r.FD)("div",{className:"container invite-success",children:[(0,r.Y)("h3",{children:"Error"}),(0,r.Y)("p",{children:u})]});let p=o&&n&&"podcast"===n.type,h=p&&i?"Fill out your profile for your podcast appearance":p&&!i?"Set up your profile for your podcast appearance":o&&i?"Set up your profile":o&&!i?"Fill out your profile":"Your invite to ".concat(t.name),m=p?"Listeners will want to know more about you. Use your profile as a chance to express yourself.":o?"Readers will want to know more about you and even follow your writing. Use your profile as a chance to express yourself.":"Before you can accept your invite, finish setting up your profile:",g=o?"Update Profile & Accept Invite":"Accept Invite",f=i?"Already a writer?":"Already have an account?",v=i?"Switch accounts":"Login";return(0,r.FD)("div",{className:"container finish-invite",children:[(0,r.Y)("h3",{children:h}),(0,r.Y)("p",{children:m}),(0,r.Y)(s.dx,{pageTitle:"",user:i,freeSignup:a,freeSignupEmail:l,needsPhoto:!1,optionalPhoto:o,isPostInvite:o,primaryEligiblePublications:c,onSuccess:this.acceptInvite,text:g}),o&&d&&(0,r.FD)("div",{className:"invite-switch-account",children:[f," ",(0,r.Y)("a",{href:d,children:v})]})]})}constructor(...e){super(...e),(0,i._)(this,"acceptInvite",async()=>{try{var e,t;let n=await o().post("/api/v1/publication_user_invite/".concat(this.props.matches.id,"/accept"));(null==(e=n.body)?void 0:e.postUrl)?location.href=null==(t=n.body)?void 0:t.postUrl:(0,c.V2)("/invite-success/".concat(this.props.matches.id))}catch(t){let e=(0,c.uX)(t);this.setState({error:e})}})}}(0,i._)(d,"defaultProps",{inviteToPost:!1,primaryEligiblePublications:[]})},43440:function(e,t,n){n.d(t,{z:()=>d});var i=n(4006),r=n(17402),a=n(34206),l=n(97432),o=n(79909),s=n(35369),c=n(82776);class d extends r.Component{renderNotAvailable(e){let{time:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,i.FD)("div",{className:"container reward-page gift-reward-page",children:[(0,i.Y)("h2",{children:"All gone"}),e,(0,i.FD)("p",{children:["Sorry, ",t?"this gift has expired":"all of these gifts have already been claimed",". You can still subscribe if you like."]}),(0,i.Y)("div",{className:"signup",children:(0,i.Y)(l.A,{source:"viral_gift_none_left",pub:this.props.pub,onSuccess:()=>{document.location.href="/subscribe"}})})]})}renderForSender(){var e;return[(0,i.FD)("h3",{className:"sender-hint",children:[(0,i.FD)("span",{children:[(e=this.props.user).name?e.name.trim().split(/\s+/g)[0]:e.email.split("@")[0],", share this page to give your gift"]}),(0,i.Y)("a",{className:"button twitter-button",href:this.props.viral_gift_data.tweet_link,"data-native":!0,children:"Share on Twitter"})]})]}render(){var e;let{pub:t,t:n,user:r,freeSignupEmail:l,viral_gift_data:d}=this.props,{sender_name:u,count_remaining:p,sender_id:h}=d,m=(0,c.getGiftValueText)(null!=(e=t.plans)?e:[]),g=m?" (value: ".concat(m,")"):"",f="A three-month subscription to ".concat(t.name).concat(g),v=(0,i.Y)(o.Metadata,{title:"Accept ".concat(u||"your friend","'s gift"),description:f,image:t.logo_url});if(!n||!p)return this.renderNotAvailable(v);let b=null;r&&r.id==h&&(b=this.renderForSender());let y="",Y=l||"";return r&&!b&&(y=r.name,Y=r.email),(0,i.FD)("div",{className:"container reward-page receive-page",children:[b,v,(0,i.Y)("h2",{children:"Accept Gift Subscription"}),(0,i.FD)("p",{children:[u||"Your friend"," would like to give you a free, three-month subscription. ",g]}),(0,i.Y)("p",{children:(0,i.Y)("b",{children:"".concat(p," left")})}),(0,i.FD)(a.Ay,{action:"/api/v1/viral_gifts/accept_gift_from_link",onSuccess:()=>document.location.href="/account/gifts/accept",children:[(0,i.Y)("input",{type:"text",name:"name",placeholder:"Your name",value:y}),(0,i.Y)("input",{type:"email",name:"email",placeholder:"Your email",value:Y}),(0,i.Y)("input",{type:"hidden",value:n,name:"token"}),(0,i.Y)("div",{id:"error-container"}),(0,i.Y)("div",{className:"button-container",children:(0,i.Y)(s.$n,{priority:"primary",type:"submit",children:"Accept Gift"})})]})]})}}},5567:function(e,t,n){n.d(t,{V:()=>p});var i=n(4006),r=n(13950),a=n(2058),l=n(10939),o=n(93800),s=n(6998),c=n(12592),d=n(97778),u=n(56458);let p=e=>{var t,n,p;let{author_id_or_slug:h,authorInfo:m,posts:g,pub:f,user:v,utm:b}=e,{authorInfo:y,posts:Y}=(0,d.Y)({author_id_or_slug:h,authorInfoPreload:m,postsPreload:g,pub:f});return y&&Y?(0,i.Y)(c.c,{children:(0,i.FD)(r.DH,{children:[(0,i.Y)(s.X,{description:null!=(t=y.bio)?t:null,logoUrl:null!=(n=y.photo_url)?n:null,name:null!=(p=y.name)?p:"",pub:f}),(0,i.Y)(l.r,{}),(0,i.Y)(a.M,{authorId:y.user_id,newPosts:Y,pub:f,sort:"new",source:"author-archive",user:v,utm:b,children:e=>{let{posts:t,linkToComments:n,onClickPost:r}=e;return(0,i.Y)(o.m,{hideImages:(0,u.$P)({pub:f}),linkToComments:n,posts:t,variant:"two-column-list",onClickPost:r})}})]})}):null}},57376:function(e,t,n){n.d(t,{m:()=>g});var i=n(4006),r=n(17402),a=n(36233),l=n(91089),o=n(57961),s=n(17028),c=n(57322),d=n(47408),u=n(42120),p=n(72147),h=n(11510),m=n(58278);let g=e=>{let{blurbs:t,freeSignup:n,freeSignupEmail:s,hide_intro_popup:g,notify_user:v,pub:b,referralCode:y,showWelcome:Y,user:_,launchWelcomePage:w,skipIntroPopupRender:C,initialData:k,subpath:S}=e;(0,r.useEffect)(()=>{v&&"undefined"!=typeof window&&(0,a.Ay)(v)},[v]);let I=(0,h.Iu)();if(!b.theme)return null;let F=["subscribers","followers","following"].includes(S),D=b.author_handle||"".concat(b.author_id,"-").concat((0,m.d9)(b.author_name));return(0,i.FD)("div",{className:"home-page home-page--modular",children:[(0,i.Y)(l.PageMetaData,{isHomepage:!0,pub:b}),(0,i.Y)(f,{children:k&&(0,i.FD)(i.FK,{children:[!I&&(0,i.Y)(c.W,{native:!0,requireLogin:null}),!F&&(0,i.Y)("div",{className:"reader-nav-page",children:(0,i.Y)(u.n7,{id:D,initialData:k,subpath:S?"/".concat(S):"/"})}),S&&F&&(0,i.Y)("div",{className:"profile-connections",children:(0,i.Y)(p.X,{id:D,subpath:"/".concat(S)})}),I&&(0,i.Y)(d.w,{})]})}),C?null:(0,i.Y)(o.l,{blurbs:t,freeSignup:n,freeSignupEmail:s,hide_intro_popup:g,launchWelcomePage:w,pub:b,referralCode:y,showWelcome:Y,user:_})]})},f=(0,s.I4)({className:"profile-theme",position:"relative",zIndex:0})},6998:function(e,t,n){n.d(t,{X:()=>u});var i=n(4006),r=n(32485),a=n.n(r),l=n(68410),o=n(76977),s=n(63136),c=n(4016),d=n(39318);let u=e=>{let{description:t,logoUrl:n,name:r,pub:u}=e,{isMobile:p}=(0,l.sM)();return(0,i.FD)(o.I1,{gap:12,paddingX:8*!p,children:[n&&(0,i.Y)("img",{alt:r,className:"logo-Q8LqG3",src:(0,d.dJ9)(n,144)}),(0,i.Y)(s.EY.H1,{className:a()({"pillarHeader-Q57NYM":(0,c.S2)({pub:u})}),color:"pub-primary-text",font:"pub-headings",children:r}),t&&(0,i.Y)(s.EY.B3,{color:"pub-secondary-text",children:t})]})}},79531:function(e,t,n){n.d(t,{S:()=>a,z:()=>l});var i=n(4016),r=n(86898);function a(e){let{breakpoint:t,firstPostMissingImage:n,heroVariant:a,pub:l}=e,o=r.O[a].postCount[t];return n&&["magaziney","magazine-5"].includes(a)&&["desktop","tablet"].includes(t)&&(o+=2),(0,i.S2)({pub:l})&&"magaziney"===a&&(o+="tablet"===t?3:5),(0,i.lu)({pub:l})&&(o=11,"tablet"===t&&(o-=2)),o}function l(e){let{breakpoint:t,firstPostMissingImage:n,heroVariant:i,posts:r,pub:l}=e,o=a({breakpoint:t,firstPostMissingImage:n,heroVariant:i,pub:l});return{effectiveHero:i,numPostsInHero:o,postsForHero:r.slice(0,o)}}},68410:function(e,t,n){n.d(t,{bH:()=>d,oA:()=>u,sM:()=>c});var i=n(17402),r=n(17988),a=n(15734),l=n.n(a),o=n(79531),s=n(98949);let c=()=>{let e,t=(0,s.Fr)(),n=(0,r.useMediaQuery)({query:"only screen and (max-width: 1024px)"}),a=(0,r.useMediaQuery)({query:"only screen and (max-width: 768px)"}),l=(0,r.useMediaQuery)({query:"only screen and (max-width: 1779px)"}),o=(0,r.useMediaQuery)({query:"(orientation: landscape)"});e="undefined"==typeof window?t?"mobile":"desktop":a?"mobile":n?"tablet":"desktop";let c="undefined"==typeof window?!t:!l;return(0,i.useMemo)(()=>({breakpoint:e,isMobile:"mobile"===e,isMobileLandscape:t&&o,isTablet:"tablet"===e,isDesktop:"desktop"===e,isWideScreen:c}),[e,o,t,c])};function d(e){let{preloadedHomepageData:t,isPreview:n}=e,[r,a]=(0,i.useState)(null),o=(0,i.useCallback)(async()=>{a((await l().get("/api/v1/homepage_data").query({preview:n})).body)},[n]);return(0,i.useEffect)(()=>{t||o()},[t,o]),{data:null!=t?t:r,refetch:o}}function u(e){let{homepageData:t,heroVariant:n,pub:r}=e,{breakpoint:a}=c(),l=(0,i.useMemo)(()=>{var e,n,i;let r=new Set((null!=(e=null==t?void 0:t.pinnedPosts)?e:[]).map(e=>e.id));return(null!=(n=null==t?void 0:t.pinnedPosts)?n:[]).concat((null!=(i=null==t?void 0:t.newPosts)?i:[]).filter(e=>!r.has(e.id)))},[null==t?void 0:t.newPosts,null==t?void 0:t.pinnedPosts]),s=(0,i.useMemo)(()=>{var e;let t=!(null==(e=l[0])?void 0:e.cover_image);return(0,o.S)({breakpoint:a,firstPostMissingImage:t,heroVariant:n,pub:r})},[a,n,l,r]),d=l.length>s;return{posts:l,numPostsInHero:s,hasBodyPosts:d}}},7761:function(e,t,n){n.d(t,{WO:()=>o,b$:()=>l});var i=n(4006),r=n(17402);let a=(0,r.createContext)({getPubPinInfo:()=>({showPin:!1}),getSectionPinInfo:()=>({showPin:!1})}),l=()=>(0,r.useContext)(a),o=e=>{let{children:t,pub:n,showPubPins:l,showSectionPins:o}=e,s=(0,r.useCallback)(e=>{var t;let{post:i}=e;return{showPin:l&&!!(null==(t=i.pins)?void 0:t.includes(n.id))}},[n.id,l]),c=(0,r.useCallback)(e=>{let{post:t}=e;return{showPin:o&&t.is_section_pinned}},[o]);return(0,i.Y)(a.Provider,{value:{getPubPinInfo:s,getSectionPinInfo:c},children:t})}},97778:function(e,t,n){n.d(t,{Y:()=>c});var i=n(69277),r=n(70408),a=n(83673),l=n.n(a),o=n(12501),s=n(58278);let c=e=>{var t,n;let{author_id_or_slug:a,authorInfoPreload:c,postsPreload:d,pub:u}=e,p=!!(0,s.ID)({slugOrId:a,pub:(0,r._)((0,i._)({},u),{authorPagesInfo:l()([c])})}),h=(0,o.st)({pathname:"/w/".concat(a,"/info"),auto:!p,initialResult:p&&c&&d?{authorInfo:c,posts:d}:void 0,deps:[a]});return{authorInfo:null==(t=h.result)?void 0:t.authorInfo,posts:null==(n=h.result)?void 0:n.posts}}},19692:function(e,t,n){n.d(t,{A:()=>h});var i=n(99851),r=n(4006),a=n(17402),l=n(15734),o=n.n(l),s=n(34206),c=n(68349),d=n(35369),u=n(16291),p=n(82776);class h extends a.Component{componentDidMount(){this.hasInvites()?this.loadInvites():(0,c.Lm)(this.props.pub)}hasInvites(){let{pub:e,user:t}=this.props;return!!e.invite_only&&(!!t&&!!t.is_contributor||!!(e.subscriber_invites>0)&&!!(t&&t.is_subscribed))}async loadInvites(){try{let e=await o().get("/api/v1/publication/invite");this.setState({invites:e.body,loading:!1})}catch(e){console.error("Failed to fetch invites:",e),alert((0,c.uX)(e))}}render(){var e;let{pub:t,user:n}=this.props,{loading:i,invites:a}=null!=(e=this.state)?e:{};if(!this.hasInvites())return(0,r.Y)("p",{className:"main-loader",children:"Loading…"});let l=n&&n.is_contributor,o=Math.max(n&&n.invites,a.length),c=Math.max(o,t.subscriber_invites),h=c-o;return(0,r.Y)("div",{className:"invite-page page",children:(0,r.FD)("div",{className:"container",children:[(0,r.Y)("h3",{children:"Your invites"}),(0,r.FD)("p",{children:[t.name," is invite-only, but you’ve been granted"," ",l?"an infinite number of invites":(0,p.pluralize)(c,"invite")," to give out."]}),(h>0||l)&&[!l&&(0,r.FD)("h5",{children:["You have ",(0,p.pluralize)(h,"invite")," left"]}),(0,r.FD)(s.Ay,{ref:this.assignForm,action:"/api/v1/publication/invite",onSuccess:this.onSuccess,noInlineErrors:!0,children:[(0,r.FD)("div",{className:"sideBySideWrap",children:[(0,r.Y)("input",{type:"text",name:"name",placeholder:"Name…"}),(0,r.Y)("input",{type:"text",name:"email",placeholder:"Email…"}),(0,r.Y)(d.$n,{priority:"primary",type:"submit",children:"Invite"})]}),(0,r.Y)("div",{id:"error-container"})]})],i&&o>0?(0,r.FD)("p",{children:[(0,r.Y)("br",{}),"Loading…"]}):a.length>0?[(0,r.Y)("h5",{children:"Used invites"}),(0,r.Y)("ul",{children:a.sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime()).map(e=>(0,r.FD)("li",{children:[e.inviteeUser&&e.inviteeUser.name||""," on"," ",(0,u.A)(e.created_at).standardDate()]}))})]:null]})})}constructor(...e){super(...e),(0,i._)(this,"form",void 0),(0,i._)(this,"assignForm",e=>{this.form=e}),(0,i._)(this,"state",{loading:!0,invites:[]}),(0,i._)(this,"onSuccess",async()=>{alert("Invite sent!"),document.location.reload()})}}},20292:function(e,t,n){n.d(t,{A:()=>s});var i=n(4006),r=n(35369),a=n(76977),l=n(63136),o=n(39318);function s(e){let{pub:t,post:n}=e;return(0,i.FD)(a.I1,{alignItems:"center",className:"container",gap:32,children:[(0,i.FD)(a.I1,{alignItems:"center",gap:4,children:[(0,i.Y)(a.I1,{paddingTop:24,paddingBottom:16,children:(0,i.FD)(l.EY.H1,{children:["You rejected your invite to ",t.name]})}),(0,i.Y)(l.EY.B3,{children:"If you change your mind, you can accept from your email invitation."}),n.is_published?(0,i.FD)(l.EY.B3,{children:["Your byline has been removed from this post: ",(0,i.Y)("a",{href:(0,o.wu9)(t,n),children:n.title})]}):null]}),(0,i.Y)(r.$n,{href:t.base_url,children:"Go to ".concat(t.name)})]})}},38248:function(e,t,n){n.d(t,{A:()=>d});var i=n(4006),r=n(17402),a=n(37767),l=n(5109),o=n(35369),s=n(76977),c=n(63136);function d(e){let{pub:t,user:n,post:d,freeSignup:u,freeSignupEmail:p}=e,[h,m]=(0,r.useState)(!1);if(!d)return(0,i.Y)(s.I1,{paddingTop:32,children:(0,i.FD)("div",{className:"container invite-success",children:[(0,i.FD)("p",{children:["You accepted your invite to ",t.name,"."]}),(0,i.Y)("p",{children:"If you need admin access, ask your inviter to change your status in the publication settings."}),(0,i.FD)("p",{children:["If you expect to be shown on this publication's author list, make sure your"," ",(0,i.Y)(a.A,{onClick:()=>m(!0),children:"profile is up to date"})]}),(0,i.Y)(l.QL,{isOpen:h,onClose:()=>m(!1),user:n,freeSignup:u,freeSignupEmail:p,needsPhoto:!0})]})});let g="podcast"===d.type?"We’ll let you know when the podcast episode goes live":"We’ll let you know when your guest post is live";return(0,i.FD)(s.I1,{alignItems:"center",className:"container",gap:32,children:[(0,i.FD)(s.I1,{alignItems:"center",gap:4,children:[(0,i.Y)(s.I1,{paddingTop:24,paddingBottom:16,children:(0,i.Y)(c.EY.H1,{children:g})}),(0,i.Y)(c.EY.B3,{children:"Your profile is set up and good to go!"})]}),(0,i.Y)(o.$n,{href:t.base_url,children:"Go to ".concat(t.name)})]})}},39352:function(e,t,n){n.d(t,{Z:()=>q});var i=n(79785),r=n(4006),a=n(32485),l=n.n(a),o=n(80697),s=n(93893),c=n(17402),d=n(15734),u=n.n(d),p=n(27437),h=n(17436),m=n(86224),g=n(69277),f=n(70408),v=n(97731);let b=e=>(0,r.Y)(v.A,(0,f._)((0,g._)({},e),{name:"TwitterIcon",svgParams:{height:24,width:24},children:(0,r.Y)("path",{d:"M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"})}));var y=n(41181),Y=n(84605),_=n(76977),w=n(63136);n(37764);function C(){let e=(0,i._)(["You're here!"]);return C=function(){return e},e}let k=e=>{let{isSelected:t,tier:n}=e,{iString:i,iTemplate:a,iPlural:l}=(0,Y.GO)(),o={comp_one_month:i("1 month comp"),comp_three_months:i("3 month comp"),comp_six_months:i("6 month comp"),comp_nine_months:i("9 month comp"),comp_twelve_months:i("12 month comp"),custom:i("Custom")};return(0,r.FD)(_.I1,{className:"rewardBox-wSCnji",border:"detail-themed",radius:"md",justifyContent:"space-between",alignItems:"center",flex:"grow",paddingTop:{desktop:20,mobile:20},paddingBottom:{desktop:8,mobile:8},paddingX:{desktop:8,mobile:8},sizing:"border-box",style:{borderColor:t?"var(--color-accent-themed)":void 0},children:[(0,r.Y)(_.Ye,{gap:4,alignItems:"center",children:Array(n.display_order).fill(0).map(()=>(0,r.Y)(y.A,{size:20,fill:"var(--color-accent-themed)",stroke:"var(--color-accent-themed)"}))}),(0,r.Y)(w.EY.H4,{weight:"bold",font:"pub-headings",color:"pub-primary-text",textAlign:"center",textWrap:"balance",children:"custom"===n.reward_type?n.reward_description:o[n.reward_type]}),(0,r.Y)(w.EY.Meta,{weight:"semibold",style:{color:t?"var(--color-accent-themed)":void 0},children:t?a(C()):l("1 Referral","%1 Referrals",n.num_referrals_required)})]})};var S=n(86500),I=n(1683),F=n(12501),D=n(95641),T=n(68349),A=n(24078),E=n(89490),N=n(35369),P=n(45064),x=n(81203),L=n(36372),O=n(39318),B=n(41086),M=n(49807),R=n(57324);let U={wrapper:"wrapper-tJi0TK",headerWrapper:"headerWrapper-EjRfuK",shareButton:"shareButton-JVF5KK",referrerRow:"referrerRow-N5KSEa",referrerRowInverted:"referrerRowInverted-CeLqXo",referrerLink:"referrerLink-nE7Cs1",responsiveHeader:"responsiveHeader-yuaZkv",shareButtons:"shareButtons-xB8IiL"};function j(){let e=(0,i._)(["You’ve qualified for the Tier "," reward."]);return j=function(){return e},e}function z(){let e=(0,i._)(["Refer friends to ",""]);return z=function(){return e},e}function H(){let e=(0,i._)(["Subscribe and invite friends to ",""]);return H=function(){return e},e}function W(){let e=(0,i._)(["No referrers yet. Be the first on ","'s leaderboard by helping them find new readers."]);return W=function(){return e},e}let V=(e,t)=>{(0,S.u4)(S.qY.SHARE_LINK_CLICKED,{name:t,source:"leaderboard"}),e&&(e.startsWith("http")?window.open(e,"_blank"):document.location.href=e)},K=e=>{let{user:t,rank:n,referrals:i,isSelf:a,isHighlighted:o}=e,{iString:s}=(0,Y.GO)();return(0,r.Y)(w.EY,{as:t?"a":"div",href:t?(0,M.rfn)(t.id,t.name):void 0,className:U.referrerLink,children:(0,r.FD)(_.Ye,{sizing:"border-box",style:{width:"100%"},alignItems:"center",border:a||o?"detail-themed":"transparent",radius:"md",paddingLeft:12,paddingY:a?16:8,paddingRight:20,justifyContent:"space-between",className:l()(U.referrerRow,{[U.referrerRowInverted]:!a}),children:[(0,r.FD)(_.Ye,{gap:8,alignItems:"center",children:[(0,r.FD)(w.EY.Digit,{weight:"semibold",paddingRight:4,color:"pub-primary-text",children:[n,"."]}),t?(0,r.Y)(p.ProfileHoverCard,{subject:t,trigger:(0,r.Y)(A.eu,{size:36,user:t})}):(0,r.Y)(A.eu,{size:36}),(0,r.Y)(w.EY.B4,{color:"pub-primary-text",weight:"semibold",children:(null==t?void 0:t.name)||s("Anonymous Reader")})]}),(0,r.Y)(w.EY.B4,{color:"pub-primary-text",weight:"semibold",children:i})]})})},q=e=>{let t,n,{pub:i,user:a,freeSignupEmail:l}=e,{iString:d,iTemplate:p,iPlural:g}=(0,Y.GO)(),f=(0,L.d)(),{result:v,isLoading:y,refetch:C}=(0,F.st)({pathname:"/api/v1/reader_referrals/leaderboard",auto:!0}),{refetch:A}=(0,D.E)({auto:!1,pathname:"/api/v1/subscription/visibilities",method:"post"});if((0,c.useEffect)(()=>{y||v||(0,T.V2)((0,M.$_T)(i))},[v,y,i]),y||!v)return(0,r.Y)("div",{className:"page typography signup-page",children:(0,r.Y)("div",{className:"container"})});let{current_user_stats:q,tiers:G,top_referrers:J,current_user_can_share:$,current_user_id:Z,current_user_profile_hidden:Q}=v,X=null==a?void 0:a.is_admin,ee=null==a?void 0:a.is_contributor,et=(0,B.y)("referrer_token"),en=a&&!a.is_magic&&a.email||l||null,ei=(0,M.yRP)((0,M.$_T)(i),{r:(null==Z?void 0:Z.toString(36))||et});G.find((e,i)=>{let r=(null==q?void 0:q.referrals)||0,a=G[i+1];r>=e.num_referrals_required&&(!a||r<a.num_referrals_required)&&(t=e,n=a)});let er="";return!t&&q?er="".concat(g("You have %1 referral","You have %1 referrals",q.referrals)," - ").concat(g("only %1 more referral to earn your first reward!","only %1 more referrals to earn your first reward!",G[0].num_referrals_required-q.referrals)):t&&n&&q?er="".concat(g("You’ve referred %1 reader!","You’ve referred %1 readers!",q.referrals)," ").concat(p(j(),t.display_order)," ").concat(g("Invite %1 more reader to earn the Tier %2 reward!","Invite %1 more readers to earn the Tier %2 reward!",n.num_referrals_required-q.referrals,n.display_order)):t&&!n&&q&&(er="".concat(g("You’ve referred %1 reader!","You’ve referred %1 readers!",q.referrals)," You’re number #").concat(q.rank," on the leaderboard.")),(0,r.Y)("div",{className:"page typography signup-page",children:(0,r.Y)("div",{className:"container",children:(0,r.FD)(_.I1,{gap:64,className:U.wrapper,children:[(X||ee)&&(0,r.FD)(_.I1,{border:"detail-themed",gap:16,paddingX:24,paddingY:16,radius:"md",children:[(0,r.FD)(_.I1,{gap:4,children:[(0,r.Y)(w.EY.Meta,{color:"pub-primary-text",children:X?"Admin View":"Contributor View"}),(0,r.Y)(w.EY.B4,{color:"pub-secondary-text",children:d(X?"A view of your leaderboard as it appears to your subscribers. Note: As an admin your referrals will not appear on the leaderboard.":"A view of your leaderboard as it appears to your subscribers. Note: As a contributor your referrals will not appear on the leaderboard.")})]}),X&&(0,r.Y)(N.$n,{priority:"secondary",href:"/publish/settings#referrals",localNavigation:!1,children:d("Edit Referral Settings")})]}),(0,r.Y)(_.I1,{alignItems:"center",children:(0,r.FD)(_.I1,{gap:24,className:U.headerWrapper,alignItems:"center",children:[(0,r.Y)(E.az,{children:(0,r.Y)(x.Nq,{pub:i,size:64})}),(0,r.FD)(_.I1,{alignItems:"center",gap:4,children:[(0,r.Y)(w.EY,{className:U.responsiveHeader,font:"pub-headings",color:"pub-primary-text",align:"center",children:p($||et?z():H(),i.name)}),(0,r.FD)(w.EY.B3,{translated:!0,color:"pub-secondary-text",align:"center",className:U.introText,children:["Show your support by sharing ",I18N.p(i.name)," and earn rewards for your referrals."]})]}),!$&&!et&&!(ee||X)&&(0,r.Y)(_.I1,{style:{width:"100%"},children:(0,r.Y)(N.$n,{flex:"grow",priority:"primary",onClick:async e=>{let t;e.preventDefault();try{if(en){let e=await u().post("/api/v1/free").send({source:"referral-leaderboard",email:en,first_url:I.R9,first_referrer:I.b7,current_url:I.AT,current_referrer:I.uC,first_session_url:I.K0,first_session_referrer:I.OG});t=e.body.referral_token,(0,S.$5)(e.body.requires_confirmation)}}catch(e){(0,S.u4)(S.qY.FREE_SIGNUP_FAILED,{reason:e.message,source:"referral-leaderboard"})}window.location.href=(0,M.eV6)(i,{addBase:!0,params:{simple:!0,next:document.location.href,utm_source:R.VU.referralLeaderboard,utm_medium:R.Jn.web,skip_redirect_check:!0,just_signed_up:!0,referral_token:t}})},href:(0,M.yRP)("/subscribe",{next:(0,M.tLs)(i,void 0,{addBase:!0}),utm_source:R.VU.referralLeaderboard}),localNavigation:!1,children:(0,r.FD)(_.Ye,{alignItems:"center",gap:8,children:[(0,r.Y)(o.A,{size:20}),d("Subscribe")]})})})]})}),($||ee||X||et)&&(0,r.FD)(_.I1,{alignItems:"center",gap:16,style:{width:"100%"},children:[(0,r.Y)(_.Ye,{style:{width:"100%"},children:(0,r.Y)(P.c,{value:ei})}),(0,r.FD)(_.pT,{className:U.shareButtons,gap:{desktop:16,mobile:8},style:{width:"100%"},children:[(0,r.Y)(N.$n,{className:U.shareButton,priority:"secondary",leading:(0,r.Y)(b,{width:18,height:18,style:{paddingTop:2}}),onClick:()=>V((0,O.gKg)({url:ei,text:i.name}),"twitter"),children:"Twitter"}),(0,r.Y)(N.$n,{className:U.shareButton,priority:"secondary",leading:(0,r.Y)(m.A,{height:20,width:20}),onClick:()=>V((0,M.yRP)("https://www.facebook.com/sharer/sharer.php",{u:ei}),"facebook"),children:"Facebook"}),(0,r.Y)(N.$n,{className:U.shareButton,priority:"secondary",leading:(0,r.Y)(h.A,{strokeWidth:1,height:20,width:20,style:{paddingTop:2}}),onClick:()=>V((0,M.yRP)("mailto:",{subject:i.name,body:ei}),"email"),children:"Email"})]})]}),(0,r.FD)(_.I1,{alignItems:"start",style:{width:"100%"},gap:16,children:[(0,r.Y)(w.EY.H3,{translated:!0,font:"pub-headings",color:"pub-primary-text",children:"Rewards and Progress"}),(0,r.Y)(_.Ye,{gap:{desktop:16,mobile:12},style:{width:"100%"},children:G.map(e=>(0,r.Y)(k,{tier:e,isSelected:e.display_order===(null==t?void 0:t.display_order)},e.display_order))}),$&&q&&(0,r.FD)(_.I1,{gap:8,style:{width:"100%"},alignItems:"center",children:[(0,r.Y)(K,{user:a,isSelf:!0,referrals:q.referrals,rank:q.rank}),!Q&&(0,r.Y)(w.EY.B4,{color:"pub-secondary-text",children:er}),Q&&(0,r.FD)(_.Ye,{sizing:"border-box",style:{width:"100%"},alignItems:"center",border:"detail-themed",radius:"md",paddingX:12,paddingY:16,justifyContent:"space-between",bg:"secondary",gap:32,children:[(0,r.FD)(_.I1,{gap:4,children:[(0,r.Y)(w.EY.B4,{translated:!0,weight:"semibold",color:"pub-primary-text",children:"Your subscription is private"}),(0,r.FD)(w.EY.B4,{translated:!0,color:"pub-secondary-text",children:["To appear on the leaderboard, turn on visibility for ",I18N.p(i.name)]})]}),(0,r.Y)(N.$n,{priority:"primary",onClick:async()=>{await A({body:{ids:[v.current_user_subscription_id],visibility:"public"}}),C(),f.popToast(()=>(0,r.Y)(L.y,{text:"".concat(i.name," is now visible on your profile!")}))},children:d("Show on profile")})]})]})]}),(0,r.FD)(_.I1,{alignItems:"start",style:{width:"100%"},gap:16,children:[(0,r.Y)(w.EY.H3,{translated:!0,font:"pub-headings",color:"pub-primary-text",children:"Leaderboard"}),(null==J?void 0:J.length)===0&&(0,r.FD)(_.I1,{alignItems:"center",justifyContent:"center",paddingX:48,sizing:"border-box",style:{width:"100%",minHeight:350},gap:4,border:"detail-themed",radius:"md",children:[(0,r.Y)(s.A,{size:22,stroke:"var(--color-fg-secondary-themed)"}),(0,r.Y)(w.EY.B4,{color:"pub-secondary-text",children:p(W(),i.name)})]}),(null==J?void 0:J.length)>0&&(0,r.FD)(_.I1,{gap:8,style:{width:"100%"},children:[(0,r.FD)(_.Ye,{alignItems:"center",style:{width:"100%"},justifyContent:"space-between",paddingBottom:2,children:[(0,r.Y)(w.EY.Meta,{translated:!0,weight:"semibold",children:"Referrer"}),(0,r.Y)(w.EY.Meta,{translated:!0,weight:"semibold",children:"Referrals"})]}),null==J?void 0:J.map(e=>(0,r.Y)(K,{user:e.user,isHighlighted:e.isCurrentUser,rank:e.rank,referrals:e.referrals},e.rank))]})]})]})})})}},83704:function(e,t,n){n.d(t,{J:()=>d});var i=n(4006),r=n(48697),a=n(68349),l=n(35369),o=n(39318),s=n(41086),c=n(62227);let d=e=>{let{pub:t}=e;return(0,i.Y)(l.K0,{onClick:()=>{let e=(0,s.y)("referrer"),n=null!=e?e:(0,o.fOI)(t);(0,a.V2)(n,{local_navigation:!1})},className:c.A.closeButton,size:"sm",priority:"secondary-outline",children:(0,i.Y)(r.A,{size:20})})}},20771:function(e,t,n){n.d(t,{H:()=>c});var i=n(4006),r=n(13022),a=n(24078),l=n(76977),o=n(81203),s=n(62227);let c=e=>{let{pub:t,user_id:n,user_profile_photo_url:c,children:d}=e;return(0,r.y0)("meetings_embed_publication_name")?(0,i.FD)(l.I1,{gap:20,alignItems:"center",paddingTop:32,children:[(0,i.Y)(o.Nq,{className:s.A.pubLogo,pub:t,size:112}),d]}):(0,i.FD)(l.I1,{gap:20,alignItems:"center",paddingTop:32,children:[(0,i.FD)("div",{className:s.A.avatarWithPubLogo,children:[(0,i.Y)(a.eu,{className:s.A.avatar,user:{id:n,photo_url:c},size:112}),(t.logo_url||t.cover_photo_url)&&(0,i.Y)(o.Nq,{className:s.A.pubAvatar,pub:t,size:40})]}),d]})}},33107:function(e,t,n){n.d(t,{p:()=>V});var i=n(69277),r=n(32641),a=n(4006),l=n(17402),o=n(13022),s=n(68349),c=n(20771),d=n(82853),u=n(35404),p=n(35369),h=n(76977),m=n(63136),g=n(36372),f=n(16291),v=n(49807),b=n(82776);let y={meetingDetails:"meetingDetails-vrQSc_"},Y=e=>{var t,n,i,r,l,o,c,f,y,Y,_,w,C,k,S,I,F,D,T,A,E,N,P,x,L,O,B,M,R,U,j,z,H,W,V,K;let{order:q,isStatic:G=!1,pub:J=null}=e,$=(0,g.d)(),{href:Z,label:Q,copyContent:X}=(t=q,n=G,i=J,(null==(r=t.location)?void 0:r.location)||(null==(l=t.location)?void 0:l.join_url)?({zoom:{href:null==(o=t.location)?void 0:o.join_url,copyContent:null==(c=t.location)?void 0:c.join_url,label:"Join Zoom"},zoom_conference:{href:null==(f=t.location)?void 0:f.join_url,copyContent:null==(y=t.location)?void 0:y.join_url,label:"Join Zoom"},google:{href:null==(Y=t.location)?void 0:Y.join_url,copyContent:null==(_=t.location)?void 0:_.join_url,label:"Join Meet"},google_conference:{href:null==(w=t.location)?void 0:w.join_url,copyContent:null==(C=t.location)?void 0:C.join_url,label:"Join Meet"},inbound_call:{href:"tel:".concat(null==(k=t.location)?void 0:k.location),copyContent:null==(S=t.location)?void 0:S.location,label:null==(I=t.location)?void 0:I.location},outbound_call:{href:null,label:"".concat((0,b.guessFirstName)(t.user_name)," will call you at ").concat(null==(F=t.location)?void 0:F.location)},microsoft_teams:{href:null==(D=t.location)?void 0:D.join_url,copyContent:null==(T=t.location)?void 0:T.join_url,label:"Join Teams"},microsoft_teams_conference:{href:null==(A=t.location)?void 0:A.join_url,copyContent:null==(E=t.location)?void 0:E.join_url,label:"Join Teams"},webex:{href:null==(N=t.location)?void 0:N.join_url,copyContent:null==(P=t.location)?void 0:P.join_url,label:"Join Webex"},webex_conference:{href:null==(x=t.location)?void 0:x.join_url,copyContent:null==(L=t.location)?void 0:L.join_url,label:"Join Webex"},gotomeeting:{href:null==(O=t.location)?void 0:O.join_url,copyContent:null==(B=t.location)?void 0:B.join_url,label:"Join GoToMeeting"},gotomeeting_conference:{href:null==(M=t.location)?void 0:M.join_url,copyContent:null==(R=t.location)?void 0:R.join_url,label:"Join GoToMeeting"},physical:{href:null,label:null!=(W=null==(U=t.location)?void 0:U.location)?W:"Unknown"},ask_invitee:{href:null,label:null!=(V=null==(j=t.location)?void 0:j.location)?V:"Unknown"},custom:{href:null,label:null!=(K=null==(z=t.location)?void 0:z.location)?K:"Unknown"}})[null==(H=t.location)?void 0:H.type]||{}:n&&i?{href:(0,v.vrI)(i,t.id,{addBase:!0}),label:"View here"}:{href:null,label:"Processing..."}),ee=(0,a.Y)(m.EY.B3,{align:"right",children:Z?(0,a.Y)("a",{href:Z,children:Q}):Q});return G||!X?ee:(0,a.FD)(h.Ye,{gap:4,alignItems:"center",children:[ee,(0,a.Y)(p.K0,{size:"sm",onClick:()=>{(0,s.lW)(X),$.popToast(()=>(0,a.Y)(g.y,{Icon:d.A,text:"Copied link to clipboard"}))},children:(0,a.Y)(u.A,{height:20})})]})},_=e=>{var t,n;let{order:i,pub:r}=e,l=(0,f.A)(null!=(t=i.start_time)?t:void 0),o=(0,f.A)(null!=(n=i.end_time)?n:void 0),s="".concat(l.format("MMMM D, YYYY")," at ").concat(l.format("h:mm A z")),c=o.diff(l,"minute");return(0,a.FD)(h.I1,{gap:8,className:y.meetingDetails,children:[(0,a.FD)(h.Ye,{justifyContent:"space-between",gap:8,children:[(0,a.Y)(m.EY.B3,{weight:"bold",children:"Time"}),(0,a.Y)(m.EY.B3,{children:s})]}),(0,a.FD)(h.Ye,{justifyContent:"space-between",gap:8,children:[(0,a.Y)(m.EY.B3,{weight:"bold",children:"Length"}),(0,a.FD)(m.EY.B3,{children:[c," minutes"]})]}),(0,a.FD)(h.Ye,{justifyContent:"space-between",alignItems:"center",gap:8,children:[(0,a.Y)(m.EY.B3,{weight:"bold",children:"Location"}),(0,a.Y)(Y,{order:i,pub:r})]}),(0,a.Y)(m.EY.B3,{align:"center",className:y.description,paddingTop:16,children:(0,a.Y)("i",{children:i.description})})]})};var w=n(39318),C=n(41086);let k=e=>{let{booking:t,settings:n,pub:i}=e,r=(0,o.y0)("meetings_embed_publication_name")?i.name:t.user_name;return t.cancelled_at?(0,a.FD)(a.FK,{children:[(0,a.Y)(c.H,{pub:i,user_id:n.user_id,user_profile_photo_url:n.user_profile_photo_url,children:(0,a.FD)(m.EY.H2,{align:"center",children:["Your meeting with ",r," has been cancelled"]})}),t.cancellation_reason&&(0,a.FD)(a.FK,{children:[(0,a.Y)(m.EY.B3,{align:"center",paddingBottom:16,children:"The author provided the following reason:"}),(0,a.Y)(m.EY.B4,{align:"center",paddingBottom:32,children:t.cancellation_reason})]}),t.refunded_at&&(0,a.Y)(m.EY.B3,{align:"center",children:"A refund has been issued to your original form of payment."}),n.enabled&&(0,a.Y)(m.EY.B3,{align:"center",paddingBottom:16,children:(0,a.FD)(a.FK,{children:["You can book another meeting"," ",(0,a.Y)("a",{href:(0,v.SJN)(i,{params:{source:"cancellation-rebook"}}),children:"here"}),"."]})})]}):(0,a.FD)(a.FK,{children:[(0,a.Y)(c.H,{pub:i,user_id:n.user_id,user_profile_photo_url:n.user_profile_photo_url,children:(0,a.FD)(m.EY.H2,{align:"center",children:["Your meeting with ",r," has been ",t.num_rebookings>0?"rebooked":"booked"]})}),(0,a.FD)(h.I1,{gap:16,alignItems:"center",children:[(0,a.Y)(_,{order:t,pub:i}),(0,a.Y)(m.EY.B4,{align:"center",children:"A confirmation of your booking has been emailed to you."}),t.refunded_at&&(0,a.Y)(m.EY.B4,{align:"center",children:"A refund has been issued to your original form of payment."}),(0,a.Y)(p.$n,{onClick:()=>{let e=(0,C.y)("referrer"),t=null!=e?e:(0,w.fOI)(i);(0,s.V2)(t,{local_navigation:!1})},children:"Done"})]})]})};var S=n(44383),I=n.n(S),F=n(48697),D=n(15734),T=n.n(D),A=n(34206),E=n(15809),N=n(86500),P=n(58326),x=n(11587),L=n(65842),O=n(66511),B=n(72879),M=n(18189);let R=e=>{let{stripe_publishable_key:t,onComplete:n,user:i,pub:r,booking:s,settings:d}=e,[u,g]=(0,l.useState)(s.name),[f,v]=(0,l.useState)(s.description),[y,Y]=(0,l.useState)(null),[_,w]=(0,l.useState)(null),[C,k]=(0,l.useState)(null),[S,D]=(0,l.useState)(null),[R,U]=(0,l.useState)(!1),[j,z]=(0,l.useState)(null);(0,l.useEffect)(()=>{let e=(0,A.YV)(t,r),n=e&&(0,A.Me)(e);w(e),k(n)},[r,t,w,k]),(0,l.useEffect)(()=>{(0,N.u4)(M.q.MEETING_ORDER_PAGE_VIEWED,{user_id:i.id,publication_id:r.id})},[]),(0,l.useEffect)(()=>{(async()=>{var e;let t=await T().get("/api/v1/subscription/last4");(null==(e=t.body)?void 0:e.last4)&&D(t.body.last4)})()},[r]);let{price:H,duration:W,subscriber_price:V,founding_price:K,currency:q}=d.selected_event_type,G=H;i.is_subscribed&&V&&(G=V),i.is_founding&&K&&(G=K);let J=!!(null==i?void 0:i.has_saved_payment),$=(0,l.useCallback)(async()=>C?_?await _.createToken(C):{token:null,error:{message:""}}:(console.error("stripeCard is null, cannot createToken"),{token:null,error:{message:"Internal error"}}),[_,C]),Z=(0,l.useCallback)(async()=>{let e;if(U(!0),z(null),!J){let{token:t,error:n}=await $();if(n){U(!1),z(n&&n.message),(0,N.u4)(M.q.MEETING_MISSING_PAYMENT,{type:n&&"type"in n&&n.type,code:n&&"code"in n&&n.code,decline_code:n&&"decline_code"in n&&n.decline_code,reason:n&&n.message});return}e=t}let t=new FormData;t.append("name",u),t.append("description",f),e&&t.append("stripe_token",JSON.stringify(e)),y&&t.append("attachment",y);let a=Intl.DateTimeFormat().resolvedOptions().timeZone;a&&t.append("timezone",a),(0,N.u4)(M.q.MEETING_SUBMIT_PRESSED,{publication_id:r.id,user_id:i.id});try{let e=await T().post("/api/v1/meetings/book").send(t);history.pushState({},"","/meetings/book/".concat(e.body.order_id)),n("schedule",I()(e.body,["order_id","calendly_scheduling_uri","name","email","description"]))}catch(e){var l,o,s,c;(null==(o=e.response)||null==(l=o.body)?void 0:l.error)?z(null==(c=e.response)||null==(s=c.body)?void 0:s.error):z("Something went wrong.")}U(!1)},[u,f,$,y,U,z]),Q=!!u&&!!f;return(0,a.FD)(a.FK,{children:[(0,a.Y)(c.H,{pub:r,user_id:d.user_id,user_profile_photo_url:d.user_profile_photo_url,children:(0,a.FD)("div",{children:[(0,a.Y)(m.EY.H2,{align:"center",size:20,children:"Book a meeting with"}),(0,a.Y)(m.EY.H2,{align:"center",paddingTop:4,children:(0,o.y0)("meetings_embed_publication_name")?r.name:d.user_name}),(0,a.FD)(m.EY.B3,{align:"center",paddingTop:8,children:[G<H&&(0,a.Y)("span",{className:"originalPrice-OtRI61",children:(0,b.centsToPriceString)(H,q)}),(0,b.centsToPriceString)(G,q)," \xb7 ",W,"-minute meeting"]})]})}),(0,a.FD)(h.I1,{gap:32,children:[(0,a.Y)(B.M,{alignment:"vertical",label:"Your name",children:(0,a.Y)(L.ks,{name:"name",value:u||"",onChange:e=>g(e.currentTarget.value),placeholder:"Name...",disabled:R,maxLength:500})}),(0,a.Y)(B.M,{alignment:"vertical",label:"What do you want to talk about?",children:(0,a.Y)(x.T,{name:"description",value:f,onChange:e=>v(e.currentTarget.value),rows:4,maxLength:1e3,placeholder:"E.g. I’m really interested in knowing...",disabled:R})}),y?(0,a.FD)("div",{children:[(0,a.Y)(m.EY.B4,{weight:"semibold",paddingBottom:8,children:"Add an attachment (optional)"}),(0,a.FD)(h.Ye,{className:"fileAttachment-fKUmWJ",gap:8,alignItems:"center",flex:"auto",children:[(0,a.Y)(F.A,{onClick:()=>Y(null),className:"fileRemoveIcon-fRmA6k",height:24}),(0,a.Y)(m.EY.B3,{className:"fileName-yGqqsU",children:y.name})]})]}):(0,a.FD)("div",{children:[(0,a.Y)(m.EY.B4,{weight:"semibold",paddingBottom:8,children:"Add an attachment (optional)"}),(0,a.Y)(P.N,{className:"filePicker-sGpV6W",onFileSelected:e=>Y(e),acceptableTypes:".doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/pdf, image/*, audio/*, video/*, .pdf, .xls, .xlsx"})]}),(0,a.FD)("div",{className:"checkoutBox-B3gOs5",children:[J&&(0,a.FD)(h.Ye,{className:"savedCard-bAi8SY",padding:12,gap:12,children:[(0,a.Y)(E.A,{className:"cardOnFileIcon-CDsU3Y"}),(0,a.Y)(m.EY.B4,{children:S?"**** **** **** ".concat(S):"Use card on file"})]}),!J&&C&&(0,a.Y)(A.Oo,{className:"input-FRaHpS",element:C}),j&&(0,a.Y)(m.EY.B4,{paddingTop:12,className:"errorContainer-TdnCG0",children:j}),(0,a.Y)(h.pT,{paddingTop:12,children:(0,a.Y)(O.m_,{text:d.enabled?"You must provide your name and a topic for the meeting before booking.":"You must enable Meetings before one can be booked.",disabled:R||Q&&d.enabled,children:(0,a.Y)(p.$n,{className:"button-qJPITd",flex:"grow",type:"submit",onClick:Z,disabled:R||!Q||!d.enabled,children:R?"Loading...":"Book meeting"})})})]})]}),(0,a.FD)(m.EY,{className:"tos-KUjQ2h",paddingBottom:16,size:14,align:"center",color:"secondary",children:["By booking, you will be automatically signed up for a free subscription to ",r.name,". Additionally, you agree to Substack's"," ",(0,a.Y)("a",{href:"https://substack.com/tos",target:"__blank",children:"Terms of Service"}),", our"," ",(0,a.Y)("a",{href:"https://substack.com/privacy",target:"__blank",children:"Privacy Policy"}),", and our"," ",(0,a.Y)("a",{href:"https://substack.com/ccpa#personal-data-collected",target:"__blank",children:"Information Collection Notice"}),"."]})]})};var U=n(64154),j=n(17988),z=n(57820);let H=e=>{let{booking:t,onComplete:n,settings:i,pub:r}=e,[s,d]=(0,l.useState)(!1),[u,p]=(0,l.useState)(!1),{duration:g}=i.selected_event_type,f=(0,o.y0)("meetings_embed_publication_name")?r.name:t.user_name,v=(0,j.useMediaQuery)({maxWidth:698});return((0,U.yl)({onEventScheduled:async e=>{var i,r,a;let l=null==(a=e.data)||null==(r=a.payload)||null==(i=r.event)?void 0:i.uri;d(!0);try{let e=await T().put("/api/v1/meetings/order/".concat(t.order_id)).send({calendly_event_uri:l});await new Promise(e=>setTimeout(e,2e3)),n("confirmation",e.body)}catch(e){p(!0)}}}),u)?(0,a.Y)(c.H,{pub:r,user_id:i.user_id,user_profile_photo_url:i.user_profile_photo_url,children:(0,a.Y)(m.EY.H2,{align:"center",children:"Something went wrong with your booking. Please contact meetings@substackinc.com."})}):s?(0,a.Y)(h.pT,{justifyContent:"center",children:(0,a.Y)(z.y$,{})}):(0,a.FD)(a.FK,{children:[(0,a.Y)(c.H,{pub:r,user_id:i.user_id,user_profile_photo_url:i.user_profile_photo_url,children:(0,a.FD)("div",{children:[(0,a.FD)(m.EY.H2,{align:"center",children:[t.num_rebookings>0?"Rebook":"Book"," your meeting with ",f]}),(0,a.FD)(m.EY.B3,{align:"center",paddingTop:8,children:["Schedule your ",g,"-minute meeting"]})]})}),"undefined"!=typeof window&&t.calendly_scheduling_uri&&(0,a.Y)(U.Cs,{iframeTitle:"calendly",url:"".concat(t.calendly_scheduling_uri,"?hide_gdpr_banner=1"),prefill:{name:t.name||"",email:t.email,customAnswers:{a1:t.description}},styles:{minWidth:"320px",height:"700px",marginTop:v?"0px":"-66px"}})]})};var W=n(83704);let V=e=>{let{stripe_publishable_key:t,pub:n,user:o,order:s,order_id:c,settings:d}=e,u=c?s.calendly_scheduling_uri?"schedule":"confirmation":"order",[p,m]=(0,l.useState)(u),[g,f]=(0,l.useState)((0,i._)({name:o.name,email:o.email,description:""},s)),v=(e=>{var{step:t}=e,n=(0,r._)(e,["step"]);switch(t){case"order":return(0,a.Y)(R,(0,i._)({},n));case"schedule":return(0,a.Y)(H,(0,i._)({},n));case"confirmation":return(0,a.Y)(k,(0,i._)({},n))}})({step:p,booking:g,settings:d,order:s,onComplete:(e,t)=>{f((0,i._)({},g,t)),m(e)},pub:n,stripe_publishable_key:t,user:o,orderId:c});return(0,a.FD)(a.FK,{children:[(0,a.Y)(W.J,{pub:n}),(0,a.Y)(h.pT,{style:{minHeight:"var(--full-height)"},bg:"secondary",alignItems:"center",justifyContent:"center",children:(0,a.Y)(h.I1,{paddingX:24,gap:32,style:{width:"schedule"===p?"100%":450,maxWidth:"100%",boxSizing:"border-box"},children:v})})]})}},62724:function(e,t,n){n.d(t,{V:()=>_});var i=n(4006),r=n(32485),a=n.n(r),l=n(57423),o=n(68309),s=n(17402),c=n(86500),d=n(13022),u=n(83704),p=n(20771),h=n(35369),m=n(76977),g=n(63136),f=n(56458),v=n(39318),b=n(41086),y=n(82776),Y=n(62227);let _=e=>{var t,n,r,_;let{pub:w,user:C,settings:k}=e,{selected_event_type:{price:S,subscriber_price:I,founding_price:F,currency:D,description_html:T,duration:A,num_availabilities:E},user_name:N}=k,P=S,x=null;null!=(n=null==(t=w.plans)?void 0:t.length)&&n&&((null==C?void 0:C.is_subscribed)&&I&&(P=I,x="SUBSCRIBER DISCOUNT"),(null==C?void 0:C.is_founding)&&F&&(P=F,x="".concat(null==(r=(0,f.m4)(w)||"FOUNDING")?void 0:r.toUpperCase()," DISCOUNT"))),(0,s.useEffect)(()=>{var e,t;(0,c.u4)(c.qY.MEETING_PAGE_VIEWED,{publication_id:w.id,user_id:C.id,referrer:null!=(e=(0,b.y)("referrer"))?e:null,source:null!=(t=(0,b.y)("source"))?t:null})},[]);let L=null!=(_=(0,b.y)("referrer"))?_:void 0,O=(0,v.oRR)("/meetings/book",{referrer:L}),B=E>0,M=T?{__html:T.replace(/<br>/g,"")}:{__html:""};return(0,i.FD)(i.FK,{children:[(0,i.Y)(u.J,{pub:w}),(0,i.Y)(m.I1,{style:{minHeight:"var(--full-height)"},bg:"secondary",alignItems:"center",justifyContent:"center",children:(0,i.FD)(m.I1,{paddingX:24,gap:32,style:{width:400,maxWidth:"100%",boxSizing:"border-box"},children:[(0,i.Y)(p.H,{pub:w,user_id:k.user_id,user_profile_photo_url:k.user_profile_photo_url,children:(0,i.FD)("div",{children:[(0,i.Y)(g.EY.H2,{align:"center",size:20,children:"Book a meeting with"}),(0,i.Y)(g.EY.H2,{align:"center",paddingTop:4,children:(0,d.y0)("meetings_embed_publication_name")?w.name:N})]})}),(0,i.FD)(m.I1,{bg:"primary",className:a()(Y.A.offer,{[Y.A.unavailable]:!B}),radius:"md",shadow:"xl",padding:20,children:[x&&(0,i.Y)("div",{className:Y.A.displayedBadge,children:x}),(0,i.FD)(m.Ye,{justifyContent:"space-between",paddingBottom:16,children:[(0,i.Y)(m.I1,{children:P&&D&&A&&(0,i.FD)(i.FK,{children:[(0,i.FD)(g.EY.H3,{color:B?"primary":"secondary",children:[A,"-minute meeting"]}),(0,i.FD)(g.EY.B4,{color:B?"primary":"secondary",paddingTop:4,children:[P<S&&(0,i.Y)("span",{className:Y.A.originalPrice,children:(0,y.centsToPriceString)(S,D)}),(0,y.centsToPriceString)(P,D)," \xb7"," ",B?E>50?"Many availabilities":"".concat((0,y.pluralize)(E,"slot")," available this month"):"No slots available in the next week"]})]})}),B?(0,i.Y)(l.A,{className:Y.A.check,size:28}):(0,i.Y)(o.A,{size:28,className:Y.A.disabledCheck})]}),(0,i.Y)(g.EY.B4,{color:"secondary",children:(0,i.Y)("div",{className:Y.A.description,dangerouslySetInnerHTML:M})})]}),(0,i.Y)(h.$n,{className:Y.A.button,disabled:!B,flex:"grow",localNavigation:!1,href:O,children:B?"Continue to book":"No meetings available"})]})})]})}},94255:function(e,t,n){n.d(t,{j:()=>c});var i=n(79785),r=n(4006),a=n(79909),l=n(84605),o=n(39318);function s(){let e=(0,i._)(['Search Substack for "','"']);return s=function(){return e},e}let c=e=>{let{subdomain:t}=e,{iString:n,iTemplate:i}=(0,l.GO)();return(0,r.FD)("div",{className:"page typography signup-page",path:"/not-found",children:[(0,r.Y)(a.Metadata,{title:n("Not Found")}),(0,r.FD)("div",{className:"container",children:[(0,r.Y)("h2",{children:n("Not Found")}),(0,r.Y)("p",{children:n("The page you are attempting to access is not found.")}),(0,r.Y)("p",{children:n("If you want to claim this URL you can start a Substack today")}),(0,r.Y)("p",{children:(0,r.Y)("a",{href:(0,o.f5H)(),class:"button primary",rel:"nofollow",children:n("Start a Substack")})}),(0,r.Y)("p",{children:(0,r.Y)("a",{href:(0,o.Tvl)({query:t,params:{searching:"publication"}}),children:i(s(),t)})})]})]})}},56519:function(e,t,n){n.d(t,{x:()=>w});var i=n(4006),r=n(95201),a=n.n(r),l=n(17402),o=n(15734),s=n.n(o),c=n(73815),d=n(84605),u=n(25006),p=n(85478),h=n(46271),m=n(68349),g=n(12592),f=n(12387),v=n(35369),b=n(76977),y=n(57820),Y=n(63136),_=n(39318);let w=()=>{let e=(0,h.Jd)(),t=(0,u.df)(),{iString:n}=(0,d.GO)(),{getConfigFor:r}=(0,p.mJ)(),[o,w]=(0,l.useState)([]),[C,k]=(0,l.useState)(!0),[S,I]=(0,l.useState)(null),F=(0,l.useCallback)(async()=>{try{k(!0),I(null);let e=await s().get("/api/v1/sponsorship-perks/subscriber");w(e.body.perks||[])}catch(e){console.error("Failed to load perks:",e),I(n("Failed to load rewards. Please try again later."))}finally{k(!1)}},[n]);(0,l.useEffect)(()=>{F()},[F]);let D=r("enable_sponsorship_perks");if((0,l.useEffect)(()=>{D||(window.location.href="/")},[D]),!D)return(0,i.Y)(i.FK,{});function T(e){let{perk:t}=e,{iString:n}=(0,d.GO)(),[r,o]=(0,l.useState)(null),[c,u]=(0,l.useState)(!1),p=async()=>{if("one-time-code"===t.type)try{u(!0);let e=(await s().post("/api/v1/sponsorship-perks/".concat(t.id,"/redeem"))).body;e.success&&o(e.code)}catch(t){var e;alert(null!=(e=(0,m.uX)(t))?e:"Failed to redeem code. Please try again later.")}finally{u(!1)}else o(t.universal_value)};return(0,i.FD)(b.I1,{gap:16,padding:24,border:"detail",radius:"md",bg:"primary",justifyContent:"space-between",style:{maxWidth:250},children:[(0,i.Y)("img",{src:t.image_url,alt:t.title,style:{width:"100%"}}),(0,i.FD)(b.I1,{gap:16,children:[(0,i.Y)(b.I1,{gap:8,children:(0,i.Y)(Y.EY.H3,{children:t.title})}),(0,i.Y)(Y.EY.B2,{style:{wordWrap:"break-word"},children:(0,i.Y)(a(),{options:{target:"_blank",attributes:{rel:"noopener noreferrer"}},children:t.description})}),(0,i.Y)(b.I1,{gap:12,children:r?(0,i.FD)(b.I1,{gap:8,padding:12,style:{backgroundColor:"var(--color-bg-secondary)",borderRadius:4},children:[(0,i.Y)(Y.EY.B3,{children:n("universal-link"===t.type?"Your reward link:":"Your code:")}),"universal-link"===t.type?(0,i.Y)("a",{rel:"noopener noreferrer",target:"_blank",href:r,children:r}):(0,i.Y)(Y.EY.B2,{style:{fontFamily:"monospace",fontWeight:600,color:"var(--color-accent-primary)",wordBreak:"break-all"},children:r})]}):(0,i.Y)(v.$n,{priority:"primary",onClick:p,loading:c,disabled:t.is_redeemed&&"one-time-code"===t.type,children:n(t.is_redeemed&&"one-time-code"===t.type?"Already Redeemed":"universal-link"===t.type?"Get Link":"Reveal Code")})})]})]})}return e?C?(0,i.Y)("div",{className:"page typography",children:(0,i.Y)(c.Z,{children:(0,i.Y)(g.c,{children:(0,i.FD)(b.I1,{gap:32,alignItems:"center",textAlign:"center",children:[(0,i.Y)(y.y$,{}),(0,i.Y)(Y.EY.B1,{children:n("Loading perks...")})]})})})}):(0,i.Y)("div",{className:"page typography",children:(0,i.Y)(c.Z,{children:(0,i.Y)(g.c,{children:(0,i.FD)(b.I1,{gap:48,alignItems:"center",children:[(0,i.FD)(b.I1,{gap:16,alignItems:"center",textAlign:"center",children:[(0,i.Y)(Y.EY.H1,{children:n("Subscriber Perks")}),(0,i.FD)(Y.EY.B1,{translated:!0,children:["Exclusive perks for ",I18N.p((null==t?void 0:t.name)||"")," subscribers"]})]}),S&&(0,i.Y)(f.F,{description:S}),!S&&(0,i.Y)(i.FK,{children:0===o.length?(0,i.FD)(b.I1,{gap:24,alignItems:"center",textAlign:"center",children:[(0,i.Y)(Y.EY.H2,{children:n("No perks available")}),(0,i.Y)(Y.EY.B1,{children:n("There are currently no subscriber rewards available at your subscription level.")})]}):(0,i.Y)(b.Ye,{wrap:"wrap",gap:16,style:{maxWidth:600},alignItems:"center",justifyContent:"center",children:o.map(e=>(0,i.Y)(T,{perk:e},e.id))})}),(0,i.FD)(Y.EY.B4,{translated:!0,children:["Gift a subscription from the"," ",(0,i.Y)("a",{"data-native":!0,href:"/account",children:"account page"}),"."]})]})})})}):(0,i.Y)("div",{className:"page typography",children:(0,i.Y)(c.Z,{children:(0,i.Y)(g.c,{children:(0,i.FD)(b.I1,{gap:32,alignItems:"center",textAlign:"center",children:[(0,i.Y)(Y.EY.H1,{children:n("Subscriber Perks")}),(0,i.Y)(Y.EY.B1,{children:n("Subscribe or Sign In to access subscriber perks")}),(0,i.Y)(v.$n,{priority:"primary",localNavigation:!1,href:(0,_.my9)(t,{utm_source:"perks_page",next:"/perks"}),children:n("Subscribe")})]})})})})}},79244:function(e,t,n){n.d(t,{E:()=>td});var i=n(99851),r=n(69277),a=n(70408),l=n(4006),o=n(32485),s=n.n(o),c=n(17159),d=n.n(c),u=n(83673),p=n.n(u),h=n(69843),m=n.n(h),g=n(87677),f=n(15977),v=n(99862),b=n(17402),y=n(15734),Y=n.n(y),_=n(37343),w=n(28308),C=n(89333),k=n(9266),S=n(67616),I=n(6212),F=n(79785),D=n(48697),T=n(8853),A=n(73164),E=n(84605),N=n(86500),P=n(17186),x=n(68349),L=n(24078),O=n(89490),B=n(35369),M=n(76977),R=n(16993),U=n(81203),j=n(63136),z=n(16291),H=n(39318),W=n(57324);function V(){let e=(0,F._)(["Read more by ",""]);return V=function(){return e},e}function K(){let e=(0,F._)(["Read ","'s posts in the app"]);return K=function(){return e},e}let q="post-app-upsell-next-shown-at";function G(e){var t,n,i;let{post:r,pub:a,onDismiss:o,variant:s,inModal:c}=e,{iString:d,iTemplate:u}=(0,E.GO)(),p=null!=(n=null==(t=r.publishedBylines)?void 0:t[0])?n:null,h=null!=(i=null==p?void 0:p.name)?i:a.name,m=()=>{(0,N.u4)(N.qY.POST_APP_UPSELL_CTA_GET_APP_CLICKED,{variant:s,post_id:r.id,is_mobile:!0});let e=(0,H.XV8)(a.subdomain,r.slug,{redirect:"app-store",source:W.VU.postUfiModal});(0,x.V2)(e,{newTab:!0})},g=()=>{(0,N.u4)(N.qY.POST_APP_UPSELL_CTA_DISMISSED,{variant:s,post_id:r.id}),o()};return(0,l.FD)(O.az,{position:"relative",children:[(0,l.FD)(M.I1,{padding:20,bg:c?void 0:"secondary",radius:c?void 0:"md",gap:16,alignItems:"center",children:[(null==p?void 0:p.photo_url)?(0,l.Y)(L.eu,{photoUrl:p.photo_url,size:64}):a.logo_url?(0,l.Y)(U.Nq,{pub:a,size:64}):(0,l.Y)(T.c,{src:"/img/substack-app-icon.png",width:64,height:64}),(0,l.FD)(M.I1,{gap:4,alignItems:"center",children:[(0,l.Y)(j.EY.B2,{weight:"semibold",color:"primary",children:u(V(),h)}),(0,l.Y)(j.EY.B3,{color:"secondary",children:u(K(),h)})]}),c?(0,l.FD)(M.I1,{style:{width:"100%"},children:[(0,l.Y)(B.$n,{priority:"primary",onClick:m,style:{width:"100%"},children:d("Continue in app")}),(0,l.Y)(B.$n,{priority:"tertiary",onClick:g,style:{width:"100%"},children:d("Continue on web")})]}):(0,l.Y)(B.$n,{priority:"secondary-outline",onClick:m,style:{width:"100%",outline:"2px solid var(--color-utility-detail)",outlineOffset:"-2px",backgroundClip:"padding-box"},children:d("Continue in app")})]}),(0,l.Y)(O.az,{position:"absolute",style:{top:8,right:8},children:(0,l.Y)(B.K0,{priority:"tertiary",size:"sm","aria-label":d("Dismiss"),onClick:g,children:(0,l.Y)(D.A,{size:16})})})]})}function J(e){let{post:t,pub:n}=e,[i,r]=(0,b.useState)(!1);return((0,b.useEffect)(()=>{(0,N.u4)(N.qY.POST_APP_UPSELL_CTA_SHOWN,{variant:"treatment_cta_top",post_id:t.id})},[t.id]),i)?null:(0,l.Y)(O.az,{style:{marginTop:16,marginBottom:16},children:(0,l.Y)(G,{post:t,pub:n,onDismiss:()=>{r(!0)},variant:"treatment_cta_top"})})}function $(e){let{post:t,pub:n}=e,[i,r]=(0,b.useState)(!1),[a]=(0,b.useState)(()=>(0,P.xm)(q)>Date.now());(0,b.useEffect)(()=>{if(a)return;let e=setTimeout(()=>{r(!0),(0,N.u4)(N.qY.POST_APP_UPSELL_CTA_SHOWN,{variant:"treatment_cta_modal",post_id:t.id}),(0,P.X3)(q,(0,z.A)().add(1,"hour").valueOf())},1e3);return()=>clearTimeout(e)},[t.id,a]);let o=()=>{r(!1),(0,P.X3)(q,(0,z.A)().add(1,"day").valueOf())};return a?null:(0,l.Y)(R.aF,{isOpen:i,onClose:o,children:(0,l.Y)(G,{post:t,pub:n,onDismiss:o,variant:"treatment_cta_modal",inModal:!0})})}function Z(e){let{post:t,pub:n}=e,{iString:i}=(0,E.GO)();return(0,b.useEffect)(()=>{(0,N.u4)(N.qY.POST_APP_UPSELL_CTA_SHOWN,{variant:"treatment_cta_inline",post_id:t.id})},[t.id]),(0,l.FD)(B.Nm,{onClick:()=>{(0,N.u4)(N.qY.POST_APP_UPSELL_CTA_GET_APP_CLICKED,{variant:"treatment_cta_inline",post_id:t.id,is_mobile:!0});let e=(0,H.XV8)(n.subdomain,t.slug,{redirect:"app-store",source:W.VU.postUfiModal});(0,x.V2)(e,{newTab:!0})},resetCss:!0,display:"flex",alignItems:"center",justifyContent:"space-between",bg:"tertiary",padding:8,radius:"md",style:{width:"100%",marginTop:12},children:[(0,l.FD)(M.pT,{alignItems:"center",gap:12,children:[(0,l.Y)(O.az,{display:"flex",alignItems:"center",justifyContent:"center",bg:"white",radius:"sm",style:{width:32,height:32},children:(0,l.Y)(A.A,{height:16})}),(0,l.Y)(j.EY.B4,{weight:"semibold",color:"primary",children:i("Read distraction-free on Substack")})]}),(0,l.Y)(g.A,{size:20,style:{color:"var(--color-text-secondary)"}})]})}var Q=n(13950),X=n(55136),ee=n(7e4),et=n(97432),en=n(10996);function ei(e){let{children:t}=e;return(0,l.Y)(en.NP,{theme:"pubInvertedTheme-U483dz",children:t})}var er=n(82776);function ea(e){let{user:t,freeSignup:n,freeSignupEmail:i,publication:r}=e,{iString:a,language:o}=(0,E.GO)(),s=!!t&&t.is_subscribed,c=!!n||!!t&&t.is_free_subscribed&&!t.is_contributor;return s||c&&!r.plans?null:(0,l.Y)(ei,{children:(0,l.Y)(el,{children:(0,l.FD)(eo,{children:[(0,l.Y)(j.EY.H3,{weight:"semibold",color:"primary",textAlign:"center",children:a("Ready for more?")}),c?(0,l.Y)(B.$n,{priority:"primary",href:(0,H.eV6)(r,{utm_source:W.VU.readyForMore}),className:"cta-HDi22T","data-native":!0,children:(0,er.getSubscribeText)(r,{language:o,isFreeSubscribed:c})}):(0,l.Y)(et.A,{freeSignupEmail:i,onAccentBackground:!0,pub:r,source:W.VU.subscribeFooter,submitButtonText:(0,er.getSubscribeText)(r),user:t,onSuccess:e=>{if(r.plans){let n=(0,H.eV6)(r,{just_signed_up:!0,referral_token:e.body.referral_token});if(e.body.prompt_to_login){var t;n="/account/login?redirect=".concat(encodeURIComponent(n),"&email=").concat(encodeURIComponent(null!=(t=e.body.email)?t:""))}document.location.href=n}else window.location.reload()}})]})})})}let el=(0,O.I4)({display:"flex",direction:"column",alignItems:"center",justifyContent:"center",bg:"primary",padding:{desktop:48,mobile:24},className:"container-jsOc9L"}),eo=(0,O.I4)({display:"flex",direction:"column",alignItems:"center",gap:24,wrap:"wrap",className:"content-jLbYeh"});var es=n(61193),ec=n(77481),ed=n(19449),eu=n(82011),ep=n(15894),eh=n(32600),em=n(85478),eg=n(17306),ef=n(68410),ev=n(75303),eb=n(18742);let ey=e=>{let{bio:t,byline:n,name:i,photoUrl:o,pub:s}=e,{getConfigFor:c}=(0,em.mJ)(),{isMobile:d}=(0,ef.sM)(),{markdownProps:u}=(0,eg.$)(t),{hasSection:p}=(0,eh.C)(n.id),h=(0,H.gYq)(n);if(c("enable_author_pages")){var m;h=null!=(m=(0,H.cxh)({userId:n.id,pub:s}))?m:h}return(0,l.FD)(M.pT,{className:"authorInfo-uQxGwM",direction:d?"column":"row",gap:16*!!d,padding:24*!!d,position:"relative",children:[(0,l.FD)(ev.AE,{"data-native":!0,href:h,children:[o&&!(0,eb.DH)(o)&&(0,l.Y)(O.az,{className:"authorImg-RBQVJm",style:{background:"url(".concat((0,H.dJ9)(o,(d?200:430)*2,{height:430}),") lightgray 50% / cover no-repeat")}}),(0,l.FD)(M.I1,{gap:16,padding:40*!d,children:[(0,l.Y)(ep.T,{color:"white",preset:"h5-serif",children:i}),(0,l.Y)(ep.T,(0,a._)((0,r._)({},u),{clamp:4,color:"white",preset:"d3-serif"}))]})]}),p&&(0,l.Y)(eu.L,{authorId:n.id,className:"notifyButton-dcpYYD",minimize:!d})]})};var eY=n(63446),e_=n(65812),ew=n(86227),eC=n(49807);let ek=e=>{var t;let{pub:n,post:i}=e,{iString:r}=(0,E.GO)(),a=null==(t=i.postTags)?void 0:t.filter(e=>{var t,n,r;return!e.hidden&&e.name!==(null==(n=i.publishedBylines)||null==(t=n[0])?void 0:t.name)&&e.name!==(null==(r=i.section)?void 0:r.name)});return a&&0!==a.length?(0,l.FD)(M.Ye,{alignItems:"center",className:"tagList-aHQ9ej",gap:16,wrap:"wrap",children:[(0,l.Y)(ep.T,{preset:"detail-small",children:r("Tags:")}),a.map(e=>(0,l.Y)("a",{className:"tagBox-lyb9LX",href:(0,eC.ii9)(n,e),children:(0,l.Y)(ep.T,{color:"tertiary",preset:"detail-small",children:e.name})}))]}):null},eS=e=>{var t;let{post:n,user:i,pub:r,includeUFI:a=!0,freeSignupEmail:o}=e,{iString:s}=(0,E.GO)();return(0,l.Y)(Q.DH,{children:(0,l.FD)(M.I1,{alignItems:"center","aria-label":s("Post footer"),className:"postFooter-urmQJ_",gap:40,children:[(null==(t=n.postTheme)?void 0:t.header_variant)!=="title_and_image_only"&&(0,l.Y)(eI,{freeSignupEmail:o,post:n,pub:r,user:i}),(0,l.Y)(ek,{post:n,pub:r}),a&&(0,l.Y)(ew.u,{post:n,pub:r,user:i})]})})},eI=e=>{let{post:t,pub:n,user:i,freeSignupEmail:r}=e,{isMobile:a}=(0,ef.sM)(),o=t.publishedBylines.map(e=>{var t,i;let r=null==(t=n.authorPagesInfo)?void 0:t.find(t=>t.user_id===e.id);return{name:null!=(i=null==r?void 0:r.name)?i:e.name,bio:null==r?void 0:r.bio,photo_url:null==r?void 0:r.photo_url,byline:e}}).filter(e=>e.bio&&e.name),s=!(null==i?void 0:i.is_subscribed)&&!t.hidden;if(0===o.length&&!s)return null;let c=!i&&!r,d=(0,l.FD)(M.I1,{alignItems:"center",className:"upgradeCtaContainer-B3vHAT",gap:24,padding:40,paddingTop:24,children:[(0,l.FD)(M.I1,{alignItems:"center",gap:16,children:[(0,l.Y)(ep.T,{align:"center",preset:"h5-sans",children:"Become a Paid Subscriber"}),(0,l.Y)(ep.T,{align:"center",preset:"body",wrap:"balance",children:"Get access to our comments section, special columns like TGIF and Things Worth Remembering, tickets in advance to our live events, and more."})]}),(0,l.Y)(M.Ye,{className:"upgradeCtaInputContainer-I6n3O5",justifyContent:"center",children:c?(0,l.Y)(e_.A,{post:t,pub:n,user:i,utmSource:W.VU.freePressPostEndCta}):(0,l.Y)(eY.v,{href:(0,H.my9)(n,{utm_source:W.VU.freePressPostEndCta,next:(0,eC.wu9)(n,t)}),localNavigation:!1,children:(null==i?void 0:i.is_free_subscribed)?"Upgrade today":"Subscribe today"})}),(0,l.FD)(M.Ye,{gap:16,children:[(0,l.Y)(ep.T,{preset:"caption",children:"Already a paid subscriber?"}),(0,l.Y)("a",{className:"upgradeCtaSwitchAccounts-uPAFOo","data-native":!0,href:(0,H.a7q)({for_pub:n.subdomain,change_user:!0}),children:(0,l.Y)(ep.T,{color:"accent",preset:"caption",children:"Switch Accounts"})})]})]});return(0,l.FD)(M.I1,{alignItems:"center",className:"authorInfoContainer-XS7yHj",gap:a?16:32,children:[s?d:null,o.map(e=>{var t,i;return(0,l.Y)(ey,{bio:null!=(t=e.bio)?t:"",byline:e.byline,name:null!=(i=e.name)?i:"",photoUrl:null==e?void 0:e.photo_url,pub:n})})]})};var eF=n(72880),eD=n(84843);let eT=()=>{let[e,t]=(0,b.useState)(!0),{iString:n}=(0,E.GO)(),i=()=>{t(!1)};return(0,l.FD)(R.aF,{isOpen:e,onClose:i,children:[(0,l.Y)(eD.Io,{showClose:!1,image:(0,l.Y)(O.az,{radius:"md",overflow:"hidden",children:(0,l.Y)(eF.o,{maxWidth:400,useRetinaSizing:!0,imageIsFixedWidth:!0,src:(0,eC.dJ9)("/img/publish/selection.gif")})})}),(0,l.Y)(R.rQ,{showClose:!1,alignItems:"center",title:n("Select a chunk of text"),description:n("We'll convert your selection into a shareable video to help promote this post")}),(0,l.Y)(R.q1,{}),(0,l.Y)(R.jl,{direction:"column",primaryButton:(0,l.Y)(B.$n,{onClick:i,priority:"primary",children:n("Okay")})})]})};var eA=n(56778),eE=n(84565),eN=n(53989),eP=n(46271),ex=n(27749),eL=n(44451),eO=n(53928),eB=n(44803),eM=n(3142),eR=n(94729),eU=n(13022),ej=n(92476),ez=n(43528),eH=n(76528),eW=n(38304),eV=n(17096),eK=n(73957),eq=n(88559),eG=n(72170),eJ=n(84934),e$=n(58398),eZ=n(79391),eQ=n(1459);let eX={container:"container-zWi_VI",imageContainer:"imageContainer-nn2nS0",postContainer:"postContainer-pVTsPs",imagePreview:"imagePreview-gmfk3B",shareButton:"shareButton-TCXuA9",foundingButton:"foundingButton-jUuPk2",upsellDescription:"upsellDescription-ILV1gy",countdownContainer:"countdownContainer-gvKChz",countdownInnerContainer:"countdownInnerContainer-P186WI",refreshLink:"refreshLink-qARRi5"},e0=e=>{var t,n,i,r,a,o,s,c,d,u;let{post:p,publication:h,user:m,freeSignup:g,freeSignupEmail:f}=e,[v,y]=(0,b.useState)(!1),Y=p.cover_image,_=p.title,w=p.description,C=(0,er.getPrintedByline)(h,p),k=(null==(t=p.postSchedule)?void 0:t.email_audience)==="founding"&&(null==m?void 0:m.is_founding)||(null==(n=p.postSchedule)?void 0:n.email_audience)==="only_paid"&&m&&(0,eQ.e)(m,h)||(null==(i=p.postSchedule)?void 0:i.email_audience)==="everyone"&&(null==m?void 0:m.is_free_subscribed),[S,I]=(0,b.useState)((0,z.A)(null==(r=p.postSchedule)?void 0:r.trigger_at).diff((0,z.A)(),"second")),F=Math.floor(S/60/60/24),D=Math.floor(S/60/60%24),T=Math.floor(S/60%60);return(0,b.useEffect)(()=>{let e=setInterval(()=>{var e;I((0,z.A)(null==(e=p.postSchedule)?void 0:e.trigger_at).diff((0,z.A)(),"second"))},500);return()=>{clearInterval(e)}}),(0,b.useEffect)(()=>{(0,N.u4)(N.qY.SCHEDULED_POST_SEEN,{post_id:p.id})},[]),(0,l.FD)(Q.DH,{children:[(0,l.Y)(eK.PostMetaTags,{post:p,publication:h}),(0,l.FD)(M.I1,{className:eX.container,alignItems:"center",gap:96,paddingTop:{desktop:64,mobile:32},paddingX:12,children:[(0,l.FD)(M.I1,{className:eX.postAndImageContainer,alignItems:"center",gap:32,children:[Y&&(0,l.Y)("div",{className:eX.imageContainer,children:(0,l.Y)("img",{src:Y,className:eX.imagePreview})}),(0,l.FD)(M.I1,{className:eX.postContainer,alignItems:"center",gap:4,children:[(0,l.Y)(j.EY.H2,{align:"center",children:_}),(0,l.Y)(j.EY.B3,{color:"secondary",align:"center",children:(0,er.truncateText)(w,135)}),(0,l.FD)(j.EY.Meta,{color:"secondary",align:"center",children:[(null==(a=p.postSchedule)?void 0:a.email_audience)==="founding"?(0,l.FD)(l.FK,{children:[(0,l.Y)(j.EY.Meta,{as:"span",color:"accent",children:"Founding"}),C?"\xa0\xa0•\xa0\xa0":""]}):(null==(o=p.postSchedule)?void 0:o.email_audience)==="only_paid"?(0,l.FD)(l.FK,{children:[(0,l.Y)(j.EY.Meta,{as:"span",color:"accent",children:"Paid"}),C?"\xa0\xa0•\xa0\xa0":""]}):"",C?"By ".concat(C):""]})]})]}),(0,l.FD)(M.I1,{className:eX.upsellContainer,alignItems:"center",children:[k?(0,l.FD)(M.Ye,{gap:12,children:[(0,l.Y)(B.$n,{onClick:()=>{(null==m?void 0:m.is_admin)||(null==m?void 0:m.is_contributor)?(0,x.V2)((0,eC.U_V)(h,p.id),{local_navigation:!1}):y(!0)},className:eX.shareButton,leading:(0,l.Y)(eG.A,{size:20}),priority:"primary",children:"Share"}),(null==m?void 0:m.is_admin)||(null==m?void 0:m.is_contributor)?(0,l.Y)(B.$n,{onClick:()=>{(0,x.V2)((0,eC.I_S)(h,p.id),{local_navigation:!1})},className:eX.shareButton,leading:(0,l.Y)(eJ.A,{size:20}),priority:"secondary",children:"Edit Post"}):null]}):(null==(s=p.postSchedule)?void 0:s.email_audience)!=="founding"||(null==m?void 0:m.is_founding)?(0,l.Y)(eZ.A,{pub:h,post:p,user:m,freeSignup:g,freeSignupEmail:f,isStatic:!1,source:"post-scheduled-page"}):(0,l.Y)(B.$n,{className:eX.foundingButton,onClick:()=>{var e,t;let n=null==(t=h.plans)||null==(e=t.find(e=>{var t;return null==(t=e.metadata)?void 0:t.founding}))?void 0:e.id;(0,x.V2)(n?(0,eC.eV6)(h,{addBase:!0,params:{next:document.location.href,utm_source:W.VU.postScheduledPage,utm_medium:W.Jn.web,utm_content:p.id,selectedPlanId:n}}):(0,H.my9)(h,{simple:!0,next:document.location.href,utm_source:W.VU.postScheduledPage,utm_medium:W.Jn.web,utm_content:p.id,plan:"founding"}),{local_navigation:!1})},children:"Upgrade to founding"}),(0,l.FD)(j.EY.B3,{className:eX.upsellDescription,color:"pub-primary-text",align:"center",children:["Publishes on ",(0,z.A)(null==(c=p.postSchedule)?void 0:c.trigger_at).format("MMMM Do, h:mma"),"."," ",(null==m?void 0:m.is_admin)||(null==m?void 0:m.is_contributor)?"":k?"You’ll receive this post in your inbox when it’s live. Meanwhile, help spread the word!":(null==(d=p.postSchedule)?void 0:d.email_audience)==="founding"&&(null==m?void 0:m.is_free_subscribed)?"Upgrade to founding and receive this post in your inbox when it’s live":(null==(u=p.postSchedule)?void 0:u.email_audience)==="only_paid"&&(null==m?void 0:m.is_free_subscribed)?"Upgrade to paid and receive this post in your inbox when it’s live":"Subscribe now and receive the post in your inbox when it’s live"]})]})]}),(0,l.Y)("div",{className:eX.countdownContainer,children:(0,l.Y)(M.I1,{className:eX.countdownInnerContainer,alignItems:"center",gap:4,children:S>0?(0,l.FD)(j.EY.B3,{color:"pub-secondary-text",align:"center",children:["Available in ",F>0?"".concat((0,er.pluralize)(F,"day"),", "):"",F>0||D>0?"".concat((0,er.pluralize)(D,"hour"),", "):"",F>0||D>0||T>0?"".concat((0,er.pluralize)(T,"minute")).concat(F>0||D>0?",":""," and "):"",(0,er.pluralize)(S%60,"second")]}):(0,l.FD)(j.EY.B3,{color:"pub-secondary-text",align:"center",children:["Available now!"," ",(0,l.Y)(j.EY.B3,{as:"a",color:"pub-secondary-text",align:"center",onClick:()=>{location.reload()},className:eX.refreshLink,decoration:"underline",children:"Refresh to see the post"}),"."]})})}),(0,l.Y)(e$.Z,{isOpen:v,onClose:()=>y(!1),user:m,pub:h,post:p,medium:"web"})]})};var e1=n(22057),e2=n(97515),e4=n(57820),e6=n(21356),e3=n(5180),e7=n(46453),e8=n(2481),e5=n(94954),e9=n(97307),te=n(62088),tt=n(79564),tn=n(7755),ti=n(56458),tr=n(4016),ta=n(56262),tl=n(78979),to=n(41086),ts=n(98949);let tc="discussionContainerFP-YrbLts";class td extends b.Component{shouldForcePostReloadForAnonUser(e){var t;return!this.props.user&&((null==(t=this.props.siteConfigs)?void 0:t.post_metering_enabled)&&(null==e?void 0:e.meter_type)!=="none"||this.props.publication.supports_ip_content_unlock)}async componentDidMount(){var e;(0,x.H7)(),this.cleanEmbedResizeListener=(0,eM._)();let t=(null==(e=this.props.publicationSettings)?void 0:e.enable_post_page_conversion)!==!1;!this.props.user&&(0,ts.Fr)()&&this.props.post&&this.props.publication&&t&&this.context.exposeExperiment("post_page_modal_app_upsell_mobile_web_v2");let n=this.props.post&&[this.props.post.slug,this.props.post.uuid].filter(e=>e).includes(this.props.slug)?this.props.post:null;this.shouldRedirectToComments(n)&&n?this.redirectToComments(n):this.shouldForcePostReloadForAnonUser(n)?await this.loadPost({forceLoad:!0}):this.state.post||await this.loadPost(),this.triggerShareOnLoad(),this.fillEmbeddedEmailInputs(),this.props.justPublished&&(0,x.qm)("justPublished"),(this.props.embeddedPostPublications||""===this.props.embeddedPostPublications)&&(0,x.qm)("embeddedPostPublications"),this.props.showRestackModal&&(0,x.qm)("showRestackModal"),"restack-comment"===this.props.action&&(0,x.qm)("action"),this.props.showWelcome||this.props.launchWelcomePage||(0,x.cH)(this.updateSubscribeTakeover),this.props.showWelcome&&((0,x.qm)("showWelcome"),this.updateSubscribeTimers()),this.props.showWelcomeOnShare&&((0,x.qm)("showWelcomeOnShare"),(this.props.launchWelcomePage||this.props.skipIntroPopupRender)&&this.updateSubscribeTimers()),this.props.selectionFromQuery&&(0,ez.Os)(this.props.selectionFromQuery),this.props.imgSelectionFromQuery&&(0,ez.tL)(this.props.imgSelectionFromQuery),this.props.trackFrontendVisit&&(0,N.u4)(N.qY.POST_PAGE_VISIT_TRACKED,{post_id:null==n?void 0:n.id}),await this.loadWelcomePageData()}async loadWelcomePageData(){if(!this.shouldShowWelcomePage()||(0,ts.Fr)())return;let e=await (0,eR.x6)("/api/v1/welcome_page_data");this.setState(e)}shouldShowWelcomePage(){return!!(!this.props.skipIntroPopupRender&&(this.props.launchWelcomePage||this.props.showWelcome||this.state.showSubscribeTakeover))}componentWillUnmount(){var e;null==(e=this.cleanEmbedResizeListener)||e.call(this),(0,x.Gr)(this.updateSubscribeTakeover)}async componentDidUpdate(e){e.slug!==this.props.slug&&this.loadPost(),this.state.embeddedEmailInputsFilled||this.fillEmbeddedEmailInputs()}shouldRedirectToComments(e){if(e&&"thread"===e.type)return!0}redirectToComments(e){(0,v.route)((0,H.wu9)(this.props.publication,e,{comments:!0,noBase:!0}),!0)}async loadPost(){let{forceLoad:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.setState({embeddedEmailInputsFilled:!1}),this.props.post&&[this.props.post.slug,this.props.post.uuid].filter(e=>e).includes(this.props.slug)&&!this.shouldRedirectToComments(this.props.post)&&!e)this.setState({post:this.props.post,comments:this.props.renderedComments},()=>(0,x.H7)());else{this.setState({post:null,comments:null});try{let e=(await Y().get("/api/v1/posts/".concat(this.props.slug)).query({postPreview:this.props.postPreview,updated:this.props.updated,sub:this.props.sub,device:this.props.device,audience:this.props.audience,free_preview:this.props.free_preview,freemail:this.props.freemail,utm_campaign:this.props.utm_campaign})).body;if(this.shouldRedirectToComments(e))this.redirectToComments(e);else{var t,n;if(await (0,x.wb)(this,{post:e,comments:e.comments,stateThemeVariables:e.themeVariables}),(0,eU.Ay)("add_section_and_tag_metadata")&&!(0,eB.wc)()){let e={url:document.location.origin+document.location.pathname+document.location.search,urlref:document.referrer||"",js:1,data:{audience:(0,eB.fe)(this.props.user)}};"undefined"!=typeof window&&window.PARSELY&&window.PARSELY.loaded&&window.PARSELY.beacon&&window.PARSELY.beacon.trackPageView&&window.PARSELY.beacon.trackPageView(e)}(0,eO.Mz)({path:document.location.pathname,title:e.title,sections:(null==(t=e.section)?void 0:t.name)||"",authors:(null==(n=e.publishedBylines)?void 0:n.map(e=>e.name).join(", "))||""}),(0,x.H7)()}}catch(e){console.error("Failed to load post:",e),404===e.status?this.setState({notFound:!0}):alert((0,x.uX)(e))}}}triggerShareOnLoad(){var e,t;"share"===(0,to.y)("action")&&(window.history.replaceState({},document.title,(0,H.oRR)({action:null})),this.post&&(null==(e=(t=this.post).triggerShare)||e.call(t,{fromEmail:!0})))}render(){var e,t,n,i;let{slug:o,freeSignup:c,freeSignupEmail:d,readerInstalledAt:u,publication:h,reaction_token:m,hide_intro_popup:g,sort:f,search:v,children:b,showWelcome:y,launchWelcomePage:Y,justPublished:w,readerIsSearchCrawler:F,postPreview:D,selectionFromQuery:T,embeddedPublications:A,siteConfigs:E={},freeTrialCoupon:N,showRestackModal:P,action:x,publicationSettings:L,show_reaction_upsell:O,stripe_publishable_key:B,bannedFromNotes:M,themeVariables:R,referringUser:U,clip:j,recentEpisodes:z,followPrompt:H,imgSelectionFromQuery:W,postSelectionStyle:V,shareImageVariantFromQuery:K}=this.props,{comments:q,notFound:G,post:X,user:et,stateThemeVariables:en,hideSubscribePrompt:ei,blurbs:el,topThreePosts:eo,topThreeSubscribers:es}=null!=(e=this.state)?e:{},{iString:ec}=this.I18N,eu=this._inlineComments(),ep=null==X||!X.audience||(0,ta.userHasFullAccessToPost)(et,X),eh=(null==et?void 0:et.is_subscribed)&&ep,em=X&&X.slug&&"coming-soon"!==X.slug&&"page"!==X.type,eg=(0,er.commentsEnabledForPost)({publication:h,post:X}),ef=(0,er.showCommentsOnPost)({publication:h,post:X}),ev=eh||(null==et?void 0:et.is_free_subscriber)||c,eb=(0,tr.lu)({pub:h}),ey=(null==L?void 0:L.enable_post_page_conversion)!==!1,eY=!et&&(0,ts.Fr)()&&X&&h&&ey&&!eb?this.context.getExperimentVariant("post_page_modal_app_upsell_mobile_web_v2"):null,e_=!!(X&&["video","podcast"].includes(X.type)),ew=en||R,eC=!(null==X?void 0:X.hidden)&&((0,er.isUUID)(o)||eh||F||X&&X.current_user_post_meter||X&&X.unlockedWithIP||X&&!(0,ta.isPaidAudience)(X.audience)||X&&!X.slug);eb&&(eC=!!eC&&(!(null==(t=this.props.utm_medium)?void 0:t.includes("paid-social_"))||!!eh));let ek=!!X&&(0,ti.Ed)({post:X})&&!eh,eI=!eC||(null==et?void 0:et.is_contributor)&&X&&(0,ta.isPaidAudience)(X.audience)||eb,eF=w&&(null==et?void 0:et.is_contributor)&&!this.props.publication.invite_only&&X&&!["page"].includes(X.type)&&(null==A?void 0:A.length),eD=!1;if("undefined"!=typeof window&&(eD="true"===new URLSearchParams(window.location.search).get("selectQuote")),eb&&X&&"page"===X.type)return(0,l.Y)(ed.r,{type:X.slug,html:X.body_html||"",post:X,pub:this.props.publication,user:this.props.user});if(X&&"is_scheduled"in X&&X.is_scheduled)return(0,l.Y)(e0,{freeSignup:c,freeSignupEmail:d,user:et,post:X,publication:h});let eE=X?(0,l.Y)(tp,{commentsEnabled:eg,comments:q,post:X,slug:o,user:et,freeSignup:c,freeSignupEmail:d,publication:h,reaction_token:m,onVisible:this.onVisible,onChangeComment:this.onChangeComment,inlineComments:eu,isShowsEpisodePage:e_,selectionFromQuery:T,imgSelectionFromQuery:W,onChange:e=>{let{post:t}=e;X?this.setState({post:(0,a._)((0,r._)({},X),{comment_count:t.comment_count})}):console.error("post not set with CommentsAndRestacks onChange")},bannedFromNotes:M}):null,eN=["podcast","video"].includes(null!=(n=null==X?void 0:X.type)?n:"")&&(null==X?void 0:X.videoUpload)&&(0,eU.Ay)("enable_video_seo_data");return(0,l.FD)("div",{children:["restack-comment"===x&&(0,l.Y)(tf,{post:X,pub:h,selection:T,imgSelection:null!=W?W:void 0}),(0,l.Y)(tm,{pub:h,post:X}),eN&&(0,l.Y)(tg,{pub:h,post:X,hasPaywall:!eC}),this.shouldShowWelcomePage()?(0,l.Y)(k.Ay,{freeSignup:c,freeSignupEmail:d,user:et,post:X,publication:h,hidden:g,launchWelcomePage:Y,showOnMount:Y,blurbs:el,topThreePosts:eo,topThreeSubscribers:es}):null,(0,l.FD)(_.HY,{children:[!e_&&(0,l.Y)(l.FK,{children:(0,l.Y)(tu,{user:et,readerInstalledAt:u,post:X,publication:h,readerIsSearchCrawler:F,publicationSettings:L,appUpsellExperimentVariant:eY})}),(0,l.FD)("div",{className:s()("single-post-container",{"singlePostContainerPillar-sdUBxf":(0,tr.S2)({pub:h})}),"aria-label":ec("Post"),role:"main",children:[(0,l.Y)("div",{className:s()({container:!(e_||(null==X?void 0:X.postTheme)&&eb)}),children:(0,l.FD)("div",{className:"single-post",children:[(0,l.Y)(eK.PostMetaTags,{shareImageVariantFromQuery:K,publication:h,post:null!=X?X:void 0,clip:j,selection:T,siteConfigs:E,selectionStyle:V}),X?(0,l.FD)(Q.DH,{children:["treatment_cta_top"===eY&&(0,l.Y)(J,{post:X,pub:h}),"treatment_cta_inline"===eY&&(0,l.Y)(Z,{post:X,pub:h}),e_?(0,l.Y)(tt.H,{ref:this.assignPost,isServingFreePodcastUrl:ek,isShowsEpisodePage:e_,isTheFreePressTheme:eb,postPreview:D,showComments:ef,user:null!=et?et:null,post:X,pub:h,freeSignup:c,freeSignupEmail:d,reaction_token:m,disableSubscribePrompt:ei||(Y||y)&&!g,paywall:!eC,noTitleLink:!0,onChange:e=>this.setState(null!=e?e:{}),fromPostPage:!0,freeTrialCoupon:N,showRestackModal:!!P,stripe_publishable_key:B,readerIsSearchCrawler:F,renderComments:()=>eE,themeVariables:ew,referringUser:U,recentEpisodes:null!=z?z:null,forceFollowPrompt:H,skipFollowPrompt:this.shouldShowWelcomePage()}):(0,l.Y)(I.L4,{ref:this.assignPost,isServingFreePodcastUrl:ek,isShowsEpisodePage:e_,isTheFreePressTheme:eb,postPreview:D,showComments:ef,user:null!=et?et:null,post:X,pub:h,freeSignup:c,freeSignupEmail:d,reaction_token:m,disableSubscribePrompt:ei||(Y||y)&&!g,paywall:!eC,noTitleLink:!0,onChange:e=>this.setState(null!=e?e:{}),fromPostPage:!0,freeTrialCoupon:N,showRestackModal:!!P,stripe_publishable_key:B,readerIsSearchCrawler:F,renderComments:()=>eE,themeVariables:ew,referringUser:U,forceFollowPrompt:H,skipFollowPrompt:this.shouldShowWelcomePage()})]}):G?(0,l.Y)("p",{className:"main-loader","aria-label":ec("Error: Post not found"),children:ec("Post not found")}):(0,l.Y)(I.DZ,{pub:h}),b]})}),(0,l.FD)(Q.DH,{children:[em&&(eC||eb)&&[eb&&(0,l.Y)(eS,{post:X,user:et,pub:h,freeSignupEmail:d,includeUFI:!!eC&&"video"!==X.type&&"podcast"!==X.type}),ef&&!e_&&eE,h.has_posts&&(!e_||eb)&&(0,l.Y)("div",{className:"single-post-section",children:(0,l.FD)("div",{className:s()({container:!(X.postTheme&&eb)}),children:[(0,l.Y)(eA.A,{onVisible:()=>{this.onVisible("Top Posts Footer")}}),(0,l.Y)(eq.Q,{user:null!=et?et:null,freeSignup:c,freeSignupEmail:d,isShowsEpisodePageForTheFP:e_,pub:h,maxPosts:eI||eh||ev&&!h.plans?10:3,filterPostsPredicate:e=>e.id!==X.id,sort:eb?"new":f,search:v,stateInUrl:!0,sortTabs:e=>{if(this.context.getConfigFor("related_posts_enabled")){let t=e.findIndex(e=>"related"===e.id);if(-1!==t)return p()([e[t]].concat(e.filter((e,n)=>n!==t)))}let t=e.findIndex(e=>"top"===e.id);return -1!==t?p()([e[t]].concat(e.filter((e,n)=>n!==t))):null},delayFirstLoad:1e3,source:"post",isBelowTheFold:!0,post:X})]})}),!eI&&[(0,l.Y)(eA.A,{onVisible:()=>this.onVisible("Subscribe Footer")}),(0,l.Y)(ea,{publication:h,user:et,freeSignupEmail:d,freeSignup:c})]],"treatment_cta_modal"===eY&&X&&(0,l.Y)($,{post:X,pub:h})]}),eF?(0,l.Y)(ee.b,{pub:h,pubsToRecommend:A}):null,O?(0,l.Y)(S.Cv,{user:et,pub:h,post:null!=X?X:void 0}):null,eD&&(0,l.Y)(eT,{}),(0,l.Y)(C.Ay,{post:X,mediaUploadId:null!=(i=this.props.clipId)?i:null})]})]})]})}constructor(e,t){super(e,t),(0,i._)(this,"I18N",void 0),(0,i._)(this,"cleanEmbedResizeListener",void 0),(0,i._)(this,"post",void 0),(0,i._)(this,"assignPost",e=>{this.post=e}),(0,i._)(this,"updateSubscribeTakeover",()=>{let e=this.props.publication.id,t=(0,P.xm)("pub-".concat(e,"-takeover-next-shown-at")),n=!t||Date.now()>=t;(0,x.Tf)()?this.state.subscribeTakeOverTimer&&(n&&Date.now()-this.state.subscribeTakeOverTimer.getTime()>=12e4&&this.setState({showSubscribeTakeover:!0},()=>{this.loadWelcomePageData()}),this.setState({subscribeTakeOverTimer:null}),this.updateSubscribeTimers()):this.state.subscribeTakeOverTimer||this.setState({subscribeTakeOverTimer:new Date})}),(0,i._)(this,"updateSubscribeTimers",()=>{let e=this.props.publication.id,t="pub-".concat(e,"-subscribe-prompt-next-shown-at"),n="pub-".concat(e,"-takeover-next-shown-at");(0,P.X3)(t,(0,z.A)().add(1,"hour").valueOf()),(0,P.X3)(n,(0,z.A)().add(1,"hour").valueOf()),this.setState({hideSubscribePrompt:!0})}),(0,i._)(this,"onChangeComment",e=>{this.setState({comments:(0,eW.cx)(this.state.comments,e)})}),(0,i._)(this,"onVisible",e=>{let t="".concat(e," Seen");!this.state.post||this.state[t]||(this.setState({[t]:!0}),(0,N.u4)(t,{post_id:this.state.post.id,post_audience:this.state.post.audience,post_type:this.state.post.type}))}),(0,i._)(this,"_inlineComments",()=>{let{inlineComments:e,publication:t}=this.props;return!!e||(0,er.shouldUseInlineComments)(t,this.state.post||this.props.post)}),(0,i._)(this,"fillEmbeddedEmailInputs",()=>{var e;let t=document.querySelectorAll('article.post input[type="email"]'),n=(null==(e=this.state.user)?void 0:e.email)||this.props.freeSignupEmail;if(n)for(let e of t)e.value=n;this.setState({embeddedEmailInputsFilled:!0})});let{user:n}=e;this.I18N=I18N.i({pub:e.publication}),e.postPreview&&(n=(0,a._)((0,r._)({},n),{is_draft:!1,is_subscribed:"free"!==e.postPreview,is_founding:"founding"===e.postPreview,is_contributor:!1})),e.post&&[e.post.slug,e.post.uuid].filter(e=>e).includes(e.slug)&&!this.shouldRedirectToComments(e.post)?this.state={post:e.post,comments:e.renderedComments,user:n}:this.state={post:null,comments:null,user:n}}}function tu(e){let{user:t,readerInstalledAt:n,post:i,publication:r,readerIsSearchCrawler:a,publicationSettings:o,appUpsellExperimentVariant:s}=e,c=i&&r&&!a&&!(0,tr.lu)({pub:r})&&!(s&&"control"!==s),d=t&&t.is_contributor&&(null==i?void 0:i.slug)=="coming-soon"&&!(null==o?void 0:o.seen_coming_soon_explainer);return(0,l.FD)(l.FK,{children:[c&&(0,l.Y)(_.oD,{subdomain:r.subdomain,post:i,readerInstalled:!!n,isContributor:!!(null==t?void 0:t.is_contributor)}),d&&(0,l.Y)(w.DZ,{})]})}(0,i._)(td,"contextType",eE.Ke);let tp=e=>{var t,n,i;let{commentsEnabled:o,comments:c,post:d,slug:u,user:p,freeSignup:h,freeSignupEmail:v,publication:y,reaction_token:Y,onVisible:_,onChangeComment:w,inlineComments:C,isShowsEpisodePage:k,selectionFromQuery:S,onChange:I,bannedFromNotes:F,imgSelectionFromQuery:D}=e,{iString:T,iPlural:A}=(0,E.GO)(),[P,x]=(0,b.useState)(!!(0,to.y)("showRestacks")),[L,B]=(0,b.useState)(!1),R=(0,eP.ur)(),{getSettingFor:U}=(0,eN.Pu)(),z=(0,tr.lu)({pub:y}),V=U("show_restacks_below_posts")&&y.community_enabled&&!z,[K,q]=(0,e3._0)(),[G,J]=(0,b.useState)(!1),$=(0,eH.OU)("/api/v1/note/p-".concat(d.id,"/restacks?filterForPub=true"),{auto:G||P,deps:[d.id]});(0,b.useEffect)(()=>{var e,t;!$.isLoading&&(null==(t=$.data)||null==(e=t.items)?void 0:e.length)&&q({type:"comments_load",payload:{comments:$.data.items.map(e=>{let{comment:t}=e;return t})}})},[q,$.isLoading,$.data]);let Z=(0,eH.OU)("/api/v1/post/".concat(d.id,"/restackers"),{auto:P,deps:[d.id]}),[Q,X]=(0,b.useState)(""),[ee,et]=(0,b.useState)(""),en=(0,e9.n)(),ei=p?void 0:function(){let{redirectOverride:e,overrideTitle:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};B(!0),e&&X(e),t&&et(t)},ea="undefined"!=typeof window&&new URL(window.location.href);ea&&(ea.searchParams.set("showRestacks",!0),ea.hash="discussion");let el=!!d.videoUpload,eo=!!(!el&&"podcast"===d.type);return(0,l.FD)(l.FK,{children:[(0,l.Y)(eA.A,{onVisible:()=>J(!0)}),(0,l.FD)(M.I1,{paddingY:32,gap:z?28:16,id:"discussion",children:[(0,l.FD)(M.I1,{gap:32,className:s()({container:"newsletter"===d.type&&!z,[tc]:z&&!k}),children:[z?(0,l.Y)(es.W,{comments:c,post:d,notAllowedToFetchComments:!(0,er.canSeeComments)(p,d)}):(0,l.Y)(j.EY.H4,{children:V?T("newsletter"===d.type?"Discussion about this post":el?"Discussion about this video":eo?"Discussion about this episode":"Discussion"):d.comment_count?A("1 Comment","%1 Comments",d.comment_count):T("Comments")}),V&&(0,l.Y)(O.az,{alignSelf:"start",children:(0,l.Y)(e6.T,{value:P?"restacks":"comments",onChange:e=>{x("restacks"===e),(0,N.u4)(N.qY.POST_DISCUSSION_TOGGLE_CLICKED,{post_id:d.id,tab:e})},tabs:[{value:"comments",label:T("Comments")},{value:"restacks",label:T("Restacks")}],ariaLabel:T("Select discussion type")})})]}),P?(0,l.FD)(M.I1,{className:"container",paddingTop:16,gap:16,children:[(0,l.Y)(e7.Dx.Provider,{value:{requireLogin:ei,onboardingModal:en,publicationUsers:[],subscriptions:[]},children:(0,l.Y)(e8.Ay,{restackUrl:(0,H.wu9)(y,d),placeholder:T((0,ts.Fr)()?"Write a restack...":"Write a restack about this post to your followers..."),surface:"post-page-restacks-list"})}),(0,l.Y)(te.M9,{isOpen:L,onCancel:()=>{B(!1),X(""),et("")},onSuccess:()=>{B(!1),window.history.replaceState(null,"",null==ea?void 0:ea.toString()),location.reload()},onSignup:()=>{B(!1),en.open({initialStep:tl.dn.SIGNUP,skipRedirectOnExit:!1})},redirectOverride:Q,overrideTitle:ee}),(0,l.Y)(e5.O,(0,a._)((0,r._)({},en.modalProps),{entry:"post-page-restacks",redirect:null==ea?void 0:ea.toString(),redirectAfterProfile:!0,skipCategories:!0})),$.isLoading?(0,l.Y)(e4.y$,{}):(null==(t=$.data)?void 0:t.items.length)?(0,l.FD)(M.I1,{gap:16,children:[(0,l.Y)(M.I1,{children:(0,l.Y)(ex.IJ,{surface:"post-page-restacks-list",dispatch:q,state:K,children:null==(n=$.data.items)?void 0:n.slice(0,3).map(e=>{var t,n,i,l,o,s;return(0,a._)((0,r._)({},e),{publication:e.publication?null!=(n=K.publications.get(e.publication.id))?n:e.publication:null,post:e.post?null!=(i=K.posts.get(e.post.id))?i:e.post:null,comment:e.comment?(0,a._)((0,r._)({},null!=(l=K.comments.get(e.comment.id))?l:e.comment),{attachments:(null!=(s=null==(t=null!=(o=K.comments.get(e.comment.id))?o:e.comment)?void 0:t.attachments)?s:[]).filter(e=>{let{type:t,postSelection:n}=e;return"post"!==t||!!n})}):null})}).map(e=>(0,l.Y)(eL.GJ,{className:"feedItem-p_SCsv",item:e},e.entity_key))})}),!m()(d.restacks)&&d.restacks-3>0&&(0,l.FD)(M.Ye,{gap:8,alignItems:"center",children:[(0,l.Y)(M.Ye,{as:"a",alignItems:"center",cursor:"pointer",href:(0,eC.so2)(d.id,{urlParams:{utm_source:W.VU.substack,utm_content:W.fL.facepileRestacks}}),children:(0,l.Y)(e1.Z,{users:(null!=(i=Z.data)?i:[]).filter(e=>{var t,n,i;let{id:r}=e;return!(null==(i=$.data)||null==(n=i.items)||null==(t=n.slice(0,3))?void 0:t.some(e=>{let{comment:t}=e;return t.user_id==r}))}).map(e=>(0,a._)((0,r._)({},e),{noLink:!0}))})}),(0,l.FD)(M.Ye,{as:"a",gap:4,alignItems:"center",cursor:"pointer",href:(0,eC.so2)(d.id,{urlParams:{utm_source:W.VU.substack,utm_content:W.fL.facepileRestacks}}),children:[(0,l.Y)(j.EY.B3,{color:"pub-secondary-text",children:A("See 1 more restack","See %1 more restacks",d.restacks-3)}),(0,l.Y)(g.A,{stroke:"var(--print_secondary_on_web_bg_color, var(--color-fg-secondary))",strokeWidth:1,size:18})]})]})]}):(0,l.Y)(M.pT,{paddingY:48,justifyContent:"center",alignItems:"center",flex:"grow",children:(0,l.Y)(e2.p,{className:"restackEmpty-joLIAL",icon:(0,l.Y)(f.A,{}),title:T("There are no restacks yet, be the first one to restack the post!")})})]}):(0,l.Y)(th,{commentsEnabled:o,comments:c,post:d,isShowsEpisodePage:k,slug:u,user:p,freeSignup:h,freeSignupEmail:v,publication:y,reaction_token:Y,onVisible:_,onChangeComment:w,inlineComments:C,selectionFromQuery:S,imgSelectionFromQuery:D,onChange:I,bannedFromNotes:F,userContext:R})]})]})};class th extends b.Component{componentDidMount(){document.addEventListener(I.$f,this.handleFocusInput)}componentWillUnmount(){document.removeEventListener(I.$f,this.handleFocusInput)}render(){var e;let{commentsEnabled:t,inlineComments:n,isShowsEpisodePage:i,post:r,user:a,freeSignup:o,freeSignupEmail:s,publication:c,reaction_token:d,onVisible:u,onChangeComment:p,selectionFromQuery:h,slug:m,onChange:g,bannedFromNotes:f,imgSelectionFromQuery:v}=this.props,{comments:b,reactionSigninComment:y}=null!=(e=this.state)?e:{};if(r.is_geoblocked)return null;let Y=(0,tr.lu)({pub:c});if(n)return(0,l.Y)("div",{id:tn.R4,children:(0,l.Y)(eW.iQ,{slug:m,user:null!=a?a:void 0,freeSignupEmail:s,freeSignup:o,post:r,publication:c,post_reaction_token:d,selectionFromQuery:h,imgSelectionFromQuery:v,initialComments:null!=b?b:[],inline:!0,onChange:g})});let{iPlural:_}=this.I18N,w=async(e,t)=>(0,eW.Jk)({user:null!=a?a:void 0,reactionToken:d,comments:null!=b?b:[],id:e,reacted:t,setComments:e=>this.setState({comments:e}),onNeedsSignin:e=>{let{comment:t}=e;this.setState({reactionSigninComment:t})}}),C=(0,eW.PG)(r,c);return(!(0,ts.Fr)()||(null==a?void 0:a.is_contributor)||(C=(0,H.XV8)(c.subdomain,r.slug,{params:{comments:!0,utm_source:W.VU.post,utm_medium:W.Jn.web}})),Y&&!(0,er.canSeeComments)(a,r))?(0,l.Y)(ec.n,{post:r,publication:c,user:null!=a?a:void 0,freeSignupEmail:s,showHeader:!1}):(0,l.Y)("div",{className:"single-post-section comments-section",children:(0,l.FD)("div",{className:Y?i?"":tc:"container",children:[(0,l.Y)(eA.A,{onVisible:()=>u("Post Comments Footer")}),t&&(0,l.Y)(eW.gi,{user:a,freeSignup:o,freeSignupEmail:s,pub:c,post:r,token:d,ref:this.inputRef,bannedFromNotes:f}),b&&b.length>0&&!t&&(0,l.Y)(eW.Nm,{post:r}),b&&b.length>0&&c.community_enabled&&(0,l.Y)(eV.Wh,{className:"post-page-root-comment-list",user:a,freeSignup:o,freeSignupEmail:s,pub:c,post:r,comments:b,reaction_token:d,onChange:p,updateCommentReacted:w,noRestack:!0},"post:".concat(r.id)),r.comment_count>(b||[]).length&&(0,l.Y)("a",{className:"more-comments",href:C,children:_("1 more comment...","%1 more comments...",r.comment_count-(b||[]).length)}),y&&(0,l.Y)(X.LZ,{isOpen:!0,comment:y,pub:c,user:a,react:()=>w(y.id,!0),onClose:()=>this.setState({reactionSigninComment:null})})]})})}constructor(e,t){super(e,t),(0,i._)(this,"I18N",void 0),(0,i._)(this,"inputRef",void 0),(0,i._)(this,"handleFocusInput",void 0),this.I18N=I18N.i({pub:e.publication}),this.inputRef=(0,b.createRef)(),this.handleFocusInput=()=>{var e;null==(e=this.inputRef.current)||e.focus()},this.state={comments:e.comments,reactionSigninComment:null}}}let tm=e=>{let{pub:t,post:n}=e;return n?(0,l.Y)("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:d()((0,ej.II)(t,n),{json:!0,isScriptContext:!0})}}):null},tg=e=>{var t;let{pub:n,post:i,hasPaywall:r}=e;if(!i.videoUpload)return null;let a=(null!=(t=i.videoUpload.preview_duration)?t:0)>0;return(0,l.Y)("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:d()((0,ej.V)(n,i,i.videoUpload,{usePreview:r&&a}),{json:!0,isScriptContext:!0})}})};function tf(e){let{pub:t,post:n,selection:i,imgSelection:r}=e,a=(0,e8.NP)();return(0,b.useEffect)(()=>{a.open({restackUrl:(0,H.wu9)(t,n,{urlParams:{selection:i,imgSelection:r}})})},[]),null}},2670:function(e,t,n){n.d(t,{m:()=>a});var i=n(4006),r=n(79909);let a=e=>{let{sitemapHeader:t,sitemapDescription:n,sitemapLinks:a}=e;return(0,i.FD)("div",{className:"container typography sitemap-page",children:[(0,i.Y)(r.Metadata,{title:t,description:n}),(0,i.Y)("h1",{children:t}),(0,i.Y)("div",{children:a.map(e=>(0,i.Y)("p",{children:(0,i.Y)("a",{className:"sitemap-link",href:e.href,"data-native":!0,children:e.text})}))})]})}},41167:function(e,t,n){n.d(t,{A:()=>P,s:()=>A});var i=n(69277),r=n(70408),a=n(79785),l=n(4006),o=n(69843),s=n.n(o),c=n(80697),d=n(17402),u=n(15734),p=n.n(u),h=n(79909),m=n(84605),g=n(86500),f=n(1683),v=n(68349),b=n(35369),y=n(81203),Y=n(99156),_=n(39318),w=n(82776),C=n(57324);function k(){let e=(0,a._)(["Substacks recommended by ","",""]);return k=function(){return e},e}function S(){let e=(0,a._)(["Recommended by ",""]);return S=function(){return e},e}function I(){let e=(0,a._)(["By ",""]);return I=function(){return e},e}function F(){let e=(0,a._)(["View all ",""]);return F=function(){return e},e}let D=function(e,t,n,i){let{trackOnly:r=!1,freeSignupEmail:a}=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return async()=>{if((0,g.u4)(g.qY.RECOMMENDATION_SUBSCRIBE_BUTTON_CLICKED,{source:"recommendations-page",recommended_publication_id:e.id,recommending_publication_id:t.id}),!r)try{let r=n&&!n.is_magic&&n.email||a;await p().post("/api/v1/free").send({email:r,source:"recommendations_page",first_url:f.R9,first_referrer:f.b7,first_session_url:f.K0,first_session_referrer:f.OG,current_url:f.AT,current_referrer:f.uC,other_publication_id:e.id,referring_pub_id:t.id}),i(e)}catch(e){alert((0,v.uX)(e)||"Something went wrong")}}},T=function(e,t,n){let{trackOnly:i=!1}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return async()=>{if((0,g.u4)(g.qY.RECOMMENDATION_UNSUBSCRIBE_BUTTON_CLICKED,{source:"recommendations-page",recommended_publication_id:e.id,recommending_publication_id:t.id}),!i)try{await p().delete("/api/v1/free").send({publication_id:e.id,source:"recommendations_page"}),n(e)}catch(e){alert((0,v.uX)(e)||"Something went wrong")}}},A=e=>{let{pub:t,recommendations:n,allSubscribedPubs:i,fullySubscribedPubs:r,user:a,freeSignupEmail:o}=e,{iString:s,iTemplate:u}=(0,m.GO)(),[p,f]=(0,d.useState)(i),Y=e=>{f([...p,e])},F=e=>{f(p.filter(t=>{let{id:n}=t;return n!==e.id}))};return(0,l.FD)("div",{className:"container",children:[(0,l.Y)(h.Metadata,{title:u(k(),(0,w.getByLine)(t)||t.name,(0,w.getByLine)(t)?" | ".concat(t.name):"")}),(0,l.FD)("div",{className:"recommendations-page-container",children:[(0,l.Y)("h2",{children:u(S(),(0,w.getByLine)(t)||t.name)}),(0,l.Y)("div",{className:"recommended-publications-container",children:n.map(e=>{let n=e.recommendedPublication;if(!n)return;let i="".concat((0,_.$_T)(n),"/?utm_source=").concat(C.VU.recommendationsPage,"&utm_campaign=").concat(t.id),d=(0,_.eV6)(n,{addBase:!0,utm_source:C.VU.recommendationsPage,referring_pub_ids:[t.id],simple:!0}),h=(0,w.getByLine)(n),m=r.map(e=>{let{id:t}=e;return t}).includes(n.id);return(0,l.Y)("div",{className:"recommended-publications-text-container with-blurb",children:(0,l.Y)("div",{className:"recommendation-body",children:(0,l.FD)("div",{className:"publication-content",children:[(0,l.FD)("div",{className:"top-row",children:[(0,l.FD)("a",{className:"left",href:i,onClick:()=>{(0,g.u4)(g.qY.PUBLICATION_RECOMMENDATION_LINK_CLICKED,{source:"recommendations-page",recommended_publication_id:n.id,recommending_publication_id:t.id})},children:[(0,l.Y)(y.Nq,{pub:n,size:48}),(0,l.FD)("div",{className:"pub-meta",children:[(0,l.Y)("div",{className:"publication-title",children:n.name}),!!h&&(0,l.Y)("div",{className:"publication-author",children:u(I(),h)})]})]}),p.map(e=>{let{id:t}=e;return t}).includes(n.id)?(0,l.Y)(b.$n,{priority:"secondary",onClick:T(n,t,F,{trackOnly:m}),href:m?(0,_.FCy)(n,{addBase:!0}):void 0,className:"unsubscribe",children:s("Subscribed")}):(0,l.Y)(b.$n,{priority:"primary",onClick:a&&!a.is_magic&&a.email||o?D(n,t,a,Y,{freeSignupEmail:o}):()=>{(0,g.u4)(g.qY.RECOMMENDATION_SUBSCRIBE_BUTTON_CLICKED,{source:"recommendations-page",recommended_publication_id:n.id,recommending_publication_id:t.id}),(0,v.V2)(d,{local_navigation:!1})},leading:(0,l.Y)(c.A,{size:20}),children:s("Subscribe")})]}),(0,l.Y)("div",{className:"publication-suggestion-text-area",children:(n.editorial_bio||n.hero_text)&&(0,l.Y)("div",{className:"publication-description",children:n.editorial_bio||n.hero_text})}),e.description&&(0,l.Y)(E,{content:e.description,author:(0,w.getByLine)(t)||t.name})]})})})})})]})]})},E=e=>{let{author:t,content:n}=e;return(0,l.FD)("div",{className:"blurb",children:[(0,l.Y)("p",{className:"blurb-content",children:n}),(0,l.FD)("p",{className:"blurb-author",children:["- ",t]})]})},N=e=>{var t,n,a;let{recommendation:o,pub:s,signedIn:c,render:d}=e,{recommendedPublication:u}=o,p=(0,_.fOI)(u,{params:{utm_source:C.VU.homepageRecommendations,utm_campaign:s.id},signedIn:c}),h=()=>{(0,g.u4)(g.qY.PUBLICATION_RECOMMENDATION_LINK_CLICKED,{recommending_publication_id:s.id,recommended_publication_id:u.id,source:"homepage-recommendations"})},m={pub:u,openInNewTab:!0,belowTheFold:!0};return d?d({pubAvatarProps:m,pubName:u.name,pubAuthor:null==(n=u.author)?void 0:n.name,url:p,onClick:h}):(0,l.Y)("div",{className:"home-right-col",children:(0,l.Y)("div",{className:"recommendation-row",children:(0,l.FD)("div",{className:"left",children:[(0,l.Y)("a",{onClick:h,children:(0,l.Y)(y.wg,(0,r._)((0,i._)({},m),{size:32}))}),(0,l.FD)("div",{className:"pub-meta",children:[(0,l.Y)("a",{href:p,target:"_blank",onClick:h,children:u.name}),(0,l.Y)("div",{className:"pub-author",children:null!=(a=null==(t=u.author)?void 0:t.name)?a:""})]})]})})})},P=e=>{let{recommendations:t,numRecommendations:n,pub:i,user:r,render:a,renderRecommendation:o}=e,{iString:c,iTemplate:u}=(0,m.GO)(),{isPreviewMode:p}=(0,Y.T)(),h=t.map(e=>(0,l.Y)(N,{recommendation:e,pub:i,signedIn:!!r,render:o}));return((0,d.useEffect)(()=>{p||(0,g.u4)(g.qY.PUBLICATION_RECOMMENDATIONS_SHOWN,{source:"pub-home",recommendations:t.map(e=>{let{recommendedPublication:t}=e;return t.id})})},[t,p]),a)?a({recommendations:h,canManage:!!(null==r?void 0:r.is_admin),manageUrl:(0,_.OFB)(i),hasMore:!s()(n)&&n>t.length,hasMoreUrl:(0,_.nUM)(i),recommendationsCount:n}):(0,l.FD)("div",{className:"home-right-group recommendations",children:[(0,l.FD)("div",{className:"home-right-group-title",children:[(0,l.Y)("a",{href:(0,_.nUM)(i),children:"Recommendations"}),(null==r?void 0:r.is_admin)?(0,l.Y)("a",{href:(0,_.OFB)(i),"data-native":!0,children:c("Manage")}):!s()(n)&&n>t.length?(0,l.Y)("a",{href:(0,_.nUM)(i),"data-native":!0,children:u(F(),n)}):null]}),h]})}},52506:function(e,t,n){n.d(t,{Y:()=>C});var i=n(69277),r=n(4006),a=n(32485),l=n.n(a),o=n(79909),s=n(84605),c=n(51190),d=n(12592),u=n(72216),p=n(63136),h=n(56458),m=n(4016),g=n(46009),f=n(39318),v=n(57324),b=n(22065);let y=e=>{let{}=e,{iString:t}=(0,s.GO)();return(0,r.Y)("div",{className:b.A.noPodcasts,children:t("No podcasts.")})},Y=(e,t,n)=>{let i=e[t.id];return i||(i=(0,f.wpu)(t,{section:null,noSection:!1,addBase:!0,user:null,startAtSubscribeFlow:!n||!n.is_free_subscribed,params:{utm_source:v.VU.allPodcasts}})),i},_=e=>{let{pub:t,user:n,idToMagicLink:i,openInNewTab:a}=e;return"thebulwark"!==t.subdomain?null:(0,r.FD)(p.EY.B3,{translated:!0,paddingTop:16,paddingBottom:16,children:[(0,r.Y)("a",{href:Y(null!=i?i:{},t,n),target:a?"_blank":void 0,rel:"noopener",children:"Click here"})," ","to set up your podcast app for everything in one feed."]})},w=e=>{let{pub:t,user:n,idToMagicLink:i={}}=e,a=[],{iString:l}=(0,s.GO)();(0,h.th)(t)&&(0,h.th)(t).forEach(e=>{var r,o;if(!(0,h.pf)({pub:t,section:e}))return;let s=(0,g.lL)({pub:t,section:e});if(!s.title)return;let c={logoUrl:null!=(r=s.artUrl)?r:void 0,mainClickUrl:(0,f.t6y)({pub:t,section:e,addBase:!0}),buttonClickUrl:i[e.id]||(0,f.wpu)(t,{section:e,noSection:!1,addBase:!0,user:null,startAtSubscribeFlow:!n||!n.is_free_subscribed,params:{utm_source:v.VU.allPodcasts}}),name:s.title,description:null!=(o=s.description)?o:"",buttonText:l("Set up podcast")};a.push(c)}),(0,h.fk)(t)&&a.push((0,u.E)(t,Y(i,t,n)));let o=Object.keys(i).length>0||(null==n?void 0:n.is_free_subscribed)?l("Private podcasts"):l("Podcasts"),c=(0,r.Y)(r.FK,{children:(0,h.Jy)(t)?(0,r.FD)(r.FK,{children:[(0,r.Y)(u.p,{showButton:!0,items:a}),(0,r.Y)(_,{pub:t,user:n,idToMagicLink:i})]}):(0,r.Y)(y,{})});return(0,r.FD)(r.FK,{children:[(0,r.Y)(p.EY.H4,{paddingTop:20,paddingBottom:8,children:o}),c]})},C=e=>{let{pub:t,user:n,idToMagicLink:a,metadata:s}=e;return(0,m.s7)({pub:t,includeTheRampart:!0})?(0,r.FD)("div",{className:l()("page","typography",b.A.container,b.A.containerBulwark),children:[(0,r.Y)(c.X,{idToMagicLink:a,pub:t,user:n}),s&&(0,r.Y)(o.Metadata,(0,i._)({},s))]}):(0,r.FD)("div",{className:l()("page","typography",b.A.container),children:[s&&(0,r.Y)(o.Metadata,(0,i._)({},s)),(0,r.Y)(d.c,{children:(0,r.Y)(w,{idToMagicLink:a,pub:t,user:n})})]})}},99054:function(e,t,n){n.d(t,{$:()=>B});var i=n(69277),r=n(70408),a=n(4006),l=n(3160),o=n(23345),s=n(17402),c=n(79454),d=n(84605),u=n(99145),p=n(12501),h=n(35369),m=n(76977),g=n(16993),f=n(57820),v=n(63136),b=n(39318);function y(e){let{isOpen:t,onClose:n,onSave:l}=e,{iString:o}=(0,d.GO)(),[y,Y]=(0,s.useState)([]),[_,w]=(0,s.useState)({}),[C,k]=(0,s.useState)(!1),[S,I]=(0,s.useState)(!1),{open:F}=(0,u.v9)(),D=()=>{I(!1),n()},{result:T,isLoading:A,refetch:E}=(0,p.st)({pathname:"/api/v1/sponsorship/featured-posts",auto:!1}),{result:N,refetch:P}=(0,p.st)({pathname:"/sponsorship/profile-data",auto:!1});(0,s.useEffect)(()=>{t&&!S?(I(!0),E()):!t&&S&&(Y([]),w({}),I(!1))},[t]),(0,s.useEffect)(()=>{(null==T?void 0:T.post_ids)&&(Y(T.post_ids),P())},[T]),(0,s.useEffect)(()=>{if((null==N?void 0:N.posts)&&(null==T?void 0:T.post_ids)){let e={};N.posts.forEach(t=>{T.post_ids.includes(t.id)&&(e[t.id]=t.title)}),w(t=>(0,i._)({},t,e))}},[N,T]);let x=async()=>{k(!0);try{if(!(await fetch("/api/v1/sponsorship/featured-posts",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({post_ids:y})})).ok)throw Error("Failed to save featured posts");null==l||l(),D()}catch(e){console.error("Error saving featured posts:",e)}finally{k(!1)}},L=(e,t)=>{let n=[...y],[i]=n.splice(e,1);void 0!==i&&(n.splice(t,0,i),Y(n))};return(0,a.FD)(g.aF,{isOpen:S,onClose:D,width:800,children:[(0,a.Y)(g.rQ,{title:o("Manage Featured Posts"),showClose:!0,onClose:D}),(0,a.Y)(g.cw,{children:(0,a.Y)(m.I1,{gap:24,children:A?(0,a.Y)(m.Ye,{justifyContent:"center",padding:20,children:(0,a.Y)(f.y$,{size:24})}):(0,a.FD)(m.I1,{gap:16,children:[(0,a.FD)(m.Ye,{justifyContent:"space-between",alignItems:"center",children:[(0,a.FD)(v.EY.B2,{weight:"semibold",children:[(0,a.Y)(v.EY,{translated:!0,children:"Featured Posts"})," (",y.length,"/10)"]}),(0,a.Y)(h.$n,{size:"sm",priority:"primary",onClick:e=>{e.preventDefault(),console.log("Opening search modal..."),I(!1),F({postsOnly:!0,onSelectResult:async e=>{console.log("onSelectResult callback triggered!",e);let{result:t,onClose:n}=e;if(console.log("result",t),"post"===t.type){let e=(0,b.Gn4)(t.post.url);if(!e){console.log("Could not extract slug from URL:",t.post.url),n(),I(!0);return}console.log("Fetching post by slug:",e);let a=await (0,c.N7)({slug:e});if(!a){console.log("Could not fetch post for slug:",e),n(),I(!0);return}let l=a.id;console.log("Adding post:",l,a.title),!y.includes(l)&&y.length<10&&(Y(e=>[...e,l]),a.title&&w(e=>(0,r._)((0,i._)({},e),{[l]:a.title})))}n(),I(!0)},onClose:()=>{console.log("Search modal closed without selection"),I(!0)}})},disabled:y.length>=10,children:(0,a.Y)(v.EY,{translated:!0,children:"Add Post"})})]}),0===y.length?(0,a.Y)(v.EY.B3,{color:"secondary",children:(0,a.Y)(v.EY,{translated:!0,children:'No posts selected. Click "Add Post" to search and add posts.'})}):(0,a.Y)(m.I1,{gap:8,children:y.map((e,t)=>(0,a.FD)(m.Ye,{gap:12,padding:12,bg:"elevated",radius:"md",justifyContent:"space-between",alignItems:"center",children:[(0,a.Y)(v.EY.B3,{weight:"semibold",children:_[e]||"Post ID: ".concat(e)}),(0,a.FD)(m.Ye,{gap:8,children:[t>0&&(0,a.Y)(h.$n,{size:"sm",priority:"tertiary",onClick:()=>L(t,t-1),children:"↑"}),t<y.length-1&&(0,a.Y)(h.$n,{size:"sm",priority:"tertiary",onClick:()=>L(t,t+1),children:"↓"}),(0,a.Y)(h.$n,{size:"sm",priority:"tertiary",onClick:()=>{Y(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},children:(0,a.Y)(v.EY,{translated:!0,children:"Remove"})})]})]},e))})]})})}),(0,a.Y)(g.jl,{secondaryButton:(0,a.Y)(h.$n,{priority:"tertiary",onClick:D,children:(0,a.Y)(v.EY,{translated:!0,children:"Cancel"})}),primaryButton:(0,a.Y)(h.$n,{priority:"primary",onClick:x,loading:C,disabled:0===y.length,children:(0,a.Y)(v.EY,{translated:!0,children:"Save Featured Posts"})})})]})}var Y=n(97731);let _=e=>(0,a.Y)(Y.A,(0,r._)((0,i._)({},e),{name:"CommentIcon",svgParams:{height:20,width:14},children:(0,a.Y)("path",{d:"M7.47092 13.7982L7.32727 13.6656H7.13176H2.14118C1.22171 13.6656 0.5 12.944 0.5 12.0679V6.09766C0.5 5.22165 1.22171 4.5 2.14118 4.5H11.8588C12.7783 4.5 13.5 5.22165 13.5 6.09766V12.0679C13.5 12.944 12.7783 13.6656 11.8588 13.6656H10.5412H10.0412V14.1656V16.1657C10.0392 16.1649 10.0339 16.1625 10.0255 16.1565L7.47092 13.7982Z",stroke:"#999999"})}));var w=n(11587);function C(e){let{isOpen:t,onClose:n,onSave:i}=e,{iString:r}=(0,d.GO)(),[l,o]=(0,s.useState)(""),[c,u]=(0,s.useState)(""),[b,y]=(0,s.useState)(!1),{result:Y,isLoading:_,refetch:C}=(0,p.st)({pathname:"/api/v1/sponsorship/stats-config",auto:!1});(0,s.useEffect)(()=>{t?C():(o(""),u(""))},[t]),(0,s.useEffect)(()=>{Y&&(o(JSON.stringify(Y.config,null,2)),u(""))},[Y]);let k=e=>{try{return JSON.parse(e),u(""),!0}catch(e){return u("Invalid JSON: ".concat(e instanceof Error?e.message:String(e))),!1}},S=async()=>{if(k(l)){y(!0);try{let e=JSON.parse(l);if(!(await fetch("/api/v1/sponsorship/stats-config",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({value:e})})).ok)throw Error("Failed to save stats configuration");null==i||i(),n()}catch(t){console.error("Error saving stats config:",t);let e=t instanceof Error?t.message:String(t);e.includes("JSON")?u("Save failed: ".concat(e)):u("Failed to save configuration. Please try again.")}finally{y(!1)}}};return(0,a.FD)(g.aF,{isOpen:t,onClose:n,width:600,children:[(0,a.Y)(g.rQ,{title:r("Edit Sponsorship Stats"),showClose:!0,onClose:n}),(0,a.Y)(g.cw,{children:(0,a.FD)(m.I1,{gap:16,children:[(0,a.Y)(v.EY.B3,{color:"secondary",children:(0,a.Y)(v.EY,{translated:!0,children:"Edit the sponsorship statistics below as JSON. This data will be displayed on the sponsorship profile page."})}),_?(0,a.Y)(m.Ye,{justifyContent:"center",padding:20,children:(0,a.Y)(f.y$,{size:24})}):(0,a.FD)(m.I1,{gap:12,children:[(0,a.Y)(v.EY.B2,{weight:"semibold",children:(0,a.Y)(v.EY,{translated:!0,children:"Stats Configuration (JSON)"})}),(0,a.Y)(w.T,{value:l,onChange:e=>{var t;o(t=e.target.value),t.trim()?k(t):u("")},placeholder:r("Enter JSON configuration..."),style:{fontFamily:'ui-monospace, SFMono-Regular, "SF Mono", Menlo, Monaco, Consolas, monospace',fontSize:"14px"}}),c&&(0,a.Y)(v.EY.B4,{color:"error",children:c})]})]})}),(0,a.Y)(g.jl,{secondaryButton:(0,a.Y)(h.$n,{priority:"tertiary",onClick:n,children:(0,a.Y)(v.EY,{translated:!0,children:"Cancel"})}),primaryButton:(0,a.Y)(h.$n,{priority:"primary",onClick:S,loading:b,disabled:!!c||!l.trim()||_,children:(0,a.Y)(v.EY,{translated:!0,children:"Save Stats"})})})]})}var k=n(46271),S=n(89490),I=n(81203),F=n(94996),D=n(65842),T=n(36372),A=n(32848),E=n(49807);let N="statsContainer-HMgEbx",P=e=>{let{title:t,value:n,listItems:i}=e;return(0,a.FD)(m.I1,{className:"statsBox-esmhyw",gap:16,padding:16,radius:"md",border:"detail-themed",children:[(0,a.Y)(v.EY.Digit,{font:"pub-headings",color:"pub-primary-text",children:t}),i&&(0,a.Y)(S.az,{children:i.map(e=>(0,a.Y)(S.az,{className:"statsItem-zSdbEo",bg:"secondary",paddingX:6,paddingY:2,radius:"sm",children:(0,a.Y)(v.EY.Meta,{color:"pub-primary-text",children:e},e)}))}),n&&(0,a.Y)(v.EY.H4,{font:"pub-headings",color:"pub-primary-text",children:n})]})},x=e=>{let{product:t,onClick:n}=e;return(0,a.FD)(m.Ye,{className:"sponsorshipProductRow-cqWGcn",border:"detail-themed",padding:16,radius:"md",justifyContent:"space-between",alignItems:"start",onClick:n,style:{cursor:"pointer"},children:[(0,a.FD)(m.I1,{gap:4,children:[(0,a.Y)(v.EY.B3,{weight:"semibold",children:t.title}),(0,a.Y)(v.EY.B4,{children:t.description})]}),t.price&&(0,a.Y)(v.EY.B3,{weight:"bold",children:t.price})]})},L=e=>{let{isOpen:t,onClose:n,sponsorshipProducts:l,selectedProduct:o}=e,{iString:c}=(0,d.GO)(),u=(0,T.d)(),[p,b]=(0,s.useState)(!1),[y,Y]=(0,s.useState)({contactName:"",contactEmail:"",sponsorshipType:(null==o?void 0:o.title)||"",brandName:"",campaignDescription:""});(0,s.useEffect)(()=>{(null==o?void 0:o.title)&&Y(e=>(0,r._)((0,i._)({},e),{sponsorshipType:o.title}))},[o]);let _=(e,t)=>{Y(n=>(0,r._)((0,i._)({},n),{[e]:t}))},C=async()=>{if(!y.contactName||!y.contactEmail||!y.sponsorshipType||!y.brandName)return void u.popToast(()=>(0,a.Y)(T.y,{text:c("Please fill in all required fields")}));b(!0);try{if((await fetch("/api/v1/sponsorship/inquiry",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify((0,i._)({},y))})).ok)u.popToast(()=>(0,a.Y)(T.y,{text:c("Sponsorship inquiry sent successfully!")})),n(),Y({contactName:"",contactEmail:"",sponsorshipType:(null==o?void 0:o.title)||"",brandName:"",campaignDescription:""});else throw Error("Failed to send inquiry")}catch(e){u.popToast(()=>(0,a.Y)(T.y,{text:c("Failed to send inquiry. Please try again.")}))}finally{b(!1)}};return(0,a.FD)(g.aF,{isOpen:t,onClose:n,children:[(0,a.Y)(g.rQ,{title:c("Sponsorship Inquiry"),onClose:n}),(0,a.FD)(m.I1,{gap:16,padding:24,children:[(0,a.FD)(m.I1,{gap:8,children:[(0,a.Y)(v.EY.B4,{weight:"semibold",children:(0,a.Y)(v.EY,{translated:!0,children:"Contact Name"})}),(0,a.Y)(D.ks,{value:y.contactName,onChange:e=>_("contactName",e.target.value),placeholder:c("Enter your name")})]}),(0,a.FD)(m.I1,{gap:8,children:[(0,a.Y)(v.EY.B4,{weight:"semibold",children:(0,a.Y)(v.EY,{translated:!0,children:"Contact Email"})}),(0,a.Y)(D.ks,{type:"email",value:y.contactEmail,onChange:e=>_("contactEmail",e.target.value),placeholder:c("Enter your email")})]}),(0,a.FD)(m.I1,{gap:8,children:[(0,a.Y)(v.EY.B4,{weight:"semibold",children:(0,a.Y)(v.EY,{translated:!0,children:"Sponsorship Type"})}),(0,a.FD)(F.I,{value:y.sponsorshipType,onChange:e=>_("sponsorshipType",e.target.value),children:[(0,a.Y)("option",{value:"",disabled:!0,children:c("Select sponsorship type")}),l.map(e=>(0,a.Y)("option",{value:e.title,children:e.title},e.title))]})]}),(0,a.FD)(m.I1,{gap:8,children:[(0,a.Y)(v.EY.B4,{weight:"semibold",children:(0,a.Y)(v.EY,{translated:!0,children:"Brand Name"})}),(0,a.Y)(D.ks,{value:y.brandName,onChange:e=>_("brandName",e.target.value),placeholder:c("Enter your brand name")})]}),(0,a.FD)(m.I1,{gap:8,children:[(0,a.Y)(v.EY.B4,{weight:"semibold",children:(0,a.Y)(v.EY,{translated:!0,children:"Description of Campaign"})}),(0,a.Y)(w.T,{value:y.campaignDescription,onChange:e=>_("campaignDescription",e.target.value),placeholder:c("Describe your campaign and goals..."),rows:4})]})]}),(0,a.Y)(g.jl,{secondaryButton:(0,a.Y)(h.$n,{priority:"tertiary",onClick:n,disabled:p,children:(0,a.Y)(v.EY,{translated:!0,children:"Cancel"})}),primaryButton:(0,a.Y)(h.$n,{priority:"primary",onClick:C,disabled:p,children:p?(0,a.Y)(f.y$,{size:20}):(0,a.Y)(v.EY,{translated:!0,children:"Submit Inquiry"})})})]})},O=e=>{var t;let{post:n,pub:i}=e;return(0,a.FD)(m.I1,{className:"featuredPostContainer-DA7xo_",justifyContent:"space-between",alignItems:"center",as:"a",href:(0,E.wu9)(i,n),target:"_blank",rel:"noopener noreferrer",gap:4,children:[(0,a.FD)(m.I1,{className:"featuredPostPreview-Wv6neL",radius:"md",border:"detail-themed",overflow:"hidden",children:[(0,a.Y)("img",{className:"featuredPostImage-IfvJu6",src:(0,E.dJ9)(null!=(t=n.cover_image)?t:"",900,{crop:"fill",height:470}),alt:n.title}),(0,a.Y)(S.az,{paddingX:12,paddingY:12,children:(0,a.Y)(v.EY.B3,{as:"span",font:"display",weight:"semibold",color:"white",children:n.title})})]}),(0,a.FD)(m.Ye,{gap:16,children:[(0,a.FD)(m.Ye,{gap:4,alignItems:"center",children:[(0,a.Y)(l.A,{stroke:"#999999",size:16}),(0,a.Y)(v.EY.Meta,{color:"pub-secondary-text",font:"pub-headings",children:n.views||0})]}),(0,a.FD)(m.Ye,{gap:4,alignItems:"center",children:[(0,a.Y)(o.A,{stroke:"#999999",size:16}),(0,a.Y)(v.EY.Meta,{color:"pub-secondary-text",font:"pub-headings",children:n.reactions["❤"]||0})]}),(0,a.FD)(m.Ye,{gap:4,alignItems:"center",children:[(0,a.Y)(_,{width:16}),(0,a.Y)(v.EY.Meta,{color:"pub-secondary-text",font:"pub-headings",children:n.comment_count||0})]})]})]})},B=e=>{var t;let{pub:n}=e,{iString:i}=(0,d.GO)(),[r,l]=(0,s.useState)(!1),[o,c]=(0,s.useState)(!1),[u,g]=(0,s.useState)(!1),[b,Y]=(0,s.useState)(void 0),_=(0,k.Jd)(),{isAuthor:w}=(0,A.NL)(n.id),S=w||(null==_?void 0:_.is_global_admin),{result:F,isLoading:D,error:T,refetch:B}=(0,p.st)({pathname:"/api/v1/sponsorship/profile-data",auto:!0}),M=(null==F?void 0:F.posts)||[],R=null==F?void 0:F.stats;return(0,a.FD)("div",{className:"page typography signup-page",children:[(0,a.Y)("div",{className:"container",children:(0,a.FD)(m.I1,{gap:32,alignItems:"center",children:[(0,a.FD)(m.I1,{alignItems:"center",gap:24,children:[(0,a.Y)(I.Nq,{pub:n,size:64,bg:"transparent"}),(0,a.FD)(m.I1,{alignItems:"center",gap:8,children:[(0,a.Y)(v.EY.H2,{font:"pub-headings",color:"pub-primary-text",align:"center",children:n.name}),(0,a.Y)(v.EY.B3,{color:"pub-secondary-text",align:"center",children:(null==R?void 0:R.description)||i("Loading description...")})]})]}),(0,a.FD)(m.I1,{className:N,gap:24,padding:24,radius:"md",children:[(0,a.FD)(m.Ye,{justifyContent:"space-between",alignItems:"center",children:[(0,a.Y)(v.EY.B2,{weight:"semibold",font:"pub-headings",color:"pub-primary-text",children:(0,a.Y)(v.EY,{translated:!0,children:"Publication Stats"})}),S&&(0,a.Y)(h.$n,{size:"sm",priority:"tertiary",onClick:()=>c(!0),children:i("Edit Stats")})]}),(0,a.FD)(m.Ye,{wrap:"wrap",gap:24,children:[!!(null==R?void 0:R.subscribers)&&(0,a.Y)(P,{title:i("Subscribers"),value:R.subscribers.toLocaleString()}),!!(null==R?void 0:R.openRate)&&(0,a.Y)(P,{title:i("Open Rate"),value:"".concat(R.openRate,"%")}),!!(null==R?void 0:R.clickThroughRate)&&(0,a.Y)(P,{title:i("Click Rate"),value:"".concat(R.clickThroughRate,"%")}),!!(null==R?void 0:R.engagementRate)&&(0,a.Y)(P,{title:i("Engagement Rate"),value:"".concat(R.engagementRate,"%")}),!!(null==R?void 0:R.categories)&&R.categories.length>0&&(0,a.Y)(P,{title:i("Categories"),listItems:R.categories}),!!(null==R?void 0:R.topReaderLocations)&&R.topReaderLocations.length>0&&(0,a.Y)(P,{title:i("Top Reader Locations"),listItems:R.topReaderLocations})]})]}),(0,a.FD)(m.I1,{className:N,gap:24,padding:24,radius:"md",children:[(0,a.FD)(m.Ye,{justifyContent:"space-between",alignItems:"center",children:[(0,a.Y)(v.EY.B2,{weight:"semibold",font:"pub-headings",color:"pub-primary-text",children:(0,a.Y)(v.EY,{translated:!0,children:"Featured Posts"})}),S&&(0,a.Y)(h.$n,{size:"sm",priority:"tertiary",onClick:()=>l(!0),children:i("Manage")})]}),(0,a.Y)(m.Ye,{wrap:"wrap",justifyContent:"space-between",children:D?(0,a.Y)(m.Ye,{justifyContent:"center",padding:32,children:(0,a.Y)(f.y$,{size:24})}):T?(0,a.Y)(v.EY.B3,{color:"pub-secondary-text",align:"center",children:(0,a.Y)(v.EY,{translated:!0,children:"Unable to load featured posts"})}):M.length>0?M.map(e=>(0,a.Y)(O,{post:e,pub:n},e.id)):(0,a.Y)(v.EY.B3,{color:"pub-secondary-text",align:"center",children:(0,a.Y)(v.EY,{translated:!0,children:"No featured posts available"})})})]}),(null==F||null==(t=F.stats)?void 0:t.partnerLogos)&&F.stats.partnerLogos.length>0&&(0,a.FD)(m.I1,{className:N,gap:24,padding:24,radius:"md",children:[(0,a.Y)(v.EY.B2,{weight:"semibold",font:"pub-headings",color:"pub-primary-text",children:(0,a.Y)(v.EY,{translated:!0,children:"Selected Brand Partners"})}),(0,a.Y)(m.Ye,{gap:24,wrap:"wrap",children:F.stats.partnerLogos.map(e=>(0,a.Y)("img",{className:"partnerLogo-BH1k1a",src:(0,E.dJ9)(e,300,{})},e))})]}),(null==R?void 0:R.sponsorshipProducts)&&R.sponsorshipProducts.length>0&&(0,a.FD)(m.I1,{className:N,gap:24,padding:24,radius:"md",children:[(0,a.Y)(v.EY.B2,{weight:"semibold",font:"pub-headings",color:"pub-primary-text",children:(0,a.Y)(v.EY,{translated:!0,children:"Available sponsorships"})}),R.sponsorshipProducts.map((e,t)=>(0,a.Y)(x,{product:e,onClick:()=>{Y(e),g(!0)}},t))]})]})}),(0,a.Y)(y,{pub:n,isOpen:r,onClose:()=>l(!1),onSave:()=>{B()}}),(0,a.Y)(C,{pub:n,isOpen:o,onClose:()=>c(!1),onSave:()=>{B()}}),(0,a.Y)(L,{isOpen:u,onClose:()=>{g(!1),Y(void 0)},sponsorshipProducts:(null==R?void 0:R.sponsorshipProducts)||[],selectedProduct:b,pub:n})]})}},52381:function(e,t,n){n.d(t,{k:()=>m});var i=n(4006),r=n(17402),a=n(13950),l=n(63446),o=n(72812),s=n(4317),c=n(15894),d=n(94729),u=n(68349),p=n(76977),h=n(92019);let m=e=>{let{token:t}=e,[n,m]=(0,r.useState)(""),[g,f]=(0,r.useState)(""),[v,b]=(0,r.useState)(null),[y,Y]=(0,r.useState)(!1);if(!t)return(0,i.Y)(p.Ye,{className:h.A.halfAndHalf,justifyContent:"center",children:(0,i.FD)(p.Ye,{className:h.A.halfAndHalfInner,children:[(0,i.Y)(p.I1,{className:h.A.leftContent,gap:40,children:(0,i.FD)(p.I1,{gap:16,className:h.A.header,children:[(0,i.Y)(c.T,{preset:"h3-compressed",className:h.A.headerTitle,children:"Invalid Reset Link"}),(0,i.Y)(c.T,{preset:"body",children:"This password reset link is invalid or has expired. Please request a new one."})]})}),(0,i.Y)(s.g,{})]})});let _=async e=>{if(e.preventDefault(),b(null),n!==g)return void b("Passwords do not match");if(n.length<8)return void b("Password must be at least 8 characters");if(n.length>128)return void b("Password must be 128 characters or less");Y(!0);try{await (0,d.x6)("/api/v1/reset",{method:"POST",json:{password:n,token:t}}),(0,u.V2)("/subscribe?isSignInAttempt=true",{local_navigation:!1})}catch(e){if(Y(!1),e&&"object"==typeof e&&"response"in e){var i,r,a,l;b((null==(l=e.response)||null==(a=l.body)||null==(r=a.errors)||null==(i=r[0])?void 0:i.msg)||"An error occurred. Please try again.")}else b("An error occurred. Please try again.")}};return(0,i.Y)(a.DH,{children:(0,i.Y)(p.Ye,{className:h.A.halfAndHalf,justifyContent:"center",children:(0,i.FD)(p.Ye,{className:h.A.halfAndHalfInner,children:[(0,i.FD)(p.I1,{className:h.A.leftContent,gap:40,children:[(0,i.FD)(p.I1,{gap:16,className:h.A.header,children:[(0,i.Y)(c.T,{preset:"h3-compressed",children:"Set a new password"}),(0,i.Y)(c.T,{preset:"body",children:"Create and confirm a new password to continue."})]}),(0,i.Y)(p.I1,{gap:16,className:h.A.form,children:(0,i.Y)("form",{onSubmit:_,children:(0,i.FD)(p.I1,{gap:8,className:h.A.inputWrap,children:[v&&(0,i.Y)(c.T,{preset:"body",style:{color:"var(--color-accent-themed)"},children:v}),(0,i.Y)(o.B,{type:"password",placeholder:"ENTER NEW PASSWORD",value:n,onChange:e=>m(e.target.value),required:!0,autoFocus:!0,disabled:y,className:"".concat(h.A.input," ").concat(h.A.inputLeftAligned)}),(0,i.Y)("hr",{className:h.A.hrSpaced}),(0,i.Y)(o.B,{type:"password",placeholder:"CONFIRM NEW PASSWORD",value:g,onChange:e=>f(e.target.value),required:!0,disabled:y,className:"".concat(h.A.input," ").concat(h.A.inputLeftAligned)}),(0,i.Y)(l.v,{type:"submit",variant:"primary",size:"lg",disabled:y||!n||!g,className:h.A.submitButton,children:y?"Saving...":"Continue"})]})})})]}),(0,i.Y)(s.g,{})]})})})}},19568:function(e,t,n){n.d(t,{S:()=>T});var i=n(69277),r=n(70408),a=n(4006),l=n(32485),o=n.n(l),s=n(17402),c=n(13950),d=n(84605),u=n(86500),p=n(12501),h=n(35369),m=n(60322),g=n(49045),f=n(76977),v=n(95477),b=n(63136),y=n(11587),Y=n(65842),_=n(21398),w=n(39318),C=n(49807),k=n(57324);let S=e=>["checkbox","checkbox_freeform","radio","radio_freeform"].includes(e||""),I=e=>["checkbox_freeform","radio_freeform"].includes(e||""),F=e=>{let{question:t,responseData:n,onChange:l,disabled:o=!1,countries:c}=e,{iString:u}=(0,d.GO)(),p=(0,s.useMemo)(()=>{if("country"===t.type&&n.value&&c){let e=String(n.value).split(",")[0],t=c.find(t=>t.countryShortCode===e);return t?{value:t.countryShortCode,label:t.countryName,regions:t.regions}:null}return null},[n.value]),h=(0,s.useMemo)(()=>{if("country"===t.type&&(null==p?void 0:p.regions)&&c&&n.value){let e=String(n.value).split(",")[1],t=p.regions.find(t=>t.shortCode===e);return t?{value:t.shortCode,label:t.name}:null}return null},[p,n.value]);return(0,a.FD)(f.I1,{gap:16,children:[(0,a.FD)(b.EY.H4,{children:[t.displayLabel,t.is_required&&(0,a.Y)(b.EY.H4,{as:"span",color:"error",children:"*"})]}),"text"===t.type&&(0,a.Y)(y.T,{disabled:o,placeholder:u("Type here"),value:String(n.value||""),onChange:e=>{n.value=e.currentTarget.value,l(n)}}),"number"===t.type&&(0,a.Y)(Y.ks,{disabled:o,placeholder:u("Type number value here"),value:Number.isNaN(Number(n.value))?"":n.value,onChange:e=>{n.value=Number(e.currentTarget.value.replace(/[^\d]/g,""))||0,l(n)}}),"country"===t.type&&(0,a.FD)(f.I1,{gap:24,children:[(0,a.Y)(g.Z,{options:(null==c?void 0:c.map(e=>({label:e.countryName,value:e.countryShortCode})))||[],value:(null==p?void 0:p.value)||null,onChange:e=>{e&&l((0,r._)((0,i._)({},n),{value:e}))},placeholder:u("Select or search for a country...")}),n.value&&(null==p?void 0:p.regions)&&(0,a.Y)(g.Z,{options:p.regions.map(e=>({label:e.name,value:e.shortCode})),value:(null==h?void 0:h.value)||null,onChange:e=>{e&&l((0,r._)((0,i._)({},n),{value:"".concat(String(n.value).split(",")[0],",").concat(e)}))},placeholder:u("Select or search for a state, province, or region...")})]}),S(t.type)&&t.options&&t.options.map(e=>(0,a.FD)(f.Ye,{as:"label",gap:16,children:[("checkbox"===t.type||"checkbox_freeform"===t.type)&&(0,a.Y)(m.S,{disabled:o,name:"".concat(t.id,"check"),checked:n.options.indexOf(String(e.id))>-1,onChange:t=>{let a=n.options.filter(t=>t!==String(e.id));t&&a.push(String(e.id)),l((0,r._)((0,i._)({},n),{options:a}))}}),("radio"===t.type||"radio_freeform"===t.type)&&(0,a.Y)(v.s,{disabled:o,value:String(e.id),name:"".concat(t.id,"check"),checked:n.options.indexOf(String(e.id))>-1,onClick:t=>{let n=[];t.target.checked&&n.push(String(e.id)),l({value:"",options:n})}}),(0,a.Y)(b.EY.B3,{children:e.label})]})),I(t.type)&&(0,a.FD)(f.Ye,{as:"label",gap:16,alignItems:"center",children:[("checkbox"===t.type||"checkbox_freeform"===t.type)&&(0,a.Y)(m.S,{disabled:o,name:"".concat(t.id,"check"),checked:String(n.value).length>0,onChange:e=>{e?l((0,r._)((0,i._)({},n),{value:" "})):l((0,r._)((0,i._)({},n),{value:""}))}}),("radio"===t.type||"radio_freeform"===t.type)&&(0,a.Y)(v.s,{disabled:o,value:"text",name:"".concat(t.id,"check"),checked:String(n.value).length>0,onClick:()=>{l({options:[],value:" "})}}),(0,a.Y)(Y.ks,{disabled:o,placeholder:u("What is your gender?"===t.label?"Prefer to self describe":"Other..."),value:String(n.value||""),onChange:e=>{n.value=e.currentTarget.value,n.value.length>0&&("radio"===t.type||"radio_freeform"===t.type)&&(n.options=[]),l(n)}})]})]})},D=e=>{let{surveyId:t,user:l,pub:u,token:m=""}=e,{iString:g}=(0,d.GO)(),[v,y]=(0,s.useState)({}),{result:Y,isLoading:D,refetch:T}=(0,p.st)({pathname:"/api/v1/survey/".concat(t),auto:!0,query:{token:m||void 0}});(0,s.useEffect)(()=>{if(!D&&Y&&!A){var e;(null==(e=Y.questions)?void 0:e.some(e=>"country"===e.type))&&E()}},[Y,D]);let{result:A,fetch:E}=(0,_.vZ)({module:"country-region-data/data.json",onRequest:()=>n.e("58623").then(n.t.bind(n,53314,19)),fetchImmediately:!1}),N=(0,p.st)({method:"post",pathname:"/api/v1/survey/".concat(t,"/responses"),auto:!1,json:{responses:Object.keys(v).map(e=>({survey_question_id:e,data:v[e]}))},query:{token:m||void 0}}),P=(0,s.useCallback)(async()=>{N.isLoading||(await N.refetch(),await T())},[N]);if(!Y&&!D)return(0,a.Y)(f.I1,{paddingTop:48,gap:48,children:(0,a.Y)(b.EY.H1,{translated:!0,children:"There was an error fetching this survey."})});if(!Y)return(0,a.Y)("div",{});if(Y.hasCurrentUserResponded)return(0,a.FD)(f.I1,{paddingTop:48,gap:24,alignItems:"center",justifyContent:"center",children:[(0,a.Y)(b.EY.H1,{translated:!0,children:"Thank you!"}),(0,a.Y)(b.EY.B3,{translated:!0,children:"Your response has been recorded."})]});let{questions:x=[],title:L}=Y,O=!!l,B=l&&l.is_free_subscribed,M=O&&B,R=M&&x.reduce((e,t)=>{let n=!0;if(t.is_required){let e=v[t.id];if("text"===t.type)n=String((null==e?void 0:e.value)||"").length>0;else if("number"===t.type)n=!Number.isNaN(Number(null==e?void 0:e.value));else if("country"===t.type)n=2===String((null==e?void 0:e.value)||"").split(",").length;else if(S(t.type)){let i=e&&Array.isArray(null==e?void 0:e.options)?e.options:[],r=String((null==e?void 0:e.value)||"");n=I(t.type)?i.length>0||r.length>0:i.length>0}}return e&&n},!0);return(0,a.Y)(c.DH,{children:(0,a.FD)(f.I1,{paddingTop:48,gap:48,children:[(0,a.Y)(b.EY.H1,{color:"pub-primary-text",children:L}),!O&&(0,a.Y)(f.Ye,{alignItems:"center",justifyContent:"center",borderBottom:"detail",paddingBottom:48,children:(0,a.FD)(f.I1,{border:"detail",padding:24,gap:24,sizing:"border-box",radius:"md",children:[(0,a.FD)(b.EY.H4,{translated:!0,children:["Sign in to answer this survey from ",I18N.p(u.name)]}),(0,a.Y)(h.$n,{localNavigation:!1,priority:"primary",href:(0,w.a7q)({for_pub:u.subdomain,redirect:window.location.href}),children:g("Sign in")})]})}),O&&!B&&(0,a.Y)(f.Ye,{alignItems:"center",justifyContent:"center",borderBottom:"detail",paddingBottom:48,children:(0,a.FD)(f.I1,{border:"detail",padding:24,gap:24,sizing:"border-box",radius:"md",children:[(0,a.FD)(b.EY.H4,{translated:!0,children:["Subscribe to ",I18N.p(u.name)," to answer this survey."]}),(0,a.Y)(h.$n,{localNavigation:!1,priority:"primary",href:(0,C.eV6)(u,{params:{next:window.location.href,email:l.email,just_signed_up:!0,autoSubmit:!0,utm_source:k.VU.substack,utm_medium:k.Jn.email,utm_content:k.fL.readerSurveySubscribePrompt}}),children:g("Subscribe")})]})}),(M||!u.invite_only)&&(0,a.FD)(f.I1,{gap:48,className:o()({"questionListDisabled-_qB8wZ":!M}),paddingBottom:48,children:[x.map(e=>{let t=v[e.id]?v[e.id]:{options:[],value:""};return(0,a.Y)(F,{question:e,responseData:t,disabled:!M,countries:null==A?void 0:A.default,onChange:t=>{y((0,r._)((0,i._)({},v),{[e.id]:t}))}},e.id)}),(0,a.Y)(h.$n,{disabled:!R,priority:"primary",onClick:P,children:g("Submit")})]})]})})},T=e=>{let{surveyId:t,user:n,pub:i,token:r=""}=e;return(0,s.useEffect)(()=>{(0,u.u4)(u.qY.READER_SURVEY_SEEN,{surveyId:t,isLoggedIn:!!n,isSubscribed:null==n?void 0:n.is_free_subscribed})},[t]),(0,a.Y)("div",{className:"container",children:(0,a.Y)(D,{surveyId:t,user:n,pub:i,token:r})})}},48825:function(e,t,n){n.d(t,{A:()=>g});var i=n(4006),r=n(13950),a=n(72987),l=n(12501),o=n(2058),s=n(10939),c=n(68410),d=n(93800),u=n(6998),p=n(12592),h=n(56458),m=n(4016);function g(e){var t,n,g,f;let{slug:v,pub:b,user:y,tagPagePreloads:Y,utm:_}=e,{isTablet:w}=(0,c.sM)(),C=(0,l.st)({pathname:"/api/v1/publication/post-tag/slug/".concat(v),auto:(null==Y?void 0:Y.slug)!==v,initialResult:(null==Y?void 0:Y.slug)===v&&null!=(g=Y.postTag)?g:void 0,deps:[Y,v]}),k=(0,m.S2)({pub:b});return(0,m.lu)({pub:b})?(0,i.Y)(i.FK,{children:C.isLoading?(0,i.Y)(p.c,{children:(0,i.Y)("p",{className:"main-loader",children:"Loading..."})}):(0,i.Y)(a.N,{isPodcast:!1,isTagPage:!0,newPosts:(null==Y?void 0:Y.slug)===v?Y.posts:void 0,pub:b,section:null,tag:null!=(f=C.result)?f:void 0,user:y,utm:_})}):(0,i.Y)(p.c,{columns:k?4:2,children:C.isLoading?(0,i.Y)("p",{className:"main-loader"}):(0,i.Y)(i.FK,{children:(0,i.FD)(r.DH,{children:[(0,i.Y)(u.X,{name:(null==(t=C.result)?void 0:t.name)||"Page not found",description:null,logoUrl:null,pub:b}),(0,i.Y)(s.r,{}),(0,i.Y)(o.M,{user:y,pub:b,renderTabs:k?()=>null:void 0,renderLoading:()=>null,sort:"new",postTagId:null==(n=C.result)?void 0:n.id,newPosts:(null==Y?void 0:Y.slug)===v?Y.posts:null,source:"tag-archive",utm:_,children:e=>{let{posts:t,linkToComments:n,onClickPost:r}=e;return(0,i.Y)(d.m,{hideImages:(0,h.$P)({pub:b}),hideHorizontalDividers:k,linkToComments:n,posts:t,variant:k?w?"three-column-grid":"four-column-grid":"two-column-list",onClickPost:r})}})]})})})}},86109:function(e,t,n){n.d(t,{S:()=>eU});var i=n(69277),r=n(4006),a=n(35970),l=n.n(a),o=n(38970),s=n.n(o),c=n(35880),d=n.n(c),u=n(48635),p=n(17402),h=n(79909),m=n(13950),g=n(40075),f=n(12501),v=n(68410),b=n(24782),y=n(28528),Y=n(85965),_=n(12592),w=n(65892),C=n(15734),k=n.n(C),S=n(70408),I=n(15871),F=n(43627),D=n(74979),T=n(83673),A=n.n(T),E=n(33031),N=n.n(E),P=n(48697),x=n(35369),L=n(76977),O=n(25318),B=n(94996),M=n(63136);function R(e){let{pub:t,selected:n,onChangeSelected:i,label:a="Sections and tags"}=e,{result:l,isLoading:o}=(0,f.st)({pathname:"/api/v1/publication/post-tag",auto:!0,deps:[t.id]}),s=(0,I.FR)((0,I.MS)(I.AN,{activationConstraint:{distance:5}})),c=(0,p.useMemo)(()=>l?[...N()(t.sections,e=>e.name.toLowerCase()).map(e=>({value:"section:".concat(e.id),label:e.name})),...N()(l,e=>e.name.toLowerCase()).map(e=>({value:"tag:".concat(e.id),label:e.name}))]:null,[t.sections,l]),d=(0,p.useMemo)(()=>{let e=n.map(e=>{if("section"===e.post_source){let n=t.sections.find(t=>t.id===e.section_id);return n?{value:"section:".concat(n.id),label:n.name}:null}let n=null==l?void 0:l.find(t=>t.id===e.post_tag_id);return n?{value:"tag:".concat(n.id),label:n.name}:null});return A()(e)},[n,t.sections,l]),u=(0,p.useMemo)(()=>{var e;let t=new Set(d.map(e=>e.value));return null!=(e=null==c?void 0:c.filter(e=>!t.has(e.value)))?e:null},[c,d]),h=e=>{let t=d.findIndex(t=>t.value===e);if(-1===t)return;let r=[...n];r.splice(t,1),i(r)};return o?(0,r.Y)("div",{children:(0,r.Y)(M.EY.B4,{color:"secondary",children:"Loading..."})}):(0,r.FD)(L.I1,{gap:16,children:[(0,r.Y)(O.D,{label:a,children:(0,r.Y)(L.I1,{gap:8,children:d.length?(0,r.Y)(I.Mp,{collisionDetection:I.fp,sensors:s,onDragEnd:e=>{let{active:t,over:r}=e;if(!r||t.id===r.id)return;let a=d.findIndex(e=>e.value===t.id),l=d.findIndex(e=>e.value===r.id);-1===a||-1===l||i((0,F.be)(n,a,l))},children:(0,r.Y)(F.gB,{items:d.map(e=>e.value),strategy:F.kL,children:d.map(e=>(0,r.Y)(U,{id:e.value,children:(0,r.Y)(j,{label:e.label,value:e.value,onRemove:h})},e.value))})}):(0,r.Y)(M.EY.B3,{color:"pub-secondary-text",children:"No sections or tags selected"})})}),(0,r.Y)(O.D,{label:"Add section or tag",children:(0,r.FD)(B.I,{value:"",onChange:e=>{(e=>{if(!e)return;let[t,r]=e.split(":");("section"!==t||r)&&("tag"!==t||r)&&i([...n,"section"===t?{post_source:"section",section_id:parseInt(r),post_tag_id:null}:{post_source:"tag",section_id:null,post_tag_id:r}])})(e.target.value)},children:[(0,r.Y)(B.K,{children:"Select section or tag"}),u&&(0,r.FD)(r.FK,{children:[u.filter(e=>e.value.startsWith("section:")).map(e=>(0,r.Y)("option",{value:e.value,children:e.label})),u.filter(e=>e.value.startsWith("tag:")).map(e=>(0,r.Y)("option",{value:e.value,children:e.label}))]})]})})]})}function U(e){let{id:t,children:n}=e,{attributes:a,isDragging:l,listeners:o,setNodeRef:s,transform:c,transition:d}=(0,F.gl)({id:t}),u={transform:D.Ks.Translate.toString(c),transition:d,zIndex:+!!l,cursor:l?"grabbing":"grab"};return(0,r.Y)("div",(0,S._)((0,i._)({ref:s},a,o),{role:"button",style:u,children:n}))}function j(e){let{value:t,label:n,onRemove:i}=e;return(0,r.FD)(L.Ye,{alignItems:"center",bg:"white",border:"detail-themed",justifyContent:"space-between",paddingLeft:12,paddingRight:8,paddingY:8,radius:"sm",children:[(0,r.Y)(M.EY.B4,{weight:"semibold",children:n}),(0,r.Y)(x.K0,{size:"xs",onClick:()=>i(t),children:(0,r.Y)(P.A,{size:14})})]})}var z=n(16993);let H=e=>{let{pub:t,sources:n,user:i}=e,[a,l]=(0,p.useState)(!1);return i.is_admin?(0,r.FD)(r.FK,{children:[(0,r.Y)(x.K0,{onClick:()=>l(!0),children:(0,r.Y)(w.A,{size:16})}),a&&(0,r.Y)(W,{initialSources:n,isOpen:a,pub:t,onClose:()=>l(!1)})]}):null},W=e=>{let{isOpen:t,pub:n,initialSources:i,onClose:a}=e,[l,o]=(0,p.useState)(i),[s,c]=(0,p.useState)(!1),d=async()=>{c(!0);let e=await k().put("/watch/config").send({value:{sources:l}});200!==e.status?console.error("Failed to save video page options:",e.body):(c(!1),window.location.reload())};return(0,r.FD)(z.aF,{isOpen:t,onClose:a,children:[(0,r.Y)(z.rQ,{showClose:!0,title:"Update Sections/Tags",onClose:a}),(0,r.Y)(z.cw,{children:(0,r.FD)(L.I1,{gap:24,children:[(0,r.Y)(R,{label:"Sections and tags",pub:n,selected:l,onChangeSelected:e=>{o(e)}}),(0,r.Y)(x.$n,{disabled:s,onClick:d,children:"Save"})]})})]})};var V=n(6632),K=n(43241),q=n(23623),G=n(98002),J=n(38305),$=n(27437),Z=n(24078),Q=n(22057),X=n(16291);let ee=e=>{let{post:t,hideAvatars:n}=e;return(0,r.FD)(L.Ye,{alignItems:"center",gap:16,children:[!n&&(0,r.Y)(Q.Z,{max:4,renderAvatar:e=>(0,r.Y)(Z.tp,(0,S._)((0,i._)({},e),{noBase:!1})),size:36,users:t.publishedBylines}),(0,r.FD)(L.Ye,{alignItems:"baseline",gap:2,children:[(0,r.Y)(M.EY.Meta,{color:"primary",nowrap:!0,children:(0,X.A)(t.post_date).locale("en").format("MMM DD")}),(0,r.Y)(M.EY.B3,{color:"primary",children:"∙"}),(0,r.Y)(M.EY.Meta,{color:"primary",children:(0,r.Y)(J.K,{array:t.publishedBylines,formatter:e=>(0,r.Y)($.ProfileHoverCard,{disabled:!1,subject:e,utmSource:"byline",trigger:(0,r.Y)(M.EY,{as:"a",decoration:"hover-underline",children:e.name})}),limit:4})})]})]})};var et=n(17096),en=n(56878),ei=n(93564),er=n(49807),ea=n(82776),el=n(57324);let eo=e=>{let{post:t,pub:n,user:i,post_reaction_token:a}=e,[l,o]=(0,p.useState)(!1);if(!l){var s;return(0,r.FD)(x.$n,{priority:"secondary",onClick:()=>o(!0),children:["Show ",(0,ea.pluralize)(null!=(s=t.comment_count)?s:0,"comment",{zero_fallback:"comments"})]})}return(0,r.FD)(L.I1,{gap:16,children:[(0,r.Y)(x.$n,{priority:"secondary",onClick:()=>o(!1),children:"Hide comments"}),(0,r.Y)(es,{post:t,post_reaction_token:a,pub:n,user:i})]})},es=e=>{let{post:t,pub:n,user:a,post_reaction_token:l}=e,[o,s]=(0,p.useState)([]),[c,d]=(0,p.useState)(!1),[u,h]=(0,p.useState)(t.default_comment_sort||n.default_comment_sort||"best_first"),m=(0,p.useRef)(!1),g=(0,p.useCallback)(async()=>{if(!m.current){m.current=!0,d(!0);try{let e=await k().get("/api/v1/post/".concat(t.id,"/comments")).query({token:l||"",all_comments:!0,sort:u});e.body.comments&&s(e.body.comments)}catch(e){console.error("Failed to load comments:",e)}finally{d(!1),m.current=!1}}},[t.id,l,u]);(0,p.useEffect)(()=>{g()},[g]);let f=n.community_enabled&&"none"!==t.write_comment_permissions;return f&&!(0,ea.canSeeComments)(a,t)?(0,r.FD)(L.I1,{alignItems:"center",gap:16,paddingTop:16,children:[(0,r.Y)(M.EY.B3,{align:"center",color:"primary",children:"Comments on this video are for paid subscribers only."}),(0,r.Y)(x.vx,{href:(0,er.eV6)(n,{addBase:!0,params:{utm_source:el.VU.videosPage,next:window.location.href}}),priority:"primary-mono",children:(null==a?void 0:a.is_free_subscribed)?"Upgrade now":"Subscribe now"})]}):(0,r.FD)(L.I1,{gap:16,children:[(0,r.Y)(ei.o6,{comments:o,handleSort:e=>{c||(h(e),g())},post:t,publication:n,sort:u}),f&&(0,r.Y)(en.g,{post:t,pub:n,token:l,user:a,onSuccess:e=>{s([e,...o])}}),c?(0,r.Y)(M.EY.B3,{color:"secondary",children:"Loading comments..."}):o.length>0?(0,r.Y)(et.Wh,{comments:o,depth:0,pageSize:et.yQ,post:t,pub:n,reaction_token:l,retainUserCollapseState:!0,user:a,onChange:e=>{let t=n=>n.map(n=>n.id===e.id?e:n.children?(0,S._)((0,i._)({},n),{children:t(n.children)}):n);s(t(o))}}):(0,r.Y)(M.EY.B3,{color:"primary",children:"No comments yet, be the first to comment."})]})};var ec=n(32485),ed=n.n(ec),eu=n(23345),ep=n(54687),eh=n(15977),em=n(72170),eg=n(41935),ef=n(33460);let ev="container-VAP7_O",eb=e=>{var t;let{post:n,pub:i,user:a,hideComments:l,hideReadMore:o,onToggleComments:s}=e,{modifiedPosts:c,onChangePost:d}=(0,y.np)(),p=null!=(t=c[n.id])?t:n;return(0,r.FD)(L.Ye,{alignItems:"center",gap:8,children:[(0,r.Y)(ey,{post:p,pub:i,user:a,onChange:d}),!l&&(0,r.Y)(eY,{post:p,onClick:s}),(0,r.Y)(e_,{post:p,pub:i,onChange:d}),(0,r.Y)(ew,{post:p,pub:i,user:a}),!o&&(0,r.Y)(x.vx,{href:p.canonical_url,priority:"secondary-outline",rounded:!0,size:"sm",trailing:(0,r.Y)(u.A,{size:16}),children:"Read more"})]})},ey=e=>{var t;let{post:n,pub:i,user:a,onChange:l}=e,o=null!=(t=n.reactions["❤"])?t:0;return(0,r.Y)(eg.Z4,{isStatic:!1,post:n,pub:i,style:"button",user:a,onChange:l,children:e=>{let{isLiked:t,handleLike:n}=e;return(0,r.Y)(x.$n,{className:ed()({"likedButton-wcNuvL":t}),leading:(0,r.Y)(eu.A,{className:ed()({"likedHeart-YgbVH4":t}),size:16}),priority:"secondary-outline",rounded:!0,size:"sm",onClick:n,children:o>0?o:""})}})},eY=e=>{let{post:t,onClick:n}=e;return(0,r.Y)(x.$n,{leading:(0,r.Y)(ep.A,{size:16}),priority:"secondary-outline",rounded:!0,size:"sm",onClick:n,children:t.comment_count>0?t.comment_count:""})},e_=e=>{let{post:t,pub:n,onChange:i}=e;return(0,r.Y)(eg.sk,{isStatic:!1,post:t,pub:n,renderTrigger:e=>{let{isRestacked:t,isDisabled:n,restacks:i,onClick:a}=e;return(0,r.Y)(x.$n,{disabled:n,leading:(0,r.Y)(eh.A,{className:ed()({"hasRestacked-aM4l_G":t}),size:16}),priority:"secondary-outline",rounded:!0,size:"sm",onClick:a,children:i>0?i:""})},style:"button",onChange:i})},ew=e=>{let{post:t,pub:n,user:i}=e;return(0,r.Y)(ef.$8,{post:t,pub:n,trigger:(0,r.Y)(x.$n,{leading:(0,r.Y)(em.A,{size:16}),priority:"secondary-outline",rounded:!0,size:"sm",children:""}),user:i})};var eC=n(74762);function ek(e){let{isActive:t,durationSeconds:n,onElapsed:i}=e,[r,a]=(0,p.useState)(n),l=(0,p.useRef)(null),o=(0,p.useRef)(!1),s=(0,p.useCallback)(()=>{o.current||(o.current=!0,null!==l.current&&(window.clearInterval(l.current),l.current=null),i())},[i]);return(0,p.useEffect)(()=>{if(!t){null!==l.current&&(window.clearInterval(l.current),l.current=null),o.current=!1;return}a(n),o.current=!1;let e=window.setInterval(()=>{a(e=>Math.max(0,e-1))},1e3);return l.current=e,()=>{window.clearInterval(e),l.current=null}},[t,n]),(0,p.useEffect)(()=>{r<=0&&s()},[r,s]),{secondsLeft:r,triggerNow:s}}let eS=e=>{let{children:t}=e,[n,i]=(0,p.useState)(!1);return(0,p.useEffect)(()=>{setTimeout(()=>{i(!0)},10)},[]),(0,r.Y)(L.I1,{alignItems:"center",className:ed()("container-Fv_hVp","container--animated-vagNJl",{"container--animated-in-jn7ZQU":n}),inset:0,justifyContent:"center",position:"absolute",children:t})};var eI=n(69706);let eF="button-aEg0kT",eD=e=>{let{nextPost:t,onClickPost:n,onClose:i}=e,{secondsLeft:a,triggerNow:l}=ek({isActive:!0,durationSeconds:10,onElapsed:(0,p.useCallback)(()=>{n({post:t})},[n,t])});return(0,r.Y)(eS,{children:(0,r.FD)(L.I1,{gap:12,style:{maxWidth:380},children:[(0,r.FD)(M.EY.Meta,{color:"secondary",children:["Up next in"," ",(0,r.Y)(M.EY.Meta,{as:"span",color:"primary",children:a})]}),(0,r.Y)("div",{onClick:l,children:(0,r.Y)(eC.t,{className:"coverImage-cT2VSY",hideTimestampIcon:!0,imageAspectRatio:eI.qr,imageWidth:380,isBelowTheFold:!0,playButtonSize:40,post:t})}),(0,r.Y)(M.EY.B3,{color:"primary",weight:"semibold",children:t.title}),(0,r.FD)(L.Ye,{gap:8,children:[(0,r.Y)(x.$n,{className:eF,priority:"secondary",onClick:i,children:"Cancel"}),(0,r.Y)(x.$n,{className:eF,priority:"primary-mono",onClick:l,children:"Play now"})]})]})})};var eT=n(67078),eA=n(68349),eE=n(39318);let eN=e=>{let{nextPost:t,post:n,pub:i,user:a,onClickPost:l,onRestart:o}=e,[s,c]=(0,p.useState)(!1),{secondsLeft:d,triggerNow:u}=ek({isActive:!s,durationSeconds:10,onElapsed:(0,p.useCallback)(()=>{t&&l({post:t})},[l,t])}),h=(0,p.useCallback)(()=>{(0,eA.V2)((0,eE.my9)(i,{simple:!0,next:document.location.href,utm_source:el.VU.videosPage,utm_medium:el.Jn.web,utm_content:n.id}),{local_navigation:!1})},[]);return(0,r.FD)(eS,{children:[(0,r.FD)(L.I1,{gap:16,style:{maxWidth:300},children:[(0,r.FD)(L.I1,{gap:4,children:[(0,r.FD)(L.Ye,{alignItems:"center",color:"primary",gap:6,justifyContent:"center",children:[(0,r.Y)(eT.A,{size:16}),(0,r.Y)(M.EY.B2,{color:"primary",textAlign:"center",children:"Paid"})]}),(0,r.Y)(M.EY.B3,{color:"secondary",textAlign:"center",children:"Subscribe to watch the full episode."})]}),(0,r.FD)(L.Ye,{gap:8,children:[o&&(0,r.Y)(x.$n,{flex:"fill",priority:"secondary",onClick:o,children:"Replay"}),(0,r.FD)(x.$n,{flex:"fill",priority:"primary-mono",onClick:h,children:[(null==a?void 0:a.is_free_subscribed)?"Upgrade":"Subscribe"," to watch"]})]})]}),!s&&t&&(0,r.Y)(eP,{nextPost:t,secondsLeft:d,onClickPlayNow:u,onClose:()=>c(!0)})]})},eP=e=>{let{secondsLeft:t,onClickPlayNow:n,nextPost:i,onClose:a}=e;return(0,r.FD)(L.Ye,{alignItems:"center",bg:"elevated-secondary",color:"primary",cursor:"pointer",gap:16,position:"absolute",radius:"xs",style:{bottom:16,right:16},onClick:n,children:[(0,r.Y)(eC.t,{className:"coverImageSmall-hsxEBv",disableVideoHover:!0,hideTimestamp:!0,imageAspectRatio:eI.qr,imageWidth:100,isBelowTheFold:!0,playButtonSize:null,post:i}),(0,r.FD)(L.I1,{children:[(0,r.FD)(M.EY.Meta,{color:"primary",children:["Up next in ",t]}),(0,r.Y)(M.EY.B4,{clamp:1,color:"primary",weight:"semibold",children:i.title})]}),(0,r.Y)(L.I1,{alignSelf:"start",children:(0,r.Y)(x.K0,{priority:"quaternary",size:"sm",onClick:e=>{e.stopPropagation(),a()},children:(0,r.Y)(P.A,{size:16})})})]})};var ex=n(47639),eL=n(56262);let eO=e=>{var t,n;let{autoPlay:i,nextPost:a,post:l,pub:o,user:s,videoPlayerRef:c,onClickPost:d}=e,{isMobile:u}=(0,v.sM)(),[h,m]=(0,p.useState)(!1),g=(null!=(n=null==(t=l.videoUpload)?void 0:t.preview_duration)?n:0)>0,f=(0,eL.isPaidAudience)(l.audience)&&!(null==s?void 0:s.is_subscribed);return l.videoUpload?(0,r.FD)(r.FK,{children:[(0,r.Y)(ex.U,{borderRadius:u?"none":"sm",forceAutoPlay:i,isFreeSubscribed:!!(null==s?void 0:s.is_free_subscribed),isSubscribed:!!(null==s?void 0:s.is_subscribed),mediaUpload:l.videoUpload,post:l,pub:o,renderPaywall:e=>{let{onRestart:t}=e;return(0,r.Y)(eN,{nextPost:a,post:l,pub:o,user:s,onClickPost:d,onRestart:t})},variant:"inbox",videoPlayerRef:c,onFinishVideo:()=>{f&&g||m(!0)}}),a&&h&&(0,r.Y)(eD,{nextPost:a,onClickPost:d,onClose:()=>m(!1)})]}):null},eB=e=>{let{isInitialPost:t,pub:n,user:i,currentPost:a,recentPosts:l,onClickPost:o}=e,{isMobile:s}=(0,v.sM)(),c=(0,p.useRef)(null),[d,u]=(0,p.useState)(!1),h=l.findIndex(e=>e.id===a.id),m=-1===h||h===l.length-1?l[0]:l[h+1];if(!a.videoUpload)return null;let g=l.filter(e=>e.id!==a.id),f=n.sections.find(e=>e.id===a.section_id),b=g.length>5;return s?(0,r.Y)(eM,{currentPost:a,isInitialPost:t,nextPost:null!=m?m:null,pub:n,recentPosts:g,user:i,onClickPost:o}):(0,r.Y)(q.a,{children:(0,r.Y)("div",{className:ev,children:(0,r.Y)(_.c,{columns:4,paddingTop:0,children:(0,r.FD)("div",{className:"playerAndListContainer-hwEtfH",children:[(0,r.FD)(L.I1,{gap:24,children:[(0,r.Y)(L.I1,{position:"relative",children:(0,r.Y)(eO,{autoPlay:!t,nextPost:null!=m?m:null,post:a,pub:n,user:i,videoPlayerRef:c,onClickPost:o})}),(0,r.FD)(L.I1,{gap:12,children:[(0,r.FD)(L.I1,{gap:8,children:[f&&(0,r.Y)(M.EY.Meta,{color:"accent",children:f.name}),(0,r.Y)(M.EY.H3,{color:"primary",weight:"medium",children:a.title})]}),(0,r.FD)(L.Ye,{alignItems:"center",justifyContent:"space-between",children:[(0,r.Y)(ee,{post:a}),(0,r.Y)(eb,{hideComments:!0,post:a,pub:n,user:i})]})]}),(0,r.Y)(eo,{post:a,pub:n,user:i})]}),(0,r.FD)(L.I1,{paddingBottom:40*!!d,position:"relative",children:[(0,r.Y)(L.I1,{inset:0,overflowY:d?"auto":"hidden",position:d?"relative":"absolute",children:(0,r.Y)(L.I1,{gap:16,children:g.map(e=>(0,r.Y)(G.z,{post:e,variant:"mini-video",onClick:o}))})}),b&&(0,r.Y)(L.I1,{alignItems:"center",className:"recentPostsBottom-l1j3wA",position:"absolute",children:(0,r.Y)(x.$n,{priority:"secondary",size:"sm",onClick:()=>u(!d),children:d?(0,r.Y)(V.A,{size:16}):(0,r.Y)(K.A,{size:16})})})]})]})})})})},eM=e=>{let{isInitialPost:t,pub:n,user:i,currentPost:a,nextPost:l,recentPosts:o,onClickPost:s}=e,c=(0,p.useRef)(null),[d,u]=(0,p.useState)(!1);if(!a.videoUpload)return null;let h=n.sections.find(e=>e.id===a.section_id);return(0,r.FD)(r.FK,{children:[(0,r.Y)(q.a,{children:(0,r.FD)("div",{className:ev,children:[(0,r.Y)(eO,{autoPlay:!t,nextPost:l,post:a,pub:n,user:i,videoPlayerRef:c,onClickPost:s}),(0,r.FD)(L.I1,{gap:16,paddingX:16,paddingY:12,children:[(0,r.FD)(L.I1,{gap:8,children:[h&&(0,r.Y)(M.EY.Meta,{color:"accent",children:h.name}),(0,r.Y)(M.EY.B3,{color:"primary",weight:"semibold",children:a.title})]}),(0,r.Y)(ee,{post:a}),(0,r.Y)(eb,{hideReadMore:!0,post:a,pub:n,user:i,onToggleComments:()=>{u(!d)}}),d&&(0,r.Y)(es,{post:a,pub:n,user:i}),(0,r.Y)(x.vx,{href:a.canonical_url,priority:"secondary",children:"Read full post"})]})]})}),(0,r.FD)(L.I1,{gap:16,padding:16,children:[(0,r.Y)(M.EY.Meta,{color:"secondary",children:"Next up"}),o.map(e=>(0,r.Y)(G.z,{post:e,variant:"mini-video",onClick:s}))]})]})};var eR=n(16074);let eU=e=>{var t,n,a,o,c;let{activeLiveStream:u,videoPageData:Y,pub:w,user:C,metadata:k}=e,S="undefined"!=typeof window?new URLSearchParams(null==(n=window)||null==(t=n.location)?void 0:t.search):new URLSearchParams,I=S.get("v")?parseInt(null!=(a=S.get("v"))?a:"0"):null,{isMobile:F}=(0,v.sM)(),[D,T]=(0,p.useState)(I),[A,E]=(0,p.useState)(!0),{activeLiveStream:N}=(0,g.Y)({pub:w,user:C,preloadedActiveLiveStream:u}),{result:P}=(0,f.st)({pathname:"/watch/data",auto:!Y,initialResult:Y,deps:[Y]}),x=null!=(c=null!=(o=(0,p.useMemo)(()=>{var e,t,n;let i=[...null!=(e=null==P?void 0:P.recentPosts)?e:[],...null!=(t=l()(d()(null==P?void 0:P.postsBySectionId).map(e=>null!=e?e:[])))?t:[],...null!=(n=l()(d()(null==P?void 0:P.postsByPostTagId).map(e=>null!=e?e:[])))?n:[]];return s()(i,"id")},[null==P?void 0:P.recentPosts,null==P?void 0:P.postsBySectionId,null==P?void 0:P.postsByPostTagId])[null!=D?D:0])?o:null==P?void 0:P.recentPosts[0])?c:null;if(!P||!x||!x.videoUpload)return(0,r.FD)(r.FK,{children:[k&&(0,r.Y)(h.Metadata,(0,i._)({},k)),(0,r.Y)(L.I1,{alignItems:"center",paddingTop:120,children:(0,r.Y)(M.EY.B3,{color:"secondary",children:"No video posts found"})})]});let{sources:O,sectionsById:B,postTagsById:R,postsBySectionId:U,postsByPostTagId:j}=P,z=e=>{let{event:t,post:n}=e;null==t||t.preventDefault(),T(n.id),E(!1),window.history.pushState({},"",(0,eE.oRR)({v:n.id.toString()}))};return(0,r.Y)(y.XL,{disableInteractive:!0,pub:w,user:C,children:(0,r.FD)(m.DH,{children:[k&&(0,r.Y)(h.Metadata,(0,i._)({},k)),(null==N?void 0:N.liveStream.id)&&(0,X.A)(N.liveStream.started_streaming_at).isBefore((0,X.A)().subtract(1,"minute"))&&(0,r.Y)(b.A,{activeLiveStream:N}),(0,r.Y)(eB,{currentPost:x,isInitialPost:A,pub:w,recentPosts:P.recentPosts,user:C,onClickPost:z},x.id),!F&&(0,r.Y)(_.c,{columns:4,children:(0,r.FD)(L.I1,{position:"relative",children:[(null==C?void 0:C.is_admin)&&(0,r.Y)(L.Ye,{position:"absolute",style:{top:0,right:0},children:(0,r.Y)(H,{pub:w,sources:O,user:C})}),(0,r.FD)(L.I1,{children:[O.map((e,t)=>{var n,i,a,l;let{section_id:o,post_tag_id:s}=e,c=null!=(n=B[null!=o?o:0])?n:null,d=null!=(i=R[null!=s?s:""])?i:null,u=o?null!=(a=U[null!=o?o:0])?a:[]:null!=(l=j[null!=s?s:""])?l:[];return 0===u.length?null:(0,r.FD)(r.FK,{children:[0!==t&&(0,r.Y)(eR.c,{paddingBottom:24,paddingTop:16,paddingX:8}),(0,r.Y)(ej,{posts:u,postTag:d,pub:w,section:c,onClickPost:z},null!=o?o:s)]})}),0===O.length&&(0,r.Y)(L.I1,{alignItems:"center",paddingTop:32,children:(0,r.Y)(M.EY.B3,{color:"secondary",children:"No sections found"})})]})]})})]})})},ej=e=>{var t;let{section:n,postTag:i,posts:a,pub:l,onClickPost:o}=e;if(!n&&!i||0===a.length)return null;let s=n?(0,er.Dor)(l,{section:n}):i?(0,er.ii9)(l,i):null;return s?(0,r.FD)(L.I1,{gap:16,children:[(0,r.FD)(L.Ye,{alignItems:"center",justifyContent:"space-between",paddingX:8,children:[(0,r.Y)(M.EY.H3,{color:"pub-primary-text",font:"pub-headings",children:null!=(t=null==n?void 0:n.name)?t:null==i?void 0:i.name}),(0,r.Y)(x.vx,{href:s,priority:"tertiary-accent",size:"sm",trailing:(0,r.Y)(u.A,{size:16}),children:"View all"})]}),(0,r.Y)(Y.C,{hideDescriptions:!0,numColumns:4,posts:a,onClickPost:o})]}):null}},5051:function(e,t,n){n(4006),n(56455),n(15894)},48535:function(e,t,n){n.d(t,{ZZ:()=>f});var i=n(69277),r=n(70408),a=n(32641),l=n(4006),o=n(32485),s=n.n(o),c=n(32307),d=n(17402),u=n(84605),p=n(76977),h=n(65842),m=n(67022),g=n(24311);function f(e){var{className:t,min:n,max:o,value:c,onChange:u,disabled:h,readOnly:f,flex:y="auto",error:Y=!1}=e,_=(0,a._)(e,["className","min","max","value","onChange","disabled","readOnly","flex","error"]);let w=(0,d.useRef)(null);return(0,l.FD)(p.pT,{position:"relative",flex:y,minWidth:0,children:[(0,l.Y)("input",(0,r._)((0,i._)({},_),{type:"datetime-local",ref:w,className:s()(t,m.A.datePicker,g.A.input,g.A.inputText,Y&&g.A.error,h&&g.A.disabled,f&&g.A.readOnly),value:b(c),min:b(n),max:b(o),onChange:u,disabled:h})),(0,l.Y)(v,{inputRef:w})]})}let v=e=>{let{inputRef:t}=e,{iString:n}=(0,u.GO)();return(0,l.Y)(h.uk,{position:"trailing",onClick:e=>{let{current:n}=t;if(n){var i;e.preventDefault(),e.stopPropagation(),n.focus(),null==(i=n.showPicker)||i.call(n)}},onMouseDown:e=>{e.preventDefault()},children:(0,l.Y)(c.A,{size:16,"aria-label":n("Calendar icon")})})};function b(e){return e instanceof Date?"".concat(e.getFullYear(),"-").concat(y(e.getMonth()+1),"-").concat(y(e.getDate()),"T").concat(y(e.getHours()),":").concat(y(e.getMinutes())):e}function y(e){let t=String(e);return t.length<2?"0".concat(t):t}},94996:function(e,t,n){n.d(t,{I:()=>m,K:()=>g});var i=n(69277),r=n(70408),a=n(32641),l=n(4006),o=n(32485),s=n.n(o),c=n(17402),d=n(82519),u=n(76977),p=n(65842),h=n(25879);let m=(0,c.forwardRef)((e,t)=>{var{className:n,error:o=!1,leading:c,trailing:m=(0,l.Y)(d.A,{}),children:g,flex:f="auto",size:v="md",priority:b="secondary-outline",disabled:y}=e,Y=(0,a._)(e,["className","error","leading","trailing","children","flex","size","priority","disabled"]);return(0,l.FD)(u.pT,{position:"relative",flex:f,children:[(0,l.Y)("select",(0,r._)((0,i._)({},Y),{disabled:y,className:s()(n,h.A.select,h.A["size_".concat(v)],h.A["priority_".concat(b)],o&&h.A.error,y&&h.A.disabled,c?h.A.leading:null,m?h.A.trailing:null),ref:t,children:g})),c&&(0,l.Y)(p.uk,{position:"leading",size:v,className:s()(o&&h.A.error),disabled:!!y,children:c}),m&&(0,l.Y)(p.uk,{position:"trailing",size:v,className:s()(o&&h.A.error),disabled:!!y,children:m})]})});m.displayName="SelectNative";let g=e=>{let{children:t}=e;return(0,l.Y)("option",{value:"",disabled:!0,selected:!0,children:t},"placeholder")}},67211:function(e,t,n){n.d(t,{Y:()=>o});var i=n(4006),r=n(60322),a=n(76977),l=n(63136);let o=e=>{let{contentBelow:t,details:n,disabled:o,label:s,name:c,paddingBottom:d,paddingTop:u,testid:p,track:h,value:m,onChange:g,usePublicationTheme:f}=e;return(0,i.FD)(a.Ye,{as:"label",gap:8,cursor:"pointer",paddingBottom:d,paddingTop:u,children:[(0,i.Y)(r.S,{checked:m,name:null!=c?c:p,"data-testid":p,"data-track-input":h,disabled:o,size:"sm",onChange:g}),(0,i.FD)(a.I1,{flex:"grow",children:[(0,i.Y)(l.EY.B4,{as:"span",color:o?f?"pub-secondary-text":"secondary":f?"pub-primary-text":"primary",children:s}),n&&(0,i.Y)(l.EY.B5,{color:f?"pub-secondary-text":"secondary",children:n}),t]})]})}},84270:function(e,t,n){n.d(t,{z:()=>l});var i=n(4006),r=n(25318),a=n(94996);let l=e=>{let{details:t,helpText:n,label:l,name:o,options:s,paddingBottom:c,paddingTop:d,flex:u,value:p,disabled:h,onChange:m}=e;return(0,i.Y)(r.D,{label:l,details:t,helpText:n,paddingTop:d,paddingBottom:c,flex:u,wrapWithLabel:!0,children:(0,i.Y)(a.I,{name:o,value:p,onChange:e=>{let t=e.target;m(t.value,{name:t.name})},disabled:h,children:s.map(e=>(0,i.Y)("option",{value:e.value,children:e.label},e.value))})})}},23168:function(e,t,n){n.d(t,{l:()=>o});var i=n(69277),r=n(70408),a=n(17402),l=n(84605);let o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{maxFiles:t=1/0,maxSize:n=1/0,accept:o="*",multiple:c=!1,initialFiles:d=[],onFilesChange:u,onFilesAdded:p}=e,{iString:h}=(0,l.GO)(),[m,g]=(0,a.useState)({files:d.map(e=>({file:e,id:e.id,preview:e.url})),isDragging:!1,errors:[]}),f=(0,a.useRef)(null),v=(0,a.useCallback)(e=>{if(e instanceof File){if(e.size>n)return'File "'.concat(e.name,'" exceeds the maximum size of ').concat(s(n),".")}else if(e.size>n)return'File "'.concat(e.name,'" exceeds the maximum size of ').concat(s(n),".");if("*"!==o){let t=o.split(",").map(e=>e.trim()),n=e instanceof File?e.type||"":e.type,i=(e instanceof File,e.name),r=i.lastIndexOf("."),a=r>0?i.substring(r):"";if(!t.some(e=>{if(e.startsWith("."))return a.toLowerCase()===e.toLowerCase();if(e.endsWith("/*")){let t=e.split("/")[0];return n.startsWith("".concat(t,"/"))}return n===e}))return'File "'.concat((e instanceof File,e.name),'" is not an accepted file type.')}return null},[o,n]),b=(0,a.useCallback)(e=>e instanceof File?URL.createObjectURL(e):e.url,[]),y=(0,a.useCallback)(e=>e instanceof File?"".concat(e.name,"-").concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,9)):e.id,[]),Y=(0,a.useCallback)(()=>{g(e=>{e.files.forEach(e=>{e.preview&&e.file instanceof File&&e.file.type.startsWith("image/")&&URL.revokeObjectURL(e.preview)}),f.current&&(f.current.value="");let t=(0,r._)((0,i._)({},e),{files:[],errors:[]});return null==u||u(t.files),t})},[u]),_=(0,a.useCallback)(e=>{if(!e||0===e.length)return;let a=Array.from(e),l=[];if(g(e=>(0,r._)((0,i._)({},e),{errors:[]})),c||Y(),c&&t!==1/0&&m.files.length+a.length>t){l.push("You can only upload a maximum of ".concat(t," files.")),g(e=>(0,r._)((0,i._)({},e),{errors:l}));return}let o=[];a.forEach(e=>{if(c&&m.files.some(t=>t.file.name===e.name&&t.file.size===e.size))return;if(e.size>n)return void l.push(c?"Some files exceed the maximum size of ".concat(s(n),"."):"File exceeds the maximum size of ".concat(s(n),"."));let t=v(e);t?l.push(t):o.push({file:e,id:y(e),preview:b(e)})}),o.length>0?(null==p||p(o),g(e=>{let t=c?[...e.files,...o]:o;return null==u||u(t),(0,r._)((0,i._)({},e),{files:t,errors:l})})):l.length>0&&g(e=>(0,r._)((0,i._)({},e),{errors:l})),f.current&&(f.current.value="")},[m.files.length,t,c,n,v,b,y,Y,u,p]),w=(0,a.useCallback)(e=>{void 0!==e&&g(t=>{let n=t.files.find(t=>t.id===e);n&&n.preview&&n.file instanceof File&&n.file.type.startsWith("image/")&&URL.revokeObjectURL(n.preview);let a=t.files.filter(t=>t.id!==e);return null==u||u(a),(0,r._)((0,i._)({},t),{files:a,errors:[]})})},[u]),C=(0,a.useCallback)(()=>{g(e=>(0,r._)((0,i._)({},e),{errors:[]}))},[]),k=(0,a.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),g(e=>(0,r._)((0,i._)({},e),{isDragging:!0}))},[]),S=(0,a.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),e.relatedTarget&&e.relatedTarget instanceof Node&&e.currentTarget.contains(e.relatedTarget)||g(e=>(0,r._)((0,i._)({},e),{isDragging:!1}))},[]),I=(0,a.useCallback)(e=>{e.preventDefault(),e.stopPropagation()},[]),F=(0,a.useCallback)(e=>{var t,n;if(e.preventDefault(),e.stopPropagation(),g(e=>(0,r._)((0,i._)({},e),{isDragging:!1})),(null==(t=f.current)||!t.disabled)&&(null==(n=e.dataTransfer)?void 0:n.files)&&e.dataTransfer.files.length>0)if(c)_(e.dataTransfer.files);else{let t=e.dataTransfer.files[0];t&&_([t])}},[_,c]),D=(0,a.useCallback)(e=>{e.currentTarget.files&&e.currentTarget.files.length>0&&_(e.currentTarget.files)},[_]),T=(0,a.useCallback)(()=>{f.current&&f.current.click()},[]),A=(0,a.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r._)((0,i._)({},e),{type:"file",onChange:D,accept:e.accept||o,multiple:void 0!==e.multiple?e.multiple:c,ref:f,className:"sr-only","aria-label":h("Upload file"),tabIndex:-1})},[o,c,D]),E=(0,a.useCallback)(()=>({onDragEnter:k,onDragLeave:S,onDragOver:I,onDrop:F}),[k,S,I,F]);return[m,{addFiles:_,removeFile:w,clearFiles:Y,clearErrors:C,handleDragEnter:k,handleDragLeave:S,handleDragOver:I,handleDrop:F,handleFileChange:D,openFileDialog:T,getInputProps:A,getDragProps:E}]},s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 Bytes";let n=Math.floor(Math.log(e)/Math.log(1024));return Number.parseFloat((e/Math.pow(1024,n)).toFixed(t<0?0:t))+(["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][n]||"Bytes")}},14085:function(e,t,n){n.d(t,{u:()=>p});var i=n(69277),r=n(70408),a=n(32641),l=n(4006),o=n(32485),s=n.n(o),c=n(17402),d=n(89490),u=n(78918);let p=(0,c.forwardRef)((e,t)=>{var{children:n,className:o,disable:c,href:p,hoverBackground:h,onClick:m}=e,g=(0,a._)(e,["children","className","disable","href","hoverBackground","onClick"]);let f=c?void 0:m,v="undefined"==typeof window?void 0:p;return(0,l.Y)(d.az,(0,r._)((0,i._)({},g,v?{as:"a",href:v}:{}),{ref:t,className:s()(o,!c&&u.A.container,{[u.A.containerHoverLight]:"light"===h&&!c}),role:f?"button":void 0,onClick:f,children:n}))})},1140:function(e,t,n){n(4006),n(73294),n(35369),n(16074),n(76977);var i=n(75303);n(63136),n(44338),n(11510),n(39318),n(79913),(0,i.I4)({display:"flex",direction:"column",gap:20,paddingLeft:{desktop:20,mobile:12},borderLeft:"detail"})},25112:function(e,t,n){n.d(t,{vK:()=>i});let i="__preview__"},65670:function(e,t,n){n.d(t,{Cd:()=>a,kG:()=>l});var i=n(90883);n(17402),n(47787),n(38804);var r=n(71783);function a(){return(0,i.md)(r.c5)}function l(){return(0,i.md)(r.SH)}},90800:function(e,t,n){function i(e,t){return t?"picker":e?e.item?"item":"block":"root"}function r(e,t,n,r){let a=i(e,t),l=i(n,r),o=function(e,t,n,i){var r,a,l,o;if(t)return!!i&&t.type===i.type&&("block-picker"===t.type&&"block-picker"===i.type?t.insertAfterIndex===i.insertAfterIndex:"module-picker"!==t.type||"module-picker"!==i.type||t.parentBlockId===i.parentBlockId&&t.column===i.column&&t.insertAtIndex===i.insertAtIndex);return null===i&&(r=n,a=e,null===r&&null===a||null!==r&&null!==a&&(l=r.block,o=a.block,l.type===o.type&&("content-block"!==l.type||"content-block"!==o.type||l.id===o.id))&&(r.item&&a.item?r.item.type===a.item.type&&r.item.moduleId===a.item.moduleId:!r.item&&!a.item))}(e,t,n,r);return o?"item"===a?{isActive:o,clickAction:"none",showOverlay:!1}:{isActive:o,clickAction:"deactivate",showOverlay:!1}:"root"===l?"item"===a?{isActive:o,clickAction:"none",showOverlay:!1}:{isActive:o,clickAction:"activate",showOverlay:!0}:"picker"===l?{isActive:o,clickAction:"deactivate",showOverlay:!1}:"block"===l?"block"===a?{isActive:o,clickAction:"activate",showOverlay:!1}:"item"===a||"picker"===a&&(null==t?void 0:t.type)==="module-picker"?{isActive:o,clickAction:"activate",showOverlay:!0}:{isActive:o,clickAction:"deactivate",showOverlay:!1}:"item"===l?{isActive:o,clickAction:"deactivate",showOverlay:!1}:{isActive:o,clickAction:"none",showOverlay:!1}}function a(e){return"".concat("preview-block-").concat("content-block"===e.type?"content-block-".concat(e.contentBlockId):"sidebar-module"===e.type?"sidebar-module-".concat(e.parentContentBlockId,"-").concat(e.moduleId):"block-picker"===e.type?"block-picker-".concat(e.insertAfterIndex):"module-picker"===e.type?"module-picker-".concat(e.parentContentBlockId,"-").concat(e.column,"-").concat(e.insertAtIndex):e.type)}n.d(t,{tP:()=>a,uz:()=>r})},71783:function(e,t,n){n.d(t,{$G:()=>v,CL:()=>b,Jv:()=>c,MS:()=>o,Nu:()=>u,SH:()=>a,c5:()=>r,cd:()=>h,jd:()=>d,lw:()=>m,n6:()=>f,nJ:()=>g,qG:()=>p,vB:()=>s,y2:()=>l});var i=n(46923);(0,i.eU)("panel");let r=(0,i.eU)(null),a=(0,i.eU)(null);(0,i.eU)(null);let l=(0,i.eU)(null);(0,i.eU)(null);let o=(0,i.eU)(null),s=(0,i.eU)(null),c=(0,i.eU)(null),d=(0,i.eU)(null),u=(0,i.eU)(null),p=(0,i.eU)(null),h=(0,i.eU)(null),m=(0,i.eU)(null),g=(0,i.eU)(null),f=(0,i.eU)(null),v=(0,i.eU)(null),b=(0,i.eU)(0);(0,i.eU)(0)},57459:function(e,t,n){n.d(t,{b:()=>l});var i=n(4016);let r={availableBlockTypes:["list","feature","subscribe"],disabledPreviewBlocks:[],hiddenPreviewBlocks:[],featureVariantOptions:[{value:"focus-left-list",label:"Focus left, list"},{value:"focus-right-list",label:"Focus right, list"},{value:"focus-left-grid",label:"Focus left, grid"},{value:"focus-center-grid",label:"Focus center, grid"},{value:"focus-right-grid",label:"Focus right, grid"}],hiddenPages:[],showCustomBodyLayoutToggle:!0},a={availableBlockTypes:["feature","half_feature","podcast_plus_three","single_post","media_carousel","subscribe_plus_five"],disabledPreviewBlocks:["header","home-hero"],hiddenPreviewBlocks:["footer"],featureVariantOptions:[{value:"special-feature",label:"Special feature"},{value:"large-on-left",label:"Large on left"},{value:"large-in-middle",label:"Large in middle"},{value:"large-on-right",label:"Large on right"}],hiddenPages:["welcome","post","podcast","section"],showCustomBodyLayoutToggle:!1};function l(e){let{pub:t}=e;return(0,i.lu)({pub:t})?a:r}},28379:function(e,t,n){n.d(t,{t:()=>u});var i=n(99851),r=n(4006),a=n(99862),l=n(17402),o=n(72880),s=n(44333),c=n(76977),d=n(63136);class u extends l.Component{static getDerivedStateFromError(e){return{error:e}}componentDidMount(){Promise.all([n.e("50551"),n.e("19565")]).then(n.bind(n,35132)).then(e=>{this.Sentry=e.Sentry})}componentDidCatch(e){console.error(e),this.Sentry&&this.Sentry.captureException(e)}render(){let{error:e}=this.state;return(0,r.Y)(p,{onReset:()=>this.setState({error:null}),error:e,children:e?(0,r.Y)(h,{}):this.props.children})}constructor(e){super(e),(0,i._)(this,"Sentry",null),this.state={error:null}}}function p(e){let{onReset:t,error:n,children:i}=e,o=(0,l.useRef)((0,a.getCurrentUrl)());return(0,s.wN)(e=>{n&&o.current!==e&&t(),o.current=e},[]),n?(0,r.Y)(h,{}):i}function h(){return(0,r.FD)(c.I1,{flex:"grow",justifyContent:"center",alignItems:"center",gap:32,padding:20,children:[(0,r.Y)(o.o,{src:"/img/reader/toad.png",maxWidth:200}),(0,r.FD)(c.I1,{gap:8,children:[(0,r.Y)(d.EY.H3,{weight:"semibold",align:"center",children:"Oh no—this page croaked."}),(0,r.Y)(d.EY.B3,{color:"secondary",align:"center",children:"Try again, or hop to another page."})]})]})}},60281:function(e,t,n){n.d(t,{Ft:()=>L,Mr:()=>j,SE:()=>U,Wc:()=>R,h8:()=>z,pS:()=>H,pp:()=>O});var i=n(4006),r=n(32485),a=n.n(r),l=n(48697),o=n(17402),s=n(78649),c=n(38305),d=n(27437),u=n(84777),p=n(68924),h=n(9292),m=n(58050),g=n(84605),f=n(46271),v=n(25859),b=n(86500),y=n(58418),Y=n(82772),_=n(68349),w=n(24078),C=n(15040),k=n(35369),S=n(76977),I=n(22602),F=n(63136),D=n(504),T=n(45122),A=n(49095),E=n(83660),N=n(39318),P=n(49807),x=n(12896);let L="inviteFriendsNuxDismissed";function O(e){let{feedUserSuggestion:t,surface:n}=e,{iString:r,language:c}=(0,g.GO)(),d=(0,o.useRef)(null),u=(0,m.cC)(t.user,n),p=r(u.isFollowing?"Following":t.isFollowing?"Follow Back":"Follow"),h=u.isFollowing?"secondary":"primary",f=(0,E.A)(t,c),[b,y]=(0,o.useState)(!1),C="feed"===n?"pymk_notes_feed_item":"suggestions"===n?"pymk_notes_suggestions_page":"pymk_notes_sidebar";(0,Y.S8)(d,()=>{(0,D.Si)(t,n,{extraEventProps:{has_social_context:!!t.mutualsContext}})});let[I,T]=(0,o.useState)(!1),N=e=>{I||(T(!0),(0,D.aK)(t,n,e))},L=e=>{N("user-suggestion"),e.defaultPrevented||(0,_.V2)((0,P.gYq)(t.user,{utm_source:C}),{event:e})},O=e=>{e.preventDefault(),N("user-suggestion-cta"),u.isFollowing?u.toggle():(u.toggle(),y(!0))},U=async e=>{e.preventDefault(),N("user-suggestion-dismiss"),y(!0),await fetch("/api/v1/reader/feed/user-suggestions/".concat(t.user.id,"/dismiss"),{method:"POST"})};if(b)return null;let j=t.user.status;return"feed"===n?(0,i.Y)(s.Q,{children:(0,i.FD)(S.I1,{ref:d,className:a()(x.A.personYouMayKnow,x.A.personYouMayKnowFeed,x.A.withSocialContext),alignItems:"center",bg:"primary",border:"detail",padding:12,gap:12,radius:"lg",shadow:"md",onClick:L,justifyContent:"space-between",children:[(0,i.Y)(k.K0,{size:"sm",priority:"tertiary",className:x.A.close,onClick:U,children:(0,i.Y)(l.A,{size:16})}),(0,i.Y)(w.eu,{user:t.user,size:100}),(0,i.FD)(S.I1,{minWidth:0,flex:"grow",justifyContent:"start",alignSelf:"stretch",gap:4,children:[(0,i.FD)(S.Ye,{gap:4,alignItems:"center",justifyContent:"center",children:[(0,i.Y)(F.EY.B4,{decoration:"hover-underline",weight:"semibold",textAlign:"center",ellipsis:!0,children:(0,i.Y)(v.yp,{user:t.user,ellipsis:!0,children:t.user.name})}),(null==j?void 0:j.badge)&&(0,i.Y)(A.UserBadge,{size:"xs",userBadge:j.badge})]}),(null==j?void 0:j.subscriber)?(0,i.Y)(A.RelationshipTag,{children:j.subscriber.label}):t.mutualsContext?(0,i.Y)(B,{mutualsContext:t.mutualsContext}):(0,i.Y)(M,{children:f})]}),(0,i.Y)(k.$n,{size:"sm",priority:h,onClick:O,alignSelf:"stretch",justifyContent:"center",children:p})]})}):(0,i.Y)(R,{user:t.user,source:C,publication:t.publication,label:f,onClick:L,cta:(0,i.FD)(S.Ye,{alignItems:"center",gap:8,children:[(0,i.Y)(k.$n,{size:"sm",priority:h,onClick:O,children:p}),(0,i.Y)(k.K0,{rounded:!0,size:"sm",priority:"tertiary",onClick:U,children:(0,i.Y)(l.A,{size:20})})]}),boxRef:d})}function B(e){let{mutualsContext:t}=e,{iString:n}=(0,g.GO)(),r=t.users.sort(e=>e.photo_url?1:-1);return 0===r.length?null:(0,i.Y)(S.fI,{alignItems:"center",justifyContent:"center",gap:6,className:x.A.personYouMayKnowMutuals,children:(0,i.FD)(M,{children:[n("Followed by "),(0,i.Y)(c.K,{array:r,limit:3,formatter:e=>(0,i.Y)(v.Yq,{href:(0,P.gYq)(e),children:e.name})})]})})}function M(e){let{children:t}=e;return(0,i.Y)(F.EY.B5,{color:"secondary",clamp:2,style:{lineHeight:"13px"},textAlign:"center",children:t})}function R(e){var t;let{user:n,publication:r,label:a,onClick:l,cta:o,source:s,boxRef:c}=e,p=(0,f.Jd)(),h=n&&n.id===(null==p?void 0:p.id);return(0,i.FD)(S.pT,{ref:c,className:x.A.personYouMayKnow,alignItems:"center",justifyContent:"space-between",padding:8,gap:12,onClick:l,radius:"md",flex:"grow",children:[(0,i.FD)(S.pT,{gap:12,minWidth:0,children:[(0,i.Y)(C.Ff,{pub:r||void 0,children:(0,i.Y)(w.tp,{user:n,size:40})}),(0,i.FD)(S.I1,{minWidth:0,justifyContent:"center",children:[(0,i.FD)(S.pT,{alignItems:"center",gap:4,children:[(0,i.Y)(d.ProfileHoverCard,{subject:n,utmSource:s,trigger:(0,i.Y)(v.Yq,{href:(0,P.gYq)(n),showBack:!0,ellipsis:!0,children:(0,i.Y)(F.EY.B3,{as:"span",decoration:"hover-underline",weight:"semibold",clamp:1,children:n.name})})}),(0,i.Y)(A.UserStatusSymbols,{size:"xs",status:n.status})]}),(0,i.Y)(u.m,{pubId:null!=(t=null==r?void 0:r.id)?t:0,disabled:!r,trigger:(0,i.Y)(F.EY.B4,{color:"secondary",ellipsis:!0,as:r?"a":void 0,decoration:r?"hover-underline":void 0,target:"_blank",rel:"noopener","data-native":!0,onClick:e=>{e.stopPropagation()},href:r?(0,N.fOI)(r):void 0,children:a})})]})]}),!h&&o]})}function U(){return(0,i.FD)(S.pT,{className:x.A.personYouMayKnow,alignItems:"center",padding:8,gap:12,children:[(0,i.Y)(I.O,{radius:"full",width:40,height:40,flex:"auto"}),(0,i.FD)(S.I1,{style:{width:"100%"},gap:8,children:[(0,i.Y)(I.O,{width:"80%",height:16}),(0,i.Y)(I.O,{width:"40%",height:16})]})]})}function j(){let[e,t]=(0,y.A)("facebookPymkNuxDismissed",604800);return e?null:(0,i.Y)(s.Q,{children:(0,i.FD)(S.I1,{className:a()(x.A.personYouMayKnow,x.A.personYouMayKnowFeed),border:"detail",alignItems:"center",bg:"primary",padding:12,gap:12,style:{position:"relative"},radius:"md",children:[(0,i.Y)(k.K0,{className:x.A.close,onClick:t,rounded:!0,children:(0,i.Y)(l.A,{size:20})}),(0,i.Y)(p.A,{fill:"var(--color-accent-fg-blue)",stroke:"none",height:64,width:64}),(0,i.FD)(S.I1,{alignItems:"center",minWidth:0,flex:"grow",children:[(0,i.Y)(F.EY.B4,{align:"center",weight:"bold",ellipsis:!0,children:"Connect Facebook"}),(0,i.Y)(F.EY.B4,{align:"center",color:"secondary",ellipsis:!0,children:"Find your friends"})]}),(0,i.Y)(k.$n,{size:"sm",priority:"primary",href:(0,P.wVQ)({type:"reader2",redirect:(0,N.oT5)()}),style:{backgroundColor:"var(--color-accent-fg-blue)"},localNavigation:!1,onClick:()=>(0,b.u4)(b.qY.CONNECT_FACEBOOK_SCREEN_VIEWED,{source:"suggestions"}),children:"Connect"})]})})}function z(){let[,e]=(0,y.A)("sidebarFacebookNuxDismissed");return(0,i.FD)(S.I1,{position:"relative",alignItems:"center",gap:12,paddingX:32,paddingY:8,children:[(0,i.Y)(k.K0,{className:x.A.close,onClick:()=>{e()},rounded:!0,children:(0,i.Y)(l.A,{size:20})}),(0,i.Y)(p.A,{width:40,height:40}),(0,i.FD)(S.I1,{alignItems:"center",gap:6,children:[(0,i.Y)(F.EY.H4,{children:"Find your friends"}),(0,i.Y)(F.EY.B4,{align:"center",color:"secondary",children:"Connect Facebook to see what your friends are reading."})]}),(0,i.Y)(k.$n,{priority:"primary",href:(0,P.wVQ)({type:"reader2",redirect:(0,N.oT5)()}),localNavigation:!1,style:{backgroundColor:"var(--color-accent-fg-blue)"},rounded:!0,onClick:()=>(0,b.u4)(b.qY.CONNECT_FACEBOOK_SCREEN_VIEWED,{source:"sidebar"}),children:"Connect Facebook"})]})}function H(e){let{utmSource:t}=e,[n,r]=(0,o.useState)(!1),[a,s]=(0,o.useState)(!1),{user:c,changeSetting:d}=(0,f.ur)(),[,u]=(0,y.A)(L),[,p]=(0,y.A)("sidebarInviteFriendsNuxDismissed");if(!c)return null;let m=()=>{d("invite_friends_nux_dismissed_at",new Date().toISOString()),u()};return(0,i.FD)(i.FK,{children:[(0,i.Y)(S.I1,{children:(0,i.FD)(S.I1,{alignItems:"center",gap:12,padding:32,className:x.A.shareProfile,children:[(0,i.Y)(k.K0,{className:x.A.close,onClick:()=>{m(),p()},rounded:!0,children:(0,i.Y)(l.A,{size:20})}),(0,i.FD)(S.I1,{className:x.A.avatarContainer,children:[(0,i.Y)(w.eu,{user:c,size:48}),(0,i.Y)(S.pT,{className:x.A.badge,padding:4,children:(0,i.Y)(h.Sb,{className:x.A.badgeIcon})})]}),(0,i.FD)(S.I1,{alignItems:"center",gap:6,children:[(0,i.Y)(F.EY.H4,{children:"Invite your friends"}),(0,i.Y)(F.EY.B4,{align:"center",color:"secondary",children:"Share your profile to help your friends find you on Substack."})]}),(0,i.Y)(k.$n,{priority:"primary",onClick:()=>{r(!0),(0,b.u4)(b.qY.INVITE_FRIENDS_MODAL_SHOWN,{source:t})},rounded:!0,children:"Invite friends"})]})}),(0,i.Y)(T.z,{isOpen:n,utmSource:t,onClose:()=>{r(!1),a&&m()},setShared:()=>s(!0)})]})}},83357:function(e,t,n){n.d(t,{N:()=>p,g:()=>h});var i=n(69277),r=n(70408),a=n(32641),l=n(4006),o=n(99862),s=n(17402),c=n(72343),d=n(99662),u=n(89490);let p=(0,s.forwardRef)((e,t)=>{var{href:n,onClick:o,campaign:s,replace:c,state:d,showBack:p}=e,m=(0,a._)(e,["href","onClick","campaign","replace","state","showBack"]);let g=h({href:n,onClick:o,campaign:s,replace:c,state:d=p?(0,r._)((0,i._)({},d),{showBack:!0}):d});return(0,l.Y)(u.az,(0,i._)((0,r._)((0,i._)({as:"a"},m),{ref:t}),g))});function h(e){let{onClick:t,href:n,campaign:r,replace:a,state:l}=e,s=!1;if(n&&!(0,d.y)()){let e;try{e=new URL(n)}catch(t){try{e=new URL("".concat(document.location.origin).concat(n))}catch(e){}}if(e)if((s=e.origin!==document.location.origin)||r)s&&r&&(n=(0,c.P)(n,r));else{let t=new URLSearchParams,i={};for(let[n,r]of e.searchParams)n.startsWith("utm_")?"utm_campaign"===n?i.name=r:i[n.replace(/^utm_/,"")]=r:t.append(n,r);r=i;let a=t.toString();n="".concat(e.pathname).concat(a?"?".concat(a):"").concat(e.hash)}}return{href:n,onClick:e=>{if(null==t||t(e),!s&&!e.ctrlKey&&!e.shiftKey&&!e.metaKey&&n&&!(0,d.y)()){if(e.defaultPrevented)return void e.stopPropagation();(0,c.x4)((0,i._)({},r)),e.preventDefault(),e.stopPropagation(),(0,o.route)(n,a),l&&history.replaceState(l,"")}}}}},2481:function(e,t,n){n.d(t,{Ay:()=>T,L6:()=>O,NP:()=>L,um:()=>A,wG:()=>x});var i=n(69277),r=n(70408),a=n(32641),l=n(4006),o=n(32485),s=n.n(o),c=n(17402),d=n(78649),u=n(84605),p=n(46271),h=n(86998),m=n(98920),g=n(24078),f=n(35369),v=n(76977),b=n(16993),y=n(63136),Y=n(2824),_=(n(81870),n(5180)),w=n(21398),C=n(46453),k=n(11510),S=n(16884),I=n(70515),F=n(79804);function D(e){var{isOpen:t}=e,o=(0,a._)(e,["isOpen"]);let{iString:s}=(0,u.GO)();return(0,l.FD)(b.aF,{className:F.A.composerModal,isOpen:t,onClose:o.onClose,fullscreenMobile:!0,width:600,children:[(0,l.Y)(b.lR,{title:s("New note")}),(0,l.Y)(w.Ic,(0,r._)((0,i._)({},o),{module:"../feed/NoteComposer",resolve:e=>e.NoteComposer,onRequest:()=>Promise.all([n.e("48810"),n.e("25363"),n.e("10550"),n.e("93994")]).then(n.bind(n,86708)),whileLoading:(0,l.Y)("div",{style:{height:336}})}))]})}function T(e){let{disabled:t,parentPubId:n,parentPostId:a,parentCommentId:o,restackUrl:c,placeholder:m,tabId:b,surface:Y,initialText:_,className:w,textClassName:k,parentMediaClipId:S}=e,{iString:I}=(0,u.GO)(),D=L(),T=(0,p.Jd)(),{requireLogin:A}=(0,C.eE)(),E=(0,h.zj)({onAddFiles:e=>{D.open((0,i._)({parentPubId:n,parentPostId:a,parentCommentId:o,restackUrl:c,initialFiles:e,tabId:b,surface:Y,initialText:_},S&&{parentMediaClipId:S}))},acceptFile:h.um});return(0,l.Y)(v.I1,(0,r._)((0,i._)({},E.props),{position:"relative",children:(0,l.Y)(f.Nm,{onClick:()=>{t||(T?D.open((0,i._)({parentPubId:n,parentPostId:a,parentCommentId:o,restackUrl:c,tabId:b,surface:Y,initialText:_},S&&{parentMediaClipId:S})):null==A||A())},disabled:t,radius:"md",resetCss:!0,showFocus:!0,animate:!0,"aria-label":I("New post"),children:(0,l.Y)(d.Q,{children:(0,l.FD)(v.Ye,{padding:16,gap:12,radius:"md",alignItems:"center",bg:"primary",border:"detail",shadow:"xs",cursor:"pointer",userSelect:"none",className:s()(F.A.inlineComposer,E.isDragging&&F.A.isDragging,w),animate:!0,children:[T?(0,l.Y)(g.eu,{size:36,user:T,"aria-hidden":!0}):(0,l.Y)(v.pT,{flex:"auto",children:(0,l.Y)(g.eu,{size:36,"aria-hidden":!0})}),(0,l.Y)(y.EY.B2,{align:"left",color:"secondary",flex:"grow",ellipsis:!0,className:k,children:m||I("What's on your mind?")})]})})})}))}function A(e){let{disabled:t,parentPubId:n,parentPostId:a,parentCommentId:o,placeholder:c,tabId:d,surface:u,parentMediaClipId:m}=e,b=L(),Y=(0,p.Jd)(),_=(0,k.Iu)(),{requireLogin:w}=(0,C.eE)(),S=(0,h.zj)({onAddFiles:e=>{b.open((0,i._)({parentPubId:n,parentPostId:a,parentCommentId:o,initialFiles:e,tabId:d,surface:u},m&&{parentMediaClipId:m}))},acceptFile:h.um});return(0,l.Y)(v.I1,(0,r._)((0,i._)({},S.props),{children:(0,l.Y)(f.Nm,{onClick:()=>{t||(Y?b.open((0,i._)({parentPubId:n,parentPostId:a,parentCommentId:o,tabId:d,surface:u},m&&{parentMediaClipId:m})):null==w||w())},disabled:t,resetCss:!0,children:(0,l.FD)(v.Ye,{padding:16,gap:12,alignItems:"center",bg:"primary",cursor:"pointer",className:s()(F.A.mobileInlineComposer,{[F.A.isDropping]:S.isDragging}),children:[Y?(0,l.Y)(g.eu,{size:36,user:Y}):(0,l.Y)(v.pT,{flex:"auto",children:(0,l.Y)(g.eu,{size:36})}),(0,l.Y)(y.EY.B3,{align:"left",color:"secondary",flex:"grow",children:c||"What's on your mind?"}),!_&&(0,l.Y)(E,{})]})})}))}function E(){return(0,l.Y)(v.pT,{fontSize:14,fontWeight:"semibold",font:"text",style:{backgroundColor:"var(--color-button-primary-bg)",opacity:.5},alignItems:"center",justifyContent:"center",height:40,paddingX:12,radius:"sm",color:"white",children:"Post"})}let N={isOpen:!1,firstComment:void 0},P=(0,c.createContext)({state:N,open:async()=>{throw Error("Not implemented")}});function x(e){var t,a,o;let{children:s}=e,d=(0,p.Jd)(),u=!(null==d?void 0:d.name),h=(0,_.wA)(),[g,f]=(0,c.useState)(N),[v,y]=(0,c.useState)(!1),{feedItem:C}=g,k=O(C),S=(null==C?void 0:C.type)==="comment"?null!=(a=null==(t=C.parentComments)?void 0:t[0])?a:C.comment:null;(0,c.useEffect)(()=>{d&&Promise.all([n.e("48810"),n.e("25363"),n.e("10550"),n.e("93994")]).then(n.bind(n,86708))},[d]),(0,c.useEffect)(()=>{g.isOpen&&n.e("22679").then(n.bind(n,15722))},[g.isOpen]),(0,c.useEffect)(()=>{g.isOpen&&u&&y(!0)},[u,g.isOpen]);let I=(0,c.useMemo)(()=>({state:g,open:e=>new Promise((t,n)=>{f((0,r._)((0,i._)({},N,e),{isOpen:!0,resolve:t,reject:n}))})}),[g]),F=function(){var e,t,n;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};null==(t=document.activeElement)||null==(e=t.blur)||e.call(t),null==(n=g.onDismiss)||n.call(g),f((0,i._)((0,r._)((0,i._)({},g),{isOpen:!1}),a))};return(0,l.FD)(P.Provider,{value:I,children:[s,u?(0,l.Y)(m.Z,{displaySignInModal:v,onCloseSignInModal:()=>{y(!1),f((0,r._)((0,i._)({},g),{isOpen:!1}))},isStatic:!1,entry:"composer-new-post"}):k?(0,l.Y)(Y.a,{isOpen:g.isOpen,onClose:()=>F(),requirement:k,writerId:null!=(o=null==S?void 0:S.user_id)?o:0}):(0,l.Y)(D,(0,r._)((0,i._)({},g),{isOpen:g.isOpen,onClose:()=>F(),onSuccess:e=>{var t,n;e.isFirstFeedCommentByUser&&"share_center"!==g.surface?f((0,r._)((0,i._)({},g),{firstComment:e})):F(),g.editComment?h({type:"edit_comment",payload:{comment:e}}):h({type:"new_comment",payload:{comment:e,skipFeedInsertion:!!g.restackUrl}}),null==(t=g.onCompose)||t.call(g,e),null==(n=g.resolve)||n.call(g,e)},onError:g.reject})),(0,l.Y)(b.aF,{isOpen:g.isOpen&&!!g.firstComment,children:g.firstComment&&(0,l.Y)(w.Ic,{module:"@/frontend/feed/NuxModal",resolve:e=>e.FeedNuxShareFirstNote,onRequest:()=>n.e("22679").then(n.bind(n,15722)),onClose:()=>F(),comment:g.firstComment})})]})}function L(){return(0,c.useContext)(P)}function O(e){var t,n;let i=(0,p.Jd)(),r=null==e?void 0:e.post,a=(null==e?void 0:e.type)=="comment"?null!=(n=null==(t=e.parentComments)?void 0:t[0])?n:e.comment:null,{user_id:l}=null!=a?a:{},{reply_minimum_role:o}=null!=a?a:{},s=(0,S.GQ)(null!=l?l:0);if(null==o&&(null==r?void 0:r.write_comment_permissions)==="only_paid"&&(o="paid_subscriber"),!l||!o||(null==e?void 0:e.canReply)||a&&i&&(0,I.fP)(a,i.id))return null;if(o){if("free_subscriber"===o&&(!s||!["free_subscription","subscribed"].includes(s)))return"free_subscriber";if("paid_subscriber"===o&&"subscribed"!==s)return"paid_subscriber"}return null}},2548:function(e,t,n){n.d(t,{I1:()=>u.I1,IE:()=>T,Qe:()=>y,YW:()=>w,Ye:()=>u.Ye,bi:()=>F,cJ:()=>k,fz:()=>Y,h1:()=>b,ix:()=>S,jA:()=>p.jA,jC:()=>I,p2:()=>D});var i=n(69277),r=n(70408),a=n(32641),l=n(4006),o=n(32485),s=n.n(o),c=n(17402);n(17988);var d=n(56804);n(68349);var u=n(76977);n(63136);var p=n(95187),h=n(24216),m=n(28379);n(11510);var g=n(49807),f=n(57324),v=n(50321);let b=(0,c.forwardRef)((e,t)=>{var{isPadded:n=!0,className:o,linkClassName:c}=e,d=(0,a._)(e,["isPadded","className","linkClassName"]);return(0,l.Y)("div",{ref:t,className:s()(v.A.linkRow,n&&v.A.isPadded,o),children:(0,l.Y)(y,(0,r._)((0,i._)({},d),{className:c}))})});function y(e){var{children:t,className:n,href:o,newTab:c,onClick:p,noAnchor:h,native:m,utmCampaign:b,utmSource:y,isSelected:Y}=e,_=(0,a._)(e,["children","className","href","newTab","onClick","noAnchor","native","utmCampaign","utmSource","isSelected"]);let w="undefined"!=typeof location?location.pathname:"",C=h||null==o?"div":"a",k=o&&(0,g.yRP)(o,{utm_source:y||w,utm_medium:f.Jn.reader2,utm_campaign:b});return(0,l.Y)(u.pT,(0,r._)((0,i._)({as:C,className:s()(v.A.linkRowA,n,(k||p)&&null==Y&&v.A.isClickable,Y&&v.A.isSelected,null!=Y&&v.A.isSelectable),"data-selected":Y,href:k,target:c?"_blank":void 0,onClick:e=>{p&&p(e),!e.defaultPrevented&&h&&k&&(0,d.o)(e,k,{native:m,newTab:c})},showFocus:!0,animate:!0},_),{children:t}))}function Y(e){var{className:t,variant:n,size:r,serif:o,isConstrained:c,maxLines:d=3}=e,u=(0,a._)(e,["className","variant","size","serif","isConstrained","maxLines"]);return(0,l.Y)("div",(0,i._)({className:s()("reader2-paragraph",n&&"reader2-".concat(n),r&&"reader2-font-".concat(r),o&&"reader2-font-serif",c&&"reader2-clamp-lines reader2-".concat(d,"-lines"),t)},u))}function _(e){let{className:t,children:n}=e;return(0,l.Y)("div",{className:s()("reader-nav-center",t),children:(0,l.Y)("div",{className:"reader2-page reader2-font-base",children:n})})}function w(e){let{className:t,scrollRef:n,children:i}=e;return(0,l.Y)(C,{ref:n,children:(0,l.Y)(_,{className:t,children:i})})}let C=(0,c.forwardRef)((e,t)=>(0,l.Y)(m.t,{children:(0,l.Y)("div",(0,i._)({id:"reader-nav-page-scroll",className:s()("reader-nav-page-scroll",e.className),ref:t},e))}));function k(e){var{gap:t=16}=e,n=(0,a._)(e,["gap"]);return(0,l.Y)(u.I1,(0,r._)((0,i._)({},n),{className:s()(v.A.pageStack,v.A["gap_".concat(t)])}))}(0,h.a)("reader2-page-top"),(0,h.a)(v.A.pageTopFixed),(0,h.a)("reader2-page-body");let S=(0,h.a)(v.A.pageStack),I=(0,h.a)("reader2-page-center");(0,h.a)("reader2-modal-title-text"),(0,h.a)("reader2-column"),(0,h.a)("reader2-text-h3 reader2-section-title"),(0,h.a)("reader2-text-h4"),(0,h.a)("reader2-item-title");let F=(0,h.a)("reader2-item-meta");(0,h.a)("reader2-form-error"),(0,h.a)("reader2-subtitle"),(0,h.a)("reader2-separator","hr"),(0,h.a)("reader2-page-section withTitle"),(0,h.a)("reader2-row reader2-split-row");let D=(0,h.a)(s()(v.A.hoverLink,"pencraft"),"a");function T(e){return(0,l.Y)(D,(0,i._)({target:"_blank"},e))}},5180:function(e,t,n){n.d(t,{B9:()=>k,Ro:()=>w,To:()=>y,_0:()=>_,bL:()=>N,et:()=>v,l$:()=>C,tO:()=>Y,wA:()=>b});var i=n(69277),r=n(70408),a=n(83673),l=n.n(a),o=n(2404),s=n.n(o),c=n(17402),d=n(96467),u=n(12501),p=n(68349),h=n(504),m=n(16291),g=n(70189),f=n(49807);let v=(0,c.createContext)({dispatch:()=>Promise.resolve()});function b(){return(0,c.useContext)(v).dispatch}let y={isSigningIn:!1,signInNoExit:!1,pages:[],readingQueue:[],posts:new Map,mediaClipsAsPosts:new Map,publications:new Map,referringPubByPostId:{},comments:new Map,inboxItems:new Map,hiddenItems:[],publicationSettings:new Map,publicationRecommendations:new Map,feedItemStats:new Map,activeLiveStreams:[],mutedFeedItems:new Set},Y=(0,c.createContext)(y);function _(){let{initialData:e={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,d.K)(k,e,e=>{let{feedItem:t,readingQueue:n,initialPost:i}=e,r=y;return t&&(r=F(r,t)),n&&(r=A(r,n)),i&&(r=T(r,{posts:[i.post],publications:l()([i.publication,i.referringPub]),publicationSettings:new Map([[i.publication.id,i.publicationSettings]]),recommendationsByPubId:i.referringRecommendation?new Map([[i.referringRecommendation.recommended_publication_id,i.referringRecommendation]]):void 0})),r})}function w(){return(0,c.useContext)(Y)}function C(e){let t=w();return!!e&&"entity_key"in e&&t.hiddenItems.includes(e.entity_key)}function k(e,t){var n,a,l,o,c,d,v,b,Y,_,w;switch(t.type){case"sign_in":return(0,r._)((0,i._)({},e),{lastDispatchType:t.type,isSigningIn:t.payload.isSigningIn,signInNoExit:null!=(n=t.payload.signInNoExit)&&n});case"page_load":{let{result:n}=t.payload;return(0,r._)((0,i._)({},I(e,n.items)),{lastDispatchType:t.type,pages:(0,u.VL)(e.pages,t)})}case"post_load":{let{post:n,publication:i}=t.payload;return T(e,{posts:[n],publications:[i]})}case"post_like":{let{postId:n,mediaClipId:i,isLiked:r}=t.payload,a=i?e.mediaClipsAsPosts.get(i):e.posts.get(n);return D(e,t.type,n,(v=a,{reaction:null!=(b=r)?b:!v.reaction,reactions:{"❤":((null==(Y=v.reactions)?void 0:Y["❤"])||0)+(b?1:-1)}}),i)}case"post_restack":{let{postId:n,mediaClipId:i,isRestacked:r}=t.payload,a=i?e.mediaClipsAsPosts.get(i):e.posts.get(n);return a?D(e,t.type,n,(_=a,{restacked:w=r,restacks:(_.restacks||0)+(w?1:-1)}),i):e}case"post_delete":{let{publication:n,post:a}=t.payload,l=new Map(e.posts),o=new Map(e.mediaClipsAsPosts);a.media_clip_id&&o.delete(a.media_clip_id),l.delete(a.id);let s=new Map([...e.comments].filter(e=>{let[t,n]=e;return n.post_id!==a.id}));return[(0,f.kGL)(a.id,{noBase:!0}),(0,f.q$n)(n,a,{noBase:!0})].includes(window.location.pathname)&&(0,p.V2)(g.TJ,{replace:!0}),(0,r._)((0,i._)({},e),{lastDispatchType:t.type,posts:l,mediaClipsAsPosts:o,comments:s,pages:e.pages.map(e=>(0,r._)((0,i._)({},e),{result:e.result?(0,r._)((0,i._)({},e.result),{items:e.result.items.filter(e=>{var t;return(null==(t=e.post)?void 0:t.id)!==a.id})}):e.result}))})}case"post_save":{let{postId:n,isSaved:i}=t.payload,r=e.posts.get(n),a=null==i?!(null==r?void 0:r.is_saved):i;return r?D(e,t.type,n,{is_saved:a}):e}case"comment_like":{let{commentId:n,isLiked:l}=t.payload,o=e.comments.get(n);if(!o)return e;return(0,r._)((0,i._)({},e),{lastDispatchType:t.type,comments:E(e.comments,n,(0,r._)((0,i._)({},o),{reaction:l?"❤":void 0,reactions:(0,r._)((0,i._)({},o.reactions),{"❤":((null==(a=o.reactions)?void 0:a["❤"])||0)+(l?1:-1)}),reaction_count:(o.reaction_count||0)+(l?1:-1)}))})}case"comment_restack":{let{commentId:n,isRestacked:a}=t.payload,l=e.comments.get(n);return(0,r._)((0,i._)({},e),{lastDispatchType:t.type,comments:l?E(e.comments,n,(0,r._)((0,i._)({},l),{restacked:a,restacks:(l.restacks||0)+(a?1:-1)})):e.comments})}case"comment_delete":{let{comment:n}=t.payload,a=new Map(e.posts),l=new Map(e.mediaClipsAsPosts),o=new Map([...e.comments].filter(e=>{let[t,i]=e;return i.id!==n.id&&!new RegExp("(^|.)".concat(n.id,"(.|$)")).test(i.ancestor_path)})),s=a.get(n.post_id),c=n.media_clip_id?l.get(n.media_clip_id):null,d=n.ancestor_path&&o.get(Number(n.ancestor_path.split(".").pop()));return d?o.set(d.id,(0,r._)((0,i._)({},d),{children_count:(d.children_count||1)-1,children:(d.children||[]).filter(e=>e.id!==n.id)})):(s||c)&&(s&&a.set(s.id,(0,r._)((0,i._)({},s),{child_comment_count:(s.child_comment_count||1)-1})),c&&l.set(n.media_clip_id,(0,r._)((0,i._)({},c),{child_comment_count:(c.child_comment_count||1)-1}))),[(0,f.Zgx)(n,{noBase:!0})].includes(window.location.pathname)&&(0,p.V2)(g.TJ,{replace:!0}),(0,r._)((0,i._)({},e),{lastDispatchType:t.type,posts:a,mediaClipsAsPosts:l,comments:o,pages:e.pages.map(e=>(0,r._)((0,i._)({},e),{result:e.result?(0,r._)((0,i._)({},e.result),{items:e.result.items.filter(e=>{var t;return(null==(t=e.comment)?void 0:t.id)!==n.id&&!(e.parentComments||[]).filter(Boolean).map(e=>e.id).includes(n.id)})}):e.result}))})}case"clip_delete":{let{mediaClip:n,author:a}=t.payload;return[(0,g.w1)(n,a,{noBase:!0})].includes(window.location.pathname)&&(0,p.V2)(g.TJ,{replace:!0}),(0,r._)((0,i._)({},e),{lastDispatchType:t.type,pages:e.pages.map(e=>(0,r._)((0,i._)({},e),{result:e.result?(0,r._)((0,i._)({},e.result),{items:e.result.items.filter(e=>{var t;return"post"!==e.type||(null==(t=e.mediaClip)?void 0:t.id)!==n.id})}):e.result}))})}case"new_post":return(0,r._)((0,i._)({},e),{lastDispatchType:t.type,publications:new Map([...e.publications].concat([[t.payload.publication.id,t.payload.publication]])),posts:new Map([...e.posts].concat([[t.payload.post.id,t.payload.post]])),pages:[{error:null,isLoading:!1,result:{items:[{type:"post",entity_key:(0,g.pi)(t.payload.post.id),publication:t.payload.publication,post:t.payload.post,context:t.payload.context||{}}]}},...e.pages]});case"new_comment":{let{comment:n,skipFeedInsertion:a}=t.payload,s=new Map(e.posts),c=new Map(e.mediaClipsAsPosts),d=s.get(n.post_id),u=n.media_clip_id?c.get(n.media_clip_id):null;d&&s.set(d.id,(0,r._)((0,i._)({},d),{child_comment_count:(d.child_comment_count||0)+1})),u&&c.set(n.media_clip_id,(0,r._)((0,i._)({},u),{child_comment_count:(u.child_comment_count||0)+1}));let p=new Map(e.comments);p.set(n.id,n);let m=((null==(l=n.ancestor_path)?void 0:l.split("."))||[]).map(Number).filter(Boolean).map(e=>p.get(e)||null),f=null!=(o=m[m.length-1])?o:null;f&&p.set(f.id,(0,r._)((0,i._)({},f),{children_count:(f.children_count||0)+1,children:[n].concat(f.children||[])}));let v=!!n.ancestor_path,b=e.pages;return v||a||(b=[{error:null,isLoading:!1,result:{items:[(0,h.n5)({type:"comment",entity_key:(0,g.a5)(n.id),comment:n,parentComments:m,publication:null,post:null,canReply:!0,context:{type:"comment",timestamp:new Date().toISOString(),users:[],fallbackReason:"",fallbackUrl:null}})]}},...e.pages]),(0,r._)((0,i._)({},e),{lastDispatchType:t.type,posts:s,mediaClipsAsPosts:c,comments:p,pages:b})}case"edit_comment":{let{comment:n}=t.payload,a=new Map(e.comments);return a.set(n.id,n),(0,r._)((0,i._)({},e),{lastDispatchType:t.type,comments:a})}case"comments_load":{let{comments:n}=t.payload,a=[],l=n.slice();for(;l.length>0;){let e=l.pop();a.push(e),l.push(...e.children||[])}return(0,r._)((0,i._)({},e),{lastDispatchType:t.type,comments:new Map([...e.comments].concat(a.map(e=>[e.id,e])))})}case"item_load":{let{item:n}=t.payload;return(0,r._)((0,i._)({},F(e,n)),{lastDispatchType:t.type})}case"items_load":{let{items:n}=t.payload;return(0,r._)((0,i._)({},I(e,n)),{lastDispatchType:t.type})}case"new_feed_items":{let n=[...e.pages];if(t.payload.insertLocation){let e={error:null,isLoading:!1,result:{items:t.payload.feedItems}};"prepend"===t.payload.insertLocation?n.unshift(e):"append"===t.payload.insertLocation&&n.push(e)}return(0,r._)((0,i._)({},I(S(e,10),t.payload.feedItems)),{lastDispatchType:t.type,pages:n})}case"items_cull":{let t=null==(d=e.pages.find(e=>{var t;return null==(t=e.result)?void 0:t.originalCursorTimestamp}))||null==(c=d.result)?void 0:c.originalCursorTimestamp;if(t&&(0,m.A)(t).isBefore((0,m.A)().subtract(10,"minutes")))return y;return S(e,10)}case"inbox_load":return A(e,t.payload);case"active_live_streams_load":if(s()(e.activeLiveStreams,t.payload))return e;return(0,r._)((0,i._)({},e),{activeLiveStreams:t.payload.filter(e=>(0,m.A)(e.liveStream.started_streaming_at).isBefore((0,m.A)().subtract(1,"minute")))});case"inbox_item_archive":{let{contentKey:n,isArchived:a}=t.payload,l=e.inboxItems.get(n);return(0,r._)((0,i._)({},e),{inboxItems:E(e.inboxItems,n,(0,r._)((0,i._)({},l),{archived_at:a?new Date().toISOString():null}))})}case"item_hide":{let{entityKey:n}=t.payload;return(0,r._)((0,i._)({},e),{lastDispatchType:t.type,hiddenItems:[...e.hiddenItems,n]})}case"item_unhide":{let{entityKey:n}=t.payload;return(0,r._)((0,i._)({},e),{lastDispatchType:t.type,hiddenItems:e.hiddenItems.filter(e=>e!==n)})}case"item_dismiss":{let{entityKey:n}=t.payload;return(0,r._)((0,i._)({},e),{lastDispatchType:t.type,pages:e.pages.map(e=>(0,r._)((0,i._)({},e),{result:e.result?(0,r._)((0,i._)({},e.result),{items:e.result.items.filter(e=>"entity_key"in e&&e.entity_key!==n)}):e.result}))})}case"update_paused_notifications":{let n=new Set([...e.mutedFeedItems,...t.payload.map(e=>e.entity_key)]);return(0,r._)((0,i._)({},e),{mutedFeedItems:n})}case"item_pause_notifications":{let{entityKey:n}=t.payload,a=new Set(e.mutedFeedItems);return a.add(n),(0,r._)((0,i._)({},e),{mutedFeedItems:a})}case"item_unpause_notifications":{let{entityKey:n}=t.payload,a=new Set(e.mutedFeedItems);return a.delete(n),(0,r._)((0,i._)({},e),{mutedFeedItems:a})}}return(0,r._)((0,i._)({},e),{lastDispatchType:t.type,pages:(0,u.VL)(e.pages,t)})}function S(e,t){let n,a=0,l=[];for(let i of e.pages){var o;let e=null==(o=i.result)?void 0:o.items;if(!e||i.error||i.isLoading)break;for(let t of(n=i,e))l.push(t),a++;if(a>t)break}if(!(null==n?void 0:n.result))return e;let s=(0,r._)((0,i._)({},n),{result:(0,r._)((0,i._)({},n.result),{items:l})});return(0,r._)((0,i._)({},e),{pages:[s]})}function I(e,t){let n=new Map(e.publications),a=new Map(e.posts),l=new Map(e.mediaClipsAsPosts),o=new Map(e.comments),s=new Set(e.mutedFeedItems);for(let e of t){if("publication"in e&&e.publication&&n.set(e.publication.id,e.publication),"post"in e){let{post:t,mediaClip:n}=e;n?l.set(n.id,t):t&&a.set(t.id,t),e.isMuted&&s.add(e.entity_key)}if("comment"in e){let{comment:t}=e;if(t&&(o.set(t.id,t),t.attachments)){for(let e of t.attachments)if("post"===e.type){var c;(null==(c=e.mediaClip)?void 0:c.id)?l.set(e.mediaClip.id,e.post):a.set(e.post.id,e.post),n.set(e.publication.id,e.publication)}}e.isMuted&&s.add(e.entity_key)}if("parentComments"in e)for(let t of e.parentComments)t&&o.set(t.id,t)}return(0,r._)((0,i._)({},e),{publications:n,posts:a,mediaClipsAsPosts:l,comments:o,mutedFeedItems:s})}function F(e,t){var n;return(0,r._)((0,i._)({},e),{posts:t.post&&!t.mediaClip?E(e.posts,t.post.id,t.post):e.posts,mediaClipsAsPosts:t.post&&t.mediaClip?E(e.mediaClipsAsPosts,t.mediaClip.id,t.post):e.mediaClipsAsPosts,publications:t.publication?E(e.publications,t.publication.id,t.publication):e.publications,comments:new Map([...e.comments].concat([t.comment,...null!=(n=t.parentComments)?n:[]].filter(Boolean).map(e=>[e.id,e]))),feedItemStats:t.feedItemStats&&t.feedItemStats.entity_key?E(e.feedItemStats,t.feedItemStats.entity_key,t.feedItemStats):e.feedItemStats,mutedFeedItems:new Set(t.entity_key&&t.isMuted?[t.entity_key]:void 0)})}function D(e,t,n,a,l){let o=new Map(e.posts),s=new Map(e.mediaClipsAsPosts),c=l?s.get(l):o.get(n);return c&&(l?s.set(l,(0,i._)({},c,a)):o.set(c.id,(0,i._)({},c,a))),(0,r._)((0,i._)({},e),{lastDispatchType:t,posts:o,mediaClipsAsPosts:s})}function T(e,t){let{posts:n,publications:a,publicationSettings:l,recommendationsByPubId:o}=t,s=new Map(e.posts);for(let e of n)s.set(e.id,(0,i._)({},s.get(e.id),e));let c=new Map(e.publications);for(let e of a)c.set(e.id,(0,i._)({},c.get(e.id),e));let d=new Map([...e.publicationSettings.entries(),...l?l.entries():[]]),u=new Map([...e.publicationRecommendations.entries(),...o?o.entries():[]]);return(0,r._)((0,i._)({},e),{posts:s,publications:c,publicationSettings:d,publicationRecommendations:u})}function A(e,t){return(0,r._)((0,i._)({},T(e,t)),{readingQueue:t.inboxItems.map(e=>e.content_key),inboxItems:new Map([...e.inboxItems].concat(t.inboxItems.map(e=>[e.content_key,e]))),referringPubByPostId:(0,i._)({},e.referringPubByPostId,t.referringPubByPostId)})}function E(e,t,n){let i=new Map(e);return i.set(t,n),i}function N(e,t){var n;return(n=e,[t].map(e=>{var t,r,a,l;let o=(0,i._)({},e);return"publication"in o&&o.publication&&(o.publication=null!=(t=n.publications.get(o.publication.id))?t:o.publication),"post"in o&&o.post&&(o.post=null!=(r="mediaClip"in o&&o.mediaClip&&n.mediaClipsAsPosts.get(o.mediaClip.id)||n.posts.get(o.post.id))?r:o.post),"mediaClip"in o&&o.mediaClip&&(o.mediaClip=null!=(a=n.mediaClipsAsPosts.get(o.mediaClip.id))?a:o.mediaClip),"comment"in o&&o.comment&&(o.comment=null!=(l=n.comments.get(o.comment.id))?l:o.comment),"parentComments"in o&&o.parentComments&&(o.parentComments=o.parentComments.map(e=>e&&n.comments.get(e.id)||null)),o}))[0]}},83804:function(e,t,n){n.d(t,{Kd:()=>S,lC:()=>C,zK:()=>w});var i=n(4006),r=n(32485),a=n.n(r),l=n(49921),o=n(5061),s=n(17402),c=n(17988),d=n(78649),u=n(82519),p=n(84605),h=n(85478),m=n(17028),g=n(69553),f=n(46376),v=n(70577),b=n(32848),y=n(43296),Y=n(55714),_=n(93375);let w=e=>{let{liveStream:t,handle:n,subscriptions:r,setSubscriptions:a,className:o,isHostView:s,isOpen:d=!0,onClose:u=()=>void 0,showClose:h=!1}=e,{iString:f}=(0,p.GO)(),v=(0,c.useMediaQuery)({maxWidth:800});return(0,i.FD)(m.VP,{display:!d||(null==n?void 0:n.active)||v?"none":"flex",width:400,alignSelf:"stretch",sizing:"border-box",borderLeft:"detail",className:o,children:[(0,i.FD)(m.pT,{padding:16,borderBottom:"detail",alignItems:"center",justifyContent:"space-between",children:[(0,i.Y)(m.EY.H4,{userSelect:"none",children:f("Live chat")}),h&&(0,i.Y)(m.K0,{onClick:u,children:(0,i.Y)(l.A,{size:20})})]}),(0,i.Y)(C,{liveStream:t,isHostView:s}),(0,i.Y)(g.T,{liveStream:t,subscriptions:r,setSubscriptions:a,showShareButton:!s})]})},C=e=>{var t,n;let{liveStream:r,isHostView:a}=e,[l,c]=(0,s.useState)([]),[d,u]=(0,s.useState)(!0),p=(0,s.useRef)(null),{getConfigFor:g}=(0,h.mJ)(),_=g("thefp_enable_web_livestream_kicking"),w=(0,y.XW)(),C=(0,b.n7)(),F=e=>{c(t=>t.find(t=>t.id===e.id)?t:[...t,e].slice(-1e3))};if((0,s.useEffect)(()=>null==w?void 0:w.listen({[(0,Y.sl)({streamId:r.liveStream.id})]:e=>{var t,n;let{data:i}=e;(null==i||null==(t=i.message)?void 0:t.type)==="live-stream:message-sent"&&F(i.message.message),(null==i||null==(n=i.message)?void 0:n.type)==="live-stream:viewer-count-updated"&&i.message.num_viewers_joined>0&&F(i.message),d&&setTimeout(()=>{p.current&&(p.current.scrollTop=p.current.scrollHeight)},0)}}),[w,r.liveStream.id,d]),(0,s.useEffect)(()=>{p.current&&!r.liveStreamInformation.desktopPlaybackUrl&&(p.current.scrollTop=p.current.scrollHeight)},[r.liveStreamInformation.desktopPlaybackUrl]),!a&&!r.liveStreamInformation.desktopPlaybackUrl)return(0,i.Y)(v.S,{});if(a&&0===l.length)return(0,i.Y)(m.VP,{flex:"grow",position:"relative",justifyContent:"center",children:(0,i.Y)(m.pT,{justifyContent:"center",children:(0,i.FD)(m.VP,{alignItems:"center",gap:16,children:[(0,i.Y)(o.A,{size:24}),(0,i.Y)(m.EY.B4,{translated:!0,weight:"semibold",children:"Live chat will appear here"})]})})});let D=null==(t=C.result)?void 0:t.publicationUserMap.get(null!=(n=r.liveStream.publication_id)?n:-1),T=(null==D?void 0:D.role)==="admin";return(0,i.FD)(m.VP,{flex:"grow",position:"relative",children:[(0,i.Y)(k,{ref:p,onScroll:()=>{p.current&&u(32>=Math.abs(p.current.scrollTop))},children:(0,i.Y)(S,{children:l.map(e=>"user"in e?(0,i.Y)(f.K,{message:e,showBlockButton:!!T&&!!_,liveStream:r.liveStream,disableUserLinks:a},e.id):e.num_viewers_joined>0?(0,i.Y)(f.t,{message:e,disableUserLinks:a},e.id):null)})}),(0,i.Y)(I,{scrollRef:p,hidden:d})]})},k=(0,m.I4)({display:"flex",direction:"column-reverse",flex:"grow",scrollBar:"hidden",overflow:"auto",position:"relative"}),S=(0,m.I4)({display:"flex",direction:"column",padding:16,gap:16}),I=e=>{let{scrollRef:t,hidden:n}=e;return(0,i.Y)(d.Q,{children:(0,i.Y)(m.pT,{bg:"primary",radius:"full",className:a()(_.A.jumpButton,n&&_.A.hidden),children:(0,i.Y)(m.K0,{priority:"secondary-outline",rounded:!0,onClick:()=>{setTimeout(()=>{var e;null==(e=t.current)||e.scrollTo({top:t.current.scrollHeight,behavior:"smooth"})},0)},children:(0,i.Y)(u.A,{})})})})}},55700:function(e,t,n){function i(e){return e?t=>{t.preventDefault(),e()}:null}n.d(t,{M:()=>i}),n(4006),n(32485),n(6498),n(33031),n(17402),n(37343),n(28308),n(46275),n(46271),n(44333),n(68349),n(76977),n(63136),n(7615),n(98643),n(887),n(45133),n(28649),n(46453),n(57322),n(47408),n(2481),n(94954),n(97307),n(68683),n(62088),n(11510),n(32848),n(59167),n(39318),n(70189),n(49807),n(82776),n(44567)},6074:function(e,t,n){n.d(t,{u:()=>r});var i=n(69277);function r(e,t){return(0,i._)({},e,Object.fromEntries(Object.entries(null!=t?t:{}).filter(e=>{let[t,n]=e;return null!=n})))}},63840:function(e,t,n){n.d(t,{a:()=>A});var i=n(79785),r=n(4006),a=n(36049),l=n.n(a),o=n(45773),s=n(1839),c=n(40972),d=n(17402),u=n(84605),p=n(55561),h=n(86500),m=n(94729),g=n(35369),f=n(76977),v=n(16993),b=n(81203),y=n(63136),Y=n(65842),_=n(36372),w=n(49807),C=n(57324),k=n(96583);function S(){let e=(0,i._)([""," added"]);return S=function(){return e},e}function I(){let e=(0,i._)([""," removed"]);return I=function(){return e},e}function F(){let e=(0,i._)([""," updated"]);return F=function(){return e},e}function D(){let e=(0,i._)([""," created"]);return D=function(){return e},e}function T(){let e=(0,i._)(["Manage Substacks (",")"]);return T=function(){return e},e}let A=e=>{let{reads:t,open:n,close:i}=e;return(0,r.Y)(E,{reads:t,open:n,close:i})},E=e=>{var t,n,i;let{list:a,reads:l,open:c,close:p}=e,{popToast:b}=(0,_.d)(),{iTemplate:w,iString:C}=(0,u.GO)(),[T,A]=(0,d.useState)(null!=(t=null==a?void 0:a.name)?t:"My list"),[E]=(0,d.useState)(null!=(n=null==a?void 0:a.slug)?n:""),[P,L]=(0,d.useState)(null!=(i=null==a?void 0:a.publications)?i:[]),[O,B]=(0,d.useState)(!1),M=P?null==l?void 0:l.filter(e=>!(null==P?void 0:P.map(e=>e.id).includes(e.id))):l;(0,d.useEffect)(()=>{(0,h.u4)(h.qY.LIST_MANAGEMENT_MODAL_SEEN,{editing:!!a})},[]);let R=()=>{var e,t;A(null!=(e=null==a?void 0:a.name)?e:"My list"),L(null!=(t=null==a?void 0:a.publications)?t:[]),B(!1)},U=e=>{L(null==P?void 0:P.filter(t=>t.id!==e.id)),B(!0),(0,h.u4)(h.qY.LIST_MANAGEMENT_MODAL_PUBLICATION_REMOVED,{pub_id:e.id}),b(()=>(0,r.Y)(_.y,{Icon:s.A,text:w(I(),e.name)}))},j=async()=>{let e,t,n={name:T,slug:E.length>0?E:void 0,publications:null==P?void 0:P.map(e=>e.id)};try{var i;a?(e=w(F(),T),t=await (0,m.x6)("/api/v1/list/".concat(a.id),{method:"PUT",json:n})):(e=w(D(),T),t=await (0,m.x6)("/api/v1/list",{method:"POST",json:n})),(0,h.u4)(h.qY.LIST_MANAGEMENT_MODAL_SUBMITTED,{data:n,editing:!!a}),b(()=>(0,r.Y)(_.y,{Icon:o.A,text:e})),R(),p(null!=(i=null==t?void 0:t.list)?i:{})}catch(e){b(()=>(0,r.Y)(_.y,{text:C("Something went wrong. Please try again")}))}},z=()=>{(0,h.u4)(h.qY.LIST_MANAGEMENT_MODAL_CLOSED,{editing:!!a}),R(),p()};return(0,r.FD)(v.aF,{isOpen:c,onClose:z,className:k.A.modalContainer,children:[(0,r.Y)(v.rQ,{onClose:z,showClose:!0,title:a?C("Edit list"):C("Create new list")}),(0,r.Y)(v.cw,{children:(0,r.FD)(f.I1,{gap:48,alignItems:"stretch",justifyContent:"start",children:[(0,r.FD)(f.I1,{flex:"grow",gap:8,children:[(0,r.Y)(y.EY.B3,{translated:!0,weight:"semibold",children:"List Name"}),(0,r.Y)(Y.ks,{placeholder:C("My List"),value:T,onChange:e=>{A(e.currentTarget.value),O||B(!0)}})]}),(0,r.Y)(N,{currentPublicationIds:null==P?void 0:P.map(e=>e.id),existingSubscriptions:null==l?void 0:l.map(e=>e.id),possibleSuggestions:M,onAdd:e=>{L([...P,e]),B(!0),(0,h.u4)(h.qY.LIST_MANAGEMENT_MODAL_PUBLICATION_ADDED,{pub_id:e.id}),b(()=>(0,r.Y)(_.y,{Icon:o.A,text:w(S(),e.name)}))},onRemove:U}),P.length>0&&(0,r.Y)(x,{pubs:P,removePub:U})]})}),(0,r.Y)(v.jl,{primaryButton:(0,r.Y)(g.$n,{priority:"primary",disabled:!(O&&T&&P.length>=1),onClick:j,children:(0,r.Y)(y.EY.B3,{color:"primary",children:a?C("Update"):C("Create")})}),secondaryButton:(0,r.Y)(g.$n,{priority:"secondary",onClick:z,children:(0,r.Y)(y.EY.B3,{translated:!0,children:"Cancel"})}),showDivider:!0})]})},N=e=>{let t,{currentPublicationIds:n,existingSubscriptions:i,possibleSuggestions:a,onAdd:o,onRemove:s}=e,{iString:m}=(0,u.GO)(),[g,v]=(0,d.useState)(""),[b,_]=(0,d.useState)(),{language:w}=(0,u.GO)(),{allResults:C,onSearch:S,isLoading:I}=(0,p.z)({defaultQuery:g,language:w}),F=new Set(i);(0,d.useEffect)(()=>{g&&(S(g),(0,h.u4)(h.qY.LIST_MANAGEMENT_MODAL_PUBLICATION_SEARCHED,{query:g}))},[g]),(0,d.useEffect)(()=>{a&&_(l()(a).slice(0,3))},[n,a]);let D=C.results;return t=""===g?[]:D.sort((e,t)=>!F.has(e.id)-!F.has(t.id)||D.indexOf(e)-D.indexOf(t)),(0,r.FD)(f.I1,{justifyContent:"start",gap:20,flex:"grow",children:[(0,r.Y)(y.EY.B3,{translated:!0,align:"left",className:k.A.fullWidth,weight:"semibold",children:"Add Substacks"}),(0,r.FD)(f.Ye,{justifyContent:"space-between",alignItems:"center",children:[(0,r.Y)(Y.ks,{placeholder:"Search for Substacks",value:g,onChange:e=>v(e.currentTarget.value)}),!!t.length&&(0,r.Y)("div",{onClick:()=>v(""),children:(0,r.Y)(c.A,{width:30,style:{cursor:"pointer"}})})]}),(0,r.Y)(r.FK,{children:t.length?(0,r.Y)(f.I1,{flex:"grow",gap:20,justifyContent:"start",paddingTop:4,children:t.map(e=>{let t=null==n?void 0:n.includes(e.id);return(0,r.Y)(L,{pub:e,buttonText:t?m("Remove"):m("Add"),onClick:t?()=>s(e):()=>o(e)},e.id)})}):g&&I?(0,r.Y)(y.EY.Meta,{translated:!0,children:"Searching..."}):g&&0===t.length?(0,r.Y)(y.EY.Meta,{translated:!0,children:"No publications found"}):(0,r.Y)(P,{pubs:b,onAdd:o,onRemove:s})})]})},P=e=>{let{pubs:t,currentPubs:n,onAdd:i,onRemove:a}=e,{iString:l}=(0,u.GO)();return(null==t?void 0:t.length)?(0,r.FD)(f.I1,{justifyContent:"start",gap:12,children:[(0,r.Y)(y.EY.Meta,{translated:!0,children:"Suggestions"}),t.map(e=>{let t=null==n?void 0:n.includes(e.id);return(0,r.Y)(L,{pub:e,buttonText:t?l("Remove"):l("Add"),onClick:()=>{t?a(e):((0,h.u4)(h.qY.LIST_MANAGEMENT_MODAL_PUBLICATION_SUGGESTION_ADDED,{pub_id:e.id}),i(e))}},e.id)})]}):(0,r.Y)(y.EY.Meta,{translated:!0,children:"Search publications to get started"})},x=e=>{let{pubs:t,removePub:n}=e,{iTemplate:i}=(0,u.GO)();return(0,r.FD)(f.I1,{justifyContent:"start",gap:20,flex:"grow",children:[(0,r.Y)(y.EY.B3,{align:"left",weight:"semibold",children:i(T(),t.length)}),(0,r.Y)(f.I1,{justifyContent:"start",gap:16,flex:"grow",children:t.map(e=>(0,r.Y)(L,{pub:e,buttonText:"Remove",onClick:()=>n(e)},e.id))})]})},L=e=>{let{pub:t,buttonText:n,onClick:i,disable:a}=e;return(0,r.Y)("a",{href:(0,w.yRP)((0,w.$_T)(t),{utm_source:C.VU.listManagementModal}),target:"_blank",rel:"noopener",children:(0,r.FD)(f.Ye,{alignItems:"center",justifyContent:"space-between",gap:12,flex:"grow",children:[(0,r.Y)(b.Nq,{pub:t,size:40}),(0,r.FD)(f.I1,{minWidth:0,flex:"grow",children:[(0,r.Y)(y.EY.B4,{weight:"semibold",ellipsis:!0,children:t.name}),(0,r.Y)(y.EY.B4,{color:"secondary",ellipsis:!0,children:t.author_name})]}),(0,r.Y)(g.$n,{onClick:e=>{e.preventDefault(),i()},priority:"secondary",disabled:a,children:n})]})})}},16884:function(e,t,n){n.d(t,{GQ:()=>v,Zm:()=>f,yc:()=>y});var i=n(69277),r=n(4006),a=n(17402),l=n(58050),o=n(46271),s=n(94729),c=n(1683),d=n(36372),u=n(32848),p=n(40659),h=n(96301),m=n(49807),g=n(82776);function f(e){var t,n,i;let{publicationId:s,publication:c,publicationName:p,user:h,allowSecondaryPublications:m=!0,subscriptionSource:f,sourceNoteId:v}=e;s=null!=(i=null!=(n=null==c?void 0:c.id)?n:s)?i:null==h||null==(t=h.primary_publication)?void 0:t.id;let _=(0,o.Jd)(),w=(0,d.d)(),C=(0,l.uy)(),k=(0,u.n7)(),[S,I]=(0,a.useState)(!1),F=!!s&&function(e,t,n){if(!e||!t||!n.hasLoadedOnce||!n.result)return!1;let i=n.result.subscriptionMap.get(t);if(i&&"unsubscribed"!==i.membership_state)return!0;let r=n.result.publicationUserMap.get(t);return!!(r&&(0,g.isAtLeastContributorRole)(r.role))}(_,s,k)||function(e,t,n){let{allowSecondaryPublications:i}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!e||!t||!n.hasLoadedOnce||!n.result)return!1;let{subscriptions:r,publicationUsers:a}=n.result;if(i){for(let e of r)if("unsubscribed"!==e.membership_state&&b(t.id,e.publication_id,n))return!0;for(let e of a)if((0,g.isAtLeastContributorRole)(e.role)&&b(t.id,e.publication_id,n))return!0}return!1}(_,h,k,{allowSecondaryPublications:m}),[D,T]=(0,a.useState)(null),A=k.isLoading||!!D,E=async e=>{var t;if(e&&(e.preventDefault(),e.stopPropagation()),A||F)return;T("subscribing");let n=await y(s,f,{publication:c,user:_,sourceNoteId:v}),i="Subscribed to ".concat(s?null!=(t=null!=p?p:null==c?void 0:c.name)?t:"publication":h?h.name:"profile");if(n.didAction){if(I(!0),w.popToast(()=>(0,r.Y)(d.y,{text:i})),_&&s)try{await k.refetchPublication(s)}catch(e){console.error("Failed to reload subscriptions:",e)}h&&C(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.includes(h.id)?e:[h.id,...e]},{revalidate:!1})}else n.errorMessage&&w.popToast(()=>{var e;return(0,r.Y)(d.y,{text:null!=(e=n.errorMessage)?e:""})});T(null)},N=async e=>{var t;if(e&&(e.preventDefault(),e.stopPropagation()),A||!F)return;T("unsubscribing");let n=await Y(s,f),i="Unsubscribed from ".concat(s?null!=(t=null!=p?p:null==c?void 0:c.name)?t:"publication":h?h.name:"profile");if(n.didAction){if(I(!1),w.popToast(()=>(0,r.Y)(d.y,{text:i})),_&&s)try{await k.refetchPublication(s)}catch(e){console.error("Failed to reload subscriptions:",e)}else if(_)try{await k.refetch()}catch(e){console.error("Failed to reload subscriptions:",e)}}else n.errorMessage&&w.popToast(()=>{var e;return(0,r.Y)(d.y,{text:null!=(e=n.errorMessage)?e:""})});T(null)},P=F&&!D||"subscribing"===D;return{showCta:!!s&&(!_||k.hasLoadedOnce)&&!(_&&_.id===(null==h?void 0:h.id))&&(!F||S||"unsubscribing"===D),isSubscribed:P,hasPublication:!!s,subscribe:E,unsubscribe:N,toggle:P?N:E}}function v(e){let t=(0,u.n7)(),n=(0,o.Jd)();if((null==n?void 0:n.id)===e)return"subscribed";let{result:i}=t;if(!i)return null;let{subscriptions:r,publicationUsers:a}=i;for(let n of a)if((0,g.isAtLeastContributorRole)(n.role)&&b(e,n.publication_id,t))return"subscribed";let l=null;for(let n of r)if(b(e,n.publication_id,t)){var s;l=null!=(s=(0,h.cE)(n.membership_state,l)?n.membership_state:l)?s:null}return l}function b(e,t,n){if(n.isLoading||!n.result)return!1;let i=n.result.publicationMap.get(t);if(i){if(i.author_id===e)return!0;for(let t of i.contributors)if(t.user_id===e)return!0}return!1}async function y(e,t){let n,{publication:r,user:a,sourceNoteId:l,openPubInNewTabAfterSubscription:o=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},d=(0,p.cf)(),u=!1;if(a)try{(await (0,s.x6)("/api/v1/reader/signup/pub",{method:"POST",json:(0,i._)({publication_id:e,email:a.email,source:t,noWelcomeEmail:!0,sourceNoteId:l,first_url:c.R9,first_referrer:c.b7,first_session_url:c.K0,first_session_referrer:c.OG,current_url:c.AT,current_referrer:c.uC},d)})).requires_confirmation?n="Check your email to confirm subscription":u=!0}catch(e){console.error(e),n="Failed to subscribe"}else if(!a){if(!r)try{r=await (0,s.x6)("/api/v1/reader/publication/".concat(e))}catch(e){console.error(e)}if(r&&o){let e=(0,m.eV6)(r,{addBase:!0,user:null!=a?a:void 0});window.open(e,"_blank")}}return{didAction:u,errorMessage:n}}async function Y(e,t){let n,i=!1;try{await (0,s.x6)("/api/v1/subscription/email",{method:"POST",json:{publication_id:e,email_disabled:!0,disable_all:!0,receive_podcast_emails:!1,source:t}}),i=!0}catch(e){console.error(e),n="Failed to unsubscribe"}return{didAction:i,errorMessage:n}}},27747:function(e,t,n){n.d(t,{KQ:()=>F,Uz:()=>D});var i=n(69277),r=n(4006),a=n(32485),l=n.n(a),o=n(17402),s=n(99070),c=n(23623),d=n(84605),u=n(68410),p=n(89490),h=n(76977),m=n(28734),g=n(56371),f=n(13348),v=n(69825),b=n(31790),y=n(8734),Y=n(60649),_=n(7755),w=n(56458),C=n(4016),k=n(56262),S=n(92967),I=n(91867);let F=e=>{let{isFreeSubscribed:t,isSubscribed:n,isTesting:i,post:a,pub:l,section:s,variant:c,reaction_token:d,trackingProps:u}=e,[p,h]=(0,o.useState)(!1),m=(0,o.useRef)(null),g=!n&&(0,k.isPaidAudience)(a.audience);if(!a.podcastUpload)return null;let f=(0,C.zM)({post:a}),v=a.podcastUpload.is_free_preview,y=!f&&g&&(p||!v&&"notes-embed"!==c)&&!(0,w.Ed)({post:a});return(0,r.FD)(r.FK,{children:[(0,r.Y)(A,{audioFileUrl:a.podcast_url,audioPlayerRef:m,metricsPost:a,hidePreviewUI:f,paywallComponent:y?(0,r.Y)(b.v,{inlineIcon:"notes-embed"===c,isFreeSubscribed:t,post:a,pub:l,medium:"audio",variant:"overlay",onRestart:v?()=>{var e;(null==(e=m.current)?void 0:e.player)&&(h(!1),m.current.player.currentTime=0,m.current.player.play())}:void 0,magicToken:d}):void 0,podcastDuration:a.podcast_duration,podcastUpload:a.podcastUpload,post:a,postId:a.id,postTitle:a.title,pub:l,section:s,showPaidLabel:g&&!v,user:null,variant:c,onFinishAudio:()=>{h(!0)},useBlur:!0,trackingProps:u}),i&&(0,r.Y)("button",{onClick:()=>{h(!0)},children:"finish audio"})]})},D=e=>{var t;let{audioPlayerRef:n,explicitHeight:i,explicitPodcastUrl:a,feedUrl:l,hasPaywall:s,isPrivateFeed:c,isServingFreePodcastUrl:d,post:u,pub:p,radius:h,section:m,ufiComponent:g,user:f,freeSignup:v,reaction_token:y}=e,[Y,_]=(0,o.useState)(!1),w=(0,C.zM)({post:u}),k=null==(t=u.podcastUpload)?void 0:t.is_free_preview,S=!w&&s&&(!k||Y)&&!d;return(0,r.Y)(A,{audioFileUrl:u.podcast_url,audioPlayerRef:n,feedUrl:l,explicitHeight:i,explicitPodcastUrl:a,hidePreviewUI:w,isPrivateFeed:c,isServingFreePodcastUrl:d,metricsPost:u,paywallComponent:S?(0,r.Y)(b.v,{isFreeSubscribed:!!(null==f?void 0:f.is_free_subscribed)||!!v,post:u,pub:p,medium:"audio",variant:"overlay",onRestart:k?()=>{var e;(null==(e=n.current)?void 0:e.player)&&(_(!1),n.current.player.currentTime=0,n.current.player.play())}:void 0,magicToken:y}):void 0,podcastDuration:u.podcast_duration,podcastUpload:u.podcastUpload,post:u,postId:u.id,postTitle:u.title,pub:p,radius:h,section:m,ufiComponent:g,user:f,variant:"episode-page",onFinishAudio:()=>{_(!0)}})},T={"episode-page":400,editor:320,"notes-embed":128,"notes-full":250},A=e=>{var t,n,a;let{audioFileUrl:o,audioPlayerRef:b,explicitHeight:w,explicitPodcastUrl:C,feedUrl:k,hasFreePodcastUrlSet:F,hidePreviewUI:D,hideUfi:A,isPrivateFeed:E,isServingFreePodcastUrl:N,metricsPost:P,postId:x,postTitle:L,podcastDuration:O,pub:B,podcastUpload:M,radius:R,section:U,showPaidLabel:j,podcastPreviewUpload:z,post:H,ufiComponent:W,editComponent:V,paywallComponent:K,variant:q,user:G,onFinishAudio:J,useBlur:$,trackingProps:Z}=e,{isMobile:Q}=(0,u.sM)(),{iString:X}=(0,d.GO)(),ee=U?null!=(t=U.podcastPalette)?t:null:null!=(n=B.podcastPalette)?n:null,{title:et,backgroundUrl:en,artUrl:ei}=(0,_.ed)({pub:B,podcastUpload:M,section:U,thumbnailInfo:(null==M?void 0:M.full_podcast_info)&&x?{post_id:x,media_upload_id:M.full_podcast_info.media_upload_id,thumbnail_id:M.full_podcast_info.thumbnail_id}:null}),er=null!=w?w:T[q],ea="notes-embed"===q,el=Q||ea,eo=!!K,es=$||ei===en,ec=!!V,ed=(null==M?void 0:M.is_free_preview)||z;return(0,r.Y)(s.A,{ref:b,duration:O,metricsPost:P,preventSnappingToCurrentTime:!0,pub:B,skipPreloading:N,src:o,updateOnEveryFrame:O<300,onFinishAudio:J,mediaUpload:null!=M?M:void 0,trackingProps:(0,i._)({contentType:"post",entityType:"post",entityKey:null!=(a=null==H?void 0:H.id)?a:"unknown",surface:"editor"===q?"editor":"post"},Z),render:e=>{var t;let{currentTime:n,dragTime:i,isPlaying:a,playbackRate:s,progress:d,progressBarRef:u,progressBarOnMouseDown:b,remainingTime:_,setPlaybackRate:w,skipBack:T,skipForward:P,togglePlayback:x}=e;return(0,r.Y)(c.a,{children:(0,r.FD)(p.az,{position:"relative",style:{minHeight:Q?Math.min(200,er):er},children:[(0,r.Y)(m._,{backgroundUrl:ea?null:en,blurAmount:ea?40:120,isBlurred:es,palette:ee,radius:R}),(0,r.FD)(h.I1,{position:"absolute",inset:0,justifyContent:el?"space-between":void 0,children:[(0,r.FD)(h.Ye,{alignItems:"stretch",flex:el?void 0:"grow",justifyContent:"space-between",children:[(!el||!eo)&&(0,r.Y)(p.az,{padding:el||"notes-full"===q?16:24,paddingBottom:"notes-embed"===q?0:void 0,overflow:"hidden",flex:"grow",children:(0,r.Y)(g.P,{isDisabled:eo,explicitPodcastUrl:C,pub:B,post:H,postTitle:L,section:U,showUpgradeButton:N,showTitle:et,variant:"notes-embed"===q?"notes-embed":Q||"notes-full"===q?"mini":"regular"})}),!el&&!eo&&!A&&W&&(0,r.Y)(h.Ye,{alignItems:"center",paddingX:24,children:W}),null!=V?V:null]}),!eo&&"notes-embed"!==q&&(0,r.Y)(h.I1,{paddingX:16,position:el?void 0:"absolute",className:l()({[I.A.controlsCentered]:!el}),children:(0,r.Y)(v.w,{audioFileUrl:o,feedUrl:k,isPlaying:null!=a&&a,isPrivateFeed:!!E,playbackRate:s,sectionId:U?U.id:null,user:G,onChangePlaybackRate:w,onSkipBack:T,onSkipForward:P,onTogglePlayback:x})}),(!el||!eo)&&(0,r.FD)(h.Ye,{className:l()(I.A.track),alignItems:"center",gap:16,opacity:eo?20:void 0,padding:el||"notes-full"===q?16:24,paddingTop:"notes-embed"===q?8:void 0,pointerEvents:eo?"none":void 0,onClick:e=>{j||(e.stopPropagation(),e.preventDefault())},children:[ed&&ec&&z&&(0,r.Y)(y.d,{children:(0,S.kq)(null!=(t=z.duration)?t:0)}),ed&&!D&&!ec&&(0,r.Y)(y.d,{children:X("Preview")}),j&&(0,r.Y)(y.d,{children:X("Paid")}),F&&(0,r.Y)(y.d,{children:X("Free url set")}),(0,r.Y)(Y.v,{containerRef:u,currentTime:n,dragTime:i,hideStartingTimestamp:Q,progress:d,remainingTime:_,onMouseDown:b}),"notes-embed"===q&&(0,r.Y)(f.gD,{isPlaying:null!=a&&a,size:40,onTogglePlayback:x})]})]}),K]})})}})}},13348:function(e,t,n){n.d(t,{gD:()=>m,ro:()=>g,tl:()=>f});var i=n(4006),r=n(64955),a=n(59307),l=n(51782),o=n(84605),s=n(35369),c=n(76977),d=n(57820),u=n(63136),p=n(76247);let h={32:10,40:14,56:16,72:20},m=e=>{let{bg:t="glass-thick",isPlaying:n,isStatic:r,size:l,onTogglePlayback:s}=e,d=h[l],{iString:u}=(0,o.GO)();return(0,i.Y)(c.pT,{bg:t,className:p.A.playButton,alignItems:"center",justifyContent:"center",onClick:s,style:{width:l,height:l},role:"button","aria-label":u(n?"Pause":"Play"),"aria-pressed":n,children:n?(0,i.FD)("div",{className:p.A.pauseIcon,style:{width:d,height:d},children:[(0,i.Y)("div",{className:p.A.pauseIconBar}),(0,i.Y)("div",{className:p.A.pauseIconBar})]}):(0,i.Y)(a.A,{className:p.A.playButtonIcon,height:d,isStatic:r,fill:r?"#000":void 0,stroke:"none"})})},g=e=>{let{isPlaying:t,size:n,onTogglePlayback:l,href:c,loading:u}=e,{iString:m}=(0,o.GO)(),g=h[n];return(0,i.Y)(s.mZ,{priority:"primary",onClick:l,rounded:!0,style:{width:n,height:n},href:c,children:u?(0,i.Y)(d.y$,{theme:"media"}):t?(0,i.Y)(r.A,{className:p.A.videoIcon,height:g,style:{stroke:"none"},"aria-label":m("Pause")}):(0,i.Y)(a.A,{className:p.A.videoIcon,height:g,style:{stroke:"none"},"aria-label":m("Play")})})};function f(){let{iString:e}=(0,o.GO)();return(0,i.FD)(c.VP,{gap:12,alignItems:"center",children:[(0,i.FD)(s.mZ,{priority:"primary",rounded:!0,style:{width:72,height:72,position:"relative",overflow:"hidden"},"aria-label":e("Unmute"),children:[(0,i.Y)("div",{className:p.A.audioWaveform}),(0,i.Y)(l.A,{fill:"var(--color-utility-white)",size:24})]}),(0,i.Y)(u.EY.B3,{weight:"semibold",color:"white",children:e("Click to listen")})]})}},59294:function(e,t,n){n.d(t,{AC:()=>y,Fy:()=>Y,Hc:()=>b,MB:()=>_,TR:()=>f,Zq:()=>g,_N:()=>v});var i=n(69277),r=n(70408),a=n(83673),l=n.n(a),o=n(11741),s=n.n(o),c=n(63375),d=n.n(c),u=n(17402),p=n(15734),h=n.n(p),m=n(39318);let g=e=>{let{pub:t,magicToken:n,section:a,user:l}=e,[o,s]=(0,u.useState)((0,m.mWT)({pub:(0,r._)((0,i._)({},t),{section:a}),token:n})),[c,d]=(0,u.useState)(!1),p=!l||!l.is_subscribed&&!l.is_free_subscribed,[g,f]=(0,u.useState)(p);return(0,u.useEffect)(()=>{p||(async()=>{try{var e;let t=await h().get("/api/v1/subscription/podcast_rss_url").query({token:n,section_id:null!=(e=null==a?void 0:a.id)?e:null});t.body.podcast_rss_url&&(s(t.body.podcast_rss_url),d(!0)),f(!0)}catch(e){f(!0)}})()},[n,a,p]),{feedUrl:o,isPrivateFeed:c,isLoaded:g}},f=e=>{let[t,n]=(0,u.useState)(!1),i=()=>{n(!0)},r=()=>{n(!1)};return(0,u.useEffect)(()=>{let t=e.current;if(t)return t.addEventListener("mouseenter",i),t.addEventListener("mouseleave",r),()=>{t.removeEventListener("mouseenter",i),t.removeEventListener("mouseleave",r)}},[e]),[t]},v=(e,t,n)=>{(0,u.useEffect)(()=>{let i=e.toLocaleLowerCase(),r=e=>{if(!n)return;e.preventDefault();let r=e.key.toLocaleLowerCase();if(r===i||e.ctrlKey&&"ctrl+shift+".concat(r)===i||e.ctrlKey&&"ctrl+".concat(r)===i||e.shiftKey&&"shift+".concat(r)===i)return void t()};return window.addEventListener("keydown",r),()=>{window.removeEventListener("keydown",r)}},[e,t,n])},b=e=>{let[t,n]=(0,u.useState)(null);return(0,u.useEffect)(()=>{let t=async e=>{let{body:{src:t}}=await h().get("/api/v1/video/upload/".concat(e,"/storyboard"));n((await h().get(t)).body)};(null==e?void 0:e.id)&&t(e.id)},[e]),t},y=e=>{let[t,n]=(0,u.useState)(!1),i=e=>{n(e)},r=t=>{e.current&&e.current.contains(t.target)?i(!0):i(!1)};return(0,u.useEffect)(()=>(document.addEventListener("click",r),()=>{document.removeEventListener("click",r)}),[]),t},Y=e=>{let{transcription:t,processAlignedRows:n}=e,[i,r]=(0,u.useState)(!1),[a,o]=(0,u.useState)([]),[s,c]=(0,u.useState)([]),[p,m]=(0,u.useState)({});return(0,u.useEffect)(()=>{(async()=>{if(!t.cdn_url)return;r(!0);let e=await h().get(t.cdn_url);if(!e.text)return r(!1);let i=JSON.parse(e.text);n?o(n({rows:i})):o(i);let a=l()(d()(i.map(e=>{var t;return null!=(t=e.speaker)?t:""}))).sort();a.length&&c(a),t.speaker_map&&Object.values(t.speaker_map).length&&m(t.speaker_map)})()},[t.cdn_url,t.cdn_unaligned_url,t.speaker_map,n]),{loading:i,rows:a,speakers:s,speakerMap:p}},_=e=>{let{containerRef:t,playerRef:n,disable:i}=e,r=(0,u.useRef)(null),a=(0,u.useRef)(null),[l,o]=(0,u.useState)();return(0,u.useEffect)(()=>{let e=()=>{i||setTimeout(()=>{var e,t,n;let i=window.getSelection();if(!i||0===i.rangeCount||i.isCollapsed||!a.current){o(void 0),a.current=null,r.current=null;return}let l=i.focusNode,c=parseInt(null==l||null==(t=l.parentNode)||null==(e=t.dataset)?void 0:e.chunkIndex),d=i.focusOffset;s()(c)||(r.current={rowIndex:c,offset:d,text:null!=(n=null==l?void 0:l.textContent)?n:""}),o(i)},0)},n=null,l=0,c=e=>{var t,n,i,r;let l=e.srcElement,o=parseInt(null!=(r=null==(t=l.dataset)?void 0:t.chunkIndex)?r:null==(i=l.parentNode)||null==(n=i.dataset)?void 0:n.chunkIndex);setTimeout(()=>{let e=window.getSelection(),t=null==e?void 0:e.anchorOffset;"number"!=typeof t||s()(o)||(a.current={rowIndex:o,offset:t,text:l.textContent})},0)},d=()=>{l>5||((n=t.current)?(n.addEventListener("mouseup",e),n.addEventListener("selectstart",c)):(l+=1,setTimeout(()=>{d()},50)))};return d(),()=>{null==n||n.removeEventListener("mouseup",e),null==n||n.removeEventListener("selectstart",c)}},[t,i,n]),{clearSelection:(0,u.useCallback)(()=>{l&&(l.removeAllRanges?l.removeAllRanges():l.empty&&l.empty()),o(void 0),a.current=null,r.current=null},[l]),selection:l,selectStartRef:a,selectEndRef:r}}},7755:function(e,t,n){n.d(t,{Ei:()=>A,Em:()=>I,Hx:()=>S,Pi:()=>D,R4:()=>T,RM:()=>C,dV:()=>w,ed:()=>y,fU:()=>E});var i=n(69277),r=n(70408),a=n(79785),l=n(83673),o=n.n(l),s=n(38970),c=n.n(s),d=n(36233),u=n(86500),p=n(68349),h=n(56458),m=n(46009),g=n(56262),f=n(39318),v=n(49807);function b(){let e=(0,a._)(['Invalid URL. URL should start with "','"']);return b=function(){return e},e}let y=e=>{let{pub:t,podcastUpload:n,section:a,thumbnailInfo:l,useSection:o}=e;if(o){let e=a?(0,v.Dor)(t,{section:a}):(0,v.$_T)(t);return a?{artUrl:a.logo_url,backgroundUrl:a.cover_photo_url,description:a.description,paidArtUrl:null,title:a.name,url:e}:{artUrl:t.logo_url,backgroundUrl:t.cover_photo_url,description:null,paidArtUrl:null,title:t.name,url:e}}let{title:s,description:c,artUrl:d,paidEpisodeArtUrl:u}=a&&!o?(0,m.lL)({pub:t,section:a}):(0,m.j_)({pub:t}),p=a?(0,v.Dor)(t,{section:a}):(0,v.$_T)(t),h=d;if(n&&l&&l.thumbnail_id>1){let e=(0,f.Pzx)((0,r._)((0,i._)({},n),{id:l.media_upload_id,post_id:l.post_id,thumbnail_id:l.thumbnail_id}));e&&(h=e)}else if(n&&n.thumbnail_id>1){let e=(0,f.Pzx)(n);e&&(h=e)}return{artUrl:d,backgroundUrl:h,description:c,paidArtUrl:null!=u?u:null,title:s,url:p}},Y=[{key:"apple_podcasts",label:"Apple Podcasts",fieldName:"apple_podcasts_url"},{key:"spotify",label:"Spotify",fieldName:"spotify_url"},{key:"spotify_for_paid_users",label:"Spotify",fieldName:"spotify_for_paid_users_url"},{key:"youtube_music",label:"YouTube Music",fieldName:"youtube_music_url"},{key:"youtube",label:"YouTube",fieldName:"youtube_url"},{key:"overcast",label:"Overcast",fieldName:"overcast_url"},{key:"pocket_casts",label:"Pocket Casts",fieldName:"pocket_casts_url"}],_=e=>{let{platform:t,feedUrl:n,isApple:i,isMobile:r}=e;return n?"apple_podcasts"===t&&i?"podcast://".concat((0,f.L56)(n)):"overcast"===t&&r?"overcast://x-callback-url/add?url=".concat(encodeURIComponent(n)):"pocket_casts"===t&&r?"pktc://subscribe/".concat((0,f.L56)(n)):null:null},w=e=>{let{feedUrl:t,isApple:n,isMobile:i,showLinks:r,userIsSubscribed:a}=e,l=[],o=c()(Y,"key"),s=!1;for(let e of Y){let c;if(["spotify","spotify_for_paid_users","spotify_open_access"].includes(e.key)){if(s)continue;let e=function(e){let{showLinks:t,userIsSubscribed:n}=e;return n&&t.spotify_for_paid_users_url?{label:"Spotify",platform:"spotify_for_paid_users",url:t.spotify_for_paid_users_url}:!n&&t.spotify_url?{label:"Spotify",platform:"spotify",url:t.spotify_url}:t.spotify_open_access_url?{label:"Spotify",platform:"spotify",url:t.spotify_open_access_url}:null}({showLinks:r,userIsSubscribed:a});if(e){l.push(e),s=!0;continue}}if(a&&"youtube"!==e.key)c=_({platform:e.key,feedUrl:t,isApple:n,isMobile:i});else{var d;c=null!=(d=r[e.fieldName])?d:_({platform:e.key,feedUrl:t,isApple:n,isMobile:i})}c&&l.push({label:o[e.key].label,platform:e.key,url:c}),"spotify"===e.key&&r.spotify_open_access_url&&l.push({label:"Spotify",platform:"spotify_open_access",url:r.spotify_open_access_url})}return l},C=e=>{let{feedUrl:t,isApple:n,isMobile:i,render:r,showLinks:a,user:l,analyticsSource:s="shows_episode_page"}=e,h=c()(Y,"key");return o()([...w({feedUrl:t,isApple:n,isMobile:i,showLinks:a,userIsSubscribed:!!(null==l?void 0:l.is_subscribed)}).map(e=>{let n="spotify_open_access"===e.platform?"Spotify":h[e.platform].label;return r({key:e.platform,label:n,url:e.url,onClick:()=>{(0,u.u4)(u.qY.PODCAST_APP_LINK_CLICK,{appName:n,feedUrl:t,url:e.url,source:s}),i||window.open(e.url,"_blank")}})}),t&&r({key:"rss",label:"RSS Feed",url:t,onClick:()=>{(0,u.u4)(u.qY.PODCAST_FEED_URL_COPIED,{feedUrl:t,source:s}),(0,d.Ay)("RSS feed URL copied"),(0,p.lW)(t)}})])},k={apple_podcasts:["https://podcasts.apple.com/","https://itunes.apple.com/"],overcast:["https://overcast.fm/"],pocket_casts:["https://pca.st/"],spotify:["https://open.spotify.com/"],spotify_for_paid_users:["https://open.spotify.com/"],youtube:["https://youtube.com/","https://www.youtube.com/"],youtube_music:["https://music.youtube.com/"]},S=e=>{let{platform:t,url:n,language:i}=e,{iString:r,iTemplate:a}=I18N.i(i),l=k[t];if(l.every(e=>!n.startsWith(e))){var o;return{isValid:!1,message:a(b(),null!=(o=l[0])?o:"undefined")}}return n.length>255?{isValid:!1,message:r("URL can't be longer than 255 characters")}:{isValid:!0,message:null}},I=e=>{let{pub:t,section:n,spotifySettings:i}=e;return F({showLinks:n?n.showLinks:t.show_links,spotifySettings:i})},F=e=>{let{showLinks:t,spotifySettings:n}=e,i={apple_podcasts_url:null,overcast_url:null,pocket_casts_url:null,spotify_url:null,spotify_for_paid_users_url:null,youtube_url:null,youtube_music_url:null,spotify_open_access_url:null};if(n&&(i.spotify_open_access_url=n.spotify_show_url),!t)return i;for(let e of t)i["".concat(e.platform,"_url")]=e.url;return i},D="https://support.substack.com/hc/en-us/articles/4519588148244-How-do-I-listen-to-episodes-on-my-podcast-app-",T="comments-for-scroll",A=e=>{var t,n,i,r;let{post:a,pub:l,user:o}=e,s=a.section_id&&null!=(n=l.sections.find(e=>e.id===a.section_id))?n:null;if((0,h.rI)({post:a,section:s,pub:l}))return null;if((null==(t=a.podcastFields)?void 0:t.free_podcast_url)&&!(null==o?void 0:o.is_subscribed))return{url:a.podcastFields.free_podcast_url,type:"free_podcast_url"};if(a.podcastUpload&&a.podcast_url){let e=!!a.podcastUpload.src_media_upload_id||!(0,g.isPaidAudience)(a.audience)||(null==o?void 0:o.is_subscribed)||null!=(r=null==(i=a.videoUpload)?void 0:i.preview_duration)&&r,t=(0,g.isPaidAudience)(a.audience)&&!(null==o?void 0:o.is_subscribed);return{url:a.podcast_url,type:t?e?"alternate_audio_preview":"extra_audio_preview":"alternate_full_audio"}}return null},E=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,n=(null==t?void 0:t.decimals)===1,i=Math.floor(e/3600),r=Math.floor(e%3600/60),a=Math.floor(e%60),l=i?"".concat(i,":").concat(r<10?"0":"").concat(r,":").concat(a<10?"0":"").concat(a):"".concat(r,":").concat(a<10?"0":"").concat(a);if(n){let t=Math.round(e%1*10);return"".concat(l,".").concat(t)}return l}},68723:function(e,t,n){n.d(t,{W2:()=>J,B2:()=>G,Lt:()=>$});var i=n(69277),r=n(70408),a=n(32641),l=n(4006),o=n(32485),s=n.n(o),c=n(17402),d=n(18993),u=n(26683),p=n(79785),h=n(17159),m=n.n(h),g=n(87583),f=n(79909),v=n(84605),b=n(86500),y=n(92476),Y=n(24078),_=n(16074),w=n(76977),C=n(63136),k=n(39318),S=n(49807),I=n(98949),F=n(82776),D=n(57324);let T="threadsLinkFallback-sQtc8r",A="appBadge-jMueor";function E(){let e=(0,p._)([""," started a thread"]);return E=function(){return e},e}function N(){let e=(0,p._)(["Join "," subscriber chat "]);return N=function(){return e},e}function P(e){let{pub:t,utm_campaign:n}=e;return(0,l.FD)(w.I1,{alignItems:"center",justifyContent:"center",gap:12,children:[(0,l.Y)(U,{utm_campaign:n}),(0,l.FD)(C.EY.B4,{translated:!0,size:12,color:"secondary",className:T,children:["Already have the app? ",(0,l.Y)("a",{href:(0,k.Q1d)(t),children:"Open now"})]})]})}function x(e){let{pub:t,utm_campaign:n}=e;return(0,l.FD)(w.I1,{alignItems:"center",justifyContent:"center",gap:12,children:[(0,l.Y)(j,{utm_campaign:n}),(0,l.FD)(C.EY.B4,{translated:!0,size:12,color:"secondary",className:T,children:["Already have the app? ",(0,l.Y)("a",{href:(0,k.Q1d)(t),children:"Open now"})]})]})}function L(e){var t,n,i,r;let{pub:a,communityAction:o}=e,{iString:s,iTemplate:c}=(0,v.GO)(),d=o?c(E(),(null==(t=o.author)?void 0:t.name)||s("Someone")):c(N(),(0,F.possessive)(a.author_name)),u=(null==o?void 0:o.communityPost)?null==(n=o.communityPost.body)?void 0:n.slice(0,128):"Subscribe to ".concat(a.name," and join the conversation."),p=(null!=(r=null==o?void 0:o.communityPost.media_assets)?r:[])[0],h=(null==o||null==(i=o.communityPost)?void 0:i.type)==="media"&&!!p,g=h?p.url:a.logo_url,b=(0,S.xWO)({pubKey:a.subdomain});return(0,l.FD)(l.FK,{children:[(0,l.Y)(f.Metadata,{title:d,socialTitle:d,description:u,image:g,isLargeImage:h}),(0,l.Y)("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:m()((0,y.AF)(a,{name:d,url:b,description:u,potentialAction:null}),{json:!0,isScriptContext:!0})}})]})}function O(e){let{publication:t,communityAction:n,publicationAuthor:i,utm_campaign:r}=e,a=(0,I.Fr)(),o=(0,I.m0)();return(0,l.FD)(w.I1,{gap:a?20:24,justifyContent:"center",alignItems:"center",children:[(0,l.Y)(Y.eu,{user:i,size:88}),(0,l.Y)(w.I1,{gap:8,children:(0,l.FD)(C.EY.H2,{translated:!0,size:24,align:"center",weight:"bold",color:"pub-primary-text",children:["Join ",I18N.p(i.name||"Substack user"),"'s subscriber chat"]})}),!a&&(0,l.Y)("div",{className:"threadsLinkContainer-JACRi5",children:(0,l.Y)(M,{utm_campaign:r,subdomain:t.subdomain})}),a&&(o?(0,l.Y)(x,{pub:t,utm_campaign:r}):(0,l.Y)(P,{pub:t,utm_campaign:r})),(0,l.Y)(B,{publication:t,source:"pub-nav-bar"}),(0,l.Y)(L,{pub:t,communityAction:n})]})}function B(e){let{publication:t,source:n,postId:i,commentId:r,targetReplyId:a,showTarget:o,text:s}=e,{iString:c}=(0,v.GO)();return s||(s=c("Or open on web")),(0,l.Y)("a",{href:(0,S.e$6)({pubId:t.id,postId:i,commentId:r,params:{utm_source:n,targetReplyId:a,showTarget:o}}),className:"webChatLink-DvDRdZ",children:(0,l.Y)(C.EY.B3,{weight:"semibold",align:"center",as:"p",color:"pub-secondary-text",children:s})})}function M(e){let{utm_campaign:t,postId:n,subdomain:i,commentId:r,targetReplyId:a}=e;return(0,l.FD)(w.I1,{gap:24,children:[(0,l.Y)(w.pT,{justifyContent:"center",children:(0,l.Y)(C.EY.B4,{translated:!0,as:"span",weight:"bold",children:"Scan the QR code below"})}),(0,l.Y)(w.pT,{flex:"auto",justifyContent:"center",alignSelf:"center",border:"detail",radius:"sm",className:"qrCode-JMB0bK",children:(0,l.Y)(R,{utm_campaign:t,postId:n,subdomain:i,commentId:r,targetReplyId:a})}),(0,l.Y)(_.v,{}),(0,l.FD)(w.pT,{gap:16,justifyContent:"center",children:[(0,l.Y)(U,{utm_campaign:t}),(0,l.Y)(j,{utm_campaign:t})]})]})}function R(e){let{utm_campaign:t,postId:n,subdomain:i,commentId:r,targetReplyId:a}=e,o=(0,c.useRef)(),s=r?(0,S.j5y)({commentId:r,targetReplyId:a,utm_campaign:t}):n?(0,S.sWz)({postId:n,utm_campaign:t}):(0,S.xWO)({pubKey:i,redirect:"app-store",utm_campaign:t});return(0,c.useEffect)(()=>{let{current:e}=o;e&&g.toCanvas(e,s,{width:180,margin:2})},[]),(0,l.Y)("canvas",{ref:o})}function U(e){let{utm_campaign:t}=e;return(0,l.Y)("a",{className:A,href:(0,k.cxW)({utm_campaign:t,utm_source:D.VU.substack}),onClick:()=>{(0,b.u4)(b.qY.APP_STORE_LINK_CLICKED,{app_store:"ios"})},children:(0,l.Y)("img",{src:(0,k.dJ9)("/img/app_page/app-store.png",400),height:40})})}function j(e){let{utm_campaign:t}=e;return(0,l.Y)("a",{className:A,href:(0,k.zw3)({utm_campaign:t,utm_source:D.VU.substack}),onClick:()=>{(0,b.u4)(b.qY.APP_STORE_LINK_CLICKED,{app_store:"android"})},children:(0,l.Y)("img",{src:(0,k.dJ9)("/img/app_page/google-play.png",400),height:40})})}var z=n(20504),H=n(36520),W=n(35369),V=n(16993),K=n(11510);function q(e){let{children:t,pub:n,user:i,showHeader:r,layoutTop:a}=e;return(0,l.FD)("div",{className:s()("pageContainer-QRoB4X",a?"layoutTop-HNorD1":"layoutCentered-puapcv"),children:[(0,l.Y)("div",{className:"header-LFnrx6",children:r&&n&&i&&(0,l.Y)(z.W1,{pub:n,user:i,hideNavBar:!0,hideTitle:!0,selectedSectionId:null})}),t]})}function G(e){let{publication:t,communityAction:n,user:i,showHeader:r,activeChatInfo:a}=e;return(0,I.Fr)()?(0,l.Y)(w.I1,{alignItems:"center",justifyContent:"center",paddingX:16,paddingTop:56,children:(0,l.Y)(H.o,{pub:t,chatInformation:a,canSkip:!1,onNext:()=>{},hasAppInstalled:!!(null==i?void 0:i.reader_installed_at),redirectToChat:!0,upsellGroup:"publication-chat-page"})}):(0,l.Y)(q,{pub:t,user:i,showHeader:r,children:(0,l.Y)(w.I1,{flex:"grow",alignSelf:"stretch",justifyContent:"center",children:(0,l.Y)(w.pT,{flex:"grow",justifyContent:"center",paddingBottom:56,children:(0,l.Y)(O,{publication:t,communityAction:n,publicationAuthor:t.author||{id:t.author_id||0,name:t.author_name||"",photo_url:t.author_photo_url},utm_campaign:D._9.threadsPage})})})})}function J(e){let{publication:t,communityAction:n,user:i,layoutTop:r,appModalOpenByDefault:a}=e,o=(0,K.Iu)(),[s,p]=(0,c.useState)(!o&&a),h=D._9.threadPage,{iString:m}=(0,v.GO)(),g=(0,l.FD)(w.I1,{gap:8,children:[(0,l.Y)(W.$n,{href:(0,S.sWz)({postId:n.communityPost.id,utm_source:D.VU.chatPostLanding,redirect:"app-store",utm_campaign:h}),onClick:o?null:e=>{e.preventDefault(),p(!0)},children:m("Open in app")}),(0,l.Y)(B,{publication:t,postId:n.communityPost.id,text:m("Or join the conversation on web"),source:"post-permalink"})]});return(0,l.Y)(q,{pub:t,user:i,layoutTop:r,children:(0,l.FD)(u.Sd,{children:[(0,l.FD)(w.I1,{flex:"grow",alignSelf:"stretch",justifyContent:"center",children:[(0,l.Y)(w.pT,{flex:"grow",justifyContent:"center",paddingBottom:16,children:(0,l.Y)(w.I1,{style:{maxWidth:580},flex:"grow",justifyContent:"center",children:"open"===n.status?(0,l.Y)(d.lS,{communityPost:n.communityPost,author:n.author,withAttribution:!0,extras:o?null:g,flex:"auto",isReadOnly:!0}):(0,l.Y)(w.I1,{children:(0,l.Y)(d.I8,{author:n.author,extras:o?null:g,commenters:n.communityPost.recent_commenters,count:n.communityPost.comment_count,audience:n.communityPost.audience})})})}),o&&(0,l.Y)(w.I1,{sizing:"border-box",borderTop:"detail-themed",paddingY:16,alignSelf:"stretch",children:g}),(0,l.Y)(L,{pub:t,communityAction:n})]}),(0,l.Y)(Z,{utm_campaign:h,isOpen:s,postId:n.communityPost.id,onClose:()=>p(!1),subdomain:t.subdomain})]})})}function $(e){var t;let{publication:n,communityAction:i,user:r,layoutTop:a,appModalOpenByDefault:o}=e,{iString:s}=(0,v.GO)(),u=(0,K.Iu)(),[p,h]=(0,c.useState)(!u&&o),m=D._9.commentPage,g=null!=(t=i.communityComment.parent_id)?t:i.communityComment.id,f=i.communityComment.parent_id?i.communityComment.id:void 0,b=i.communityComment.post_id,y=(0,l.FD)(w.I1,{gap:8,children:[(0,l.Y)(W.$n,{href:(0,S.j5y)({commentId:g,targetReplyId:f,utm_source:D.VU.chatPostLanding,redirect:"app-store",utm_campaign:m}),onClick:u?null:e=>{e.preventDefault(),h(!0)},children:s("Open in app")}),(0,l.Y)(B,{publication:n,postId:b,commentId:g,targetReplyId:f,showTarget:!!f||void 0,text:s("Or join the conversation on web"),source:"post-permalink"})]});return(0,l.FD)(q,{pub:n,user:r,layoutTop:a,children:[(0,l.FD)(w.I1,{flex:"grow",alignSelf:"stretch",justifyContent:"center",children:[(0,l.Y)(w.pT,{flex:"grow",justifyContent:"center",paddingBottom:16,children:(0,l.Y)(w.I1,{style:{maxWidth:580},flex:"grow",justifyContent:"center",children:"VISIBLE"!==i.status&&i.status?"PAID_SUBSCRIPTION_REQUIRED"===i.status||"FOUNDING_SUBSCRIPTION_REQUIRED"===i.status?(0,l.Y)(w.I1,{children:(0,l.Y)(d.I8,{author:i.author,extras:u?null:y,commenters:i.communityComment.recent_commenters,count:i.communityComment.reply_count,audience:"FOUNDING_SUBSCRIPTION_REQUIRED"===i.status?"only_founding":"only_paid"})}):(0,l.Y)(w.I1,{children:(0,l.Y)(d.dw,{author:i.author,extras:u?null:y,commenters:i.communityComment.recent_commenters,count:i.communityComment.reply_count})}):(0,l.Y)(d.eT,{chatPublicationId:n.id,communityComment:i.communityComment,author:i.author,extras:u?null:y,isReadOnly:!0,isBanned:!1,quoteReply:i.quote,chatAuthorNameAttribution:n.author_name,flex:"auto"})})}),u&&(0,l.Y)(w.I1,{sizing:"border-box",borderTop:"detail-themed",paddingY:16,alignSelf:"stretch",children:y})]}),(0,l.Y)(Z,{utm_campaign:m,isOpen:p,postId:b,commentId:g,targetReplyId:f,onClose:()=>h(!1),subdomain:n.subdomain})]})}function Z(e){var{postId:t,utm_campaign:n,subdomain:o,commentId:s,targetReplyId:c}=e,d=(0,a._)(e,["postId","utm_campaign","subdomain","commentId","targetReplyId"]);let{iString:u}=(0,v.GO)();return(0,l.FD)(V.aF,(0,r._)((0,i._)({},d),{children:[(0,l.Y)(V.rQ,{title:u("Open in the Substack app"),showClose:!0,onClose:d.onClose,showDivider:!0}),(0,l.Y)(w.I1,{paddingY:32,paddingX:40,children:(0,l.Y)(M,{utm_campaign:n,postId:t,subdomain:o,commentId:s,targetReplyId:c})})]}))}},14984:function(e,t,n){n.d(t,{Ty:()=>u,fk:()=>h,tB:()=>m});var i=n(4006),r=n(50014),a=n.n(r),l=n(17402);n(46271);var o=n(17186),s=n(49807),c=n(84985);let d={surfaces:[],addSurface:()=>void 0},u=e=>{let{pub:t}=e,n=(0,l.useRef)(null),[r,a]=(0,l.useState)(!1);(0,l.useEffect)(()=>(window.addEventListener("message",o),()=>window.removeEventListener("message",o))),(0,l.useEffect)(()=>{var e;if(r&&(null==(e=n.current)?void 0:e.contentWindow)&&t){let e=n.current.contentWindow;null==e||e.postMessage({pub:t},"".concat((0,s.Ewe)()))}},[t,r]);let o=e=>{var t;(null==(t=e.data)?void 0:t.surfaceReady)===!0&&a(!0)};return"undefined"==typeof window?null:(0,i.Y)("iframe",{className:c.A.visitedSurfacesIFrame,ref:n,src:"".concat((0,s.Ewe)(),"/visited-surface-frame"),width:"0",height:"0"})},p=(0,l.createContext)(d);function h(){return(0,l.useContext)(p)}function m(e){let{user:t,children:n}=e,{surfaces:r,addSurface:s}=(e=>{let[t,n]=(0,l.useState)([]),i=(0,l.useMemo)(()=>e?"".concat("user-recent-surfaces","-").concat(e.id):"",[e]);(0,l.useEffect)(()=>{if(!e)return;let t=(0,o.xm)(i);n(null!=t?t:[])},[e,i]);let r=(0,l.useCallback)(e=>{var t;let r=null!=(t=(0,o.xm)(i))?t:[],l="visited-publication"===e.type?{type:e.type,publication:{id:e.publication.id,name:e.publication.name,base_url:e.publication.base_url,logo_url:e.publication.logo_url,custom_domain:e.publication.custom_domain,custom_domain_optional:e.publication.custom_domain_optional,subdomain:e.publication.subdomain,theme:e.publication.theme,theme_var_background_pop:e.publication.theme_var_background_pop,author_photo_url:e.publication.author_photo_url,author:e.publication.author,cover_photo_url:e.publication.cover_photo_url}}:{type:e.type,profile:{name:e.profile.name,id:e.profile.id,photo_url:e.profile.photo_url}},s=a()([l,...r],e=>"visited-publication"===e.type?"pub-".concat(e.publication.id):"profile-".concat(e.profile.id)).slice(0,10);n(s);try{(0,o.X3)(i,s)}catch(e){console.error("Failed to update local recent surfaces:",e)}},[i]);return e?{surfaces:t,addSurface:r}:d})(t);return(0,i.Y)(p.Provider,{value:{surfaces:r,addSurface:s},children:n})}},38123:function(e,t,n){function i(e,t){for(let[n,i]of Object.entries(t))null!=i&&(e[n]=i);return e}function r(e,t){return Object.entries(e).every(e=>{let[n,i]=e;return i===t[n]})}n.d(t,{bN:()=>r,qy:()=>i})},86898:function(e,t,n){n.d(t,{AD:()=>r,O:()=>i,VK:()=>a,cD:()=>l,wJ:()=>o}),n(4016);let i={newspaper:{id:"newspaper",legacyEquivalent:"newspaper",postCount:{desktop:1,tablet:1,mobile:1}},magaziney:{id:"magaziney",legacyEquivalent:"magaziney",postCount:{desktop:3,tablet:3,mobile:3}},"magazine-5":{id:"magazine-5",legacyEquivalent:"magaziney",postCount:{desktop:5,tablet:3,mobile:5}},"feature-media":{id:"feature-media",legacyEquivalent:"newspaper",postCount:{desktop:1,tablet:1,mobile:1}},feature:{id:"feature",legacyEquivalent:"magaziney",postCount:{desktop:5,tablet:5,mobile:5}},podcast:{id:"podcast",legacyEquivalent:"newspaper",postCount:{desktop:0,tablet:0,mobile:0}}},r={posts:{min:3,default:6,max:7},rows:{min:1,default:2,max:4}},a=e=>{let{contentBlock:t,breakpoint:n="desktop",isTheFP:i}=e;if("list"===t.block_type)return t.num_posts||r.posts.default;if("grid"===t.block_type){let e=t.num_rows||r.rows.default;if("desktop"===n||"mobile"===n){let n=4;return t.primary_sidebar_modules.length>0&&(n-=1),t.secondary_sidebar_modules.length>0&&(n-=1),n*e}if("tablet"===n){let n=3;return(t.primary_sidebar_modules.length>0||t.secondary_sidebar_modules.length>0)&&(n-=1),n*e}}if("feature"===t.block_type){if(i){var a;return t.attrs.feature&&(null==(a=t.attrs.feature)?void 0:a.variant)!=="special-feature"?5:8}return 5}return"podcast_plus_three"===t.block_type?4:"single_post"===t.block_type?1:"half_feature"===t.block_type?"tablet"===n?3:4:0},l=e=>{let{contentBlocks:t,breakpoint:n,isTheFP:i,recentPosts:r,postsBySectionId:l,postsByTagId:s,postsByContentBlockId:c,postsForContentBlockPins:d}=e,u={},p=0;for(let e of t){var h,m,g,f;let t,v=[];if("latest"===e.post_source){let t=a({contentBlock:e,breakpoint:n,isTheFP:i});v=r.slice(p,p+t),p+=t}else"section"===e.post_source&&e.section_id?v=null!=(h=l[e.section_id])?h:[]:"tag"===e.post_source&&e.post_tag_id?v=null!=(m=s[e.post_tag_id])?m:[]:"multiple"===e.post_source&&c&&(v=null!=(g=null==(t=c[e.id])?void 0:t.flatMap(e=>e.posts))?g:[]);let{posts:b,numPostsDisplaced:y}=o({posts:v,contentBlockPins:null!=(f=e.contentBlockPins)?f:[],pinnedPosts:d});"latest"===e.post_source&&(p-=y),u[e.id]={posts:b,postsWithoutPins:v,postsBySource:t}}return u},o=e=>{let{posts:t,contentBlockPins:n,pinnedPosts:i}=e,r=[...t],a=0;if(!n||0===n.length)return{posts:r,numPostsDisplaced:a};for(let e of n.sort((e,t)=>e.position-t.position)){let n=i[e.post_id];if(!n)continue;let l=r.findIndex(e=>e.id===n.id);-1===l?(r.splice(e.position,0,n),r=r.slice(0,t.length),a+=1):(r.splice(l,1),r.splice(e.position,0,n))}return{posts:r,numPostsDisplaced:a}}},85520:function(e,t,n){n.d(t,{B9:()=>i});let i="choose_handle"},70515:function(e,t,n){n.d(t,{$f:()=>u,$h:()=>l,Pp:()=>c,Qz:()=>o,WD:()=>function e(t,n){if(Symbol.iterator in Object(t)){for(let i of t)if(!1===n(i)||!1===e(i.children||[],n))return!1}},fP:()=>d,rX:()=>s});var i=n(9740),r=n(50129),a=n(75237);let l=9999,o=function(){let{likesEnabled:e=!0,language:t="en"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{iString:n}=I18N.i(t),i=[];return e&&i.push({key:"best_first",text:n("Top first"),description:n("Top comments first")}),i.push({key:"most_recent_first",text:n("Newest first"),description:n("Newest comments first")}),i.push({key:"oldest_first",text:n("Oldest first"),description:n("Oldest comments first")}),i},s=(e,t)=>{var n;return null==(n=o({language:t}).find(t=>t.key===e))?void 0:n.text},c=e=>!e.deleted&&!!e.status&&r.Qg.has(e.status);function d(e,t){let{attachments:n}=e;if(n&&n.length>0){for(let e of n)if("post"===e.type){for(let n of e.post.publishedBylines)if(n.id===t)return!0;if((0,i.Ie)(e.publication,t))return!0}else if("comment"===e.type){if(e.comment.user_id===t)return!0}else if("publication"===e.type&&(0,i.Ie)(e.publication,t))return!0}return(function(e){let t=[];if(e.body_json)for(let l of(0,a.A)(e.body_json)){var n,i,r;"substack_mention"!==l.type||(null==(n=l.attrs)?void 0:n.mentionType)!=="user"&&(null==(i=l.attrs)?void 0:i.mentionType)||t.push(null==(r=l.attrs)?void 0:r.id)}return new Set(t)})(e).has(t)}function u(e){var t;return Number(null==(t=e.ancestor_path)?void 0:t.split(".")[0])||e.id}}}]);