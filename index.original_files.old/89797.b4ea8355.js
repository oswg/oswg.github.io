!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};e.SENTRY_RELEASE={id:"substack@af5f699"};var t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="0e5ab4b8-f5e1-42df-9caa-7187e6751b9c",e._sentryDebugIdIdentifier="sentry-dbid-0e5ab4b8-f5e1-42df-9caa-7187e6751b9c")}catch(e){}}();"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["89797"],{72458:function(e,t,n){n.d(t,{A:()=>o});let o={avatar:"avatar-u8q6xB",ltr:"ltr-qDBmby",rtl:"rtl-zsi3Q8",overlap:"overlap-q75iOo",last:"last-JfNEJ_"}},34835:function(e,t,n){let o;n.d(t,{A:()=>s,E:()=>f});var r,i,a=n(4006);n(17402),n(50977);var d=n(50172),l=n(74322),u=n(2797),c=n(86500);function s(e){if(o)throw Error("Cannot re-render the things");o=e,window._preloads&&(window._preloads.original_url=window.location.href),(0,c.Bu)(),(0,u.oo)(),(0,u.Tu)(),function(){if(!window.history||!window.history.pushState||!window.scrollTo)return;let e=window.history.pushState;history.pushState=function(t,n,o){var r;let i=e.apply(history,arguments);return(null==(r=null==t?void 0:t.resetScroll)||r)&&-1===o.indexOf("#")&&window.scrollTo(0,0),i}}(),(0,u.Zi)(window._preloads.language).finally(()=>{w()}),(0,u.$j)()}function f(e){let t=!1;if("object"==typeof window._preloads&&null!==window._preloads)for(let n in e)("object"==typeof e[n]&&null!==e[n]||e[n]!==window._preloads[n])&&(window._preloads[n]=e[n],t=!0);t&&w()}function w(){if(!o)return;let e=document.getElementById("entry");(0,d.render)((0,a.Y)(l.v,{children:(0,a.Y)(o,{initialData:window._preloads})}),e||document.body)}n(20363),"undefined"!=typeof window&&(null==(i=window._preloads)||null==(r=i.user)?void 0:r.is_global_admin)&&new URLSearchParams(window.location.search).get("devtools")&&n(14858)},86500:function(e,t,n){n.d(t,{$5:()=>o.$5,Bu:()=>i.T,TM:()=>r.TM,fN:()=>r.fN,qY:()=>r.qY,u4:()=>r.u4});var o=n(25757);n(66565);var r=n(44803),i=n(43880)},44803:function(e,t,n){n.d(t,{MY:()=>P,TM:()=>D,fN:()=>F,j6:()=>A,qY:()=>_,u4:()=>C});var o,r,i=n(69277),a=n(72343),d=n(53928),l=n(4392),u=n(66565),c=n(7354),s=n(13022),f=n(82260),w=n(68349),p=n(40659);n(16291);var m=n(18189),h=n(39318),g=n(41086),y=n(94402),v=n(82776);let _=m.q,b="undefined"!=typeof window,S=!!(b&&window.navigator&&window.navigator.sendBeacon),x=!(0,w.lT)()&&S,E=new c.W({batchOptions:x?{maxBatchSize:8,maxBatchDataSize:1e4}:void 0,send:function(e,t){b&&(x&&t&&e.push(N(e,t)),new Image().src=(0,h.yRP)(x?"/api/v1/firehose/batch":"/api/v1/firehose",{_:new Date().getTime(),d:e.join(",")}))},beacon:function(e,t){if(!b)return;e.push(N(e,"beacon",t));let n=new Blob([JSON.stringify(e)],{type:"application/json"});navigator.sendBeacon("/api/v1/firehose/batch",n)}}),A=()=>{b&&x&&(window.addEventListener("beforeunload",e=>{E.sendBeacon(e)}),window.addEventListener("pagehide",e=>{E.sendBeacon(e)}),document.addEventListener("visibilitychange",e=>{"hidden"===document.visibilityState&&E.sendBeacon(e)}),setInterval(()=>{E.intervalFlush()},6e4))},T=b&&window!=window.top&&(0,y.G)(w.QT),k="browser";function D(){return T}function C(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{var n;if(["development","test"].includes((n="production",void 0!==n)?n:"")&&!e)throw Error("`undefined` event passed to FRONTEND track call");U(e,Object.assign({},t))}catch(e){try{window.Sentry&&window.Sentry.captureException(e)}catch(t){console.error("Failed to track event",e)}}}function F(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};C(_.PUBLICATION_VISITED,(0,i._)({visited_publication_id:e.id,visited_publication_subdomain:e.subdomain,source:t},n,(0,v.extractEventAttributionDataFromRecord)((0,p.cf)())))}b&&(navigator.standalone||(null==(o=(r=window).matchMedia)?void 0:o.call(r,"(display-mode: standalone)").matches))&&(k="standalone");let I=()=>document.location.pathname.startsWith("/p/");function P(){var e,t,n,o,r,i,a;let l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("undefined"==typeof document||document.location.pathname.startsWith("/embed")&&b&&(null==(n=window)||null==(t=n._preloads)||null==(e=t.pub)?void 0:e.embed_tracking_disabled))return;U(_.PAGES,Object.assign(function(){let e={};if(b){let t=window._preloads&&"post"in window._preloads&&window._preloads.post,n=window.location&&/^\/p\/([^\/]+)/.exec(window.location.pathname),o=window.location&&/\/p-(\d+)/.exec(window.location.pathname);if(n&&n[1]){let o=n[1];t&&t.slug===o&&(e.post_id=t.id,e.post_audience=t.audience,e.post_type=t.type),e.post_slug=o}else o&&o[1]&&(e.post_id=parseInt(o[1]))}return e}(),l));let c=(0,u.wJ)();if(c&&(new Image().src="https://www.facebook.com/tr?id=".concat(c,"&ev=PageView")),(0,f.F)("pageview"),(0,u.b8)("pageview"),(0,u.BU)("page_view"),b&&!I()&&(0,d.Mz)({path:document.location.pathname,title:document.title,sections:"",authors:""}),b&&window.PARSELY&&window.PARSELY.loaded&&window.PARSELY.beacon&&window.PARSELY.beacon.trackPageView){let e={url:document.location.origin+document.location.pathname+document.location.search,urlref:document.referrer||"",js:1,data:{}};if((0,s.Ay)("add_section_and_tag_metadata")){let t,n,d;if(I()&&(n=(null==(t=window._preloads)||null==(o=t.post)?void 0:o.id)&&(null==t?void 0:t.pub),d=!!(null==t||null==(r=t.post)?void 0:r.slug)&&(null==t||null==(i=t.post)?void 0:i.slug)===document.location.pathname.split("/")[document.location.pathname.split("/").length-1],!(n&&I())||!d))return;if(I()){let t=window._preloads;e.data={audience:(a=null==t?void 0:t.user)?a.is_subscribed?"Paid subs":a.is_free_subscribed?"Free subs":"Anonymous":"Anonymous"}}}window.PARSELY.beacon.trackPageView(e)}}function R(e){var t,n,o,r,i,d,u,c,s;let f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},p=null;try{p=Intl.DateTimeFormat().resolvedOptions().timeZone}catch(e){}let m={event:e,timestamp:new Date().toISOString(),properties:Object.assign({browserSessionId:l.O,iframeVisitId:T,r:(0,g.y)("r"),magicUserId:"undefined"!=typeof window&&(null==(o=window)||null==(n=o._preloads)||null==(t=n.user)?void 0:t.is_magic)?window._preloads.user.id:void 0},f),context:{client_type:"web",displayMode:k,page:{referrer:document.referrer,title:document.title,url:document.location.href,height:null!=(d="undefined"!=typeof window&&window.innerHeight)?d:0,width:null!=(u="undefined"!=typeof window&&window.innerWidth)?u:0},campaign:(0,a.tm)(),timezone:p,screen:{height:null!=(c="undefined"!=typeof window&&(null==(r=window.screen)?void 0:r.height))?c:0,width:null!=(s="undefined"!=typeof window&&(null==(i=window.screen)?void 0:i.width))?s:0}}};return(0,w.Cw)(JSON.stringify(m))}function N(e,t,n){let o=e.length,r=e.map(e=>e.length).reduce((e,t)=>e+t,0);return R(_.FIREHOSE_BATCH_SENT,{dataSize:r,batchSize:o,batchType:t,eventType:null==n?void 0:n.type})}function U(e){var t,n,o;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("undefined"==typeof window||"undefined"==typeof document)return;let i=R(e,r);E.add(i),(null==(o=window)||null==(n=o._preloads)||null==(t=n.user)?void 0:t.is_global_admin)&&console.log("EVENT: ".concat(e),r)}},68349:function(e,t,n){n.d(t,{Cw:()=>ec,EW:()=>L,Eh:()=>e_,FK:()=>eu,Gr:()=>ea,I5:()=>M,LJ:()=>q,NN:()=>U,Q2:()=>Q,QT:()=>eh,Sd:()=>el,TJ:()=>eS,Tf:()=>er,Uj:()=>R,V2:()=>ef,Wy:()=>ek,YK:()=>ed,aS:()=>ey,cH:()=>ei,cX:()=>K,dO:()=>P,gI:()=>W,gK:()=>ev,gm:()=>J,iQ:()=>et,lT:()=>H,lW:()=>G,m0:()=>V,nr:()=>Z,o7:()=>j,qm:()=>eg,qr:()=>ep,rr:()=>z,uX:()=>Y,vL:()=>em,vy:()=>en,wp:()=>eb,zY:()=>N,zs:()=>B});var o=n(69277),r=n(79785),i=n(4006),a=n(99862),d=n(72343),l=n(14242);n(74894);var u=n(16291),c=n(96400);n(35884);var s=n(39318),f=n(9036),w=n(98949),p=n(82776);function m(){let e=(0,r._)(["","% off first month"]);return m=function(){return e},e}function h(){let e=(0,r._)(["","% off first year"]);return h=function(){return e},e}function g(){let e=(0,r._)(["","% off first week"]);return g=function(){return e},e}function y(){let e=(0,r._)(["","% off first day"]);return y=function(){return e},e}function v(){let e=(0,r._)(["","% off first payment"]);return v=function(){return e},e}function _(){let e=(0,r._)(["","% off forever"]);return _=function(){return e},e}function b(){let e=(0,r._)([""," off first month"]);return b=function(){return e},e}function S(){let e=(0,r._)([""," off first year"]);return S=function(){return e},e}function x(){let e=(0,r._)([""," off first week"]);return x=function(){return e},e}function E(){let e=(0,r._)([""," off first day"]);return E=function(){return e},e}function A(){let e=(0,r._)([""," off first payment"]);return A=function(){return e},e}function T(){let e=(0,r._)([""," off forever"]);return T=function(){return e},e}function k(){let e=(0,r._)([" at ",""]);return k=function(){return e},e}function D(){let e=(0,r._)([" at ",""]);return D=function(){return e},e}function C(){let e=(0,r._)([" at ",""]);return C=function(){return e},e}function F(){let e=(0,r._)([" at ",""]);return F=function(){return e},e}let I="undefined"==typeof window||!window.addEventListener;I||window.addEventListener("load",()=>{I=!0},!1),"undefined"!=typeof window&&window._preloads;let P="undefined"!=typeof window?new l.A:null,R=e=>{I?e():window.addEventListener("load",e,!1)},N=function(e,t){var n,o,r,i,a,d;let l,{language:u="en"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{iTemplate:s,iPlural:f}=c.TH.i(u);if(e&&!e.loading&&!e.error){if(e.trial_period_days)l=f("1 day free trial","%1 day free trial",e.trial_period_days);else if(e.extra_seats)l=f("an additional seat","%1 additional seats",e.extra_seats);else if(e.percent_off)if("once"===e.duration)if(t)switch(t.interval){case"month":l=s(m(),Math.round(e.percent_off_precise||e.percent_off));break;case"year":l=s(h(),Math.round(e.percent_off_precise||e.percent_off));break;case"week":l=s(g(),Math.round(e.percent_off_precise||e.percent_off));break;case"day":l=s(y(),Math.round(e.percent_off_precise||e.percent_off))}else l=s(v(),Math.round(e.percent_off_precise||e.percent_off));else l="repeating"===e.duration?null===e.duration_in_months||e.duration_in_months%12==0?f("%2% off for 1 year","%2% off for %1 years",(null!=(n=e.duration_in_months)?n:0)/12,"".concat(Math.round(e.percent_off_precise||e.percent_off))):f("%2% off for 1 month","%2% off for %1 months",e.duration_in_months,"".concat(Math.round(e.percent_off_precise||e.percent_off))):s(_(),Math.round(e.percent_off_precise||e.percent_off));else if(e.amount_off)if("once"===e.duration)if(t)switch(t.interval){case"month":l=s(b(),(0,p.centsToPriceString)(e.amount_off,t.currency));break;case"year":l=s(S(),(0,p.centsToPriceString)(e.amount_off,t.currency));break;case"week":l=s(x(),(0,p.centsToPriceString)(e.amount_off,t.currency));break;case"day":l=s(E(),(0,p.centsToPriceString)(e.amount_off,t.currency))}else{let n=(0,p.centsToPriceString)(e.amount_off,null!=(o=null==t?void 0:t.currency)?o:"");l=s(A(),n)}else if("repeating"===e.duration)if(null===e.duration_in_months||e.duration_in_months%12==0){let n=(0,p.centsToPriceString)(e.amount_off,null!=(r=null==t?void 0:t.currency)?r:"");l=f("%2 off for 1 year","%2 off for %1 years",(null!=(i=e.duration_in_months)?i:0)/12,n)}else{let n=(0,p.centsToPriceString)(e.amount_off,null!=(a=null==t?void 0:t.currency)?a:"");l=f("%2 off for 1 month","%2 off for %1 months",e.duration_in_months,n)}else{let n=(0,p.centsToPriceString)(e.amount_off,null!=(d=null==t?void 0:t.currency)?d:"");l=s(T(),n)}return l}},U=function(e,t){let n=new Image;n.onload=()=>{n.onload=n.onerror=null,t&&t(n)},n.onerror=n.onload,n.src=e},L=e=>{let t=document.createElement("a");return t.href=e,(t.hostname||"").replace(/\.localhost$/,"")},O=e=>{let t=document.createElement("a");return t.href=e,(t.pathname||"")+(t.search||"")+(t.hash||"")},Y=(e,t)=>{var n;return q((null==e?void 0:e.body)||(null==e||null==(n=e.response)?void 0:n.body),t)},B=e=>{var t,n,o;let r=(null==e?void 0:e.body)||(null==e||null==(t=e.response)?void 0:t.body);return r&&r.error?{msg:r.error}:r&&r.errors&&r.errors.length>0?{html:null==(n=r.errors[r.errors.length-1])?void 0:n.msgHTML,msg:null==(o=r.errors[r.errors.length-1])?void 0:o.msg}:void 0},M=(e,t)=>{let n;try{n=e?JSON.parse(e&&e.responseText):e}catch(e){}return q(n,t)},q=(e,t)=>{if(t=t||"Something went wrong",e&&e.error)return e.error;if(e&&e.errors&&e.errors.length>0){var n;return(null==(n=e.errors[e.errors.length-1])?void 0:n.msg)||t}return t},j=function(){return[(0,i.Y)("input",{type:"email",name:"fake_email",placeholder:"email",style:{position:"absolute",top:-1e4,left:-1e4},"aria-hidden":"true",tabIndex:-1}),(0,i.Y)("input",{type:"password",name:"fake_password",placeholder:"password",style:{position:"absolute",top:-1e4,left:-1e4},"aria-hidden":"true",tabIndex:-1})]},z=function(){if("undefined"!=typeof navigator||"undefined"!=typeof window){let e=navigator.userAgent||navigator.vendor||window.opera;if(e&&(0,w.fJ)(e,{checkFirst4:!0}))return!0}return!1},H=()=>"undefined"!=typeof window&&!!window.navigator&&!!window.navigator.userAgent&&/(MSIE|Trident)/i.test(window.navigator.userAgent),J=()=>"undefined"!=typeof window&&!!window.navigator&&!!window.navigator.userAgent&&/Firefox/i.test(window.navigator.userAgent),V=()=>"undefined"!=typeof window&&!!window.navigator&&!!window.navigator.userAgent&&/Android/i.test(window.navigator.userAgent),W=()=>!!$(),K=e=>{if("undefined"==typeof window||e||(e=window.navigator),!e)return!1;let t=e;return t.userAgentData&&t.userAgentData.platform?/macOS/.test(t.userAgentData.platform):/Mac/.test(e.platform)},Z=()=>!!navigator&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent),Q=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K();return e?"âŒ˜":"^"},$=()=>"undefined"==typeof window?null:(0,w.UN)(),G=e=>{if("undefined"!=typeof window&&e){if(navigator.clipboard&&navigator.clipboard.writeText)return void navigator.clipboard.writeText(e).catch(()=>{X(e)});X(e)}},X=e=>{var t,n,o;let r;(t=window,n=document,o=navigator,{copy:e=>{let i,a;(r=n.createElement("textArea")).value=e,n.body.appendChild(r),o.userAgent.match(/ipad|iphone/i)?((i=n.createRange()).selectNodeContents(r),(a=t.getSelection()).removeAllRanges(),a.addRange(i),r.setSelectionRange(0,999999)):r.select(),n.execCommand("copy"),n.body.removeChild(r)}}).copy(e);let i=t=>{t&&t.clipboardData?(t.clipboardData.setData("text/plain",e),t.preventDefault()):window.clipboardData&&window.clipboardData.setData("Text",e)};$()||window.addEventListener("copy",i),setTimeout(()=>{try{let t=document.createElement("input");t.style="position: absolute; top: 0; right: 0; height: 1px; width: 1px;",document.documentElement.appendChild(t),t.value=e,t.contentEditable="true",t.readOnly=!1;let n=document.createRange();n.selectNodeContents(t);let o=window.getSelection();null==o||o.removeAllRanges(),null==o||o.addRange(n),t.setSelectionRange(0,999999),document.execCommand("copy"),document.documentElement.removeChild(t)}catch(e){}window.removeEventListener("copy",i)},0)},ee=function(e){let t="undefined"!=typeof window&&window.location.hash?decodeURIComponent(window.location.hash.slice(1)):null;if(!t)return;let n=document.getElementById(t);n&&("number"!=typeof e&&(e=-122),document.documentElement.scrollTop=Math.max(0,((e,t)=>{let n="offset".concat((0,p.toTitleCase)(t)),o=0;for(;e&&e!==document.body;)o+=e[n],e="offsetParent"in e&&e.offsetParent||e.parentNode;return o})(n,"top")+e))},et=(e,t)=>{e.className+=" ".concat(t)},en=(e,t)=>{e&&(e.className=e.className.replace(RegExp("\\b".concat(t,"\\b"),"g"),"").trim())},eo=()=>{let e,t;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(e="visibilitychange",t="hidden"):void 0!==document.msHidden?(e="msvisibilitychange",t="msHidden"):void 0!==document.webkitHidden&&(e="webkitvisibilitychange",t="webkitHidden")),{visibilityChange:e,hidden:t}},er=()=>{let{hidden:e}=eo();return!e||!document[e]},ei=e=>{let{visibilityChange:t}=eo();t&&document.addEventListener(t,e,!1)},ea=e=>{let{visibilityChange:t}=eo();t&&document.removeEventListener(t,e,!1)},ed=e=>new Promise((t,n)=>{if(!window.FileReader)return void n(TypeError("File reader API not found"));let o=new FileReader;o.onerror=n,o.onload=()=>{t(o.result)},o.readAsDataURL(e)}),el=async e=>{let t,n;if(e){try{t=await ed(e)}catch(e){console.error("Failed to get data URL from file:",e),alert(e.message);return}try{n=await new Promise((t,n)=>{if(!window.FileReader)return void n(TypeError("File reader API not found"));if(!window.DataView)return void n(TypeError("DataView API not found"));let o=new FileReader;o.onerror=n,o.onload=()=>{let e=new DataView(o.result);if(65496!=e.getUint16(0,!1))return t(-2);let n=e.byteLength,r=2;for(;r<n;){if(8>=e.getUint16(r+2,!1))return t(-1);let n=e.getUint16(r,!1);if(r+=2,65505==n){if(0x45786966!=e.getUint32(r+=2,!1))return t(-1);let n=18761==e.getUint16(r+=6,!1);r+=e.getUint32(r+4,n);let o=e.getUint16(r,n);r+=2;for(let i=0;i<o;i++)if(274==e.getUint16(r+12*i,n))return t(e.getUint16(r+12*i+8,n))}else if((65280&n)!=65280)break;else r+=e.getUint16(r,!1)}t(-1)},o.readAsArrayBuffer(e)})}catch(e){console.error("Failed to extract EXIF data from file:",e)}}return{url:t,orientation:n}},eu=e=>{switch(e){case 2:return"rotateY(180deg)";case 3:return"rotateZ(-180deg)";case 4:return"rotateZ(-180deg) rotateY(180deg)";case 5:return"rotateZ(-90deg) rotateY(180deg)";case 6:return"rotateZ(90deg)";case 7:return"rotateZ(90deg) rotateY(180deg)";case 8:return"rotateZ(-90deg)";default:return""}},ec=e=>{let t,n,o,r,i,a,d,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",u="",c=0;for(e=es(e);c<e.length;)t=e.charCodeAt(c++),n=e.charCodeAt(c++),o=e.charCodeAt(c++),r=t>>2,i=(3&t)<<4|n>>4,a=(15&n)<<2|o>>6,d=63&o,isNaN(n)?a=d=64:isNaN(o)&&(d=64),u=u+l.charAt(r)+l.charAt(i)+l.charAt(a)+l.charAt(d);return u},es=e=>{let t="";for(let n=0;n<e.length;n++){let o=e.charCodeAt(n);o<128?t+=String.fromCharCode(o):(o>127&&o<2048?t+=String.fromCharCode(o>>6|192):(t+=String.fromCharCode(o>>12|224),t+=String.fromCharCode(o>>6&63|128)),t+=String.fromCharCode(63&o|128))}return t},ef=function(e){let{event:t=null,local_navigation:n=!0,replace:r=!1,newTab:i=!1,state:l,campaign:u}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t&&t.preventDefault(),!e||"string"!=typeof e)return;try{let t=new URL(e);if(!["http:","https:","substack:"].includes(t.protocol))return}catch(e){}if(e.startsWith("#")&&n){if(window.location.hash!==e){var c;r&&(null==(c=window.history)?void 0:c.replaceState)?window.history.replaceState(null!=l?l:window.history.state,null,e):window.location.hash=e}ee();return}if(n&&L(e)&&L(e)!==L(window.location.href)&&(n=!1),!n&&u&&(e=(0,d.P)(e,u)),i||t&&("metaKey"in t&&t.metaKey||"ctrlKey"in t&&t.ctrlKey))return void window.open(e,"_blank");let s=history.state;if(n){if(u&&(0,d.x4)((0,o._)({},u)),"react-router"===window.__SUBSTACK_ROUTER_TYPE__)return void window.__reactRouterNavigate(O(e),{replace:r,state:l});if((0,a.route)(O(e),r)){void 0!==l?history.replaceState(l,""):r&&void 0!==s&&history.replaceState(s,""),setTimeout(()=>ee(),0);return}}window.location.href=e},ew=(e,t)=>new Promise(n=>{e.setState(t,n)}),ep=(e,t)=>new Promise((n,o)=>{let r=async function(){for(var r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];try{n(await t.apply(e,i))}catch(e){o(e)}};e.setState(r)}),em=async function(e,t,n){let{force:o}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return"function"==typeof t&&(n=t,t="lock"),await ep(e,async function(r){for(var i=arguments.length,a=Array(i>1?i-1:0),d=1;d<i;d++)a[d-1]=arguments[d];if(r[t]&&!o)return;await ew(e,{[t]:!0});let l=await n.call(e,r,...a);return await ew(e,{[t]:!1}),l})},eh=()=>{let e=window.crypto||window.msCrypto;if("function"==typeof(null==e?void 0:e.randomUUID))return e.randomUUID();if(e)return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,t=>(t^e.getRandomValues(new Uint8Array(1)[0])&15>>t/4).toString(16));let t=new Date().getTime(),n="undefined"!=typeof performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let o=16*Math.random();return t>0?(o=(t+o)%16|0,t=Math.floor(t/16)):(o=(n+o)%16|0,n=Math.floor(n/16)),("x"===e?o:3&o|8).toString(16)})},eg=function(e){var t;let{stripHash:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("undefined"!=typeof window&&(null==(t=window.history)?void 0:t.replaceState)){let t=(0,f.m)(window.location.href);if(Array.isArray(e))for(let n of e)delete t[n];else delete t[e];let o="".concat((0,s.yRP)(window.location.pathname,t)).concat(n?"":window.location.hash);window.history.replaceState(window.history.state,document.title,o)}},ey=()=>"undefined"!=typeof window&&(void 0!==document.webkitCurrentFullScreenElement?null!==document.webkitCurrentFullScreenElement:void 0!==document.fullscreenElement&&null!==document.fullscreenElement),ev=e=>"undefined"!=typeof window&&(e.requestFullScreen?(e.requestFullScreen(),!0):e.webkitRequestFullScreen?(e.webkitRequestFullScreen(),!0):!!e.mozRequestFullScreen&&(e.mozRequestFullScreen(),!0)),e_=()=>{if(!ey())return!1;if(document.exitFullscreen)return document.exitFullscreen(),!0;if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullScreen)return document.mozCancelFullScreen(),!0;else if(document.msExitFullscreen)return document.msExitFullscreen(),!0;return!1},eb=()=>"undefined"!=typeof window&&!!document.pictureInPictureElement&&!!document.exitPictureInPicture&&(document.exitPictureInPicture(),!0),eS=e=>{let t=document.createElement("a");document.body.appendChild(t),t.href=e,t.target="_blank",t.click(),document.body.removeChild(t)},ex=new Intl.DateTimeFormat(void 0,{timeStyle:"short"}),eE=new Intl.DateTimeFormat(void 0,{month:"short",day:"numeric"}),eA=new Intl.DateTimeFormat(void 0,{dateStyle:"long"}),eT=new Intl.DateTimeFormat(void 0,{dateStyle:"long"}),ek=function(e){let{includeTime:t,language:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=(0,u.A)(e).locale(n||"en"),r=(0,u.A)(),{iTemplate:i}=c.TH.i(n);return o.isBefore(r.startOf("year"))?eA.format(o.toDate())+(t?i(k(),ex.format(o.toDate())):""):o.isBefore(r.startOf("day"))?eE.format(o.toDate())+(t?i(D(),ex.format(o.toDate())):""):o.isAfter(r.endOf("year"))?eT.format(o.toDate())+(t?i(C(),ex.format(o.toDate())):""):o.isAfter(r.endOf("day"))?eE.format(o.toDate())+(t?i(F(),ex.format(o.toDate())):""):ex.format(o.toDate())}},13892:function(e,t,n){n.d(t,{A:()=>o});let o=(0,n(89490).I4)({display:"contents"},"a")},94874:function(e,t,n){n.d(t,{F:()=>h});var o=n(69277),r=n(70408),i=n(4006),a=n(46271),d=n(94729),l=n(56804),u=n(12501),c=n(36372),s=n(70486),f=n(46453),w=n(29611),p=n(15567),m=n(28700);function h(e){let{source:t}=e,n=function(e){let{source:t}=e,n=(0,s.wA)(),i=(0,u.st)({pathname:"/api/v1/messages/dm/start",method:"POST"}),a=async e=>{let o=await i.refetch({json:{user_ids:e,source:t}});return o instanceof Error||n({type:"conversation-load_more",payload:{edge:"before",cursor:null,page:o}}),o};return(0,r._)((0,o._)({},i),{handleStart:a})}({source:t}),h=(0,w.v)(),g=(0,c.d)(),y=(0,a.Jd)(),{onboardingModal:v,requireLogin:_}=(0,f.eE)(),b=async e=>{var t;if(!y)return _?_():v?v.open():h(Error("Onboarding modal not found"),"Could not start conversation."),!1;let o=await n.handleStart(e);return o instanceof Error?(o instanceof d.fk&&(null==(t=o.body)?void 0:t.type)==="profile_not_set_up"?g.popToast(()=>(0,i.Y)(c.y,{text:"Please set up your profile before sending a message.",cta:"Set up profile",href:(0,m.W$)({utm_source:"substack",utm_campaign:"chat_dm_button",redirect:window.location}),localNavigation:!1})):h(o,"Could not start conversation."),!1):((0,l.z)((0,p.tv)(o.thread.id)),!0)};return(0,r._)((0,o._)({},n),{handleStart:b})}},15567:function(e,t,n){n.d(t,{tv:()=>r});var o=n(92636);function r(e,t){return(0,o.c$)("/chat/".concat(e),t)}n(49807)}}]);