!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};e.SENTRY_RELEASE={id:"substack@af5f699"};var n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="e2af4d2c-7408-48be-aad7-4df0eb8516a5",e._sentryDebugIdIdentifier="sentry-dbid-e2af4d2c-7408-48be-aad7-4df0eb8516a5")}catch(e){}}();"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["5966"],{38476:function(){},39101:function(){},72285:function(){},8174:function(e,n,t){t.d(n,{A:()=>r});let r={signInAppUpsell:"signInAppUpsell-u9SVL0",isDesktop:"isDesktop-_mI6rc",appDownloadButton:"appDownloadButton-Lbsixg",qrContainer:"qrContainer-ApUIIX",qrCode:"qrCode-f8T8_u"}},65259:function(){},79804:function(e,n,t){t.d(n,{A:()=>r});let r={avatarLink:"avatarLink-M6ZJnW",inlineComposer:"inlineComposer-v8PLSi",disabled:"disabled-YAsoUi",mobileInlineComposer:"mobileInlineComposer-jKgh_1",isDragging:"isDragging-TcoucF",floatingComposer:"floatingComposer-np5rUF",inputSpacer:"inputSpacer-x19EDg",wordCountIndicator:"wordCountIndicator-KkYqEv",exceded:"exceded-x1z6ce",composerModal:"composerModal-q2ZgZt",setupProfileModalContent:"setupProfileModalContent-IhiQBI",editorContainer:"editorContainer-Lfneza",dropdownIcon:"dropdownIcon-HzL2Jt",dropdownMenu:"dropdownMenu-RAjGgB",pubRow:"pubRow-ZqkbZG",pubName:"pubName-DndaDy",linkImage:"linkImage-VNRJEM",imageContainer:"imageContainer-sSgwnk",imageActions:"imageActions-J_pVYc",removeAttachment:"removeAttachment-lybT5W",shareImageButton:"shareImageButton-O3Fvsx",notifyConformModalPubRow:"notifyConformModalPubRow-929y7D"}},95755:function(e,n,t){t.d(n,{A:()=>r});let r={modalBody:"modalBody-yrSvJm",captcha:"captcha-awCBm5"}},40554:function(e,n,t){t(4006),t(32485),t(76977),t(63136),t(39101)},13950:function(e,n,t){t.d(n,{DH:()=>u});var r=t(4006),o=t(32485),i=t.n(o),a=t(17402),l=t(10996),c=t(6045);function u(e){let{prefix:n,children:t}=e;if(n){let e="header"===n?c.A.headerTheme:"footer"===n?c.A.footerTheme:c.A.footerSecondaryTheme;return(0,r.Y)(d.Provider,{value:n,children:(0,r.Y)("div",{className:i()(c.A.pubTheme,e),children:t})})}return(0,r.Y)(l.NP,{theme:c.A.pubTheme,children:t})}let d=(0,a.createContext)(null)},51419:function(e,n,t){t(4006),t(17402)},2929:function(e,n,t){t(4006),t(97731)},68058:function(e,n,t){t(4006),t(97731)},92707:function(e,n,t){t(4006),t(97731)},92170:function(e,n,t){t(4006),t(97731)},44512:function(e,n,t){t(4006),t(97731)},45197:function(e,n,t){t(4006),t(32485),t(17402),t(82519),t(2929),t(68058),t(92707),t(92170),t(44512),t(40554),t(13950),t(51419),t(52820),t(62668),t(84605),t(97640),t(85478),t(86500),t(55200),t(44333),t(68349),t(68410),t(24078),t(15040),t(35369),t(76977),t(88774),t(63136),t(11510),t(39318),t(80856),t(49807);var r=t(57324);t(72285),r.VU.userMenu},62668:function(e,n,t){t(17402)},46275:function(e,n,t){t.d(n,{BR:()=>a}),t(4006);var r=t(17402),o=t(92636);let i=(0,r.createContext)({isOnDestination:(0,o.Sg)()});function a(){return(0,r.useContext)(i)}i.displayName="IsDestinationContext"},97640:function(e,n,t){t(4006);var r=t(17402);t(79909),t(25006),t(94729),t(59922),t(12501),t(82772),t(68349),t(4016),(0,r.createContext)({lastViewedAt:null,activityUnreadCount:0,activityUnreadAtMax:!1,refetch:async()=>!0,markAllAsRead:async()=>{},hasLoadedOnce:!1}).displayName="NotificationsContext"},55200:function(e,n,t){t(39318)},59922:function(e,n,t){t.d(n,{A:()=>o});var r=t(17402);let o=(e,n)=>{let t=(0,r.useRef)();(0,r.useEffect)(()=>{t.current=e},[e]),(0,r.useEffect)(()=>{if(null!==n){let e=setInterval(function(){var e;null==(e=t.current)||e.call(t)},n);return()=>clearInterval(e)}},[n])}},74049:function(e,n,t){t.d(n,{k:()=>f});var r=t(4006),o=t(7350),i=t.n(o),a=t(17402),l=t(15734),c=t.n(l),u=t(84605),d=t(86500),s=t(36372),p=t(57324);let f=e=>{let n=(0,s.d)(),{iString:t}=(0,u.GO)(),[o,l]=(0,a.useState)(0),f=i()(e=>{l(e)},100),m=(0,a.useCallback)(async()=>{var n,t;let r,o,i=!e.live_stream_id||(null==(n=e.liveStream)?void 0:n.is_rtmp)?"original":"mp4",a="/api/v1/video/upload/".concat(e.id,"/src.json?type=").concat(i),{body:{src:u}}=await c().get(a),s=await fetch(u),m=null==(t=s.body)?void 0:t.getReader(),h=s.headers.get("Content-Length");if(!m||!h)throw Error("Failed to read the response body or content length is missing.");let g=parseInt(h),_=0,E=[];do{let e=await m.read();r=e.done,(o=e.value)&&(E.push(o),f((_+=o.length)/g*100))}while(!r);let v=new Blob(E),S=window.URL.createObjectURL(v),b=document.createElement("a");b.href=S,b.download="undefined"!==e.name&&e.name?e.name:"original.webm",b.target="_blank",b.rel="noopener noreferrer",b.style.display="none",document.body.appendChild(b),b.click(),document.body.removeChild(b),(0,d.u4)(d.qY.VIDEO_CLIP_DOWNLOAD_BUTTON_CLICKED,{name:"download",post_id:e.post_id,utm_campaign:p._9.substackClips,utm_medium:p.Jn.web,media_upload_id:e.id}),setTimeout(()=>l(0),200)},[e]);return{startDownload:()=>{l(0),m(),n.popToast(()=>(0,r.Y)(s.y,{text:t("Download started, do not close the window until download is completed")}))},downloadPercentage:o}}},82772:function(e,n,t){t.d(n,{S8:()=>i});var r=t(17402),o=t(45611);function i(e,n){let{root:t,threshold:i=0,rootMargin:a,disabled:l=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=(0,r.useRef)(!1);!function(e,n){let{root:t,threshold:i=0,rootMargin:a,disabled:l=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=(0,o._)(e=>{n(e.some(e=>e.isIntersecting),e)});(0,r.useEffect)(()=>{if("undefined"==typeof IntersectionObserver||!e.current||l)return;let n=new IntersectionObserver(c,{root:t,threshold:i,rootMargin:a});return n.observe(e.current),function(){n.disconnect()}},[t,i,a,l])}(e,e=>{e&&!c.current&&(c.current=!0,n())},{root:t,threshold:i,rootMargin:a,disabled:l||c.current})}t(68349)},80103:function(e,n,t){t.d(n,{a7:()=>_});var r=t(4006),o=t(32485),i=t.n(o);t(99862);var a=t(47963);t(78895),t(20201),t(79909),t(52820),t(85478);var l=t(86500),c=t(56804);t(3479),t(35840),t(49660);var u=t(76977),d=t(63136);t(4016);var s=t(39318),p=t(98949),f=t(57324),m=t(8174);let h=f._9.appMarketing,g=f.fL.signInPage;function _(e){let{abTestingId:n}=e,t=(0,p.aR)()?"ios":(0,p.m0)()?"android":"desktop",o="desktop"===t?180:120;return(0,r.Y)(u.pT,{padding:20,paddingTop:32,alignItems:"center",justifyContent:"center",children:(0,r.FD)(u.Ye,{radius:"lg",border:"detail",className:i()(m.A.signInAppUpsell,{[m.A.isDesktop]:"desktop"===t}),paddingX:20,paddingTop:20,gap:20,shadow:"lg",cursor:"pointer",onClick:e=>{(0,l.u4)(l.qY.SIGN_IN_APP_UPSELL_CLICKED,{position:"sign-in-page"}),(0,c.o)(e,(0,s.wHz)({utm_campaign:h,utm_content:g,utm_source:f.VU.upsell}),{native:!0,newTab:!0})},children:[(0,r.FD)(u.I1,{justifyContent:"space-between",flex:"grow",paddingBottom:20,gap:8,children:[(0,r.FD)(u.I1,{gap:8,children:[(0,r.Y)(d.EY.H3,{weight:"heavy",children:"Stay signed in"}),(0,r.Y)(d.EY.B4,{color:"secondary",children:"Download the Substack app for ".concat("ios"===t?"iOS":"android"===t?"Android":"Android or iOS")})]}),"desktop"===t?(0,r.Y)(E,{abTestingId:n}):(0,r.Y)(S,{type:t})]}),(0,r.Y)(u.pT,{alignItems:"end",children:(0,r.Y)("img",{style:{maxWidth:o},src:(0,s.dJ9)("/img/app_page/highlight-6-ios-v2.png",2*o)})})]})})}function E(e){let{abTestingId:n}=e;return(0,r.FD)(u.I1,{gap:16,alignItems:"center",children:[(0,r.Y)(v,{abTestingId:n}),(0,r.FD)(u.Ye,{gap:8,children:[(0,r.Y)(S,{type:"ios"}),(0,r.Y)(S,{type:"android"})]})]})}function v(e){let{abTestingId:n}=e;return(0,r.Y)(u.pT,{border:"detail",radius:"lg",className:m.A.qrContainer,children:(0,r.Y)(u.pT,{className:m.A.qrCode,padding:8,children:(0,r.Y)(a.hj,{abTestingId:n,width:160,height:160,utm_campaign:h,utm_content:g,utm_source:f.VU.qr})})})}function S(e){let{type:n}=e;return(0,r.Y)(u.pT,{style:{minWidth:135},radius:"sm",overflowX:"hidden",overflowY:"hidden",className:m.A.appDownloadButton,as:"a",href:(0,s.wHz)({utm_campaign:h,utm_content:g,utm_source:f.VU.badge,force:"android"===n?"android":"ios"}),onClick:e=>e.stopPropagation(),children:(0,r.Y)("img",{className:"app-upsell",src:(0,s.dJ9)("android"===n?"/img/app_page/google-play.png":"/img/app_page/app-store.png",320),height:40})})}},38093:function(e,n,t){t.d(n,{Q:()=>E,Z:()=>_});var r=t(69277),o=t(4006),i=t(32485),a=t.n(i),l=t(42216),c=t(17402),u=t(84605),d=t(94729),s=t(89490),p=t(8149),f=t(76977),m=t(20500),h=t(63136),g=t(24311);function _(e){let{email:n,redirect:t,forPub:i,onIsAttemptingLoginChange:a}=e,[u,s]=(0,c.useState)(""),[f,m]=(0,c.useState)(!1),[h,g]=(0,c.useState)(!1),[_,E]=(0,c.useState)(!1),C=async()=>{m(!0),a&&a(!0);try{let[e]=await Promise.all([(0,d.x6)("/api/v1/email-otp-login/complete",{method:"POST",json:{code:u,email:n,redirect:t,for_pub:i}}),new Promise(e=>setTimeout(e,250))]);window.location.href=e.redirect}catch(e){e instanceof d.fk&&"login_guard_challenge"===e.body.type&&E(!0),m(!1),a&&a(!1),g(!0),s("")}};return n?(0,o.FD)(b,{children:[(0,o.Y)(l.wE,{autoFocus:!0,maxLength:6,pattern:l.UO,onChange:e=>{s(e),e.length&&g(!1)},onComplete:C,value:u,render:e=>{let{slots:n}=e;return(0,o.Y)(Y,{children:n.map((e,n)=>(0,o.Y)(v,(0,r._)({disabled:f},e),n))})}}),(0,o.Y)(p.N,{open:!!h,children:(0,o.Y)(S,{suspiciousLogin:_})})]}):null}function E(e){let{onComplete:n,error:t,isLoading:i}=e,[a,d]=(0,c.useState)(""),{iString:s}=(0,u.GO)();return(0,o.FD)(b,{children:[(0,o.Y)(l.wE,{autoFocus:!0,maxLength:6,pattern:l.UO,onChange:e=>{d(e)},onComplete:e=>{i||n(e)},value:a,disabled:i,render:e=>{let{slots:n}=e;return(0,o.Y)(Y,{children:n.map((e,n)=>(0,o.Y)(v,(0,r._)({disabled:i},e),n))})}}),t&&(0,o.Y)(m.yn,{style:{textAlign:"center"},children:s("You entered an incorrect code. Please try again.")})]})}function v(e){let{char:n,isActive:t,disabled:r}=e;return(0,o.Y)(f.fI,{justifyContent:"center",alignItems:"center",width:36,height:40,className:a()(g.A.input,t&&g.A.focus,r&&g.A.disabled),children:(0,o.Y)(h.EY.B2,{textAlign:"center",children:n||""})})}function S(e){let{suspiciousLogin:n}=e,{iString:t}=(0,u.GO)(),r=t(n?"Please check your email for instructions to complete signing in.":"You entered an incorrect code. Please try again.");return(0,o.Y)(m.yn,{style:{textAlign:"center"},children:r})}let b=(0,s.I4)({display:"flex",direction:"column",alignItems:"center",gap:8}),Y=(0,s.I4)({display:"flex",direction:"row",justifyContent:"center",alignItems:"center",gap:8})},2824:function(e,n,t){t(4006),t(84605),t(46271),t(12501),t(35369),t(16993),t(84843),t(49807)},81870:function(e,n,t){t(4006),t(84605),t(35369),t(16993),t(84843)},21398:function(e,n,t){t.d(n,{Ic:()=>u});var r=t(69277),o=t(70408),i=t(32641),a=t(4006),l=t(17402),c=t(12501);function u(e){return(0,l.createElement)(d,(0,o._)((0,r._)({},e),{key:e.module}))}function d(e){var n;let{onRequest:t,resolve:r,module:o,whileLoading:u,ifError:d}=e,f=(0,i._)(e,["onRequest","resolve","module","whileLoading","ifError"]),{error:m,isLoading:h,result:g}=function(e){let{module:n,onRequest:t,fetchImmediately:r=!0}=e,o=s.has(n),i=(0,c.qK)(()=>p(n,t),[],{auto:r&&!o,initialResult:o?s.get(n):null});return i.error&&console.error(i.error),{error:i.error,isLoading:i.isLoading,result:i.result,fetch:i.refetch}}({module:o,onRequest:t});return(0,a.Y)(a.FK,{children:m?null!=(n=null!=d?d:u)?n:"Error":h||!g?null!=u?u:null:(0,l.createElement)(r(g),f)})}let s=new Map;async function p(e,n){let t=s.get(e);return t||(t=await n(),s.set(e,t)),t}},2481:function(e,n,t){t.d(n,{L6:()=>u,NP:()=>c}),t(4006),t(32485);var r=t(17402);t(78649),t(84605);var o=t(46271);t(86998),t(98920),t(24078),t(35369),t(76977),t(16993),t(63136),t(2824),t(81870),t(5180),t(21398),t(46453),t(11510);var i=t(16884),a=t(70515);t(79804);let l=(0,r.createContext)({state:{isOpen:!1,firstComment:void 0},open:async()=>{throw Error("Not implemented")}});function c(){return(0,r.useContext)(l)}function u(e){var n,t;let r=(0,o.Jd)(),l=null==e?void 0:e.post,c=(null==e?void 0:e.type)=="comment"?null!=(t=null==(n=e.parentComments)?void 0:n[0])?t:e.comment:null,{user_id:u}=null!=c?c:{},{reply_minimum_role:d}=null!=c?c:{},s=(0,i.GQ)(null!=u?u:0);if(null==d&&(null==l?void 0:l.write_comment_permissions)==="only_paid"&&(d="paid_subscriber"),!u||!d||(null==e?void 0:e.canReply)||c&&r&&(0,a.fP)(c,r.id))return null;if(d){if("free_subscriber"===d&&(!s||!["free_subscription","subscribed"].includes(s)))return"free_subscriber";if("paid_subscriber"===d&&"subscribed"!==s)return"paid_subscriber"}return null}},50630:function(e,n,t){t.d(n,{W:()=>a,r:()=>l});var r=t(4006),o=t(17402);let i=(0,o.createContext)(null);function a(e){let{children:n}=e,[t,a]=(0,o.useState)("email"),[l,c]=(0,o.useState)(""),[u,d]=(0,o.useState)(!1),[s,p]=(0,o.useState)(null);return(0,r.Y)(i.Provider,{value:{mode:t,email:l,verificationCodeEnabled:u,onboardingRedirect:s,setMode:e=>{"magic-link"!==e&&d(!1),a(e)},setEmail:c,setVerificationCodeEnabled:d,setOnboardingRedirect:p},children:n})}function l(){let e=(0,o.useContext)(i);if(!e)throw Error("useSignIn must be used within an SignInProvider");return e}},83842:function(e,n,t){t.d(n,{j:()=>g});var r=t(79785),o=t(4006),i=t(43954),a=t(84605),l=t(59922),c=t(38093),u=t(17028),d=t(16993),s=t(84843),p=t(50630),f=t(62088);function m(){let e=(0,r._)(["We've sent an email to ",". Click the magic link or enter the code below:"]);return m=function(){return e},e}function h(){let e=(0,r._)(["We've sent an email to ",". Click the magic link inside to continue."]);return h=function(){return e},e}let g=e=>{let{noCloseButton:n,noExit:t,onCancel:r,onSuccess:i}=e;return(0,o.FD)(o.FK,{children:[(0,o.Y)(_,{noCloseButton:!n||t,onCancel:r}),(0,o.Y)(E,{onSuccess:i}),(0,o.Y)(v,{})]})},_=e=>{let{noCloseButton:n,onCancel:t}=e,{iString:r,iTemplate:l}=(0,a.GO)(),{verificationCodeEnabled:c,email:u}=(0,p.r)();return(0,o.Y)(s.rQ,{title:r("Check your email to continue"),showClose:!n,onClose:t,icon:(0,o.Y)(s.qx,{icon:(0,o.Y)(i.A,{size:20})}),alignItems:"center",description:l(c?m():h(),null!=u?u:"your email address")})};function E(e){let{onSuccess:n}=e,{verificationCodeEnabled:t,email:r,onboardingRedirect:i}=(0,p.r)();return(0,l.A)(()=>{fetch("/api/v1/am_i_logged_in").then(async e=>{(await e.json()).loggedIn&&n()})},5e3),t?(0,o.Y)(d.cw,{children:(0,o.Y)(c.Z,{email:r,redirect:i||document.location.href})}):(0,o.Y)(d.q1,{})}let v=()=>{let{iString:e}=(0,a.GO)(),{setMode:n}=(0,p.r)();return(0,o.Y)(f.dt,{children:(0,o.FD)(o.FK,{children:[e("Didn't get the email? "),(0,o.Y)(u.Yq,{color:"substack",decoration:"hover-underline",onClick:()=>n("email"),cursor:"pointer",children:e("Try again")})]})})}},23358:function(e,n,t){t.d(n,{_:()=>g});var r=t(4006),o=t(84605),i=t(43294),a=t(94729),l=t(12501),c=t(68349),u=t(17028),d=t(20500),s=t(16993),p=t(65842),f=t(50630),m=t(62088),h=t(95755);let g=e=>{let{overrideTitle:n,noCloseButton:t,onCancel:o,onSignup:i,onUserCreated:a,redirectOverride:l}=e;return(0,r.FD)(r.FK,{children:[(0,r.Y)(m.$P,{overrideTitle:n,noCloseButton:t,onCancel:o,onSignup:i}),(0,r.Y)(_,{onUserCreated:a,redirectOverride:l})]})};function _(e){let{onUserCreated:n,redirectOverride:t}=e,{iString:m}=(0,o.GO)(),{setMode:g,setEmail:_,setVerificationCodeEnabled:E,setOnboardingRedirect:v,email:S}=(0,f.r)(),b=(0,i.X)(),Y=(0,l.st)({pathname:"/api/v1/email-login",method:"POST"});return(0,r.FD)("form",{onSubmit:e=>{if(e.preventDefault(),Y.isLoading)return;let r=e.currentTarget.email.value;Y.refetch({json:{email:r,redirect:t||location.pathname,can_create_user:!0}}).then(e=>{if(!(e instanceof a.fk)){if(!(e instanceof Error)&&"optional"===e.verification_code){E(!0),_(r),v(e.onboarding_redirect||null),g("magic-link");return}if(!(e instanceof Error)&&e.user){if(n)return void n(e.user);window.location.reload()}_(r),g("magic-link")}})},children:[(0,r.Y)(s.cw,{className:h.A.modalBody,children:(0,r.FD)(u.VP,{gap:16,children:[(0,r.Y)(p.ks,{type:"email",name:"email",placeholder:m("Your email"),autoComplete:"email",ref:b,autoFocus:!0,defaultValue:S}),Y.error&&(0,r.Y)(d.yn,{children:(0,c.uX)(Y.error)})]})}),(0,r.Y)(s.jl,{direction:"column",primaryButton:(0,r.Y)(u.$n,{priority:"primary",type:"submit",loading:Y.isLoading,children:m("Continue")}),secondaryButton:(0,r.Y)(u.$n,{priority:"secondary-outline",onClick:()=>{var e;_((null==(e=b.current)?void 0:e.value)||""),g("password")},children:m("Sign in with password")}),buttonDivider:(0,r.Y)(u.vj,{})})]})}},82804:function(e,n,t){t.d(n,{Q:()=>m});var r=t(4006),o=t(67078),i=t(84605),a=t(94729),l=t(12501),c=t(38093),u=t(17028),d=t(16993),s=t(84843),p=t(50630),f=t(62088);let m=e=>{let{onSuccess:n}=e;return(0,r.FD)(r.FK,{children:[(0,r.Y)(h,{}),(0,r.Y)(g,{onSuccess:n}),(0,r.Y)(_,{})]})},h=()=>{let{iString:e}=(0,i.GO)();return(0,r.Y)(s.rQ,{title:e("Enter the code from your authenticator app"),description:e("This helps us make sure it's really you."),showClose:!1,icon:(0,r.Y)(s.qx,{icon:(0,r.Y)(o.A,{size:20})}),alignItems:"center"})};function g(e){let{onSuccess:n}=e,t=(0,l.st)({pathname:"/api/v1/mfa-login",method:"Post"});return(0,r.Y)(d.cw,{children:(0,r.Y)(u.VP,{gap:16,children:(0,r.Y)(c.Q,{onComplete:e=>{t.isLoading||t.refetch({json:{code:e}}).then(e=>{e instanceof a.fk||n()})},error:t.error,isLoading:t.isLoading})})})}let _=()=>{let{iString:e}=(0,i.GO)(),{setMode:n}=(0,p.r)();return(0,r.Y)(f.dt,{children:(0,r.FD)(r.FK,{children:[e("Made a mistake? "),(0,r.Y)(u.Yq,{color:"substack",decoration:"hover-underline",onClick:()=>n("email"),cursor:"pointer",children:e("Start over")})]})})}},23191:function(e,n,t){t.d(n,{d:()=>E});var r=t(4006),o=t(17402),i=t(42250),a=t(84605),l=t(43294),c=t(94729),u=t(12501),d=t(68349),s=t(17028),p=t(20500),f=t(16993),m=t(65842),h=t(50630),g=t(62088),_=t(95755);let E=e=>{let{overrideTitle:n,noCloseButton:t,noExit:o,onCancel:i,onSignup:a,onSuccess:l}=e;return(0,r.FD)(r.FK,{children:[(0,r.Y)(g.$P,{overrideTitle:n,noCloseButton:t||o,onCancel:i,onSignup:a}),(0,r.Y)(v,{onSuccess:l})]})};function v(e){let{onSuccess:n}=e,{iString:t}=(0,a.GO)(),{email:g,setEmail:E,setMode:v}=(0,h.r)(),S=(0,u.st)({pathname:"/api/v1/login",method:"post"}),b=(0,o.useRef)(),Y=(0,l.X)(),C=(0,l.X)(),w=async e=>{if(e.preventDefault(),S.isLoading)return;let t=Object.fromEntries(Array.from(e.currentTarget.elements).filter(e=>e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement).map(e=>[e.name,e.value]));b.current&&(t.captcha_response=b.current.getResponse());let r=await S.refetch({json:t});r instanceof Error||(r.mfa_required?v("mfa"):n())};return(0,r.FD)(r.FK,{children:[S.error instanceof c.fk&&401===S.error.response.status&&(0,r.Y)(i.A,{ref:b}),(0,r.FD)("form",{onSubmit:w,children:[(0,r.Y)(f.cw,{className:_.A.modalBody,children:(0,r.FD)(s.VP,{gap:8,children:[(0,r.Y)(m.ks,{type:"email",name:"email",placeholder:t("Your email"),autoComplete:"email",ref:C,defaultValue:g,autoFocus:!0}),(0,r.Y)(m.ks,{type:"password",name:"password",placeholder:t("Your password"),ref:Y}),S.error&&(0,r.Y)(p.yn,{children:(0,d.uX)(S.error)})]})}),(0,r.Y)(f.jl,{direction:"column",primaryButton:(0,r.Y)(s.$n,{priority:"primary",type:"submit",loading:S.isLoading,children:t("Continue")}),secondaryButton:(0,r.Y)(s.$n,{priority:"secondary-outline",onClick:()=>{var e;E((null==(e=C.current)?void 0:e.value)||""),v("email")},children:t("Sign in with email")}),buttonDivider:(0,r.Y)(s.vj,{})})]})]})}},87370:function(e,n,t){t.d(n,{$:()=>i}),t(4006);var r=t(17402);t(16993),t(21398);let o=(0,r.createContext)({open:()=>void 0});function i(){return(0,r.useContext)(o)}},46453:function(e,n,t){t.d(n,{eE:()=>i});var r=t(17402);let o=(0,r.createContext)({setChildOptions:()=>{},isLoading:!1,subscriptions:[],publicationUsers:[],onPageScroll:()=>void 0,setPinTitle:()=>void 0,setDrawer:()=>null,checkFocus:()=>!1,requireLogin:null,isExpanded:!1});function i(){return(0,r.useContext)(o)}},48239:function(e,n,t){t.d(n,{Gg:()=>l,Ur:()=>a,Xf:()=>u,zz:()=>d});var r=t(69277),o=t(70408),i=t(17402);function a(e){return{step:e,previousStepData:{}}}function l(e,n){switch(n.type){case"GO_TO_STEP":return(0,o._)((0,r._)({},e),{step:n.step});case"SET_STEP_DATA":return(0,o._)((0,r._)({},e),{previousStepData:(0,o._)((0,r._)({},e.previousStepData),{[n.key]:n.data})});case"RESET":return a(n.initialStep);default:return e}}let c=(0,i.createContext)(null),u=c.Provider;function d(){let e=(0,i.useContext)(c);if(!e)throw Error("useOnboarding must be used within an OnboardingProvider");return e}},51721:function(e,n,t){t.d(n,{B:()=>S});var r=t(4006),o=t(86500),i=t(42535),a=t(7196),l=t(99039),c=t(78856),u=t(65253),d=t(59849),s=t(31623),p=t(78394),f=t(52943),m=t(23576),h=t(55556),g=t(67749),_=t(44407),E=t(78979);let v={[E.dn.SIGNUP]:{render:()=>(0,r.Y)(g.n,{}),trackScreenShown:o.qY.READER_ONBOARDING_SIGNUP_STEP_SHOWN},[E.dn.PUB_SIGNUP]:{render:()=>(0,r.Y)(h.U,{}),trackScreenShown:o.qY.READER_ONBOARDING_PUB_SIGNUP_STEP_SHOWN},[E.dn.CATEGORIES]:{render:()=>(0,r.Y)(a.Z,{}),trackScreenShown:o.qY.READER_ONBOARDING_CATEGORIES_SCREEN_SHOWN},[E.dn.CATEGORIES_SUGGESTIONS]:{render:()=>(0,r.Y)(_._,{}),trackScreenShown:o.qY.READER_ONBOARDING_SUGGESTIONS_SCREEN_SHOWN},[E.dn.PROFILE]:{render:()=>(0,r.Y)(p.e,{}),trackScreenShown:o.qY.READER_ONBOARDING_PROFILE_SETUP_STARTED},[E.dn.CREATOR_CHOICE]:{render:()=>(0,r.Y)(c.E,{}),trackScreenShown:o.qY.READER_ONBOARDING_INTENT_STEP_SHOWN},[E.dn.CREATOR_WELCOME]:{render:()=>(0,r.Y)(u.J,{}),trackScreenShown:o.qY.READER_ONBOARDING_CREATOR_WELCOME_STEP_SHOWN},[E.dn.START_WRITING]:{render:()=>(0,r.Y)(m.a,{}),trackScreenShown:o.qY.READER_ONBOARDING_START_WRITING_STEP_STARTED},[E.dn.CREATE_PUBLICATION]:{render:()=>(0,r.Y)(l.V,{}),trackScreenShown:o.qY.READER_ONBOARDING_CREATE_PUBLICATION_STEP_STARTED},[E.dn.CREATE_PUBLICATION_SUCCESS]:{render:()=>(0,r.Y)(f.V,{}),trackScreenShown:o.qY.READER_ONBOARDING_CREATE_PUBLICATION_SUCCESS_STEP_STARTED},[E.dn.ERROR]:{render:()=>(0,r.Y)(s.z,{}),trackScreenShown:o.qY.READER_ONBOARDING_ERROR_STEP_SHOWN},[E.dn.APP_UPSELL]:{render:()=>(0,r.Y)(i.v,{}),trackScreenShown:o.qY.READER_ONBOARDING_APP_UPSELL_SHOWN},[E.dn.WELCOME]:{render:()=>(0,r.Y)(d.n,{}),trackScreenShown:o.qY.READER_ONBOARDING_WELCOME_STEP_STARTED}};function S(e){let n=v[e];if(n)return n;console.error("Unknown onboarding step: ".concat(e,", falling back to WELCOME"));let t=v[E.dn.WELCOME];if(!t)throw Error("WELCOME step config is missing");return t}},32848:function(e,n,t){t.d(n,{NL:()=>c,n7:()=>l}),t(50014);var r=t(17402);t(94729);var o=t(82776);let i={hasLoadedOnce:!1,publications:[],subscriptions:[],publicationUsers:[],publicationMap:new Map,subscriptionMap:new Map,publicationUserMap:new Map,publicationsWithPledges:[]},a=(0,r.createContext)({result:null,isLoading:!1,hasLoadedOnce:!1,refetch:()=>Promise.resolve(i),refetchPublication:()=>Promise.resolve(),updatePublication(){},removeByPubId:()=>{},updateSubscriptions:()=>{}});function l(){return(0,r.useContext)(a)}function c(e){let{subscription:n,publicationUser:t,is_pledged:r}=function(e){var n;let{subscriptionMap:t,publicationUserMap:r,publicationsWithPledges:o}=null!=(n=l().result)?n:{subscriptionMap:new Map,publicationUserMap:new Map,publicationsWithPledges:[]};return{subscription:t.get(e),publicationUser:r.get(e),is_pledged:!!(null==o?void 0:o.includes(e))}}(e),i=(null==n?void 0:n.membership_state)==="free_signup",a=(null==n?void 0:n.membership_state)==="subscribed",c=!!(null==n?void 0:n.is_founding),u=!!(t&&(0,o.isAtLeastContributorRole)(t.role));return{subscription:n,publicationUser:t,isFreeSubscribed:i,isPaid:a,isSubscribed:i||a||u,isAuthor:u,isFounding:c,isPledged:r}}},80856:function(e,n,t){t.d(n,{Ru:()=>a,_:()=>u,_4:()=>i,gB:()=>c,iQ:()=>l,lk:()=>o});var r=t(92636);let o=function(){let{utm_source:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r.yR)("".concat((0,r.Ew)(),"/tos"),{utm_source:e})},i=function(){let{utm_source:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r.yR)("".concat((0,r.Ew)(),"/pa"),{utm_source:e})},a=function(){let{pub:e,utm_source:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e?(0,r.yR)("".concat((0,r.$_)(e),"/tos"),{utm_source:n}):o({utm_source:n})},l=function(){let{utm_source:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return"".concat((0,r.yR)("".concat((0,r.Ew)(),"/ccpa"),{utm_source:e}),"#personal-data-collected")},c=function(){let{utm_source:e,hash:n=null}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return"".concat((0,r.yR)("".concat((0,r.Ew)(),"/privacy"),{utm_source:e})).concat(n?"#".concat(n):"")},u=function(){let{pub:e,utm_source:n,hash:t=null}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e)return"".concat(c({utm_source:n,hash:t}));let o=t?"#".concat(t):"";return"".concat((0,r.yR)("".concat((0,r.$_)(e),"/privacy"),{utm_source:n})).concat(o)}}}]);