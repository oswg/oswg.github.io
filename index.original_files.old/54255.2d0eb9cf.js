!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};e.SENTRY_RELEASE={id:"substack@af5f699"};var n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="39e13966-ede8-45ec-8614-c2be71218156",e._sentryDebugIdIdentifier="sentry-dbid-39e13966-ede8-45ec-8614-c2be71218156")}catch(e){}}();"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["54255"],{87544:function(e,n,t){t.d(n,{W:()=>s,v:()=>d});var i=t(4006),r=t(84605),o=t(85478),u=t(74827),l=t(35369);function d(e){var n;let{content:t,onVerificationComplete:o,source:d="post"}=e,{iString:s}=(0,r.GO)(),{launchFlow:a,isLoading:c}=(0,u.K)(o,d),f=(null==(n=t.age_verification)?void 0:n.declined)===!0;return(0,i.Y)(l.$n,{priority:"primary-mono",onClick:()=>{a(t)},size:"sm",loading:c,disabled:f,children:s("Verify age")})}function s(){let{iString:e}=(0,r.GO)(),{getConfigFor:n}=(0,o.mJ)(),t=n("mobile_age_verification_learn_more_link");return t?(0,i.Y)(l.$n,{priority:"secondary-outline",href:t,newTab:!0,size:"sm",children:e("Learn more")}):null}},43262:function(e,n,t){t.d(n,{T:()=>f});var i=t(4006),r=t(22492),o=t(17402),u=t(87544),l=t(84605),d=t(44803),s=t(97515),a=t(82286),c=t(18189);function f(e){let{content:n,description:t,source:f="comment"}=e,{iString:_}=(0,l.GO)();return(0,o.useEffect)(()=>{(0,d.u4)(c.q.AGE_GATING_VIEW_SEEN,{source:f,entity_id:n.id})},[f,n.id]),(0,i.Y)(s.X,{icon:(0,i.Y)(r.A,{}),title:_("Age-restricted content"),description:t,button:(0,i.FD)(a.Xn,{children:[(0,i.Y)(u.v,{content:n,source:f}),(0,i.Y)(u.W,{})]}),paddingY:8})}},74827:function(e,n,t){t.d(n,{K:()=>a});var i=t(4006),r=t(17402),o=t(84605),u=t(46271),l=t(44803),d=t(36372),s=t(18189);function a(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"post",{iString:t}=(0,o.GO)(),{popToast:a}=(0,d.d)(),c=(0,u.Jd)(),[f,_]=(0,r.useState)(!1),v=function(e){let{iString:n}=(0,o.GO)(),{popToast:t}=(0,d.d)();return()=>{t(()=>(0,i.Y)(d.y,{text:n("Verification submitted. Refreshing...")})),e&&e(),setTimeout(()=>{window.location.reload()},3e3)}}(e);return{launchFlow:e=>{var r;if(!(null==(r=e.age_verification)?void 0:r.template_id))return void console.error("No Persona template ID found");if(!(null==c?void 0:c.id)){console.error("User must be logged in for age verification"),a(()=>(0,i.Y)(d.y,{text:t("Please log in to verify your age.")}));return}if("undefined"==typeof window)return void console.error("Persona SDK not loaded");let o=window.Persona;if(!o)return void console.error("Persona SDK not loaded");_(!0),(0,l.u4)(s.q.AGE_VERIFICATION_FLOW_STARTED,{source:n});let u={templateId:e.age_verification.template_id,environment:"production",environmentId:window._preloads.persona_environment_id||"",referenceId:c.id.toString(),onReady:()=>{_(!1),f.open()},onComplete:()=>{_(!1),(0,l.u4)(s.q.AGE_VERIFICATION_FLOW_ENDED,{status:"complete",source:n}),v()},onCancel:()=>{_(!1),(0,l.u4)(s.q.AGE_VERIFICATION_FLOW_ENDED,{status:"cancel",source:n})},onError:()=>{_(!1),(0,l.u4)(s.q.AGE_VERIFICATION_FLOW_ENDED,{status:"error",source:n}),a(()=>(0,i.Y)(d.y,{text:t("Age verification failed. Please try again.")}))}},f=new o.Client(u)},isLoading:f}}},28528:function(e,n,t){t.d(n,{XL:()=>a,np:()=>c});var i=t(69277),r=t(70408),o=t(4006),u=t(69843),l=t.n(u),d=t(17402);let s=(0,d.createContext)({authorPagesEnabled:!1,cropGravity:"center",disableInteractive:!1,hideUfi:!1,highlightByline:!1,linkToComments:!1,pub:null,modifiedPosts:{},showPinForPostIds:new Set,user:null,onChangePost:()=>void 0,onUnpinPost:()=>void 0}),a=e=>{let{actionsClassName:n,authorPagesEnabled:t,children:u,cropGravity:a,disableInteractive:c,hideUfi:f,highlightByline:_,linkToComments:v,postPreviewUrl:p,pub:b,showPinForPostIds:m,showSectionOrTag:g,user:h,utm:y,onClickPost:w,onToggleMenu:E,onUnpinPost:P}=e,A=(0,d.useContext)(s),[C,I]=(0,d.useState)({}),L=(0,d.useCallback)(e=>{let{post:n}=e;I(e=>(0,r._)((0,i._)({},e),{[n.id]:n}))},[]);return(0,o.Y)(s.Provider,{value:(0,r._)((0,i._)({},A,l()(n)?null:{actionsClassName:n},l()(t)?null:{authorPagesEnabled:t},l()(a)?null:{cropGravity:a},l()(c)?null:{disableInteractive:c},l()(f)?null:{hideUfi:f},l()(_)?null:{highlightByline:_},l()(v)?null:{linkToComments:v},l()(p)?null:{postPreviewUrl:p},l()(b)?null:{pub:b},l()(m)?null:{showPinForPostIds:m},l()(g)?null:{showSectionOrTag:g},l()(h)?null:{user:h},l()(y)?null:{utm:y},l()(w)?null:{onClickPost:w},l()(E)?null:{onToggleMenu:E},l()(P)?null:{onUnpinPost:P}),{modifiedPosts:C,onChangePost:L}),children:u})},c=()=>{let e=(0,d.useContext)(s);if(!e.pub)throw Error("No pub provided to PostPreviewContext");return e}},59294:function(e,n,t){t.d(n,{AC:()=>s,Hc:()=>d,TR:()=>u,_N:()=>l}),t(83673),t(11741),t(63375);var i=t(17402),r=t(15734),o=t.n(r);t(39318);let u=e=>{let[n,t]=(0,i.useState)(!1),r=()=>{t(!0)},o=()=>{t(!1)};return(0,i.useEffect)(()=>{let n=e.current;if(n)return n.addEventListener("mouseenter",r),n.addEventListener("mouseleave",o),()=>{n.removeEventListener("mouseenter",r),n.removeEventListener("mouseleave",o)}},[e]),[n]},l=(e,n,t)=>{(0,i.useEffect)(()=>{let i=e.toLocaleLowerCase(),r=e=>{if(!t)return;e.preventDefault();let r=e.key.toLocaleLowerCase();if(r===i||e.ctrlKey&&"ctrl+shift+".concat(r)===i||e.ctrlKey&&"ctrl+".concat(r)===i||e.shiftKey&&"shift+".concat(r)===i)return void n()};return window.addEventListener("keydown",r),()=>{window.removeEventListener("keydown",r)}},[e,n,t])},d=e=>{let[n,t]=(0,i.useState)(null);return(0,i.useEffect)(()=>{let n=async e=>{let{body:{src:n}}=await o().get("/api/v1/video/upload/".concat(e,"/storyboard"));t((await o().get(n)).body)};(null==e?void 0:e.id)&&n(e.id)},[e]),n},s=e=>{let[n,t]=(0,i.useState)(!1),r=e=>{t(e)},o=n=>{e.current&&e.current.contains(n.target)?r(!0):r(!1)};return(0,i.useEffect)(()=>(document.addEventListener("click",o),()=>{document.removeEventListener("click",o)}),[]),n}},56262:function(e,n,t){t.r(n),t.d(n,{getAllAudiences:()=>c,getAudiencesForPublicListing:()=>f,getCommentAuthor:()=>L,getCoverImageUrl:()=>F,getDurationForPostPreview:()=>k,getFoundingAudiences:()=>v,getFreePodcastUrl:()=>T,getPaidAudiences:()=>_,getPostAuthor:()=>I,getPreamble:()=>D,isFoundingAudience:()=>b,isPaidAudience:()=>p,isSubscriptionLevel:()=>m,previewSubHasFullAccessToPost:()=>C,pubRoleHasFullAccessToPost:()=>P,pubRolesHaveFullAccessToPost:()=>A,subHasFullAccessToPost:()=>w,userHasCommentAccess:()=>E,userHasFullAccessToPost:()=>y});var i=t(69277),r=t(32641),o=t(82776);let u=["founding","only_paid","everyone","only_free"],l=["founding","only_paid","everyone"],d=["founding","only_paid"],s=["founding"],a=["free","paid","founding"];function c(){return[...u]}function f(){return[...l]}function _(){return[...d]}function v(){return[...s]}function p(e){return _().includes(e)}function b(e){return v().includes(e)}function m(e){return a.map(String).includes(e)}function g(e,n){if(!n||(null==e?void 0:e.subscription_publication_id)===n){if((null==e?void 0:e.is_founding)||(null==e?void 0:e.is_contributor))return"founding";if(null==e?void 0:e.is_subscribed)return"paid"}return"free"}function h(e){switch(e){case"founding":return["founding"];case"only_paid":return["paid","founding"];case"only_free":return["free"];case"everyone":return["free","paid","founding"];default:throw Error("Unknown audience: ".concat(e))}}function y(e,n){if(!n)return!1;if(!n.audience)throw Error("Post has no audience");if(e&&e.is_contributor&&e.subscription_publication_id===n.publication_id)return!0;let t=g(e,n.publication_id);return h(n.audience).includes(t)}function w(e,n){if(!n)return!1;if(!n.audience)throw Error("Post has no audience");let t=function(e,n){if(!n||(null==e?void 0:e.publication_id)===n){if((null==e?void 0:e.membership_state)==="subscribed"&&(null==e?void 0:e.is_founding))return"founding";if((null==e?void 0:e.membership_state)==="subscribed")return"paid"}return"free"}(e,n.publication_id);return h(n.audience).includes(t)}function E(e,n){if(!n)return!1;if(e&&e.is_contributor&&e.subscription_publication_id===n.publication_id)return!0;let t=g(e,n.publication_id);return"everyone"===n.write_comment_permissions?!!e:"only_paid"===n.write_comment_permissions&&("founding"===t||"paid"===t)}function P(e,n){if(!n)return!1;if(!n.audience)throw Error("Post has no audience");let t=(0,o.isAtLeastContributorRole)(null==e?void 0:e.role)||(null==e?void 0:e.membership_state)==="subscribed"&&(null==e?void 0:e.is_founding)?"founding":(null==e?void 0:e.membership_state)==="subscribed"?"paid":"free";return h(n.audience).includes(t)}function A(e,n){return!!(n&&P(null==e?void 0:e[n.publication_id],n))}function C(e,n,t){let{audienceOverride:i}=t;if(!n)return!1;if(!n.audience&&!i)throw Error("Post has no audience");return h(null!=i?i:n.audience).includes(e)}function I(e,n){var t;let u=null==n||null==(t=n.publishedBylines)?void 0:t[0];if(u)return u;let l=e.contributors.find(e=>e.owner);if(l){let{user_id:e}=l,n=(0,r._)(l,["user_id"]);return(0,i._)({id:e},n)}let d=e.contributors.find(e=>(0,o.isAtLeastContributorRole)(e.role));if(d){let{user_id:e}=d,n=(0,r._)(d,["user_id"]);return(0,i._)({id:e},n)}return{id:e.author_id,name:e.author_name,photo_url:e.author_photo_url,bio:e.author_bio}}function L(e){var n,t,i,r,o,u,l,d,s,a,c,f,_,v,p,b,m,g;return{id:null!=(s=null!=(d=null==(n=e.user)?void 0:n.id)?d:e.user_id)?s:-1,name:null!=(c=null!=(a=null==(t=e.user)?void 0:t.name)?a:e.name)?c:"",handle:null!=(f=null==(i=e.user)?void 0:i.handle)?f:e.handle,photo_url:null!=(_=null==(r=e.user)?void 0:r.photo_url)?_:e.photo_url,bestseller_tier:null!=(p=null!=(v=null==(o=e.user)?void 0:o.bestseller_tier)?v:e.user_bestseller_tier)?p:null,status:null!=(m=null!=(b=null==(u=e.user)?void 0:u.status)?b:e.userStatus)?m:null,primary_publication:null!=(g=null==(l=e.user)?void 0:l.primary_publication)?g:e.user_primary_publication}}function F(e){return!e.cover_image||/12634ced-0eb6-4238-a94a-70ab242c5ad8/.test(e.cover_image)||/fa15c776-f514-42fe-8ee0-4c94148a0a8a/.test(e.cover_image)||/8826edac-0d50-4ba0-b861-f3ed9336878b/.test(e.cover_image)||/49be2356-6491-4a6f-84a5-15e99d23b6d1/.test(e.cover_image)?null:e.cover_image}function T(e){var n,t;let{post:i}=e;return null!=(t=null==(n=i.podcastFields)?void 0:n.free_podcast_url)?t:null}function k(e){var n,t,i,r,o,u,l,d;let{post:s}=e;return null!=(d=null!=(l=null!=(u=null!=(o=null==(n=s.videoUpload)?void 0:n.duration)?o:null==(i=s.podcastUpload)||null==(t=i.full_podcast_info)?void 0:t.duration)?u:null==(r=s.podcastUpload)?void 0:r.duration)?l:s.podcast_duration)?d:0}function D(e,n,t){let{is_freemail:i,is_free_preview:r,sectionEmailRenderElements:u}=t,l=(e,t)=>{var i,r;let o=!("section"in n&&(null==(i=n.section)?void 0:i.ignore_publication_email_settings));return null!=(r=null==u?void 0:u[t])?r:o?null==e?void 0:e[t]:null};return r?l(e.email_render_elements,"free_preview_preamble"):(0,o.isPaidPub)(e)?"everyone"===n.audience?l(e,i?"public_post_free_signup_preamble":"public_post_subscriber_preamble"):p(n.audience)?l(e,"subscriber_post_subscriber_preamble"):void 0:l(e.email_render_elements,"email_preamble_for_free_writer")}},69706:function(e,n,t){t.d(n,{B7:()=>o,UH:()=>d,Zi:()=>i,d8:()=>u,fo:()=>r,qr:()=>l});let i=1,r=1.5,o=16/9,u=1.91,l=1.91,d={square:1,editorial:1.5,thumb:1.91,landscape:16/9,portrait:9/16,instagram:.8,social:1.91,cover:3}}}]);