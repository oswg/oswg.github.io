!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};e.SENTRY_RELEASE={id:"substack@af5f699"};var t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="77e32904-8aee-4e9f-849d-f852af5fbde9",e._sentryDebugIdIdentifier="sentry-dbid-77e32904-8aee-4e9f-849d-f852af5fbde9")}catch(e){}}();"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["1274"],{15092:function(){},82130:function(){},86972:function(){},84759:function(){},35407:function(){},12896:function(){},9751:function(e,t,i){i.d(t,{b:()=>p});var n=i(4006),a=i(84605);i(6049);var o=i(24078),r=i(35369),l=i(76977),s=i(63136),d=i(49807),c=i(57324),u=i(36092);function p(e){let{pub:t,subdomain:i}=e,{iString:c}=(0,a.GO)();return(0,n.FD)(l.I1,{className:u.A.webContainer,alignItems:"center",border:"detail-themed",radius:"md",padding:20,gap:16,as:"a",href:h(i),target:"_blank","data-component-name":"CommunityChatEmbed",children:[(0,n.Y)(o.eu,{size:64,photoUrl:(0,d.dJ9)(t.author_photo_url)}),(0,n.FD)(l.I1,{gap:4,alignItems:"center",children:[(0,n.FD)(s.EY.H3,{translated:!0,as:"div",color:"pub-primary-text",children:["Join ",I18N.p(t.author_name),"’s subscriber chat"]}),(0,n.Y)(s.EY.B4,{translated:!0,color:"pub-secondary-text",children:"Available in the Substack app and on web"})]}),(0,n.Y)(l.I1,{alignSelf:"stretch",children:(0,n.Y)(r.$n,{priority:"primary",href:h(i),children:c("Join chat")})})]})}function h(e){return(0,d.xWO)({pubKey:e,utm_source:c.VU.chatEmbed})}},83427:function(e,t,i){i.d(t,{B:()=>h});var n=i(4006),a=i(18993);i(39333);var o=i(86500),r=i(94729),l=i(12501),s=i(44333),d=i(76977),c=i(49807),u=i(57324),p=i(91348);function h(e){var t,i,h,m,y;let g,{postId:f}=e,{path:v}=(0,s.zy)();"undefined"!=typeof window&&(g=v.startsWith("/inbox/post/")?Number(v.split("/post/")[1]):"post"in window._preloads?null==(y=window._preloads)||null==(m=y.post)?void 0:m.id:void 0);let{error:Y,result:b}=(0,l.st)({pathname:"/api/v1/community/posts/".concat(f),auto:!0,deps:[f]}),_=Y instanceof r.fk&&402===Y.response.status&&((null==(t=Y.body)?void 0:t.status)==="PAID_SUBSCRIPTION_REQUIRED"||(null==(i=Y.body)?void 0:i.status)==="FOUNDING_SUBSCRIPTION_REQUIRED"||(null==(h=Y.body)?void 0:h.status)==="FREE_SUBSCRIPTION_REQUIRED")?Y.body:null;return(0,n.Y)(d.pT,{as:"a",className:p.A.container,target:"_blank",href:(0,c.sWz)({postId:f,utm_source:u.VU.threadEmbed}),"data-component-name":"CommunityPostEmbed",onClick:()=>(0,o.u4)(o.qY.EMBEDDED_COMMUNITY_POST_CLICKED,{post_id:g,community_post_id:f}),children:_?"FREE_SUBSCRIPTION_REQUIRED"===_.status&&_.communityPost?(0,n.Y)(a.lS,{author:_.user,communityPost:_.communityPost,surface:"community_post_embed",communityPostEmbedPostId:g,useClientSideRouting:!1,withAttribution:!0,isReadOnly:!0,utmSource:u.VU.threadEmbed}):(0,n.Y)(a.I8,{author:_.user,audience:"FREE_SUBSCRIPTION_REQUIRED"===_.status?"all_subscribers":"PAID_SUBSCRIPTION_REQUIRED"===_.status?"only_paid":"only_founding"}):Y?"Could not load chat message: Click to view":b&&(0,n.Y)(a.lS,{author:b.user,communityPost:b.communityPost,surface:"community_post_embed",communityPostEmbedPostId:g,utmSource:u.VU.threadEmbed,useClientSideRouting:!1,withAttribution:!0,isReadOnly:!0})})}},18993:function(e,t,i){i.d(t,{I8:()=>eC,lS:()=>ep});var n=i(69277),a=i(70408),o=i(32641),r=i(79785),l=i(4006);i(50172);var s=i(45994),d=i(32485),c=i.n(d),u=i(95201),p=i.n(u),h=i(99609),m=i(40972),y=i(54718),g=i(35404),f=i(82853),v=i(48587),Y=i(54687),b=i(98188),_=i(37946),w=i(48686),k=i(16079),A=i(32708),E=i(65892),C=i(87677),I=i(67078),T=i(26683),P=i(73040),D=i(91461),S=i(86404),N=i(66443);i(72880),i(15688);var R=i(82936),x=i(84605),F=i(46275),L=i(46271),O=i(88325),U=i(25714),M=i(86500),B=i(27069),H=i(94729),W=i(72569),z=i(68349),V=i(24078),K=i(15040),j=i(35369),G=i(17028),q=i(88774),J=i(75303),X=i(81929),$=i(36372),Q=i(3046),Z=i(46647),ee=i(69089),et=i(70486),ei=i(42831);i(53457);var en=i(32848),ea=i(20437),eo=i(49807),er=i(82776),el=i(11993),es=i(45464),ed=i(3898),ec=i(36083);function eu(){let e=(0,r._)(["You are not allowed to post or react to this chat. ",""]);return eu=function(){return e},e}function ep(e){var t,i,n;let{communityPost:a,author:o,pubRole:r,userStatus:d,extras:c,withAttribution:u,flex:p,hideReply:m,isReadOnly:y,onReply:g,onDelete:f,pub:v,truncate:Y=!0,surface:b,useClientSideRouting:_,utmSource:w,isPaid:k,isFounding:A}=e,{iString:E}=(0,x.GO)(),C=(0,s.li)(null),I=_?(0,eo.e$6)({pubId:a.publication_id,postId:a.id,noBase:!0}):(0,eo.sWz)({postId:a.id,utm_source:w}),T=(0,ei.d)({entityType:"communityPost",publication:v}),P=(0,R._N)(a.user_id);return(0,l.FD)(eS,{pubThemeAccentColor:null!=(n=null==v||null==(t=v.theme)?void 0:t.background_pop_color)?n:null==v?void 0:v.theme_var_background_pop,pubThemePrintOnPopColor:null==v||null==(i=v.theme)?void 0:i.print_on_pop,user:o,pubRole:r,userStatus:d,flex:p,containerRef:C,extras:c,children:[u&&(0,l.Y)(e7,{text:"From ".concat(o.name,"’s subscriber chat")}),!P&&(0,l.Y)(Q.Nf,{user:o}),(0,l.Y)(ey,{actionMenuProps:{communityEntity:a,publicationId:a.publication_id,replyAction:g&&!m&&(0,l.Y)(q.Dr,{leading:(0,l.Y)(h.A,{}),disabled:a.is_locked,onClick:g,children:E("Reply")}),onReply:y||m||a.is_locked?void 0:g,onDelete:f,onReport:T,isReadOnly:y,isFlagged:a.reported_by_user},flex:p,children:(0,l.Y)(eh,{communityPost:a,hideReply:m,userBlockStatus:P,isFounding:A,isPaid:k,isReadOnly:y,useClientSideRouting:_,utmSource:w,pub:v,truncate:Y,surface:b,author:o})}),!m&&(0,l.Y)(J.AE,{href:I,children:(0,l.Y)(eZ,{onClick:g,direction:"incoming",commenters:a.recent_commenters,count:a.comment_count,hasUnread:!!(a.most_recent_comment_created_at&&a.user_last_viewed_timestamp&&a.user_last_viewed_timestamp<a.most_recent_comment_created_at)})}),!m||a.body||a.link_metadata?(0,l.Y)(Q.Xx,{direction:"incoming"}):null]})}function eh(e){let{communityPost:t,hideReply:i,userBlockStatus:o,isReadOnly:r,isFounding:s,isPaid:d,pub:u,surface:p,communityPostEmbedPostId:h,useClientSideRouting:m,utmSource:y,truncate:g,onReply:f,reactionsContext:v,handleReactionClick:Y,reaction:b,reactions:_,backAction:w,outline:k}=e,{images:A,video:E}=em(t.mediaAttachments),C=!(A.length>0||E),I=null!=v?v:{type:"posts",id:t.id},{audience:T}=t,{canReply:P,shouldShowToken:D}=e1({audience:T,isFounding:s,isPaid:d,chatPaywallStatus:null==u?void 0:u.paywall_chat}),S=(0,et.wA)(),R=m?(0,eo.e$6)({pubId:t.publication_id,postId:t.id,noBase:!0,params:{backAction:w}}):(0,eo.sWz)({postId:t.id,utm_source:y}),x=function(e,t){if(!e||!(null==t?void 0:t.url))return e;let i=t.url,n=e.trim();return n.startsWith(i)?n.slice(i.length).trim():n.endsWith(i)?n.slice(0,-i.length).trim():e}(t.body,t.link_metadata),F=e=>{"feed-recommended"!==I.type&&(Y?Y({id:t.id,reaction:e}):eg(t.id,"posts",S,t.reaction)(e))},L=null!=b?b:t.reaction,U=null!=_?_:t.reactions,M=p&&(p.startsWith("chat_inbox")?"chat_inbox":(0,O.u)(p));return(0,l.FD)(ej,{hasFooter:!i,children:[!o&&"media"===t.type&&(A.length>0||E)&&(0,l.FD)(ee.e,{context:I,reactions:U,currentReaction:L,onReactionClick:F,isReadOnly:r,children:[E&&(0,l.Y)(ea.R8,{mediaUpload:E.mediaUpload,composing:!1,maxWidth:400,videoPlayerProps:{surface:M,entityType:"community_post",entityKey:t.id,contentType:"communityPost",primaryEntityKey:h,primaryEntityType:h?"post":void 0}},E.mediaUpload.id),A&&(0,l.FD)(G.az,{children:[(0,l.Y)(N.K,{assets:A.filter(e=>e.url).map(e=>({src:e.url,explicit:e.explicit,width:e.width,height:e.height})),className:c()(es.A.imageGroup,i&&!t.body&&es.A.isLast),maxWidth:400,maxHeight:420,readOnly:r,isContained:!0,outline:k}),D&&!t.body&&(0,l.Y)(eJ,{className:es.A.right,canReply:!!P,audience:t.audience,style:"media"})]})]}),!o&&t.link_metadata&&(0,l.Y)(ee.e,{context:I,reactions:U,currentReaction:null!=b?b:t.reaction,onReactionClick:F,setReactions:!!(C&&t.link_metadata),isReadOnly:r,alignSelf:"stretch",children:(0,l.Y)(Q.ZT,{metadata:t.link_metadata,isFirst:C,direction:"incoming"})}),(t.body||C&&!t.link_metadata)&&(0,l.Y)(ee.e,{context:I,reactions:U,currentReaction:null!=b?b:t.reaction,onReactionClick:F,setReactions:C&&!t.link_metadata,isReadOnly:r,alignSelf:"stretch",children:x&&(0,l.Y)(J.AE,{href:R,style:{display:"flex"},children:(0,l.Y)(eq,{publication:u,communityEntity:(0,a._)((0,n._)({},t),{body:x}),onClick:e=>{!e.defaultPrevented&&f&&f(e)},truncate:g,isPaid:d,isFounding:s,outline:k})})})]})}let em=e=>{let t=[],i=null;for(let n of e)"image"===n.type?t.push(n):i||(i=n);return{images:t,video:i}};function ey(e){let{children:t,actionMenuProps:i,flex:a="grow"}=e;return(0,l.FD)(G.Ye,{alignItems:"start",gap:12,flex:a,children:[(0,l.Y)(Q.dU,{children:t}),(0,l.Y)(ex,(0,n._)({},i))]})}let eg=(e,t,i,n)=>async a=>{n===a?i(ev(a,e,t)):i(ef(a,e,t,n))},ef=(e,t,i,n)=>async(a,o)=>{let{iString:r,iTemplate:l}=I18N.i("en");a({type:"".concat(i,"-new_reaction"),payload:{id:t,reaction:e}});let s=await (0,T.YD)(e,t,i);if(s instanceof H.fk){var d,c;(null==(d=s.body)?void 0:d.status)==="PUBLICATION_BAN"?alert(l(eu(),null==(c=s.body)?void 0:c.error)):alert(r("We failed post your reaction. Please try again later."))}else(0,B.v)(s,{message:"Failed to add reaction"});s instanceof Error&&a(n?{type:"".concat(i,"-new_reaction"),payload:{id:t,reaction:n}}:{type:"".concat(i,"-remove_reaction"),payload:{id:t,reaction:e}})},ev=(e,t,i)=>async(n,a)=>{n({type:"".concat(i,"-remove_reaction"),payload:{id:t,reaction:e}}),await (0,T.jx)(e,t,i) instanceof Error&&n({type:"".concat(i,"-new_reaction"),payload:{id:t,reaction:e}})};async function eY(e,t){try{return await fetch("/api/v1/community/posts/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({is_locked:t})})}catch(e){return e}}async function eb(e,t){try{return await fetch("/api/v1/community/comments/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({is_locked:t})})}catch(e){return e}}async function e_(e,t){try{return await fetch("/api/v1/community/comments/".concat(e,"/publication_bans?ban=").concat(t.toString()),{method:"POST"})}catch(e){return e}}async function ew(e){try{return await (0,H.x6)("/api/v1/community/comments/".concat(e),{method:"DELETE",json:{commentId:e}})}catch(e){return e}}async function ek(e){try{return await (0,H.x6)("/api/v1/community/comments/".concat(e),{method:"GET"})}catch(e){return console.warn(e),e}}async function eA(e){try{return await (0,H.x6)("/api/v1/community/posts/".concat(e),{method:"GET"})}catch(e){return console.warn(e),e}}async function eE(e){try{return await (0,H.x6)("/api/v1/community/posts/".concat(e),{method:"DELETE",json:{postId:e}})}catch(e){return e}}function eC(e){let{author:t,extras:i,showReply:o=!0,analyticsParams:r,commenters:d,count:c,audience:u,paywallInfo:p,onClick:h}=e;return(0,s.vJ)(()=>{var e;r&&(0,M.u4)(M.qY.THREAD_PAYWALL_SCREEN_VIEWED,(0,a._)((0,n._)({},r),{audience:u&&("only_founding"===(e=u)?"founding":"only_paid"===e?"paid":"free")}))},[]),(0,l.FD)(eS,{user:t,extras:i,children:[t&&(0,l.Y)(Q.Nf,{user:t}),(0,l.FD)(ej,{children:[p?(0,l.Y)(e4,{audience:u,paywallInfo:p,onClick:h}):(0,l.Y)(e0,{audience:u,onClick:h}),o&&(0,l.Y)(eZ,{isLocked:!0,direction:"incoming",commenters:d,count:c,onClick:h})]})]})}function eI(e){return"string"==typeof e.message}function eT(e){let{text:t,rawText:i,specialText:n,mentionMap:a,direction:o="incoming",limit:r=600,linkify:d=!0}=e,{iString:u}=(0,x.GO)(),[p,h]=(0,s.J0)(!1);if(n)return(0,l.Y)("em",{children:n});if(!t)return(0,l.Y)(l.FK,{});let m=[{characters:t.length,message:t}];i&&a&&(m=function(e,t,i){let n=/\$\{(\d+)\}/g,a=n.exec(e),o=[],r=0;for(;a;){var s,d,c;let u=t[Number(a[1])],p=u.text.slice(1);u?(a.index>r&&o.push({characters:a.index-r,message:e.slice(r,a.index)}),o.push({characters:u.text.length,message:(s=u.user_id,d=p,c=i,(0,l.Y)(U.P,{id:s,label:d,type:"user",unstyled:"outgoing"===c}))})):o.push({characters:n.lastIndex-r,message:e.slice(r,n.lastIndex)}),r=n.lastIndex,a=n.exec(e)}return r<e.length&&o.push({characters:e.length-r,message:e.slice(r)}),o}(i,a,o));let{alwaysShow:y,afterExpansion:g}=function(e,t){let i=0,n=[],a=[];for(let o of e){let e=o;if(i<t){if(i+e.characters>t&&eI(e)){let n=t-i,o={characters:n,message:e.message.slice(0,n)},r={characters:e.characters-n,message:e.message.slice(n)};e=o,a.push(r)}i+=e.characters,n.push(e)}else a.push(e)}return{alwaysShow:n,afterExpansion:a}}(m,r),f=g.length>0;return(0,l.FD)(l.FK,{children:[y.map(e=>d&&eI(e)?(0,l.Y)(eP,{children:e.message}):e.message),f&&!p&&(0,l.FD)(l.FK,{children:[(0,l.Y)("span",{children:" "}),(0,l.Y)(j.Nm,{resetCss:!0,className:c()(es.A.readMore,es.A[o]),onClick:e=>{e.preventDefault(),h(!0)},children:u("See more")})]}),f&&p&&(0,l.Y)(l.FK,{children:g.map(e=>d&&eI(e)?(0,l.Y)(eP,{children:e.message}):e.message)})]})}function eP(e){let{children:t}=e;return(0,l.Y)(p(),{options:{attributes:{rel:"nofollow ugc",onClick:e=>e.stopPropagation()},className:es.A.textLink,format:(e,t)=>"url"===t?(0,el.H)(e,64):e},children:t})}function eD(e){return void 0===e.post_id}function eS(e){var t;let{user:i,children:n,extras:a,flex:o="grow",containerRef:r,id:s,pubRole:d,userStatus:u,pubThemeAccentColor:p,pubThemePrintOnPopColor:h}=e,m=(0,R._N)(null!=(t=null==i?void 0:i.id)?t:0);return(0,l.FD)(G.I1,{id:s,flex:o,gap:2,ref:r,className:c()(ed.A.reactionsHoverZone,es.A.avatarContainer),children:[(0,l.FD)(G.pT,{alignItems:"end",gap:12,children:[(0,l.Y)(G.pT,{paddingTop:4,children:m?(0,l.Y)(eN,{user:i}):i?(0,l.Y)(e8,{pubThemeAccentColor:p,pubThemePrintOnPopColor:h,user:i,pubRole:d,userStatus:u,size:32}):(0,l.Y)(eR,{})}),(0,l.Y)(G.I1,{flex:"grow",gap:2,position:"relative",alignItems:"start",children:n})]}),a&&(0,l.FD)(G.pT,{gap:12,children:[(0,l.Y)(G.az,{width:32}),(0,l.Y)(G.I1,{flex:"grow",gap:4,children:a})]})]})}function eN(e){let{user:t}=e,i=(0,F.BR)().isOnDestination;return(0,l.Y)(J.AE,{href:t?(0,eo.gYq)(t,{noBase:i}):void 0,children:(0,l.Y)(eR,{children:(0,l.Y)(m.A,{size:20,stroke:"var(--color-fg-tertiary)"})})})}let eR=(0,J.I4)({radius:"full",width:32,height:32,bg:"secondary"},J.ov);function ex(e){var{isNew:t}=e,i=(0,o._)(e,["isNew"]);if(t)return null;let{onNewQuote:a,onReply:r,communityEntity:s}=i;return(0,l.FD)(G.pT,{alignItems:"center",gap:4,className:es.A.actions,children:[a&&s&&(0,l.Y)(eL,{onNewQuote:a,communityComment:s}),r&&s&&(0,l.Y)(eO,{onReply:r}),(0,l.Y)(q.W1,{trigger:(0,l.Y)(j.K0,{"aria-label":"Options",size:"sm",priority:"tertiary",children:(0,l.Y)(y.A,{size:20})}),children:(0,l.Y)(eF,(0,n._)({},i))})]})}function eF(e){let{communityEntity:t,replyAction:i,onDelete:n,onReport:a,isReadOnly:o,publicationId:r,isBanned:s,isFlagged:d,onNewQuote:c}=e,u=(0,L.Jd)(),{isAuthor:p,publicationUser:h}=(0,en.NL)(null!=r?r:0),m=(null==h?void 0:h.role)==="community_moderator",y=r&&p,g=t&&u&&t.user_id===u.id,f=t&&!eD(t),v=f&&"parent_id"in t&&null!==t.parent_id,Y=g||y||m,b=g||y||m,_=!g&&!d,w=(y||m)&&f&&!g,k=!f&&u&&(null==t?void 0:t.user_id)===u.id;return t?(0,l.FD)(l.FK,{children:[(0,l.Y)(eB,{communityEntity:t}),t.body&&(0,l.Y)(eM,{communityEntity:t}),!o&&c&&f&&(0,l.Y)(eU,{onNewQuote:c,communityComment:t}),!o&&i,k&&(0,l.Y)(eW,{communityEntity:t}),(0,l.FD)(q.H9,{children:[!o&&!v&&b&&(0,l.Y)(eH,{communityEntity:t}),!o&&Y&&(0,l.Y)(eK,{communityEntity:t,onDelete:n}),!o&&void 0!==s&&w&&(0,l.Y)(eV,{communityEntity:t,isBanned:s}),!o&&_&&(0,l.Y)(ez,{onReport:a,communityEntity:t})]}),(0,l.Y)(q.NW,{children:(0,l.Y)(G.pT,{paddingY:4,children:(0,l.Y)(Z.D,{conjunction:!0,timestamp:t.created_at})})})]}):null}function eL(e){let{onNewQuote:t,communityComment:i}=e;return(0,l.Y)(j.K0,{size:"sm",priority:"tertiary","aria-label":"Reply",onClick:()=>{t(i)},children:(0,l.Y)(h.A,{size:20})})}function eO(e){let{onReply:t}=e;return(0,l.Y)(j.K0,{size:"sm",priority:"tertiary","aria-label":"Reply",onClick:t,children:(0,l.Y)(h.A,{size:20})})}function eU(e){let{onNewQuote:t,communityComment:i}=e,{iString:n}=(0,x.GO)();return(0,l.Y)(q.Dr,{leading:(0,l.Y)(h.A,{}),onClick:()=>{t(i)},children:n("Reply")})}function eM(e){let{communityEntity:t}=e,{iString:i}=(0,x.GO)(),n=(0,$.d)();return(0,l.Y)(q.Dr,{leading:(0,l.Y)(g.A,{}),onClick:()=>{if(t){let{body:e}=t;(0,z.lW)(e),n.popToast(()=>(0,l.Y)($.y,{text:i("Text copied to clipboard"),Icon:g.A}))}},children:i("Copy text")})}function eB(e){let{communityEntity:t}=e,{iString:i}=(0,x.GO)(),n=(0,W.c)(),{id:a}=t,o=eD(t);return(0,l.Y)(q.Dr,{leading:(0,l.Y)(f.A,{}),onClick:()=>{let e;if(o)e=(0,eo.sWz)({postId:a});else if(t.parent_id){var i;e=(0,eo.j5y)({commentId:null!=(i=t.parent_id)?i:a,targetReplyId:t.parent_id?a:void 0,showTarget:!0})}else e=(0,eo.sWz)({postId:t.post_id,targetReplyId:t.id,showTarget:!0});n(e)},children:i("Copy link")})}function eH(e){let{communityEntity:t}=e,{iString:i}=(0,x.GO)(),n=(0,et.wA)(),a=(0,$.d)(),{id:o,is_locked:r}=t,s=eD(t),d=async()=>{if(s){let e;n((e=!r,async(t,i)=>{t({type:"posts-lock_replies",payload:{id:o,isLocked:e}});let n=await eY(o,e);n instanceof Error&&(console.warn("error locking post",n),alert("There was an error ".concat(e?"locking":"unlocking"," replies to this post. Please try again later.")),t({type:"posts-lock_replies",payload:{id:o,isLocked:!e}}))}))}else{let e;n((e=!r,async(t,i)=>{t({type:"comments-lock_replies",payload:{id:o,isLocked:e}});let n=await eb(o,e);n instanceof Error&&(console.warn("error locking comment",n),alert("There was an error ".concat(e?"locking":"unlocking"," replies to this comment. Please try again later.")),t({type:"comments-lock_replies",payload:{id:o,isLocked:!e}}))}))}r?a.popToast(()=>(0,l.Y)($.y,{text:i("Enabled replies"),Icon:Y.A})):a.popToast(()=>(0,l.Y)($.y,{text:i("Disabled replies"),Icon:v.A}))};return(0,l.Y)(q.Dr,{leading:(0,l.Y)(v.A,{}),onClick:d,priority:"destructive",children:r?i("Re-enable replies"):i("Disable replies")})}function eW(e){let{communityEntity:t}=e,i=(0,et.wA)(),n=eD(t),a=async()=>{n&&i({type:"posts-edit_post",payload:{post:t}})};return(0,l.Y)(q.Dr,{leading:(0,l.Y)(b.A,{}),onClick:a,priority:"primary",children:"Edit"})}function ez(e){let{onReport:t,communityEntity:i}=e,{iString:n}=(0,x.GO)();return(0,l.Y)(l.FK,{children:(0,l.Y)(q.Dr,{leading:(0,l.Y)(_.A,{}),onClick:()=>{t(i.id,"admin"!==i.user_pub_role)},priority:"destructive",children:n("Report")})})}function eV(e){let{communityEntity:t,isBanned:i}=e,{iString:n}=(0,x.GO)(),a=(0,et.wA)(),o=async()=>{if(confirm("Are you sure you want to ban this user?")){let e,{id:n}=t;a((e=!i,async(t,i)=>{t({type:"comments-ban_author",payload:{id:n,ban:e}});let a=await e_(n,e);a instanceof Error&&(console.warn("error toggling ban for comment author",a),alert("There was an error ".concat(e?"banning":"unbanning"," this user. Please try again later.")),t({type:"comments-ban_author",payload:{id:n,ban:!e}}))}))}};return(0,l.Y)(q.Dr,{leading:i?(0,l.Y)(w.A,{}):(0,l.Y)(k.A,{}),onClick:o,priority:"destructive",children:n(i?"Unban":"Ban")})}function eK(e){let{communityEntity:t,onDelete:i}=e,{iString:n}=(0,x.GO)(),a=(0,et.wA)(),o=eD(t),r=async()=>{if(confirm("Are you sure you want to delete this ".concat(o?"thread":"comment","?"))){let{id:e}=t;if(o){let{publication_id:i}=t;a(async(t,n)=>{t({type:"posts-delete_post",payload:{id:e,publication_id:i}});let a=await eE(e);a instanceof Error&&console.warn("error deleting thread",a)})}else{let{post_id:i,parent_id:n}=t;a(async(t,a)=>{t({type:"comments-delete_comment",payload:{id:e,postId:i}});let o=await ew(e);if(o instanceof Error&&console.warn("error deleting comment",o),n){let e=await ek(n);e instanceof Error||t({type:"comments-update_comment",payload:{id:n,comment:e.comment}})}let r=await eA(i);r instanceof Error||t({type:"posts-update_post",payload:{id:i,post:r.communityPost}})})}i&&setTimeout(i,500)}};return(0,l.Y)(q.Dr,{leading:(0,l.Y)(A.A,{}),onClick:r,priority:"destructive",children:n("Delete")})}function ej(e){var{hasFooter:t}=e,i=(0,o._)(e,["hasFooter"]);return(0,l.Y)(G.I1,(0,n._)({className:c()(es.A.bubbleStack,t&&es.A.hasFooter),gap:2,alignItems:"start"},i))}function eG(e){var{isTargeted:t,className:i}=e,a=(0,o._)(e,["isTargeted","className"]);return(0,l.Y)(G.I1,(0,n._)({className:c()(es.A.bubble,t&&es.A.highlight,i),sizing:"border-box",paddingY:8,paddingX:12,bg:"secondary",minWidth:0,gap:8},a))}function eq(e){let{communityEntity:t,publication:i,isTargeted:n,onClick:a,truncate:o=!0,isPaid:r,isFounding:s,outline:d}=e,{audience:c}=t,{canReply:u,shouldShowToken:p}=e1({audience:c,isFounding:s,isPaid:r,chatPaywallStatus:null==i?void 0:i.paywall_chat}),h=p||t.is_edited,m=t.reactions?Object.keys(t.reactions).length:0;return(0,l.FD)(eG,{isTargeted:n,onClick:a,className:ec.A[m>0?"reactions-".concat(m):""],outline:d,children:[(0,l.Y)(eQ,{communityEntity:t,truncate:o}),h&&(0,l.FD)(G.Ye,{justifyContent:"end",gap:2,children:[p&&(0,l.Y)(eJ,{canReply:!!u,audience:c}),t.is_edited&&(0,l.Y)(e$,{})]})]})}function eJ(e){let{canReply:t,audience:i,style:n="default",showLabel:a=!0,className:o}=e,r=a?"media"===n?"var(--vibrance-primary)":"var(--color-chat-incoming-fg-primary)":"var(--color-fg-primary)";return(0,l.FD)(X.vw,{className:c()(es.A.paywallReplyTag,"media"===n&&es.A.media,!a&&es.A.iconOnly,o),priority:"secondary",children:[t?(0,l.Y)(S.A,{size:12,color:r}):(0,l.Y)(D.A,{size:12,color:r}),a&&(0,l.Y)(G.EY.B5,{weight:"medium",children:eX.get(i)})]})}let eX=new Map([["only_paid","Paid subscribers only"],["only_paid_replies","Paid subscriber replies"],["only_founding","Founding members only"],["only_founding_replies","Founding member replies"]]);function e$(){return(0,l.FD)(X.vw,{className:es.A.paywallReplyTag,priority:"secondary",children:[(0,l.Y)(E.A,{size:12}),(0,l.Y)(G.EY.B5,{weight:"medium",children:"Edited"})]})}function eQ(e){var t,i,n,a,o;let{communityEntity:r,truncate:s=!0}=e,d=null,c=eD(r)?"thread":"reply";r.reported_by_user&&(d="You reported this ".concat(c)),"deleted"!==r.status&&r.body||(d="This ".concat(c," is not available"));let u=(0,R._N)(r.user_id);d||"blocking"!==u?d||"blocked"!==u||(d="This person is blocked"):d="This person blocked you";let p=null!=(t=r.raw_body)?t:r.body;return p?eD(r)&&r.link_url&&!r.link_metadata&&(p="".concat(p,"\n\n").concat(r.link_url).trim()):eD(r)?(null==(n=r.media_assets)?void 0:n.length)?d="".concat(r.media_assets.length," ").concat(r.media_assets.length>1?"photos":"photo","."):r.link_url&&(r.link_metadata?d='Link: "'.concat(r.link_metadata.title,'"'):(p=r.link_url,d=null)):(null==(i=r.media_uploads)?void 0:i.length)&&(d="".concat(r.media_uploads.length," ").concat(r.media_uploads.length>1?"photos":"photo",".")),(0,l.Y)(G.EY.B3,{className:es.A.body,isParagraph:!0,children:(p||d)&&(0,l.Y)(eT,{text:p,rawText:null!=(a=r.raw_body)?a:"",mentionMap:Array.isArray(r.mentions)?void 0:null!=(o=r.mentions)?o:void 0,specialText:d,limit:s?void 0:9999999})})}function eZ(e){let{isLocked:t,count:i=0,commenters:n,hasUnread:a,onClick:o,direction:r,outline:s}=e,{iString:d,iPlural:u}=(0,x.GO)();return(0,l.Y)(Q.Zh,{isLast:!0,messageDirection:r,onClick:o,cursor:o?"pointer":void 0,height:36,paddingY:4,paddingRight:12,paddingLeft:12,outline:s,children:(0,l.FD)(G.pT,{justifyContent:"space-between",alignItems:"center",gap:32,children:[(0,l.FD)(G.pT,{alignItems:"center",gap:8,children:[n&&i>0&&(0,l.Y)(G.pT,{className:es.A.facepile,alignItems:"center",children:n.map(e=>(0,l.Y)(V.eu,{className:c()(es.A.facepileAvatar,"outgoing"===r&&es.A.outgoing),user:e,size:22}))}),(0,l.Y)(G.pT,{gap:8,alignItems:"center",children:(0,l.Y)(G.EY.B3,{as:"span",className:a?es.A.hasUnread:es.A.noUnread,children:0===i?d("Leave a reply"):u("%1 reply","%1 replies",i)})})]}),t?(0,l.Y)(D.A,{size:14,color:"var(--color-chat-fg-secondary)"}):(0,l.Y)(C.A,{size:20,stroke:a?"var(--color-chat-reply-active)":"var(--color-chat-fg-secondary)"})]})})}function e0(e){let{audience:t,href:i,onClick:n}=e;return(0,l.Y)(G.I1,{className:es.A.paywallBubble,as:i?"a":"div",onClick:n,cursor:n?"pointer":void 0,alignSelf:"stretch",alignItems:"center",justifyContent:"center",bg:"secondary",href:i,target:i?"_blank":void 0,children:(0,l.FD)(G.pT,{alignItems:"center",gap:4,children:[(0,l.Y)(I.A,{size:12,stroke:"var(--color-fg-secondary)"}),(0,l.Y)(G.EY.Meta,{weight:"semibold",children:"only_founding"===t?"FOUNDING MEMBERS ONLY":"only_paid"===t?"PAID SUBSCRIBERS ONLY":"SUBSCRIBERS ONLY"})]})})}function e1(e){let{audience:t,isFounding:i,isPaid:n,chatPaywallStatus:a}=e,o=["only_founding","only_founding_replies"].includes(t);return{canReply:i||"all_subscribers"===t||n&&["only_paid","only_paid_replies"].includes(t),shouldShowToken:a&&("free"===a&&"all_subscribers"!==t||"paid"===a&&o)}}function e4(e){let{paywallInfo:t,audience:i,onClick:n}=e,{mediaAttachments:a}=t,{body:o}=t,r=a[0];return o||r||(o=[,,,,].fill("Blah blah blah blahhhhh blah.").join(" ")),(0,l.FD)(l.FK,{children:[r&&(0,l.Y)(G.I1,{position:"relative",children:(0,l.Y)(N.K,{className:es.A.ImageGrid,assets:[{src:r.thumb_url,width:r.width,height:r.height,explicit:!1}],maxWidth:400,maxHeight:420,readOnly:!0,isContained:!0,children:(0,l.Y)(e6,{className:es.A.paywallFade,children:(0,l.Y)(eJ,{canReply:!1,audience:null!=i?i:"only_paid",style:"media",showLabel:!o,className:o?es.A.right:es.A.center})})})}),o&&(0,l.FD)(eG,{className:es.A.bubble,onClick:n,children:[(0,l.Y)(G.EY.B3,{className:es.A.paywallText,isParagraph:!0,children:o}),(0,l.Y)(e6,{className:c()(es.A.paywallFade,es.A.paywallBlur),children:(0,l.Y)(G.az,{className:es.A.paywallReplyTagAbsolute,children:(0,l.Y)(eJ,{canReply:!1,audience:null!=i?i:"only_paid",style:"media"})})})]})]})}let e6=(0,J.I4)({position:"absolute",inset:0,alignItems:"center",justifyContent:"center"},J.VP);function e7(e){let{text:t,isStatic:i}=e;return(0,l.Y)(G.pT,{paddingX:8,paddingY:4,children:(0,l.FD)(G.EY.B5,{color:"secondary",weight:"semibold",children:[(0,l.Y)(P.A,{strokeWidth:2,height:12,stroke:"#808080",fill:"transparent",isStatic:i})," ",t]})})}function e8(e){let t,{user:i,size:n,pubRole:a,userStatus:o,className:r,disabled:s,pubThemeAccentColor:d,pubThemePrintOnPopColor:c}=e,u=(0,F.BR)().isOnDestination;(0,er.isAtLeastContributorRole)(null==a?void 0:a.role)?t="author":(null==a?void 0:a.is_founding)?t="founding":(null==a?void 0:a.membership_state)==="subscribed"&&(t="paid");let p=(0,l.Y)(V.tp,{user:i,size:n,className:r,disabled:s,linkProps:{target:"_blank"},noBase:u});return"author"!==t?(null==o?void 0:o.badge)?(0,l.Y)(K.Pk,{badge:o.badge,children:p}):p:(0,l.Y)(K.w4,{tier:t,fgOverride:c,bgOverride:d,children:p})}},39333:function(e,t,i){i(4006),i(18993),i(41873),i(6049),i(89490),i(63136),i(39318),i(49807),i(82776)},36066:function(e,t,i){i(4006),i(46137),i(3364)},78423:function(e,t,i){i(4006),i(17402),i(27402),i(86500),i(58418),i(35369),i(76977),i(63136),i(82144)},34615:function(e,t,i){i(4006),i(32485),i(84605),i(24078),i(15040),i(35369),i(76977),i(16993),i(63136),i(93718),i(15092)},21805:function(e,t,i){i.d(t,{i_:()=>_});var n=i(69277),a=i(70408),o=i(4006),r=i(32485),l=i.n(r),s=i(84934),d=i(17402),c=i(52742),u=i(72880),p=i(17028),h=i(76977),m=i(49807),y=i(36008);let g=(e,t)=>1===t?"large":2===t||4===t?"medium":t%3==0?"small":5===t||7===t?e<=2?"small":"medium":e<=5?"small":"medium",f={small:237,medium:360,large:728},v=e=>{let{src:t,size:i,onSelectImage:n,useViewer:a=!1,alt:r}=e;return(0,o.Y)(u.o,{src:t,alt:r,maxWidth:2*f[i],className:l()(y.A.image,y.A[i],a&&y.A.zoom,(0,p.iF)({pressable:"lg"})),onClick:()=>{a&&n()}})},Y=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=[];for(let a in e){let o=e[a],{height:r=0,width:l=0}=o&&(0,m.d4Y)(o.src)||{},s="(".concat(Number(a)+1," of ").concat(e.length,")"),d={src:o.src,height:r,width:l,alt:"".concat(i," ").concat(s),title:"".concat(t," ").concat(s)};n.push({attrs:d})}return n},b=e=>{let{onEditGallery:t}=e;return(0,o.Y)(p.mZ,{priority:"primary",onClick:t,className:y.A.edit,children:(0,o.Y)(s.A,{size:20})})},_=e=>{var t;let{node:i,editor:r,post:s,publication:u,onLike:p}=e,{gallery:m}=i.attrs,f=i.attrs.isEditor||r,{caption:_,alt:w}=null!=m?m:{},k=null!=(t=null==m?void 0:m.images.map((e,t)=>(0,a._)((0,n._)({},e),{idx:t})))?t:[],A="undefined"!=typeof window&&!window.location.pathname.startsWith("/publish"),[E,C]=(0,d.useState)(!1),[I,T]=(0,d.useState)(0),P=1===k.length,D=Y(k,_),S=e=>{T(e),C(!0)};if(0===k.length)return null;let N=function e(t){let i=4===t.length?2:3,n=[t.slice(0,i)],a=t.slice(i);return a.length>0&&(n=n.concat(e(a))),n}(k);return(0,o.FD)("figure",{className:y.A.gallery,"data-drag-handle":!0,"data-component-name":"ImageGallery",children:[f&&m&&(0,o.Y)(b,{onEditGallery:()=>{document.dispatchEvent(new Event("editSelectedImageGallery"))}}),(0,o.FD)(h.I1,{gap:8,children:[P?(0,o.Y)(v,{src:k[0].src,alt:w,caption:_,size:g(0,1),onSelectImage:()=>S(0),useViewer:A}):N.map(e=>(0,o.Y)(h.pT,{className:l()(y.A.imageRow,y.A["length-".concat(e.length)]),gap:8,children:e.map(e=>(0,o.Y)(v,{src:e.src,alt:w,caption:_,size:g(e.idx,k.length),onSelectImage:()=>S(e.idx),useViewer:A}))})),_&&(0,o.Y)("figcaption",{className:y.A.imageCaption,children:_})]}),(0,o.Y)(c.V,{isOpen:E,modalContent:D,onClose:()=>C(!1),step:I,post:s,publication:u,onLike:p})]})}},33460:function(e,t,i){i.d(t,{Ai:()=>f,Eg:()=>v});var n=i(4006);i(32485);var a=i(27775),o=i(17402);i(69715),i(60996),i(60745),i(49031),i(34581),i(70357),i(38685),i(41935),i(9979);var r=i(84605);i(40691),i(86500),i(17186),i(68349),i(35369);var l=i(60322),s=i(76977),d=i(88774),c=i(43145),u=i(63136),p=i(65842);i(36372);var h=i(87370),m=i(68601),y=i(92967),g=i(39625);let f=e=>{let{initialTime:t,onChange:i,maxTime:a}=e,{iString:d}=(0,r.GO)(),[h,m]=(0,o.useState)(!0),[f,v]=(0,o.useState)(!0),[Y,b]=(0,o.useState)((0,y.kq)(null!=t?t:0));return(0,n.FD)(s.Ye,{gap:12,alignItems:"center",paddingX:8,paddingY:4,children:[(0,n.Y)(c.T6,{children:(0,n.Y)(l.S,{size:"sm",checked:h,onChange:()=>m(!h)})}),(0,n.Y)(u.EY.B4,{weight:"medium",color:"primary",children:d("Start at")}),(0,n.Y)(p.ks,{className:g.A.textInput,value:Y,error:!f,onChange:e=>{var t;let n,o;return t=e.currentTarget.value,n=(0,y.i)(t),o=(0,y.wG)(t),void(n&&(!a||o<=a)?(i((0,y.wG)(t)),v(!0)):(i(null),v(!1)),b(t))},placeholder:"0:00"})]})};function v(e){let{url:t,onShare:i}=e,{iString:o}=(0,r.GO)(),l=(0,h.$)();return(0,n.Y)(d.Dr,{leading:(0,n.Y)(a.A,{}),onClick:()=>{l.open({linkAttachmentUrl:t,source:"share_post"}),null==i||i()},onMouseEnter:m.M,children:o("Send as message")})}},30653:function(e,t,i){i(4006),i(32485),i(17402),i(8853),i(71900),i(9599),i(2538),i(84605),i(86500),i(68349),i(24078),i(89490),i(35369),i(16993),i(84843),i(81203),i(46453),i(11510),i(39318),i(82130)},38893:function(e,t,i){i.d(t,{$g:()=>m});var n=i(4006),a=i(4963),o=i(14506),r=i(48617),l=i(99070),s=i(4169),d=i(84605),c=i(89490),u=i(63136),p=i(82286),h=i(53076);function m(e){let{label:t,src:i,duration:c,downloadable:h,autoPlay:m,post:f,pub:v,mediaUpload:Y,trackingProps:b}=e,{iString:_}=(0,d.GO)();return(0,n.Y)(l.A,{src:i,duration:c,autoPlay:m,post:f,pub:v,metricsPost:f,feature:"Embed audio",mediaUpload:Y,trackingProps:null!=b?b:{},render:e=>{let{currentTime:l,isPlaying:d,progress:m,progressBarRef:f,progressBarOnMouseDown:v,remainingTime:Y,playbackRate:b,setPlaybackRate:w,togglePlayback:k}=e;return(0,n.FD)(g,{"aria-label":_("Audio embed player"),role:"region","data-component-name":"AudioEmbedPlayer",children:[(0,n.Y)(o.e,{isPlaying:d,onClick:k}),(0,n.FD)(y,{children:[t&&(0,n.Y)(u.EY.B4,{weight:"medium",color:"secondary",children:t}),(0,n.Y)(s.b,{currentTime:l,remainingTime:Y,containerRef:f,progress:m,onMouseDown:v})]}),(0,n.FD)(p.Xn,{children:[h&&(0,n.Y)(a.Y,{src:i}),c&&c>600&&(0,n.Y)(r.x,{onSetPlaybackRate:w,playbackRate:b})]})]})}})}let y=(0,c.I4)({display:"flex",flex:"grow",direction:"column",gap:6}),g=(0,c.I4)({display:"flex",flex:"grow",radius:"sm",bg:"primary",userSelect:"none",sizing:"border-box",alignItems:"center",gap:12,padding:12,border:"detail",className:h.A.embed})},86938:function(e,t,i){i.d(t,{w:()=>h});var n=i(4006),a=i(32485),o=i.n(a),r=i(48635),l=i(41935),s=i(25006),d=i(46271);i(6049);var c=i(76977),u=i(63136),p=i(20004);let h=e=>{var t;let{disableLinks:i,href:a,includeUfi:h=!1,paddingBottom:m=0,paddingTop:y=0,post:g}=e,f=(0,d.Jd)(),v=(0,s.df)();return(0,n.FD)(c.Ye,{alignItems:"center",gap:16,paddingBottom:m,paddingTop:y,children:[h&&v&&f&&g&&(0,n.FD)(c.Ye,{className:"post-ufi",gap:8,children:[(0,n.Y)(l.wR,{post:g,pub:v,user:f}),(0,n.Y)(l.hy,{post:g,pub:v}),(0,n.Y)(l.if,{labelStyle:"cta",post:g,pub:v,style:"button",user:f})]}),(0,n.Y)(u.EY.B4,{align:"center",as:"a",className:o()({[null!=(t=p.A.disableLink)?t:""]:i}),href:a,weight:"medium",children:(0,n.FD)(c.Ye,{alignItems:"center",className:p.A.link,gap:8,children:[(0,n.Y)(u.EY.B4,{as:"span",color:"accent",size:14,weight:"semibold",children:"Read full story"}),(0,n.Y)(r.A,{size:16})]})})]})}},74019:function(e,t,i){i.d(t,{W:()=>p});var n=i(4006),a=i(32485),o=i.n(a),r=i(38305);i(6049);var l=i(68349),s=i(76977),d=i(63136),c=i(49807),u=i(20004);let p=e=>{let{bylines:t,date:i,disableLinks:a}=e;return(0,n.FD)(s.Ye,{alignItems:"center",gap:4,children:[(null==t?void 0:t.length)?(0,n.FD)(n.FK,{children:[(0,n.Y)(d.EY.Meta,{className:o()({[u.A.disableLink]:a}),color:"pub-secondary-text",children:(0,n.Y)(r.K,{array:t||[],formatter:e=>{let{id:t,name:i}=e;return(0,n.Y)("a",{className:u.A.inheritColor,href:(0,c.rfn)(t,i),children:i})},limit:3})}),(0,n.Y)(d.EY,{color:"pub-secondary-text",children:"\xb7"})]}):null,(0,n.Y)(d.EY.Meta,{color:"pub-secondary-text",children:(0,l.Wy)(i)})]})}},43327:function(e,t,i){i.d(t,{vV:()=>T});var n=i(69277),a=i(70408),o=i(4006),r=i(32485),l=i.n(r),s=i(45773),d=i(17402),c=i(12018),u=i(86938),p=i(74019),h=i(72880),m=i(41873),y=i(84605),g=i(85478),f=i(15113);i(6049);var v=i(12501),Y=i(68349),b=i(89490),_=i(76977),w=i(57820),k=i(81203),A=i(63136),E=i(39318),C=i(20004);function I(e){let{postId:t,fallbackSizeLgProps:i}=e,{iString:r}=(0,y.GO)(),[c,u]=(0,d.useState)(!1),{result:p,isLoading:h}=(0,v.st)({pathname:"/api/v1/posts/by-id/".concat(t),deps:[t],auto:!0});if(h)return(0,o.Y)(_.pT,{alignItems:"center",bg:"tertiary",className:C.A.videoEmbedPlaceholder,justifyContent:"center",radius:"md",children:(0,o.Y)(w.y$,{flex:"grow"})});let g=null==p?void 0:p.post,I=null==p?void 0:p.publication,P=null==g?void 0:g.videoUpload;if(!g||!I||!P)return console.warn("VideoPostEmbed: missing data, falling back to legacy render"),(0,o.Y)(T,(0,a._)((0,n._)({},i),{forceLegacyRender:!0}));let D=g.canonical_url,S=e=>{e.stopPropagation(),e.preventDefault(),(0,Y.lW)(D),u(!0),setTimeout(()=>u(!1),3e3)};return(0,o.Y)(b.az,{className:C.A.videoEmbed,position:"relative",children:(0,o.Y)(m.A,{mediaUpload:P,post:g,pub:I,renderOverlay:e=>{var t;let{isPlaying:i,getCurrentTimeInSeconds:n}=e;return(0,o.FD)(_.Ye,{className:l()(C.A.videoOverlay,{[null!=(t=C.A.alwaysVisible)?t:""]:!i}),justifyContent:"space-between",padding:16,pointerEvents:"auto",position:"absolute",top:0,children:[(0,o.FD)(_.Ye,{alignItems:"center",flex:"grow",gap:12,paddingRight:12,children:[(0,o.Y)(k.Nq,{pub:I,radius:"full",size:32}),(0,o.Y)("a",{className:C.A.titleLink,href:D,rel:"noopener",target:"_blank",onClick:()=>{let e=n(),t=(0,E.oRR)(D,{t:e});(0,Y.V2)(t,{newTab:!0})},children:(0,o.Y)(A.EY,{clamp:2,color:"white",decoration:"hover-underline",weight:"medium",children:g.title})})]}),(0,o.FD)(_.I1,{alignItems:"end",gap:0,hover:!0,position:"relative",onClick:S,children:[(0,o.Y)(b.az,{paddingRight:16,children:c?(0,o.Y)(s.A,{stroke:"white"}):(0,o.Y)(f.qY,{stroke:"white"})}),(0,o.Y)(A.EY,{color:"white",size:14,wrap:"nowrap",children:c?r("Copied to clipboard"):r("Copy link")})]})]})},stopPropagation:!0})})}let T=e=>{var t,i,n;let{disableLinks:a,isEditingCaption:r,post:s,caption:d,onEditCaption:m,onSaveCaption:y,onCancelCaption:f,forceLegacyRender:v}=e,{publishedBylines:Y,title:w,canonical_url:k,post_date:E,section_name:T,cover_image:P,cover_image_alt:D}=s,{getConfigFor:S}=(0,g.mJ)();return!v&&S("use_enhanced_video_embed_player")?(0,o.Y)(I,{fallbackSizeLgProps:e,postId:s.id}):(0,o.FD)(_.I1,{children:[T&&(0,o.Y)("a",{className:l()({[null!=(t=C.A.disableLink)?t:""]:a}),href:k,rel:"noopener",target:"_blank",children:(0,o.Y)(A.EY.Meta,{color:"pub-primary-text",paddingBottom:8,children:T})}),(0,o.Y)("a",{className:l()({[null!=(i=C.A.disableLink)?i:""]:a}),href:k,rel:"noopener",target:"_blank",children:(0,o.Y)(A.EY.H2,{color:"pub-primary-text",children:w})}),(0,o.Y)(p.W,{bylines:Y,date:E,disableLinks:a}),P&&(0,o.Y)(b.az,{paddingTop:24,children:(0,o.Y)("a",{className:l()({[null!=(n=C.A.disableLink)?n:""]:a}),href:k,rel:"noopener",target:"_blank",children:(0,o.Y)(h.o,{alt:null!=D?D:w,className:C.A.fullWidth,imageProps:{height:Math.round(650),smartCrop:!0},maxWidth:1300,src:P})})}),(0,o.Y)(_.pT,{flex:"grow",paddingTop:16,children:r&&y&&f?(0,o.Y)(c.y,{initialCaption:d,onCancel:f,onSave:y}):(0,o.Y)("p",{className:C.A.caption,dangerouslySetInnerHTML:{__html:d},onClick:m||void 0})}),(0,o.Y)(u.w,{disableLinks:a,href:k,includeUfi:!1,post:s})]})}},47663:function(e,t,i){i.d(t,{T:()=>y});var n=i(4006),a=i(32485),o=i.n(a),r=i(12018),l=i(86938),s=i(74019);i(43327);var d=i(72880),c=i(89490),u=i(76977),p=i(63136),h=i(11510),m=i(20004);let y=e=>{var t,i,a;let{caption:y,disableLinks:g,post:f,isEditingCaption:v,onEditCaption:Y,onSaveCaption:b,onCancelCaption:_}=e,{publishedBylines:w,title:k,canonical_url:A,post_date:E,section_name:C,cover_image:I,cover_image_alt:T}=f,P=(0,h.Iu)();return(0,n.FD)(u.I1,{children:[C&&(0,n.Y)("a",{className:o()({[null!=(t=m.A.disableLink)?t:""]:g}),href:A,rel:"noopener",target:"_blank",children:(0,n.Y)(p.EY.Meta,{color:"pub-primary-text",paddingBottom:8,children:C})}),(0,n.Y)("a",{className:o()({[null!=(i=m.A.disableLink)?i:""]:g}),href:A,rel:"noopener",target:"_blank",children:(0,n.Y)(p.EY.H2,{color:"pub-primary-text",children:k})}),(0,n.Y)(s.W,{bylines:w,date:E,disableLinks:g}),(0,n.FD)(u.pT,{direction:{mobile:"column",desktop:"row"},gap:16,paddingTop:16,children:[I&&(0,n.Y)(c.az,{style:{width:P?"unset":140},children:(0,n.Y)("a",{className:o()({[null!=(a=m.A.disableLink)?a:""]:g}),href:A,rel:"noopener",target:"_blank",children:(0,n.Y)(d.o,{alt:null!=T?T:k,className:P?m.A.fullWidth:m.A.mdSquare,imageProps:{height:Math.round(P?1300:280),smartCrop:!0},maxWidth:P?1300:280,src:I})})}),(0,n.FD)(u.I1,{flex:"grow",children:[v&&b&&_?(0,n.Y)(r.y,{initialCaption:y,onCancel:_,onSave:b}):(0,n.Y)("p",{className:m.A.caption,dangerouslySetInnerHTML:{__html:y},onClick:null!=Y?Y:void 0}),(0,n.Y)(l.w,{disableLinks:g,href:A,post:f})]})]})]})}},12988:function(e,t,i){i.d(t,{w:()=>h});var n=i(4006),a=i(32485),o=i.n(a),r=i(86938),l=i(74019),s=i(72880);i(6049);var d=i(89490),c=i(76977),u=i(63136),p=i(20004);let h=e=>{var t;let{post:i,disableLinks:a}=e,{publishedBylines:h,title:m,canonical_url:y,post_date:g,cover_image:f,cover_image_alt:v}=i;return(0,n.Y)("a",{className:o()({[null!=(t=p.A.disableLink)?t:""]:a}),href:y,rel:"noopener",target:"_blank",children:(0,n.FD)(c.Ye,{gap:16,children:[f&&(0,n.Y)(d.az,{style:{width:70,height:70},children:(0,n.Y)(s.o,{alt:null!=v?v:m,className:p.A.smSquare,imageProps:{height:Math.round(140),smartCrop:!0},maxWidth:140,src:f})}),(0,n.FD)(c.I1,{children:[(0,n.Y)(u.EY.H4,{color:"pub-primary-text",children:m}),(0,n.Y)(l.W,{bylines:h,date:g,disableLinks:a}),(0,n.Y)(r.w,{disableLinks:a,href:y,includeUfi:!1,post:i})]})]})})}},18999:function(e,t,i){i.d(t,{u:()=>k});var n=i(4006),a=i(32485),o=i.n(a),r=i(80964),l=i(87332),s=i(69308),d=i(92919),c=i(65892),u=i(17402),p=i(81704),h=i(13950),m=i(72880),y=i(15894);i(6049);var g=i(35369),f=i(76977),v=i(88774),Y=i(16993),b=i(63136),_=i(31933),w=i(96473);let k=e=>{let{title:t,postIds:i,showCount:a,posts:k,pub:A,isEditor:E,updateAttributes:C,align:I}=e,[T,P]=(0,u.useState)(k||[]),[D,S]=(0,u.useState)(!k&&!E),[N,R]=(0,u.useState)(!1),[x,F]=(0,u.useState)(t),[L,O]=(0,u.useState)(!1),[U,M]=(0,u.useState)(null),[B,H]=(0,u.useState)(0),[W,z]=(0,u.useState)(!1),[V,K]=(0,u.useState)(""),j=(0,u.useRef)(null),G=e=>{if(null===U)return;let t=[...T];U<t.length?t[U]=e:t.push(e),P(t),C&&C({posts:t,postIds:t.map(e=>e.id)}),O(!1),M(null),Q()},{searchQuery:q,searchResults:J,isSearching:X,handleSearch:$,clearSearch:Q,getLatestPostsByTag:Z,fetchAvailableTags:ee,availableTags:et}=(0,p.E)({pubId:A.id,onSelectPost:G});(0,u.useEffect)(()=>{let e=!1;return(async()=>{if(!k||(null==i?void 0:i.length)===0||E&&0===T.length&&!(null==i?void 0:i.length)){E||S(!0);try{let t=await (0,_.tZ)((null==i?void 0:i.length)>0?i:void 0);if(e)return;let n=t.slice(0,a);P(n),C&&C({posts:n,postIds:n.map(e=>e.id)})}catch(t){e||console.error("Error fetching posts:",t)}finally{e||S(!1)}}})(),()=>{e=!0}},[i,a,k,C,E,T.length]),(0,u.useEffect)(()=>{N&&j.current&&(j.current.focus(),j.current.select())},[N]);let ei=()=>{C&&C({title:x}),R(!1)},en=T.slice(0,a),ea=async(e,t)=>{let i=await Z(e);if(i.length>0){let e=i.slice(0,a);P(e),C&&C({title:t,posts:e,postIds:e.map(e=>e.id)}),F(t)}z(!1),K("")},eo=async()=>{await ee(),z(!0),K("")};return(0,n.FD)(n.FK,{children:[(0,n.Y)("div",{className:"the-free-press-theme",children:(0,n.Y)(h.DH,{children:(0,n.FD)("div",{className:o()(w.A.fpRecircBlock,E?w.A.editor:"","left"===I&&w.A.alignLeft,"right"===I&&w.A.alignRight),"data-component-name":"FpRecircBlock",children:[(0,n.FD)(f.pT,{justifyContent:"space-between",alignItems:"center",style:{marginBottom:24},className:w.A.header,children:[N&&E?(0,n.Y)("input",{ref:j,type:"text",value:x,onChange:e=>F(e.target.value),onBlur:ei,onKeyDown:e=>{"Enter"===e.key&&ei(),"Escape"===e.key&&(F(t),R(!1))},className:w.A.titleInput}):(0,n.Y)("div",{className:o()(w.A.sectionTitle,E?w.A.editable:""),onClick:E?()=>R(!0):void 0,children:(0,n.Y)(y.T,{preset:"body",children:(0,n.Y)("span",{style:{fontWeight:700},children:t})})}),E&&(0,n.FD)(v.W1,{trigger:(0,n.Y)(g.K0,{size:"sm",priority:"tertiary",className:w.A.settingsButton,children:(0,n.Y)(r.A,{})}),children:[(0,n.FD)(v.H9,{title:"Count",isFirst:!0,children:[(0,n.Y)(v.Dr,{onClick:()=>null==C?void 0:C({showCount:3}),priority:3===a?"accent":"secondary",children:"Show 3 stories"}),(0,n.Y)(v.Dr,{onClick:()=>null==C?void 0:C({showCount:4}),priority:4===a?"accent":"secondary",children:"Show 4 stories"})]}),(0,n.Y)(v.H9,{title:"Populate",children:(0,n.Y)(v.Dr,{onClick:()=>eo(),priority:"secondary",children:"Populate by tag"})}),(0,n.FD)(v.H9,{title:"Alignment",children:[(0,n.Y)(v.Dr,{onClick:()=>null==C?void 0:C({align:null}),priority:I?"secondary":"accent",leading:(0,n.Y)(l.A,{}),children:"Center"}),(0,n.Y)(v.Dr,{onClick:()=>null==C?void 0:C({align:"left"}),priority:"left"===I?"accent":"secondary",leading:(0,n.Y)(s.A,{}),children:"Float left"}),(0,n.Y)(v.Dr,{onClick:()=>null==C?void 0:C({align:"right"}),priority:"right"===I?"accent":"secondary",leading:(0,n.Y)(d.A,{}),children:"Float right"})]})]})]}),D&&!E?(0,n.Y)("div",{className:w.A.loading,children:"Loading posts..."}):(0,n.Y)(n.FK,{children:en.length>0&&(0,n.Y)(f.pT,{direction:"column",gap:16,children:en.map((e,t)=>(0,n.Y)("div",{className:w.A.postWrapper,children:(0,n.FD)("a",{href:E?"#":e.canonical_url,className:w.A.postCard,onClick:E?e=>e.preventDefault():void 0,children:[(0,n.FD)(f.pT,{gap:12,children:[(0,n.Y)("div",{className:w.A.imageWrapper,children:e.cover_image?(0,n.Y)(m.o,{className:w.A.postImage,imageIsFixedWidth:!0,maxWidth:300,src:e.cover_image,useRetinaSizing:!0}):(0,n.Y)("div",{className:w.A.imagePlaceholder})}),(0,n.FD)(f.pT,{direction:"column",justifyContent:"center",gap:8,className:w.A.postContent,children:[(0,n.Y)(y.T,{preset:"lg-preview-byline",className:w.A.postTitle,children:e.title}),e.author_names&&e.author_names.length>0&&(0,n.Y)(y.T,{preset:"detail-small",color:"accent",className:w.A.postAuthor,children:e.author_names.join(", ")})]})]}),E&&(0,n.Y)("div",{className:w.A.editButtonContainer,children:(0,n.Y)(g.K0,{priority:"primary-mono",size:"sm",onClick:e=>{e.preventDefault(),e.stopPropagation(),M(t),O(!0),H(0),Q()},children:(0,n.Y)(c.A,{size:16})})})]})},"post-".concat(e.id)))})})]})})}),(0,n.Y)(Y.aF,{isOpen:L,onClose:()=>{O(!1),M(null),Q()},className:w.A.modalContainer,children:(0,n.Y)("div",{className:"the-free-press-theme",children:(0,n.Y)(h.DH,{children:(0,n.FD)("div",{className:w.A.searchModal,children:[(0,n.Y)("div",{className:w.A.searchModalTitle,children:"Search Posts"}),(0,n.Y)("input",{type:"text",placeholder:"Search posts...",value:q,onChange:e=>{$(e.target.value),H(0)},onKeyDown:e=>{"ArrowDown"===e.key?(e.preventDefault(),H(e=>Math.min(e+1,J.length-1))):"ArrowUp"===e.key?(e.preventDefault(),H(e=>Math.max(e-1,0))):"Enter"===e.key&&J.length>0&&J[B]&&(e.preventDefault(),G(J[B]))},className:w.A.searchModalInput,autoFocus:!0}),(0,n.FD)("div",{className:w.A.searchModalResults,children:[X&&(0,n.Y)("div",{className:w.A.loading,children:(0,n.Y)(b.EY,{color:"secondary",children:"Searching..."})}),!X&&J.map((e,t)=>(0,n.Y)("div",{className:o()(w.A.postWrapper,t===B&&w.A.selected),onClick:()=>G(e),role:"option","aria-selected":t===B,children:(0,n.Y)("a",{href:"#",className:w.A.postCard,onClick:e=>e.preventDefault(),children:(0,n.FD)(f.pT,{gap:12,children:[(0,n.Y)("div",{className:w.A.imageWrapper,children:e.cover_image?(0,n.Y)(m.o,{className:w.A.postImage,imageIsFixedWidth:!0,maxWidth:300,src:e.cover_image,useRetinaSizing:!0}):(0,n.Y)("div",{className:w.A.imagePlaceholder})}),(0,n.FD)(f.pT,{direction:"column",justifyContent:"center",gap:8,className:w.A.postContent,children:[(0,n.Y)(y.T,{preset:"lg-preview-byline",className:w.A.postTitle,children:e.title}),e.author_names&&e.author_names.length>0&&(0,n.Y)(y.T,{preset:"detail-small",color:"accent",className:w.A.postAuthor,children:e.author_names.join(", ")})]})]})})},e.id)),!X&&q&&0===J.length&&(0,n.Y)("div",{className:w.A.noResults,children:(0,n.Y)(b.EY,{color:"secondary",children:"No posts found"})})]})]})})})}),(0,n.Y)(Y.aF,{isOpen:W,onClose:()=>{z(!1),K("")},className:w.A.modalContainer,children:(0,n.Y)("div",{className:"the-free-press-theme",children:(0,n.Y)(h.DH,{children:(0,n.FD)("div",{className:w.A.searchModal,children:[(0,n.Y)("div",{className:w.A.searchModalTitle,children:"Select Tag"}),(0,n.Y)("input",{type:"text",placeholder:"Search tags...",value:V,onChange:e=>K(e.target.value),className:w.A.searchModalInput,autoFocus:!0}),(0,n.FD)("div",{className:w.A.searchModalResults,style:{maxHeight:"400px",overflowY:"auto"},children:[0===et.length?(0,n.Y)("div",{className:w.A.loading,children:(0,n.Y)(b.EY,{color:"secondary",children:"No tags available"})}):et.filter(e=>e.name.toLowerCase().includes(V.toLowerCase())||e.slug.toLowerCase().includes(V.toLowerCase())).map(e=>(0,n.Y)("div",{className:w.A.postWrapper,onClick:()=>ea(e.id,e.name),role:"option",style:{cursor:"pointer",padding:"12px"},children:(0,n.Y)(b.EY,{children:e.name})},e.id)),0===et.filter(e=>e.name.toLowerCase().includes(V.toLowerCase())||e.slug.toLowerCase().includes(V.toLowerCase())).length&&V&&(0,n.Y)("div",{className:w.A.noResults,children:(0,n.Y)(b.EY,{color:"secondary",children:"No matching tags found"})})]})]})})})})]})}},64998:function(e,t,i){i.d(t,{Uf:()=>S,sP:()=>N});var n=i(79785),a=i(4006),o=i(32485),r=i.n(o),l=i(82853),s=i(98188),d=i(17402),c=i(18203),u=i(48329),p=i(39232),h=i(15469),m=i(39469),y=i(31245),g=i(60294),f=i(49386),v=i(66710),Y=i(17744),b=i(84605),_=i(25006),w=i(46271);i(6049);var k=i(68349),A=i(76977),E=i(63136),C=i(36372),I=i(16291),T=i(4016),P=i(39318);function D(){let e=(0,n._)(["Option ",""]);return D=function(){return e},e}let S=(e,t)=>{let{iTemplate:i}=I18N.i(t);return i(D(),e+1)},N=e=>{var t,i;let{id:n,isEditor:o,post:D,isVersionView:N}=e,{iString:R,language:x}=(0,b.GO)(),F=(0,_.df)(),L=(0,C.d)(),O=(0,Y.m)(),U=(0,T.lu)({pub:F}),M=(0,w.Jd)()||{},[B,H]=(0,d.useState)(!1),[W,z]=(0,d.useState)(!1),[V,K]=(0,d.useState)(!1),j=(0,d.useCallback)(()=>{H(!1)},[]),{error:G,loading:q,poll:J,savePoll:X,voteForOption:$}=(0,y.j)({isEditor:o,isVersionView:!!N,pollId:n,post:D,onFinishSaving:j}),Q=!!(null==J?void 0:J.is_published),Z=J&&J.published_at&&(0,I.A)(J.published_at).add(J.expiry,"hour"),ee=(0,I.A)(),et=!!Q&&!!Z&&Z.isBefore(ee),ei=Z?Z.diff(ee,"hour"):0,en=o&&((null==J?void 0:J.post_type)!=="adhoc_email"||!Q),ea=!!J&&J.options.some(e=>e.my_vote),eo=(null==J?void 0:J.audience)==="only_paid"?!!M.is_subscribed:!!(M.is_free_subscribed||O),er=!ea&&Q&&!et&&eo&&(!o||(null==J?void 0:J.post_type)==="adhoc_email"),el=o?null:"".concat((0,P.wu9)(F,D),"#poll-").concat(n),es=en?Array(Math.max(2,(null==J||null==(t=J.options)?void 0:t.length)||0)).fill("").map((e,t)=>{var i,n,a;return J&&(null==(i=J.options)?void 0:i.length)>t?null!=(a=null==(n=J.options[t])?void 0:n.label)?a:"":S(t,x)}):null==J||null==(i=J.options)?void 0:i.map(e=>e.label),ed=(0,d.useCallback)(async e=>{if(!o&&!et&&Q){if(!eo)return void K(!0);await $(e)}},[eo,o,et,Q,$]);return null===G||J?(0,a.FD)(A.I1,{className:r()("poll-wrapper poll-web",{"poll-wrapper--thefp":U}),"data-component-name":"Poll",gap:24,children:[el&&(0,a.Y)("div",{className:"poll-anchor-target",id:"poll-".concat(n),children:(0,a.Y)("div",{className:"poll-anchor-copy-button",onClick:e=>{var t;(null==(t=location)?void 0:t.href)&&(e.preventDefault(),(0,k.lW)(el),L.popToast(()=>(0,a.Y)(C.y,{Icon:l.A,text:R("Copied link to clipboard")})))},children:(0,a.Y)("a",{href:el,children:(0,a.Y)(l.A,{size:20})})})}),en&&J&&(0,a.Y)(c.z,{isOpen:B,isPublished:Q,poll:J,shouldShowAudiencePicker:"adhoc_email"!==J.post_type,onClose:()=>{H(!1)},onSave:X}),!o&&J&&F&&(0,a.Y)(p.u,{audience:J.audience,isOpen:V,pollId:J.id,post:D,pub:F,user:M,onClose:()=>K(!1)}),q?(0,a.Y)(A.I1,{alignItems:"center",gap:8,justifyContent:"center",paddingY:48,children:(0,a.Y)(E.EY.Meta,{translated:!0,children:"Loading..."})}):(0,a.FD)(a.FK,{children:[en&&(0,a.Y)("button",{className:"poll-edit",disabled:q,onClick:()=>{H(!0)},children:(0,a.Y)(s.A,{height:20})}),U?(0,a.Y)(g.D,{poll:J}):(0,a.Y)(u.f,{poll:J}),null!==G&&(0,a.Y)("div",{className:"poll-error",children:G}),(0,a.Y)(A.I1,{className:r()("poll-options",{"no-margins":!Q}),gap:U?16:12,children:es&&es.map((e,t)=>{var i,n,o,r,l,s;return U?(0,a.Y)(v.H,{currentVotes:(null==J||null==(i=J.options[t])?void 0:i.votes)||0,hasVoted:ea,id:(null==J||null==(n=J.options[t])?void 0:n.id)||null,index:t,myVote:(null==J||null==(o=J.options[t])?void 0:o.my_vote)||!1,showVotes:ea||et||!!(M.is_contributor||M.is_admin||M.is_author)&&W,text:e,totalVotes:(null==J?void 0:J.total_votes)||0,onVote:ed}):(0,a.Y)(m.h,{canVote:er,currentVotes:(null==J||null==(r=J.options[t])?void 0:r.votes)||0,id:(null==J||null==(l=J.options[t])?void 0:l.id)||null,myVote:(null==J||null==(s=J.options[t])?void 0:s.my_vote)||!1,showVotes:ea||et||!!(M.is_contributor||M.is_admin||M.is_author)&&W,text:e,totalVotes:(null==J?void 0:J.total_votes)||0,onVote:ed})})}),Q&&J&&(U?(0,a.Y)(f.h,{hasVoted:ea,poll:J,user:M}):(0,a.Y)(h.r,{hasVoted:ea,isExpired:et,poll:J,remainingHours:ei,showResults:W,user:M,onToggleShowResults:()=>{z(!W)}}))]})]}):(0,a.Y)("div",{className:"poll-wrapper poll-web",children:(0,a.Y)("div",{className:"poll-error",children:G})})}},4013:function(e,t,i){i(4006),i(97731)},85688:function(e,t,i){i(4006),i(97731)},10956:function(e,t,i){i(4006),i(97731)},68924:function(e,t,i){i(4006),i(97731)},46137:function(e,t,i){i(4006),i(97731)},4067:function(e,t,i){i(4006),i(97731)},20297:function(e,t,i){i(4006),i(97731)},89839:function(e,t,i){i(4006),i(97731)},14394:function(e,t,i){i(4006),i(97731)},78330:function(e,t,i){i(4006),i(97731)},15074:function(e,t,i){i(4006),i(97731)},26184:function(e,t,i){i(4006),i(97731)},71900:function(e,t,i){i(4006),i(97731)},9599:function(e,t,i){i(4006),i(97731)},2538:function(e,t,i){i(4006),i(97731)},97683:function(e,t,i){i(4006),i(17402),i(15734),i(37767),i(41935),i(68349),i(35369),i(76977),i(67211),i(84270),i(16993),i(36372),i(84605),i(86500),i(94729),i(13022),i(28528),i(88774),i(52145),i(16291),i(4016),i(39318),i(49807),i(82776)},55136:function(e,t,i){i.d(t,{Qw:()=>I});var n=i(99851),a=i(69277),o=i(4006),r=i(32485),l=i.n(r),s=i(36119),d=i.n(s),c=i(17402),u=i(15734),p=i.n(u),h=i(97432),m=i(43427),y=i(84605),g=i(70145),f=i(34835),v=i(86500),Y=i(68349),b=i(76977),_=i(16993),w=i(81203),k=i(63136),A=i(98111),E=i(39318),C=i(82776);let I=(e,t)=>T(e,t,!t.reaction),T=(e,t,i)=>{let n="reaction"in t?t.reaction:void 0,{reactions:o={"❤":0},reactor_names:r=[]}=t;if(o=(0,a._)({},o),r=[...r],i&&!n){let t=o[n="❤"];o[n]=t?t+1:1,e&&e.is_public_admin&&r.push(e.name||"author")}else!i&&n&&(o["❤"]=o["❤"]?o["❤"]-1:0,e&&e.is_public_admin&&(r=r.filter(t=>t!==(e.name||"author"))),n=null);return{reaction:n,reactions:o,reactor_names:r}};class P extends c.Component{notifyParent(e){var t;let{reaction:i,reactions:n,reactor_names:o}=e,r=(0,a._)({},this.props.post),l=this.props.comment&&(0,a._)({},this.props.comment);(t=l||r).reaction=i,t.reactions=n,t.reactor_names=o,this.props.onChange&&this.props.onChange({post:r,comment:l})}reactionRejected(e){(0,v.u4)(v.qY.REACTION_REJECTED,{comment_id:this.props.comment&&this.props.comment.id,post_id:this.props.post&&this.props.post.id,reason:"Not logged in",unreact:!e}),this.setState({includeModal:!0,modalOpen:!0})}render(){let e,{className:t,user:i,pub:n,comment:a,height:r,isStatic:s,post:c,buttonStyle:u,hideReactionCount:p,countInParenthesesStyle:h,iString:y}=this.props,g=a||c,f=null==g?void 0:g.reaction,v=(null==g?void 0:g.reactions)||{},Y=d()(Object.values(v));return e=c&&c.reaction_url_override?c.reaction_url_override:s?A.T.REACTION_URL:"javascript:void(0)",(0,o.FD)(k.EY,{as:"span",decoration:"hover-underline",color:f?"error":"pub-secondary-text",className:t,children:[this.props.render?this.props.render({liked:f,numReactions:Y>0?(0,C.numberToString)(Y):null,onClick:e=>{this.react(e)}}):(0,o.Y)("a",{href:e,className:l()("like-button",{button:u,"post-meta-button":u,liked:f}),onClick:e=>this.react(e),children:(0,o.FD)(b.pT,{gap:6,alignItems:"center",className:t,children:[s?(0,o.Y)(m.A,{ampProps:{layout:"fixed"},isStatic:!0,height:r,stroke:"var(--color-fg-secondary-themed)",fill:"transparent"}):(0,o.FD)(b.pT,{className:"reaction-container",children:[(0,o.Y)(m.A,{className:"animation"}),!f&&(0,o.Y)(m.A,{strokeWidth:2,height:r,fill:"transparent",stroke:"var(--color-fg-secondary-themed)"}),f&&(0,o.Y)(m.A,{height:r,strokeWidth:2})]}),h?(0,o.FD)(k.EY.Meta,{color:f?"error":"pub-secondary-text",className:"like-count",children:[y(f?"Liked":"Like"),!p&&Y>0?" (".concat((0,C.numberToString)(Y),")"):""]}):!p&&Y>0?(0,o.Y)("span",{className:"like-count",children:(0,C.numberToString)(Y)}):u?(0,o.Y)("span",{className:"like-count",children:y("Like")}):null]})}),!s&&this.state.includeModal&&(0,o.Y)(D,{isOpen:this.state.modalOpen,user:i,pub:n,comment:a,react:this.react,onClose:()=>this.setState({modalOpen:!1})})]})}constructor(...e){super(...e),(0,n._)(this,"state",{includeModal:!1,modalOpen:!1}),(0,n._)(this,"react",async e=>{if(this.props.commentActionsOverride){null==e||e.preventDefault(),null==e||e.stopPropagation(),this.props.commentActionsOverride();return}if(this.props.isStatic)return;e&&(e.preventDefault(),e.stopPropagation());let t=this.props.comment||this.props.post;if(!t)return void console.warn("LikeButton: no subject");let i=!t.reaction;if(this.props.onReactedChange&&this.props.onReactedChange(i),this.props.noSelfUpdate)return;let n=await (0,Y.vL)(this,"locked",async(e,t)=>{var n,a;let o,r,l=t.comment||t.post;if(!l)return void console.warn("LikeButton: no subject");let s=(n=!!t.comment,a=t.token,r=(0,E.yRP)("/api/v1/".concat(n?"comment":"post","/").concat(l.id,"/reaction"),{token:a}),i?p().post(r).send({reaction:"❤"}):p().delete(r));t.oauthAccessToken&&s.set("Authorization","Bearer ".concat(t.oauthAccessToken));let{reaction:d,reactions:c,reactor_names:u}=I(t.user,l);this.notifyParent({reactions:c,reaction:d,reactor_names:u});try{await s}catch(e){o=e,this.notifyParent(l)}return{error:o,reaction:d}});return n&&n.error&&(n.error.response&&401===n.error.response.statusCode?await this.reactionRejected(n.reaction):alert((0,Y.uX)(n.error))),!!n&&!n.error})}}function D(e){let{comment:t,pub:i,user:n,isOpen:a,onClose:r,react:l}=e,{iString:s}=(0,y.GO)();return(0,o.FD)(_.aF,{isOpen:a,onClose:r,children:[(0,o.Y)(_.rQ,{title:s(t?"Subscribe to like this comment":"Subscribe to like this post"),alignItems:"center",showClose:!0,onClose:r,icon:(0,o.Y)(w.Nq,{pub:i,size:48})}),(0,o.Y)(_.cw,{children:(0,o.Y)(h.A,{user:n,pub:i,showLogin:!0,showTerms:!0,source:"like_button",onSuccess:async e=>{let t=e&&e.body&&e.body.email;e&&e.body&&e.body.prompt_to_login||!await l()?window.location.href=(0,E.a7q)({for_pub:i.subdomain,email:t}):((0,f.E)({freeSignup:!0,freeSignupEmail:t}),r())}})})]})}(0,y.wr)((0,g.ct)(P))},21471:function(e,t,i){i.d(t,{P:()=>m});var n=i(4006),a=i(17402),o=i(15734),r=i.n(o),l=i(18468),s=i(84605);i(6049);var d=i(76977),c=i(81203),u=i(63136),p=i(47851),h=i(39318);i(86972);let m=e=>{let{tierNumber:t,rewardDescription:i,numReferralsRequired:o,pub:m}=e,[y,g]=(0,a.useState)([]),f=async()=>{let{body:e}=await r().get("/api/v1/reader_referrals/tiers");g(e.tiers)},{iString:v}=(0,s.GO)();if((0,a.useEffect)(()=>{f()},[]),!t||!m.id)return(0,n.Y)("div",{"data-component-name":"ReferralsTierCardError"});let Y=y[t-1],b=Y?"custom"===Y.reward_type?Y.reward_description:v(p.mn[Y.reward_type]):i,_=Y?Y.num_referrals_required:o;return _?(0,n.FD)(d.I1,{"data-component-name":"ReferralsTierCard",className:"milestone-tier-card",justifyContent:"start",border:"detail-themed",radius:"md",padding:20,gap:16,children:[(0,n.Y)("div",{className:"tier-stars-container",children:Array(t).fill(0).map((e,t)=>(0,n.Y)(l.A,{width:20,height:20,strokeWidth:2,stroke:m.theme_var_background_pop||"#FF6719",fill:m.theme_var_background_pop||"#FF6719"},t))}),(0,n.FD)(d.I1,{gap:4,children:[(0,n.Y)(u.EY.H4,{children:b}),(0,n.FD)(u.EY.Meta,{translated:!0,children:["Tier ",I18N.p(t)," reward - ",I18N.p(_)," Referrals"]})]}),(0,n.FD)(d.Ye,{alignItems:"center",children:[(0,n.Y)(c.Nq,{pub:m,size:24}),(0,n.Y)(u.EY.Meta,{color:"primary",as:"a",href:(0,h.$_T)(m),decoration:"none",weight:"bold",children:m.name})]})]}):(0,n.Y)("div",{"data-component-name":"ReferralsTierCardError"})}},50883:function(e,t,i){i(4006),i(17402),i(15734),i(84605),i(86500),i(68349),i(35369),i(8149),i(48535),i(76977),i(67211),i(20500),i(76171),i(16993),i(81203),i(94996),i(63136),i(11587),i(65842),i(36372),i(16291),i(56262),i(39318)},9979:function(e,t,i){i.d(t,{Bg:()=>w,Et:()=>C,HT:()=>I,NH:()=>Y,PB:()=>A,QY:()=>k,Uy:()=>b,ZE:()=>P,_m:()=>E,aE:()=>T,sx:()=>_,x5:()=>D});var n=i(69277),a=i(70408),o=i(32641),r=i(4006),l=i(17402),s=i(84605),d=i(86500),c=i(48531),u=i(17186),p=i(68349),h=i(36372),m=i(39318),y=i(70189),g=i(82776),f=i(57324);function v(e,t,i,o){let{shareUrl:r,post:l,pub:s,selectionId:c,utm_campaign:p,utm_medium:h,event:m=d.qY.SHARE_LINK_CLICKED,trackParams:y={}}=i,{openInNewTab:g=!1}=null!=o?o:{};(0,d.u4)(m,(0,n._)((0,a._)((0,n._)({name:e,post_id:l?l.id:null},c?{selection_id:c}:{}),{source:p,utm_medium:h}),y));let f=t(r);f&&"string"==typeof f&&(g||f.startsWith("http")?window.open(f,"_blank"):document.location.href=f),(0,u.X3)("".concat(null==s?void 0:s.subdomain," shared"),!0)}function Y(e){let{pub:t,post:i,sharingSelfPub:n,shareName:a}=e,o=(null==t?void 0:t.twitter_screen_name)||t&&g.twitterScreenNames[t.subdomain],r=a;t&&n?r="I just started a Substack! You can subscribe to it here":(t&&!i&&(r="Subscribe to ".concat(r)),o&&(!i||t&&(!i.publishedBylines.length||i.publishedBylines.some(e=>e.id===t.author_id)))&&(r+=", by @".concat(o))),v("twitter",e=>(0,m.gKg)({url:e,text:r}),e)}function b(e){v("linkedin",e=>(0,m.yRP)("https://www.linkedin.com/sharing/share-offsite/",{url:e}),e)}function _(e){v("reddit",t=>(0,m.yRP)("https://www.reddit.com/submit/",{url:t,title:e.shareName}),e)}function w(e){v("hackernews",t=>(0,m.yRP)("https://news.ycombinator.com/submitlink",{url:t,title:e.shareName}),e)}function k(e){v("pinterest",t=>(0,m.yRP)("https://www.pinterest.com/pin/create/button",{u:t,description:e.shareName}),e)}function A(e){v("bluesky",t=>(0,m.man)({text:"".concat(e.shareName,"\n").concat(t)}),e)}function E(e){let t=(0,h.d)(),{iString:i}=(0,s.GO)(),{justCopied:n,markCopied:a}=(0,c.N)(),o=null!=e?e:i("Copied link to clipboard");return{handleCopyLink:(0,l.useCallback)(e=>{v("copy",e=>((0,p.lW)(e),!1),e),t.popToast(()=>(0,r.Y)(h.y,{text:o})),a()},[o,t,a]),justCopied:n}}function C(e){v("email",t=>(0,m.yRP)("mailto:",{subject:e.shareName,body:t}),e)}function I(e){var{openInNewTab:t}=e;v("notes",e=>(0,m.yRP)((0,y.XX)({message:e})),(0,o._)(e,["openInNewTab"]),{openInNewTab:t})}function T(e){v("facebook",e=>(0,m.yRP)("https://www.facebook.com/sharer/sharer.php",{u:e}),e)}function P(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{post:t,pub:i,profile:n}=e;return t?t.title:i?i.name:n?"".concat(n.name," on Substack"):document.title}function D(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{pub:i,post:a,clip:o,comments:r,commentId:l,selectionId:s,profile:d,user:c,utm_campaign:u,medium:p,referral_token:h,useCustomDomainOverOpen:y,params:v}=t,Y=(0,n._)({r:(null==c?void 0:c.id)?(0,g.userReferralKey)(c):h,selection:s,utm_campaign:u||(a?"post":d?"profile":i?"pub":o?"clip":"unknown"),utm_medium:p||f.Jn.web,utm_source:e},{comments:null!=r&&!!r.length||void 0,commentId:l},o?{clipId:o.id}:{},v);return(null==i?void 0:i.subdomain)&&(null==a?void 0:a.slug)&&!o?(0,m.XV8)(i.subdomain,a.slug,{params:Y,hostOverride:y&&i.custom_domain?(0,m.$_T)(i):null}):(0,m.yRP)("".concat(a?(0,m.wu9)(i,a,{comments:!!(null==r?void 0:r.length),commentId:l,clipId:null==o?void 0:o.id}):i?"".concat(i.base_url,"/"):"undefined"!=typeof window?window.location.href.split("?")[0]:""),Y)}},54515:function(e,t,i){i.d(t,{eF:()=>v});var n=i(4006),a=i(32485),o=i.n(a),r=i(97213),l=i(56778),s=i(44909),d=i(46271);i(6049);var c=i(63136),u=i(66511);i(4016);var p=i(82455),h=i(39318),m=i(49807),y=i(86508),g=i(8242);let f=async(e,t)=>{try{await fetch("/api/v1/sponsorship-campaigns/".concat(e,"/track-post-view"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({postId:t})})}catch(e){console.error("Failed to track sponsorship campaign post view:",e)}},v=e=>{var t;let{campaign:i,pub:a,isEditor:r,dataAttrs:l,post:s}=e;return(0,n.Y)("div",{className:o()("sponsorship-campaign-embed",{"sponsorship-campaign-embed-structured":"structured"===i.campaign_type,[null!=(t=g.A.editorBorder)?t:""]:r}),dataAttrs:l,children:"structured"===i.campaign_type?(0,n.Y)(Y,{campaign:i,pub:a,isEditor:r,post:s}):(0,n.Y)(b,{campaign:i,pub:a,isEditor:r,post:s})})},Y=e=>{var t,i,a;let{campaign:o,pub:p,isEditor:y,post:v}=e,Y=(0,d.Jd)(),{scrollContainerRef:b}=(0,s.o)(),_=(0,n.FD)("a",{className:"sponsorshipCampaignContainer",href:y?"#":(0,h.qCG)({campaignId:o.id,medium:"web",pubId:null!=(t=null==p?void 0:p.id)?t:0,userId:null==Y?void 0:Y.id,postId:null==v?void 0:v.id,referrer:"undefined"!=typeof window?window.location.href:void 0}),children:[o.short_text&&(0,n.Y)("span",{className:"sponsorshipCampaignPresentedBy",children:o.short_text}),o.image_url&&(0,n.Y)("div",{className:"sponsorshipCampaignImageContainer",children:(0,n.Y)("img",{alt:null!=(i=o.image_alt_text)?i:"",className:"sponsorshipCampaignImage",src:(0,m.dJ9)(o.image_url,300)})})]});return y?(0,n.FD)("div",{className:g.A.editorWrapper,children:[(0,n.Y)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:(0,n.FD)(c.EY.Digit,{as:"div",color:"secondary",className:g.A.editorHelperText,children:["paid"===o.exclude_audience_minimum?"Sponsorship Campaign (Free Only)":"Sponsorship Campaign",o.description&&(0,n.Y)(u.m_,{text:o.description,children:(0,n.Y)(r.A,{size:14})}),p&&(0,n.FD)(n.FK,{children:[" - ",(0,n.Y)("a",{href:(0,h.sTG)({campaignId:o.id,pub:p}),children:"Edit"})]})]})}),_]}):(0,n.Y)(l.A,{parent:null!=(a=null==b?void 0:b.current)?a:void 0,onFirstVisible:()=>f(o.id,null==v?void 0:v.id),children:_})},b=e=>{var t;let{campaign:i,pub:a,isEditor:o,post:m}=e,v=(0,d.Jd)(),{scrollContainerRef:Y}=(0,s.o)();if(!a)return null;let b=y.toHtml(i.doc_content,!1,{pubId:a.id}),_=o?b:(e=>{let{html:t,campaign:i,pub:n,userId:a,medium:o,postId:r}=e;return t.replace(/href="([^"]*)"/g,(e,t)=>{var l;let s=(0,h.qCG)({campaignId:i.id,medium:o,pubId:null!=(l=null==n?void 0:n.id)?l:0,userId:a,url:t,postId:r,referrer:"undefined"!=typeof window?window.location.href:void 0});return'href="'.concat(s,'"')})})({html:(0,p.W)(b,{pub:a,user:v}),campaign:i,pub:a,userId:String(null==v?void 0:v.id),medium:"web",postId:null==m?void 0:m.id}),w=(0,n.Y)("div",{className:"sponsorshipCampaignDocContentWrapper",dangerouslySetInnerHTML:{__html:_}});return o?(0,n.FD)("div",{className:g.A.editorWrapper,children:[(0,n.Y)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:(0,n.FD)(c.EY.Digit,{color:"secondary",className:g.A.editorHelperText,children:["paid"===i.exclude_audience_minimum?"Sponsorship Campaign (Free Only)":"Sponsorship Campaign",i.description&&(0,n.Y)(u.m_,{text:i.description,children:(0,n.Y)(r.A,{size:14})}),a&&(0,n.FD)(n.FK,{children:[" - ",(0,n.Y)("a",{href:(0,h.sTG)({campaignId:i.id,pub:a}),children:"Edit"})]})]})}),w]}):(0,n.Y)(l.A,{parent:null!=(t=null==Y?void 0:Y.current)?t:void 0,onFirstVisible:()=>f(i.id,null==m?void 0:m.id),children:w})}},41873:function(e,t,i){i.d(t,{A:()=>C});var n=i(99851),a=i(69277),o=i(70408),r=i(4006),l=i(32485),s=i.n(l),d=i(17402),c=i(68414),u=i(59307),p=i(13505),h=i(86500),m=i(13022),y=i(17186),g=i(68349),f=i(89490),v=i(35369),Y=i(13348),b=i(91392),_=i(39318),w=i(9036),k=i(82776),A=i(18012);let E={hls:"application/x-mpegURL",mp4:"video/mp4"};class C extends d.Component{componentDidMount(){if(this._initHlsjs(),null===g.dO||void 0===g.dO||g.dO.on("play",this.onGlobalPlay),"undefined"!=typeof window&&(document.addEventListener("keydown",this.onGlobalKeyDown,!1),window.addEventListener("beforeunload",this.onBeforeUnload,!1)),this.player&&(this.player.volume=1,this.player.addEventListener("loadedmetadata",this.onLoadedMetadata),this.player.addEventListener("loadeddata",this.onLoadedData),this.player.addEventListener("canplay",this.onCanPlay),this.player.addEventListener("play",this.onPlay),this.player.addEventListener("pause",this.onPause),this.player.addEventListener("ended",this.onEnded),this.player.addEventListener("timeupdate",this.onTimeUpdate),this.player.addEventListener("waiting",this.onWaiting),this.player.addEventListener("playing",this.onPlaying),this.player.addEventListener("contextmenu",this.onContextMenu),this.player.addEventListener("click",this.onUserInteraction),this.player.addEventListener("mouseover",this.onUserInteraction),this.player.addEventListener("mousedown",this.onUserInteraction),this.player.addEventListener("touchstart",this.onUserInteraction),this.player.addEventListener("seeked",this.onSeeked)),this.onTimeUpdate(),window&&window._preloads.mux_env_key&&!(window._preloads.disabledCookies||[]).includes(b.HY.MUX_DATA)){let{entityType:e}=this.getEntityKeyAndType();i.e("25505").then(i.t.bind(i,21624,23)).then(t=>{var i;let n=t.default||t;n.monitor(this.player,{Hls:this.hlsModule,hlsjs:this.hls,debug:!1,data:{env_key:window._preloads.mux_env_key,player_name:null!=(i=this.props.surface)?i:"substack",player_init_time:n.utils.now(),video_id:this.props.mediaUpload.id,video_stream_type:e}})})}}componentWillUnmount(){this.setPlaybackRestoreLocation(),this.lastTimeUpdate=null,null===g.dO||void 0===g.dO||g.dO.off("play",this.onGlobalPlay),"undefined"!=typeof window&&(document.removeEventListener("keydown",this.onGlobalKeyDown,!1),window.removeEventListener("beforeunload",this.onBeforeUnload,!1)),this.player&&(this.player.removeEventListener("loadedmetadata",this.onLoadedMetadata),this.player.removeEventListener("loadeddata",this.onLoadedData),this.player.removeEventListener("canplay",this.onCanPlay),this.player.removeEventListener("play",this.onPlay),this.player.removeEventListener("pause",this.onPause),this.player.removeEventListener("ended",this.onEnded),this.player.removeEventListener("timeupdate",this.onTimeUpdate),this.player.removeEventListener("waiting",this.onWaiting),this.player.removeEventListener("playing",this.onPlaying),this.player.removeEventListener("contextmenu",this.onContextMenu),this.player.removeEventListener("click",this.onUserInteraction),this.player.removeEventListener("mouseover",this.onUserInteraction),this.player.removeEventListener("mousedown",this.onUserInteraction),this.player.removeEventListener("touchstart",this.onUserInteraction)),this.onVideoReachEnd({resetTime:!1,triggerCallback:!1,track:!1}),null!=this.hls&&this.hls.destroy()}componentDidUpdate(e,t){var i,n,o;if((this.props.noPreview!==e.noPreview||this.props.noControls!==e.noControls||this.props.noKeyboardShortcuts!==e.noKeyboardShortcuts||this.props.mediaUpload.id!==e.mediaUpload.id)&&(this._initHlsjs(),this.resetDurationTracking()),!this.state.playing&&"number"==typeof this.state.waiting&&"number"!=typeof t.waiting){let{useHLSJS:e,browserCanPlayHLS:t,HLSerrored:i}=this.state;this.track(h.qY.VIDEO_BUFFERING_STARTED,{use_hlsjs:e,browser_can_play_hls:t,hls_errored:i})}if(!this.state.playing||t.playing||this.state.waiting||"number"!=typeof t.waiting||this.track(h.qY.VIDEO_BUFFERING_COMPLETED,{buffering_duration:Date.now()-t.waiting}),this.state.playing&&!(null==(i=this.player)?void 0:i.ended)&&Math.floor(this.state.currentTime)!==Math.floor(t.currentTime)&&Math.floor(this.state.currentTime)%5==0&&(this.trackMedia(h.qY.MEDIA_PLAYBACK_CONTINUED),this.props.mediaUpload.post_id&&this.state.duration&&(!this.props.surface||"post"===this.props.surface)&&(!this.props.videoType||"post"===this.props.videoType)&&!this.props.isClip)){let e=Math.min(Math.max(0,this.state.currentTime/this.state.duration),1);(0,p.AG)(this.props.mediaUpload.post_id,"video",e)}if(!this.state.playing&&t.playing&&(null==(n=this.player)?void 0:n.ended)&&this.trackMedia(h.qY.MEDIA_PLAYBACK_COMPLETED),this.props.mediaUpload.id&&(0,m.Ay)("use_preloaded_player_sources")&&(this.props.mediaUpload.id!==e.mediaUpload.id||!(null==(o=Object.keys(this.state.sources))?void 0:o.length))){let e=async e=>fetch((0,_.oRR)("/api/v1/video/upload/".concat(this.props.mediaUpload.id,"/src.json"),{type:e})).then(e=>e.json()).then(t=>({[e]:t.src}));Promise.all(["hls"].map(t=>e(t))).then(e=>{let t=e.reduce((e,t)=>(0,a._)({},e,t),{});this.setState({sources:t})})}}getPlaybackLocationKey(){return"".concat("video:playback_location:").concat(this.props.mediaUpload.id)}shouldShowNativeVideoControls(){let{noControls:e,noPreview:t}=this.props,{previewHidden:i,showControls:n}=this.state;return n&&!e&&!(!t&&!i)}getPlaybackRestoreLocation(){if(this.playbackEnabled()&&this.props.restorePlaybackLocation&&this.props.mediaUpload.duration&&this.props.mediaUpload.duration>240){let e=(0,y.xm)(this.getPlaybackLocationKey());if((null==e?void 0:e.currentTime)>5&&null!==this.props.duration&&void 0!==this.props.duration&&this.props.duration-e.currentTime>60){let t=3*(Date.now()-e.watchedAt>60),i=Math.max(0,e.currentTime-t);if(i)return i}}return null}setPlaybackRestoreLocation(){var e;this.playbackEnabled()&&(null==(e=this.player)?void 0:e.currentTime)&&(0,y.X3)(this.getPlaybackLocationKey(),{currentTime:this.player.currentTime,watchedAt:Date.now()})}onPreviewClick(e){var t,i,n,a,o;let r=!(0,g.nr)()||!this.shouldShowNativeVideoControls();if((this.props.stopPropagation||r)&&(e.preventDefault(),e.stopPropagation()),null==(t=this.player)||t.setAttribute("data-user-changed-playback","true"),this.state.previewHidden){r&&((null==(i=this.player)?void 0:i.paused)?this.player.play():null==(n=this.player)||n.pause());return}if(!this.href()){if(!this.playbackEnabled())return void this.onClickNonPlayableVideo();this.state.attemptingToPlay?(this.lastTimeUpdate=null,this.setState({attemptingToPlay:!1,autoPlay:!1}),null==(a=this.player)||a.pause(),this.previewHiddingTimeout&&clearTimeout(this.previewHiddingTimeout)):(this.setState({attemptingToPlay:!0}),null==(o=this.player)||o.play(),this.previewHiddingTimeout=window.setTimeout(()=>this.setState({previewHidden:!0}),3e3))}}track(e){var t,i,n,a;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.props.communityPostEmbedPostId||this.props.mediaUpload.post_id,l=this.props.mediaUpload.user_id;(0,h.u4)(e,Object.assign({post_id:r,video_user_id:l,community_post_id:this.props.communityPostId,media_upload_id:this.props.mediaUpload.id,live_stream_id:this.props.liveStreamId,current_time:this.state.currentTime?Math.floor(this.state.currentTime):0,duration:this.state.duration?Math.floor(this.state.duration):0,is_clip:null!=(i=this.props.isClip)&&i,surface:this.props.surface,is_preview:null!=(n=this.props.usePreview)&&n,muted:null!=(a=null==(t=this.player)?void 0:t.muted)&&a,video_type:this.props.videoType,display:(0,g.aS)()?"fullscreen":document.pictureInPictureElement?"pip":"inline"},o))}trackMedia(e){var t,i,n,r,l,s,d,c;let u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{mediaUpload:p,videoType:m,surface:y,primaryEntityKey:f,primaryEntityType:v,contentType:Y,feedItemTrackingParameters:b}=this.props,_=null!=Y?Y:m?null!=(n=({communityCommentReply:"communityComment","video-embed":"embed"})[m])?n:m:"unknown",{entityKey:w,entityType:k}=this.getEntityKeyAndType(),A=Array.from(null!=(r=null==(t=this.player)?void 0:t.textTracks)?r:[]),E=A.length>0,C=this.isShowingCaptionsElsewhere||A.some(e=>["subtitles","captions"].includes(e.kind)&&"showing"===e.mode);(0,h.u4)(e,(0,a._)((0,o._)((0,a._)({},b),{media_type:"video",video_upload_id:p.id,src_video_upload_id:p.src_media_upload_id,content_type:_,primary_entity_key:String(null!=f?f:w),primary_entity_type:null!=v?v:k,entity_key:String(w),entity_type:k,publication_id:p.publication_id,surface:y,display:(0,g.aS)()?"fullscreen":document.pictureInPictureElement?"pip":"inline",muted:null!=(l=null==(i=this.player)?void 0:i.muted)&&l,captions_enabled:E?C:null,autoplay:this.state.autoPlay&&!this.state.failedAutoplay,is_preview:null!=(s=this.props.usePreview)&&s,current_time:Math.floor(null!=(d=this.state.currentTime)?d:0),duration:Math.floor(null!=(c=this.state.duration)?c:0),duration_played:Math.floor(this.state.durationPlayed),duration_played_id:this.state.durationPlayedId}),u))}render(){var e;let t=this.props,i=null!=(e=this.state)?e:{},{height:n,width:a}=(0,k.videoPlayerDimensions)(t.mediaUpload,{isStatic:!1}),o=s()("video-player",{"video-player-clip":t.isClipping,"video-player-with-background":!t.omitBackgroundColor},t.videoPlayerClassName);return(0,r.Y)(I,{className:s()(t.className,{"with-preview":!i.previewHidden,"full-width":a>=960,"video-player-wrapper-clip":t.isClipping,"video-player-with-background":!t.omitBackgroundColor}),linkClassName:o,href:this.href(),width:a,height:n,onClick:this.onPreviewClick,style:t.style,liveStreamId:t.liveStreamId,children:this.renderPlayer(this.props,this.state)})}renderPlayer(e,t){let{hidePlayButton:i,mediaUpload:n,noPreview:a,renderPlayButton:o,renderOverlay:l,startMuted:s,videoClassName:c,liveStreamId:p,loop:h,thumbnailUrl:y,noPictureInPicture:f=!1}=e,{autoPlay:b,attemptingToPlay:w,previewHidden:k,useHLSJS:C,browserCanPlayHLS:I,HLSerrored:D,failedAutoplay:S,playing:N}=t,R=!this.playbackEnabled(),x=this.getBaseVideoSrc(),F=[];F=p?["hls"]:I?["hls","mp4"]:C?[]:(0,g.m0)()?["hls","mp4"]:D?["mp4"]:["hls","mp4"];let L=(0,g.rr)(),O=!!(0,m.Ay)("use_preloaded_player_sources")&&L,U=b&&!S&&this.playbackEnabled(),M=y||"".concat((0,_.H10)(n),"?refresh=").concat(n.updated_at),B=this.shouldShowNativeVideoControls();return[this.playbackEnabled()&&"undefined"!=typeof window&&(0,r.Y)("video",{ref:this.assignPlayer,controls:B,controlsList:"nodownload",autoPlay:U,poster:M,muted:s,loop:h,className:c,playsInline:L,disablePictureInPicture:f,crossOrigin:"anonymous",children:O?Object.entries(this.state.sources).map((e,t)=>{let[i,n]=e;return(0,r.Y)("source",{src:n,type:E[i],onError:t===Object.keys(this.state.sources).length-1?this.onAllSourcesFailed:void 0},"".concat(i,"_").concat(t))}):F.map((e,t)=>(0,r.Y)("source",{src:(0,_.oRR)(x,{type:e}),type:E[e],onError:t===F.length-1?this.onAllSourcesFailed:void 0},"".concat(e,"_").concat(t)))}),l&&(0,r.Y)("div",{className:A.A.previewOverlay,children:l({isPlaying:N,getCurrentTimeInSeconds:()=>this.state.currentTime})}),!a&&!k&&!i&&(0,r.FD)(d.Fragment,{children:[R&&(0,r.Y)(T,{mediaUpload:n,thumbnailUrl:M}),!o&&(0,r.Y)(P,{children:this.cta()?(0,r.Y)(v.Bj,{href:this.href(),loading:w&&this.playbackEnabled(),"aria-label":"play",leading:(0,r.Y)(u.A,{height:16,width:16,style:{stroke:"none",fill:"white"}}),children:this.cta()}):(0,r.Y)(Y.ro,{isPlaying:!1,href:this.href(),size:72,loading:w&&this.playbackEnabled()})}),o&&(0,r.Y)(P,{children:o()})]})]}isChromeWithBrokenNativeHLS(){var e;if("undefined"==typeof navigator)return!1;let t=null==(e=navigator.userAgentData)?void 0:e.brands;if(!t)return!1;let i=t.find(e=>"Google Chrome"===e.brand);return i&&parseInt(i.version)>=141}_initHlsjs(){let e=!!(this.player&&this.player.canPlayType("application/vnd.apple.mpegurl"));if(e&&!(0,g.m0)()&&!this.isChromeWithBrokenNativeHLS()){this.setState({browserCanPlayHLS:e}),this.autoPlayVideo();return}i.e("9234").then(i.bind(i,40137)).then(e=>{this._initHlsjsWrapped(e.default)})}autoPlayVideo(){if(this.state.autoPlay&&this.player){let e=new IntersectionObserver(t=>{t.forEach(t=>{if(e.unobserve(t.target),t.isIntersecting&&this.player){var i;this.player.muted=null!=(i=this.props.startMuted)&&i,this.player.play().catch(e=>{console.error("Unable to autoplay prior to user interaction with the dom.",e),this.setState({failedAutoplay:!0,attemptingToPlay:!1}),this.player&&(this.player.muted=!0,this.player.play().then(()=>{var e,t;null==(e=(t=this.props).onAutoplayMuted)||e.call(t)}).catch(e=>{console.error("Unable to autoplay prior to user interaction with the dom when muted.",e),this.setState({failedAutoplay:!0,attemptingToPlay:!1})}))})}})},{threshold:.5});e.observe(this.player)}}_initHlsjsWrapped(e){let t=this,i=e.isSupported();if(!e.isSupported()){this.setState({useHLSJS:i}),this.autoPlayVideo();return}null!=this.hls&&this.hls.destroy();let n=new e((0,a._)({enableWorker:!1},{}));null!=this.player&&n.attachMedia(this.player);let o=this.getBaseVideoSrc("hls");n.on(e.Events.MEDIA_ATTACHED,()=>{n.loadSource(o),n.on(e.Events.MANIFEST_PARSED,()=>{this.autoPlayVideo()})}),n.on(e.Events.ERROR,function(i,a){if(a.fatal)switch(a.type){case e.ErrorTypes.NETWORK_ERROR:var o;t.setState({useHLSJS:!1}),null==(o=t.hls)||o.destroy(),n.startLoad();break;case e.ErrorTypes.MEDIA_ERROR:n.recoverMediaError();break;default:this._initHlsjs()}}),this.hls=n,this.hlsModule=e}constructor(e,t){var i,r;super(e,t),i=this,(0,n._)(this,"player",null),(0,n._)(this,"previewHiddingTimeout",null),(0,n._)(this,"lastTimeUpdate",null),(0,n._)(this,"_accumulatedDurationPlayed",0),(0,n._)(this,"containerRef",(0,d.createRef)()),(0,n._)(this,"isShowingCaptionsElsewhere",!1),(0,n._)(this,"assignPlayer",e=>{this.player=e}),(0,n._)(this,"resetDurationTracking",()=>{this.lastTimeUpdate=null,this.setState({durationPlayed:0,durationPlayedId:(0,c.v4)()})}),(0,n._)(this,"onLoadedMetadata",()=>{this.state.playbackRestoreLocation&&(this.player&&(this.player.currentTime=this.state.playbackRestoreLocation),this.previewHiddingTimeout=window.setTimeout(()=>this.setState({playbackRestoreLocation:null,previewHidden:!0}),3e3))}),(0,n._)(this,"onLoadedData",()=>{this.state.playbackRestoreLocation&&(this.previewHiddingTimeout&&clearTimeout(this.previewHiddingTimeout),this.setState({playbackRestoreLocation:null,previewHidden:!0}))}),(0,n._)(this,"onCanPlay",()=>{this.onTimeUpdate()}),(0,n._)(this,"onPlay",()=>{null===g.dO||void 0===g.dO||g.dO.emit("play",this),this.setState({playing:!0}),this.lastTimeUpdate=Date.now(),this.trackMedia(h.qY.MEDIA_PLAYBACK_STARTED)}),(0,n._)(this,"onPause",()=>{var e;this.setPlaybackRestoreLocation(),this.lastTimeUpdate=null,this.setState({playing:!1,waiting:!1,previewHidden:!this.props.showPreviewWhenPaused&&this.state.previewHidden}),(null==(e=this.player)?void 0:e.ended)||this.trackMedia(h.qY.MEDIA_PLAYBACK_PAUSED),this.player&&this.player.currentTime>this.player.duration-.1&&this.onVideoReachEnd()}),(0,n._)(this,"onEnded",()=>{this.lastTimeUpdate=null,this.setState({playing:!1,waiting:!1,previewHidden:!this.props.showPreviewWhenPaused&&this.state.previewHidden}),this.trackMedia(h.qY.MEDIA_PLAYBACK_PAUSED),this.onVideoReachEnd()}),(0,n._)(this,"onTimeUpdate",()=>{if(!this.player||!isFinite(this.player.duration))return;let e=this.player.currentTime,t=Date.now();if(this.state.playing&&null!==this.lastTimeUpdate){let e=(t-this.lastTimeUpdate)/1e3;e>0&&e<1&&(this._accumulatedDurationPlayed=(this._accumulatedDurationPlayed||0)+e,this._accumulatedDurationPlayed>=1&&(this.setState(e=>({durationPlayed:e.durationPlayed+this._accumulatedDurationPlayed})),this._accumulatedDurationPlayed=0))}this.lastTimeUpdate=t,(this.props.duration||this.state.duration===this.player.duration)&&this.state.currentTime===e?this.setState({waiting:!1}):this.setState({duration:this.props.duration||this.player.duration,currentTime:e,waiting:!1})}),(0,n._)(this,"onWaiting",()=>{this.lastTimeUpdate=null,this.setState({waiting:Date.now()})}),(0,n._)(this,"onPlaying",()=>{this.previewHiddingTimeout&&clearTimeout(this.previewHiddingTimeout),this.lastTimeUpdate=Date.now(),this.setState({playing:!0,waiting:!1,previewHidden:!0,attemptingToPlay:!1,autoPlay:!1,hasPlayed:!0})}),(0,n._)(this,"onSeeked",()=>{this.lastTimeUpdate=Date.now(),this.trackMedia(h.qY.MEDIA_SEEKED)}),(0,n._)(this,"onVideoReachEnd",function(){let{resetTime:e=!0,triggerCallback:t=!0,track:n=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i.lastTimeUpdate=null,i.player&&!i.player.paused&&i.player.pause(),i.state.previewHidden&&i.setState({previewHidden:!1,attemptingToPlay:!1,hasReachedEnd:!0}),e&&i.player&&!(0,g.gI)()&&!i.props.doNotResetOnEnd&&(i.player.currentTime=0),(0,g.Eh)(),(0,g.wp)(),i.props.onFinishVideo&&t&&i.props.onFinishVideo(),n&&i.trackMedia(h.qY.MEDIA_PLAYBACK_COMPLETED)}),(0,n._)(this,"onContextMenu",e=>{e.preventDefault()}),(0,n._)(this,"onUserInteraction",()=>{this.state.showControls||this.setState({showControls:!0})}),(0,n._)(this,"onAllSourcesFailed",()=>{var e,t;console.info("Failed to load all video sources, falling back to preview image"),this.setState((0,o._)((0,a._)({},this.props.liveStreamId?{}:{previewHidden:!1,attemptingToPlay:!1,autoPlay:!1}),{allSourcesFailed:!0})),null==(e=(t=this.props).onPlaybackFailed)||e.call(t)}),(0,n._)(this,"onBeforeUnload",()=>{this.setPlaybackRestoreLocation(),this.state.previewHidden&&this.setState({previewHidden:!1,attemptingToPlay:!1}),this.player&&!this.player.paused&&this.player.pause()}),(0,n._)(this,"onGlobalPlay",e=>{this!==e&&this.player&&!this.player.paused&&this.player.pause()}),(0,n._)(this,"onGlobalKeyDown",e=>{var t;this.props.noKeyboardShortcuts||e.metaKey||e.altKey||e.ctrlKey||document.activeElement!==document.body||!this.player||(!((null!=(t=null===g.dO||void 0===g.dO?void 0:g.dO.listenerCount("play"))?t:0)>1)||!this.player.paused)&&("f"===e.key?(0,g.aS)()?(0,g.Eh)()&&e.preventDefault():((0,g.gK)(this.player)&&e.preventDefault(),this.player.paused&&this.player.play()):" "!==e.key||(0,g.aS)()?"ArrowRight"===e.key?this.player.currentTime+5>this.player.duration?this.onVideoReachEnd():(this.player.currentTime+=5,this.state.previewHidden||this.setState({previewHidden:!0,attemptingToPlay:!1})):"ArrowLeft"===e.key&&(this.player.currentTime-=5):(e.preventDefault(),this.player.paused?this.player.play():this.player.pause()))}),(0,n._)(this,"getEntityKeyAndType",()=>{let{mediaUpload:e,communityPostId:t,entityKey:i,entityType:n}=this.props;return i?{entityKey:i,entityType:n}:t?{entityKey:t,entityType:"community_post"}:e.post_id?{entityKey:String(e.post_id),entityType:"post"}:{entityKey:i,entityType:n}}),(0,n._)(this,"getBaseVideoSrc",e=>{var t;let i={token:this.props.reaction_token,override_publication_id:null==(t=this.props.pub)?void 0:t.id,preview:this.props.usePreview};return e&&(i.type=e),(0,_.oRR)("/api/v1/video/upload/".concat(this.props.mediaUpload.id,"/src"),i)}),(0,n._)(this,"hls",null),(0,n._)(this,"hlsModule",void 0),(0,n._)(this,"cta",()=>""),(0,n._)(this,"href",()=>this.props.href),(0,n._)(this,"playbackEnabled",()=>!0),(0,n._)(this,"onClickNonPlayableVideo",()=>{});const l="undefined"!=typeof window?(0,w.m)(window.location.href):{};let s=null;l.timestamp?s=parseInt(l.timestamp):l.t&&(s=parseInt(l.t));const u=null!==s&&!isNaN(s);u||(0,g.qm)("timestamp");const p=u?s:this.getPlaybackRestoreLocation();this.state={playbackRestoreLocation:p,currentTime:0,waiting:!0,duration:null!=(r=e.mediaUpload.duration)?r:null,autoPlay:e.autoPlay,playing:!1,attemptingToPlay:e.autoPlay,previewHidden:null!==p&&p>0,showControls:!1,hasPlayed:!1,hasReachedEnd:!1,browserCanPlayHLS:!1,useHLSJS:!0,HLSerrored:!1,allSourcesFailed:!1,failedAutoplay:!1,sources:{},durationPlayed:0,durationPlayedId:(0,c.v4)()},this.onPreviewClick=this.onPreviewClick.bind(this)}}function I(e){let{className:t,linkClassName:i,width:n,height:a,href:o,onClick:l,children:d,style:c,liveStreamId:u}=e,p={paddingBottom:"".concat(Math.min(u?56.25:60,100*a/n).toFixed(4),"%")};return(0,r.Y)("div",{className:s()(t,"video-player-wrapper",n>=960&&"full-width"),onClick:l,role:"region","aria-label":"Video player",style:c,children:(0,r.Y)(o?"a":"div",{className:s()("video-player",i),href:o,style:p,children:d})})}function T(e){let{mediaUpload:t,thumbnailUrl:i,testId:n,isStatic:a}=e;return(0,r.Y)("img",{className:"video-player-preview",width:550,src:i||(0,_.Pzx)(t,{isStatic:a}),"data-component-name":"VideoPlayer-PreviewImg","data-testid":n})}let P=(0,f.I4)({position:"absolute",className:s()(A.A.buttonContainer,"video-player-button")})},58050:function(e,t,i){i.d(t,{km:()=>A,uy:()=>k});var n=i(69277),a=i(79785),o=i(4006),r=i(91648),l=i.n(r),s=i(74242),d=i(31062),c=i(17402),u=i(25250);i(82936);var p=i(84605),h=i(46271);i(72026),i(6547);var m=i(94729),y=i(76528),g=i(68349);i(88774);var f=i(36372),v=i(46453),Y=i(50963);function b(){let e=(0,a._)(["Followed ",""]);return b=function(){return e},e}function _(){let e=(0,a._)(["Unfollowed ",""]);return _=function(){return e},e}function w(e){let t=(0,h.Jd)();return(0,y.OU)("/api/v1/feed/following",(0,n._)({auto:!!t},e))}function k(){let{mutate:e}=(0,u.iX)();return function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return e("/api/v1/feed/following",...i)}}function A(e,t,i){let{isFollowing:n,toggle:a}=function(e,t,i,n){let a=(0,h.Jd)(),{onboardingModal:r,requireLogin:c}=(0,v.eE)(),u=function(e,t){let{data:i}=w(t);return(null!=i?i:[]).includes(null!=e?e:0)}(null==e?void 0:e.id,n),{mutate:y,data:k}=w(n),A=(0,f.d)(),E=(0,Y.$k)((null==e?void 0:e.name)||""),{iString:C,iTemplate:I}=(0,p.GO)(),T=async n=>{if(e){if(!a&&r)return void(c?c():r.open());y(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return n?[...t,e.id]:l()(t,e.id)},{revalidate:!1});try{await (0,m.x6)("/api/v1/feed/".concat(e.id,"/follow"),{method:n?"POST":"DELETE",json:{surface:t,noteId:i}}),A.popToast(()=>(0,o.Y)(f.y,{Icon:n?s.A:d.A,text:n?I(b(),E):I(_(),E),cta:C("Undo"),onAccept:()=>T(!n)}))}catch(e){A.popToast(()=>(0,o.Y)(f.y,{text:(0,g.uX)(e)}));return}}};return{isFollowing:u,toggle:()=>T(!u),isLoaded:!!k}}(e,t,i),[r,u]=(0,c.useState)(!1);return{isFollowing:n,buttonProps:{onClick:()=>{a(),n||u(!0)},onMouseLeave:()=>u(!1)}}}},6049:function(e,t,i){i(4006),i(50172),i(32485),i(83673),i(38305),i(95977),i(773),i(57051),i(56305),i(35465),i(81203);var n=i(24216);i(56458),i(4016),i(39318),i(82776),i(87300),i(84685),i(82203),(0,n.a)("email-text-button","a"),(0,n.a)("email-text-b4 email-text-secondary","div")},42686:function(e,t,i){i.d(t,{Yw:()=>M,ti:()=>U,wR:()=>H});var n=i(69277),a=i(70408),o=i(4006),r=i(66443),l=i(10278),s=i(72880),d=i(27749),c=i(7984),u=i(10398),p=i(42509),h=i(95887),m=i(26401),y=i(65547),g=i(2675),f=i(8103),v=i(22858),Y=i(77181),b=i(25667),_=i(9079),w=i(90856),k=i(46478),A=i(88325),E=i(78479),C=i(94328),I=i(99662),T=i(76977),P=i(3046),D=i(504),S=i(13348),N=i(20437),R=i(46754),x=i(50129),F=i(75914),L=i(39318);i(49807);var O=i(44307);function U(e){let{parent:t,item:i,attachments:n,readOnly:a,isDm:r,isRestack:s,isPermalink:c,isComposing:u,onQuoteThemeChange:p,onAttachmentClick:h,onSavePostClick:m,utm_content:y,commentId:g}=e,f=(0,d.PK)();if(0===n.length)return null;let v=n.filter(e=>"image"===e.type),Y=n.filter(e=>"video"===e.type),b=n.filter(e=>"image"!==e.type&&"video"!==e.type);return(0,o.FD)(o.FK,{children:[v.length>0&&(0,o.Y)(l.xn,{parent:t,readOnly:a||(0,I.y)(),assets:v.map(e=>z(e)),onClick:h,onSwipe:()=>{i&&(0,D.fP)(i,f)},isRestack:s,isPermalink:c,isDm:r,feedItem:i,commentId:g}),Y.map(e=>{var n;return(0,o.Y)(N.R8,{mediaUpload:e.mediaUpload,composing:null!=u&&u,videoPlayerProps:{surface:(0,A.u)(f),entityType:"comment",entityKey:null!=(n=null==t?void 0:t.id)?n:"unknown",contentType:"comment",feedItemTrackingParameters:null==i?void 0:i.trackingParameters}},e.mediaUpload.id)}),b.map(e=>(0,o.Y)(H,{parent:t,attachment:e,readOnly:a,isDm:r,isRestack:s,isPermalink:c,isComposing:u,onAttachmentClick:h,onSavePostClick:m,onQuoteThemeChange:p,utm_content:y,compactIfPossible:v.length>0||Y.length>0||b.length>1,item:null!=i?i:void 0}))]})}function M(e){let{attachments:t}=e;if(0===t.length)return null;let i=t.filter(e=>"image"===e.type),n=t.filter(e=>"video"===e.type);return(0,o.FD)(o.FK,{children:[i.length>0&&(0,o.Y)(r._,{assets:i.map(e=>z(e))}),n.map(e=>(0,o.Y)(B,{mediaUpload:e.mediaUpload}))]})}function B(e){let{mediaUpload:t}=e,i=(0,L.Pzx)(t);return(0,o.FD)(T.pT,{width:72,height:72,radius:"md",overflow:"hidden",sizing:"border-box",border:"detail",position:"relative",alignItems:"center",justifyContent:"center",flex:"auto",children:[(0,o.Y)(s.o,{src:i,maxWidth:72,useRetinaSizing:!0,imageIsFixedWidth:!0,imageProps:{height:72,smartCrop:!0},className:O.A.videoThumbnailImage}),(0,o.Y)(S.ro,{isPlaying:!1,size:40})]})}function H(e){var t,i,r,l,s,I,T,D;let{parent:S,attachment:O,readOnly:U,isRestack:M,isDm:B,isPermalink:H,isComposing:z,onAttachmentClick:V,onSavePostClick:K,onQuoteThemeChange:j,utm_content:G,compactIfPossible:q,item:J}=e,X=(0,d.PK)(),$=V?e=>{V((0,a._)((0,n._)({},e),{attachmentId:String(O.id),attachmentType:O.type}))}:void 0;if((0,x._d)(O))return(0,o.Y)(m.G,{attachment:O,readOnly:U,isRestack:M,onAttachmentClick:$,utm_content:G});if("live_stream"===O.type)return(0,o.Y)(h.G,{activeLiveStream:O.active_live_stream,onAttachmentClick:$,maxWidth:N.di,feedItem:null!=J?J:null,videoPlayerProps:{surface:(0,A.u)(X),entityType:"comment",entityKey:null!=(t=null==S?void 0:S.id)?t:"unknown",contentType:"comment",feedItemTrackingParameters:null==J?void 0:J.trackingParameters}});if("link"===O.type){let{linkMetadata:e}=O,t=(0,P.Ac)(e.url),i=(0,P.b5)(e.url);if(t)return(0,o.Y)(k.H,{videoId:t});if(i)return(0,o.Y)(_.k,{videoId:i});let a=(0,b.x)(e.url);if(a)return(0,o.Y)(b.E,{embedType:a.embedType,resourceId:a.resourceId});let r=(0,R.RP)(e.url);if(r)return(0,o.Y)(y.E,{fullEmbedUrl:r.fullEmbedUrl,eventSlug:r.eventSlug,marketSlug:r.marketSlug,profileName:r.profileName});let l=(0,c.a)(e.url);if(l)return(0,o.Y)(c.x,{country:l.country,type:l.type,id:l.id});let s=(0,Y.l)(e.url);return s?(0,o.Y)(Y.Y,{url:s.url,type:s.type}):(0,o.Y)(p.i,(0,n._)({readOnly:U,onClick:$},O.linkMetadata))}if("comment"===O.type)return(0,o.Y)(u.Hr,{parent:S,readOnly:U,publication:null!=(i=O.publication)?i:void 0,comment:O.comment,onAttachmentClick:$,utm_content:G,isDm:B,isPermalink:H,commentId:O.comment.id});if("post"===O.type&&O.postSelection)return(0,o.Y)(E.DP,{readOnly:U,attachment:O,onClick:$,onSavePostClick:K,onThemeChange:j,isPermalink:H,isComposing:z,isRestack:M});if("post"===O.type&&O.postImageSelection)return(0,o.Y)(v.h,{parent:S,item:J,attachment:O,onClick:$,readOnly:U,isRestack:M,isPermalink:H,isDm:B});if("post"===O.type){let e=J&&(0,F.tL)(J,O)&&"post"===J.type?(null==(r=J.mediaClip)?void 0:r.clip_info)||(null==(l=O.mediaClip)?void 0:l.clip_info):(null==(s=O.mediaClip)?void 0:s.clip_info)||O.clipInfo,t=O.post.videoUpload;return e&&t?(0,o.Y)(N.R8,{tag:(0,o.Y)(C.b_,{pub:O.publication,post:O.post,onViewEpisodeClick:$}),mediaUpload:t,composing:!1,videoPlayerProps:{surface:(0,A.u)(X)}},O.id):(0,o.Y)(g.Sp,{clipInfo:e,readOnly:U,publication:O.publication,post:O.post,onClick:$,onSavePostClick:K,compact:q,item:J},O.id)}return"publication"===O.type?q?(0,o.Y)(p.i,{readOnly:U,onClick:$,title:O.publication.name,host:(0,L.EWE)(O.publication),image:null!=(I=O.publication.logo_url)?I:void 0,url:(0,L.fOI)(O.publication)}):(0,o.Y)(f.S,{publication:O.publication,readOnly:U,onClick:$}):"user"===O.type?q?(0,o.Y)(p.i,{readOnly:U,onClick:$,title:O.user.name,host:O.user.handle?"@".concat(O.user.handle):void 0,image:null!=(T=O.user.photo_url)?T:void 0,url:(0,L.gYq)(O.user)}):(0,o.Y)(w.f,{attachment:O,readOnly:U,onClick:$,noteId:null==J?void 0:J.entity_key}):"video"===O.type?(0,o.Y)(N.R8,{mediaUpload:O.mediaUpload,composing:!1,videoPlayerProps:{surface:(0,A.u)(X),entityType:"comment",entityKey:null!=(D=null==S?void 0:S.id)?D:"unknown",contentType:"comment"}},O.mediaUpload.id):(0,o.Y)(W,{attachment:O})}function W(e){let{}=e;return(0,o.Y)(T.pT,{})}function z(e){return{id:e.id,src:e.imageUrl,explicit:e.explicit,width:e.imageWidth,height:e.imageHeight}}},27332:function(e,t,i){i.d(t,{GZ:()=>T,Iz:()=>E,X6:()=>C,jS:()=>w,l8:()=>k});var n=i(69277),a=i(70408),o=i(4006),r=i(75107);i(84565),i(58050),i(84605),i(85478);var l=i(46271);i(95282);var s=i(27749);i(51498),i(80520),i(77405);var d=i(25859),c=i(58292),u=i(89490),p=i(35369);i(76977);var h=i(88774),m=i(63136);i(92028);var y=i(504),g=i(83629),f=i(85050),v=i(16884),Y=i(49095),b=i(16291),_=i(49807);function w(e){let{user:t,setTargetUser:i,eligibleTargetUsers:n,targetUser:a}=e;return(0,o.Y)(C,{children:(0,o.Y)(I,{children:(0,o.Y)(h.W1,{trigger:(0,o.Y)(p.$n,{priority:"quaternary",size:"sm",color:"primary",trailing:(0,o.Y)(r.A,{size:16}),children:(0,o.Y)(k,{user:null!=a?a:t})}),children:n.map(e=>(0,o.Y)(h.Dr,{onClick:()=>{e.id===t.id?i(null):i(e)},children:e.name},e.id))})})})}function k(e){let{user:t}=e;return(0,o.Y)(C,{children:(0,o.FD)(I,{children:[(0,o.Y)(m.EY,{as:"span",weight:"medium",children:t.name}),(0,o.Y)(Y.UserStatusSymbols,{status:t.status,userId:t.id,size:"xs"})]})})}let A=new Intl.DateTimeFormat(void 0,{dateStyle:"medium",timeStyle:"short"});function E(e){let{timestamp:t,comment:i,post:n,publication:a}=e;return(0,o.Y)(d.Yq,{href:i?(0,_.Zgx)(i,{noBase:g.Z}):n?(0,_.q$n)(a,n):void 0,color:"secondary",title:A.format((0,b.A)(t).toDate()),children:(0,o.Y)(c.iE,{timestamp:t})})}let C=(0,u.I4)((0,a._)((0,n._)({},m.nS),{display:"flex",minWidth:0,gap:8,alignItems:"center",height:20}));(0,u.I4)((0,a._)((0,n._)({},m.nS),{display:"flex",minWidth:0,gap:12,alignItems:"center"}));let I=(0,u.I4)({display:"flex",flex:"grow",minWidth:0,gap:8,alignItems:"center"});function T(e){var t,i;let{targetUser:n,item:a,comment:o,post:r,publication:d}=e,c=(0,l.Jd)(),u=(0,s.PK)(),p=o?"comment":r?"post":void 0,h=null!=(i=null!=(t=null==o?void 0:o.id)?t:null==r?void 0:r.id)?i:0,m=p?(0,_.Vvu)(h,p):void 0,g=null!=d?d:null==n?void 0:n.primary_publication,Y=(0,f.s)({surface:"substack-feed-item"})(g),b=(0,v.Zm)({user:n,publicationId:null==g?void 0:g.id,publicationName:null==g?void 0:g.name,subscriptionSource:"substack-feed-item",sourceNoteId:m});return{finalPublication:g,isSubscribed:b.isSubscribed,showCta:b.showCta,handleClick:e=>{a&&(0,y.Qb)(a,u,"subscribe"),!c&&g?Y(e):b.isSubscribed?b.unsubscribe(e):b.subscribe(e)},currentUser:c}}},93355:function(e,t,i){i(17402),i(95641),i(68349)},58418:function(e,t,i){i(17402),i(86500),i(17186),i(16291)},74894:function(e,t,i){function n(e,t){var i;return null!=(i=(null==t?void 0:t.cover_image)||(null==t?void 0:t.podcast_art_url)||(null==e?void 0:e.podcast_art_url))?i:null}i.d(t,{M$:()=>n}),i(83673),i(47307),i(94729),i(16291),i(56458),i(46009)},51131:function(e,t,i){i.d(t,{l:()=>u});var n=i(4006),a=i(84605);i(6049);var o=i(68349),r=i(24078),l=i(35369),s=i(76977),d=i(63136),c=i(2890);let u=e=>{let{avatarUrl:t,name:i,url:u}=e,{iString:p}=(0,a.GO)();return(0,n.FD)(s.pT,{direction:{mobile:"column",desktop:"row"},radius:"md",padding:24,alignItems:"center",className:c.A.container,justifyContent:"space-between","data-component-name":"MeetingEmbed",children:[(0,n.FD)(s.Ye,{className:c.A.header,gap:16,paddingBottom:{mobile:20,desktop:0},children:[(0,n.Y)(r.eu,{photoUrl:t,size:40}),(0,n.FD)("div",{children:[(0,n.FD)(d.EY.H4,{translated:!0,paddingBottom:4,color:"pub-primary-text",children:["Book a meeting with ",I18N.p(i)]}),(0,n.Y)(d.EY.B4,{translated:!0,color:"pub-secondary-text",children:"Schedule a meeting"})]})]}),(0,n.Y)(l.$n,{className:c.A.cta,priority:"primary",onClick:()=>{(0,o.V2)(u,{newTab:!0})},children:p("Book meeting")})]})}},84843:function(e,t,i){i.d(t,{Io:()=>f,Ud:()=>k,qx:()=>w,rQ:()=>g});var n=i(69277),a=i(4006),o=i(38390),r=i(32485),l=i.n(r),s=i(48697),d=i(23623),c=i(73164),u=i(89490),p=i(35369),h=i(76977),m=i(63136),y=i(74084);function g(e){let t,i,{onClose:n,showClose:o=!1,title:r,description:l,icon:s,showDivider:d=!1,alignItems:c="start",isInsideDialog:u=!0}=e;return"center"===c?(t=d?S:P,i=x):(t=d?D:T,i=R),(0,a.FD)(t,{children:[s,(0,a.FD)(i,{children:[r&&(0,a.Y)(v,{text:r,isInsideDialog:u}),l&&(0,a.Y)(Y,{text:l,isInsideDialog:u})]}),o&&n&&(0,a.Y)(b,{onClose:n})]})}function f(e){let{onClose:t,showClose:i=!1,image:n}=e;return(0,a.FD)(T,{children:[n,i&&t&&(0,a.Y)(_,{onClose:t})]})}function v(e){let{text:t,isInsideDialog:i}=e;return i?(0,a.Y)(o.hE,{asChild:!0,children:(0,a.Y)(m.EY.H2,{weight:"semibold",color:"primary",size:17,lineHeight:24,children:t})}):(0,a.Y)(m.EY.H2,{weight:"semibold",color:"primary",size:17,lineHeight:24,children:t})}function Y(e){let{text:t,isInsideDialog:i}=e,n=i?o.VY:"span";return(0,a.Y)(n,{asChild:!0,children:(0,a.Y)(m.EY.B3,{color:"secondary",as:"span",children:t})})}function b(e){let{onClose:t,position:i="absolute"}=e;return(0,a.Y)(p.K0,{priority:"quaternary",size:"sm",title:"Close",onClick:t,"aria-label":"close",position:i,className:l()(y.A.closeButton,y.A[i]),children:(0,a.Y)(s.A,{size:20})})}function _(e){let{onClose:t}=e;return(0,a.Y)(d.a,{children:(0,a.Y)(o.bm,{asChild:!0,children:(0,a.Y)(p.mZ,{priority:"secondary",size:"sm",title:"Close",onClick:t,"aria-label":"close",position:"absolute",className:y.A.imageCloseButton,children:(0,a.Y)(s.A,{size:20})})})})}function w(e){let{icon:t,bg:i}=e;return(0,a.Y)(A,{bg:i,children:t})}function k(){return(0,a.Y)(A,{bg:"accent-orange",children:(0,a.Y)(c.A,{height:20})})}function A(e){let{children:t,bg:i="secondary"}=e;return(0,a.Y)(h.fI,{display:"flex",flex:"auto",width:48,height:48,bg:i,radius:"sm",alignItems:"center",justifyContent:"center",outline:"detail",children:t})}let E={display:"flex",direction:"column",gap:16,paddingX:20,paddingTop:20},C={paddingTop:16,paddingBottom:16,borderBottom:"detail"},I={alignItems:"center"},T=(0,u.I4)((0,n._)({},E)),P=(0,u.I4)((0,n._)({},E,I)),D=(0,u.I4)((0,n._)({},E,C)),S=(0,u.I4)((0,n._)({},E,C,I)),N={display:"flex",direction:"column",gap:4},R=(0,u.I4)((0,n._)({},N)),x=(0,u.I4)((0,n._)({},N,{alignItems:"center",textAlign:"center"}))},52298:function(e,t,i){i(4006),i(35369)},21356:function(e,t,i){i(4006),i(17402),i(84605);var n=i(17028);i(44552),i(52298),i(71518),i(95187);var a=i(7743);(0,n.I4)({display:"flex",direction:"column",position:"relative",bg:"primary",radius:"sm",minWidth:0,overflow:"hidden",outline:"detail"}),(0,n.I4)({display:"flex",direction:"column",flex:"grow"}),(0,n.I4)({position:"absolute",height:32,radius:"xs",bg:"secondary",sizing:"border-box",className:a.A.highlight}),(0,n.I4)({display:"flex",alignItems:"center",justifyContent:"center",width:24,height:24})},25758:function(e,t,i){i(4006),i(17402),i(84605),i(89490),i(35369),i(76977),i(16993),i(57820);var n=i(75303);i(21356);var a=i(83447);(0,n.I4)({height:20,width:20,radius:"xs",overflow:"hidden",border:"detail"}),(0,n.I4)({position:"relative",overflow:"hidden",radius:"md",outline:"detail",bg:"secondary"}),(0,n.I4)({position:"relative",overflow:"hidden",radius:"md",outline:"detail",className:a.A.transparent})},62870:function(e,t,i){i(4006),i(32485),i(17402),i(84605),i(86500),i(35369),i(76977),i(57820),i(75303),i(39318),i(49807),i(84759)},60281:function(e,t,i){i(4006),i(32485),i(17402),i(78649),i(38305),i(27437),i(84777),i(68924),i(9292),i(58050),i(84605),i(46271),i(25859),i(86500),i(58418),i(82772),i(68349),i(24078),i(15040),i(35369),i(76977),i(22602),i(63136),i(504),i(45122),i(49095),i(39318),i(49807),i(12896)},93718:function(e,t,i){i(4006),i(58050),i(84605),i(46271),i(56804),i(35369),i(60281),i(49807)},52145:function(e,t,i){i(4006),i(84605),i(94729),i(35369),i(88774),i(36372),i(36319),i(70486),i(16291),i(35407)},28916:function(e,t,i){i.d(t,{I:()=>E});var n=i(69277),a=i(4006),o=i(15977),r=i(50180),l=i(17402),s=i(71941),d=i(84605),c=i(46271),u=i(12501),p=i(68349),h=i(35369),m=i(76977),y=i(88774),g=i(16993),f=i(63136),v=i(36372),Y=i(5180),b=i(2481),_=i(90554),w=i(70189),k=i(18947),A=i(49807);function E(e){var t,i;let h,m,f,{pub:E,post:I,comment:T,feedItem:P,onRestack:D,tabId:S,surface:N,renderWithoutUser:R=!1}=e,x=(0,c.Jd)(),F=(0,v.d)(),L=(!!x||R)&&!(null==E?void 0:E.hide_post_restacks)&&!(null==E?void 0:E.invite_only),O=!!(null==(t=T||I)?void 0:t.restacked),U=(null==(i=T||I)?void 0:i.restacks)||0,M=(0,Y.wA)(),B=(0,b.NP)(),[H,W]=(0,l.useState)(!1),z=(0,u.st)({pathname:"/api/v1/restack/feed"}),{iString:V}=(0,d.GO)(),{nuxModal:K,showRestackNux:j}=(h=function(e){let{entityType:t}=e,[i,n]=(0,l.useState)(!1),o=()=>{n(!1)};return{open:()=>{n(!0)},element:(0,a.Y)(g.aF,{isOpen:i,onClose:o,children:(0,a.Y)(C,{onClose:o,entityType:t})})}}({entityType:T&&!T.post_id?"note":T?"comment":"post"}),m=(0,u.st)({pathname:"/api/v1/feed/has-restacked",auto:!1,cacheTtl:1/0}),f=async()=>{var e;let t=null!=(e=m.result)?e:await m.refetch();t instanceof Error||(null==t?void 0:t.hasRestacked)!==!1||(h.open(),m.setResult({hasRestacked:!0}))},{nuxModal:h.element,showRestackNux:f}),G=async()=>{var e,t;if(!x)return void W(!0);null==D||D(!0);let i=await z.refetch({method:"POST",json:{postId:T?null:null==I?void 0:I.id,commentId:(null==T?void 0:T.id)||null,mediaClipId:(null==P?void 0:P.type)==="post"?null==(e=P.mediaClip)?void 0:e.id:void 0,tabId:S,surface:N}});if(i instanceof Error){null==D||D(!1),alert((0,p.uX)(i));return}if(F.popToast(()=>(0,a.Y)(v.y,{text:i.comment?V("Note restacked"):V("Post restacked"),Icon:o.A,cta:V("View now"),href:(0,w.oT)()})),i.comment)M({type:"comment_restack",payload:{commentId:i.comment.id,isRestacked:!0}});else{M({type:"post_restack",payload:{postId:i.post.id,isRestacked:!0}});let e=(null==P?void 0:P.type)==="post"?null==(t=P.mediaClip)?void 0:t.id:void 0;e&&M({type:"post_restack",payload:{postId:i.post.id,mediaClipId:e,isRestacked:!0}})}j()},q=async()=>{var e,t;null==D||D(!1);let i=await z.refetch({method:"DELETE",json:{postId:T?null:null==I?void 0:I.id,commentId:(null==T?void 0:T.id)||null,mediaClipId:(null==P?void 0:P.type)==="post"?null==(e=P.mediaClip)?void 0:e.id:void 0,tabId:S}});if(i instanceof Error){null==D||D(!0),alert((0,p.uX)(i));return}if(F.popToast(()=>(0,a.Y)(v.y,{text:V("Restack undone"),Icon:r.A})),T)M({type:"comment_restack",payload:{commentId:T.id,isRestacked:!1}});else if(I){M({type:"post_restack",payload:{postId:I.id,isRestacked:!1}});let e=(null==P?void 0:P.type)==="post"?null==(t=P.mediaClip)?void 0:t.id:void 0;e&&M({type:"post_restack",payload:{postId:I.id,mediaClipId:e,isRestacked:!1}})}},J=async()=>{if(!x)return void W(!0);try{var e;await B.open((0,n._)({feedItem:P,restackUrl:T?(0,k.XB)(I,T,E):(0,A.wu9)(E,I),tabId:S,surface:N},(null==P?void 0:P.type)==="post"&&{mediaClipId:null==(e=P.mediaClip)?void 0:e.id})),j()}catch(e){}};return(0,_.y)({name:"restack-comment",action:()=>{L&&J()}}),{canRestack:L,isRestacked:O,restacks:U,nuxModal:K,loggedOutRestackAttempt:H,menuItems:[O?(0,a.Y)(y.Dr,{leading:(0,a.Y)(r.A,{}),onClick:q,children:V("Undo restack")}):(0,a.Y)(y.Dr,{leading:(0,a.Y)(o.A,{}),onClick:G,children:V("Restack")}),(0,a.Y)(y.Dr,{leading:(0,a.Y)(s.A,{}),onClick:J,children:V("Restack with a note")})]}}function C(e){let{onClose:t,entityType:i}=e,{iString:n}=(0,d.GO)();return(0,a.FD)(m.I1,{paddingX:16,children:[(0,a.Y)(m.pT,{justifyContent:"center",paddingTop:32,paddingBottom:24,children:(0,a.Y)(o.A,{size:40,stroke:"var(--color-fg-primary)"})}),(0,a.FD)(m.I1,{gap:12,children:[(0,a.FD)(f.EY.H3,{align:"center",children:["comment"===i&&n("You restacked a comment"),"note"===i&&n("You restacked a note"),"post"===i&&n("You restacked a post")]}),(0,a.FD)(f.EY.B3,{color:"secondary",align:"center",children:["comment"===i&&n("Restack comments that inspire you to share them with more people."),"note"===i&&n("Restack notes that inspire you to share them with more people."),"post"===i&&n("Restack posts that inspire you to share them with more people.")," ",n("Subscribers can see your restacks in the Notes tab and on your profile.")]})]}),(0,a.FD)(m.I1,{paddingBottom:16,paddingTop:20,gap:8,children:[(0,a.Y)(h.$n,{priority:"primary",href:(0,w.oT)(),children:n("View now")}),(0,a.Y)(h.$n,{priority:"secondary-outline",onClick:t,children:n("OK")})]})]})}},20956:function(e,t,i){i.d(t,{x:()=>p});var n=i(69277),a=i(70408),o=i(4006),r=i(84605),l=i(16074),s=i(76977),d=i(63136),c=i(67140),u=i(5955);function p(e){return(0,o.Y)(s.VP,{gap:8,children:(0,o.Y)(h,(0,a._)((0,n._)({},e),{separator:(0,o.Y)(l.c,{})}))})}function h(e){let{date:t,replyCount:i,retweetCount:n,likeCount:a,impressionCount:l,separator:s}=e,{iCombo:p}=(0,r.GO)(),h=i>0||n>0||a>0,g=i>0&&n>0,f=(i>0||n>0)&&a>0;return(0,o.FD)(o.FK,{children:[(0,o.FD)(d.EY.B4,{color:"secondary",children:[(0,o.Y)(m,{children:(0,u.hV)(t)}),l>0&&(0,o.FD)(o.FK,{children:[(0,o.Y)(y,{}),(0,o.FD)(m,{children:[(0,c.V)(l,"number-truncated")," ",p("tweetStats","View","Views",l)]})]})]}),h&&s,h&&(0,o.FD)(d.EY.B4,{color:"secondary",children:[i>0&&(0,o.FD)(m,{children:[(0,c.V)(i,"number-truncated")," ",p("tweetStats","Reply","Replies",i)]}),g&&(0,o.Y)(y,{}),n>0&&(0,o.FD)(m,{children:[(0,c.V)(n,"number-truncated")," ",p("tweetStats","Repost","Reposts",n)]}),f&&(0,o.Y)(y,{}),a>0&&(0,o.FD)(m,{children:[(0,c.V)(a,"number-truncated")," ",p("tweetStats","Like","Likes",a)]})]})]})}function m(e){let{children:t}=e;return(0,o.Y)(d.EY,{as:"span",children:t})}function y(){return(0,o.Y)(m,{children:" \xb7 "})}},5955:function(e,t,i){i.d(t,{hV:()=>a,sK:()=>o});var n=i(16291);function a(e){return(0,n.A)(e).format("h:mm A \xb7 MMM D, YYYY")}function o(e){return e?"X avatar for @".concat(e):"X avatar"}i(49807)},19601:function(e,t,i){i(56262)},96301:function(e,t,i){function n(e,t){if(!e)return!1;if(!t)return!0;let i=["unsubscribed","free_signup","subscribed"];return i.indexOf(e)>=i.indexOf(t)}i.d(t,{cE:()=>n}),i(4016)},70189:function(e,t,i){i.d(t,{EX:()=>p,Hr:()=>A,M$:()=>f,RV:()=>v,RY:()=>y,TJ:()=>s,Vv:()=>b,XX:()=>k,Zg:()=>g,kG:()=>Y,oT:()=>h,q$:()=>m});var n=i(69277),a=i(56262),o=i(37764),r=i(92636),l=i(28700);let s="/".concat("home"),d="/notes";new RegExp("".concat(s,"/(").concat(Object.values(o.j3).join("|"),")/([^\\/]+)"));let c=/^\/profile\/(\d+)-([^\/]+)\/note\/c-(\d+)(\/stats)?$/,u=/^\/@[^\/]+\/note\/c-(\d+)(\/stats)?$/;function p(e){let t=e.match(c);if(t){let e=t[3],i=t[2];if(e&&i)return{type:"comment",id:Number(e),author:{id:Number(t[1]),name:i},isStats:!!t[4]}}let i=e.match(u);return i?{type:"comment",id:Number(i[1]),isStats:!!i[2]}:null}function h(){var e;let{baseUrl:t,urlParams:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=s,a=null!=t?t:(0,r.Ew)();return"undefined"!=typeof window&&(null==(e=window.location.href)?void 0:e.startsWith(a))||(n=a+n),(0,r.yR)(n,i)}function m(e,t){var i,n,o;let{noBase:s,urlParams:d,mediaClip:c}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=(null==(i=t.publishedBylines)?void 0:i[0])?null==(n=t.publishedBylines)?void 0:n[0]:e?(0,a.getPostAuthor)(e,t):{id:0,name:"someone"},p=c?(o=c.id,"m-".concat(o)):null;return(0,r.yR)("".concat((0,l.gY)(u,{noBase:s}),"/note/").concat(null!=p?p:w(t.id)),d)}function y(e,t){let{isPreview:i=!1}=t;return"".concat((0,r.Ew)(),"/embed/c/").concat(e.id,"?origin=").concat(window.location.origin).concat(i?"&isPreview=true":"")}function g(e){let{noBase:t,baseUrl:i,urlParams:n,noHandle:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.user_id?(0,r.yR)("".concat((0,l.gY)((0,a.getCommentAuthor)(e),{baseUrl:i,noBase:t,noHandle:o}),"/note/").concat(_(e.id)),n):h({baseUrl:i})}function f(e){let{noBase:t,baseUrl:i,urlParams:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t?"":null!=i?i:(0,r.Ew)();return(0,r.yR)("".concat(a,"/note/").concat(e),n)}function v(e){let{noBase:t,urlParams:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t?"":(0,r.$_)();return(0,r.yR)("".concat(n,"/note/").concat(_(e)),i)}function Y(e){let{noBase:t,urlParams:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t?"":(0,r.$_)();return(0,r.yR)("".concat(n).concat(s,"/post/").concat(w(e)),i)}function b(e,t){return"".concat("comment"===t?"c":"media_clip"===t?"m":"p","-").concat(e)}function _(e){return"c-".concat(e)}function w(e){return"p-".concat(e)}function k(e){return(0,r.yR)(h(),(0,n._)({action:"compose"},e))}function A(e){let{noBase:t,isSmall:i,attachmentsOnly:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t?"":(0,r.$_)();return(0,r.yR)("".concat(a,"/note/").concat(_(e),"/preview.jpeg"),{size:i?"sm":"md",attachmentsOnly:n?"1":void 0})}new RegExp("".concat(s,"/(short|post)/p-(\\d+)")),new RegExp("^".concat(d,"(/?)")),new RegExp("^".concat(d,"/comment/(d+)$"))}}]);