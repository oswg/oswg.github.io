!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};e.SENTRY_RELEASE={id:"substack@af5f699"};var t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="7afb4209-2d48-4b21-a8a7-8f22aaec4636",e._sentryDebugIdIdentifier="sentry-dbid-7afb4209-2d48-4b21-a8a7-8f22aaec4636")}catch(e){}}();"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["4744"],{71036:function(e,t,n){n.d(t,{A:()=>i});let i={content:"content-JGN4ux",open:"open-zZMbkU",close:"close-KnhLUu"}},14444:function(e,t,n){n.d(t,{A:()=>i});let i={inlineContainer:"inlineContainer-FbhgTi",container:"container-ORd8N2"}},48028:function(e,t,n){n.d(t,{I:()=>p});var i=n(69277),r=n(4006),a=n(38390),l=n(32485),o=n.n(l),s=n(17402),c=n(84014),u=n(11510),d=n(18359);let p=(0,s.forwardRef)((e,t)=>{let{children:n,className:l,fullscreenMobile:s,width:p,style:h,onClose:b,disableCloseOnBackdropClick:g,testId:f,initialFocus:m}=e,C=(0,u.Iu)(),v=C&&!s&&b;return(0,r.FD)(a.UC,{forceMount:!0,ref:t,"data-testid":f,className:o()(l,d.A.panel,C&&d.A.mobile,s&&d.A.fullscreenMobile),style:(0,i._)({width:C?void 0:p},h),onOpenAutoFocus:e=>{(null==m?void 0:m.current)&&(e.preventDefault(),m.current.focus())},onCloseAutoFocus:e=>{e.preventDefault()},onPointerDownOutside:e=>{e.preventDefault()},onEscapeKeyDown:e=>{g&&e.preventDefault()},children:[v&&(0,r.Y)(c.D,{close:b}),n]})});p.displayName="ModalPanel"},55734:function(e,t,n){n.d(t,{r:()=>h,p:()=>p});var i=n(4006),r=n(35426),a=n(32485),l=n.n(a),o=n(17402);let s="transition-vApOKl",c="mobile-v3F3YQ",u="from-yIK2iV",d="to-tgOjA4",p=e=>{let{children:t}=e;return(0,i.Y)(r.e.Child,{as:o.Fragment,enter:s,enterFrom:u,enterTo:d,leave:s,leaveFrom:d,leaveTo:u,children:t})},h=e=>{let{children:t}=e;return(0,i.Y)(r.e.Child,{as:o.Fragment,enter:l()(s,c),enterFrom:l()(u,c),enterTo:l()(d,c),leave:l()(s,c),leaveFrom:l()(d,c),leaveTo:l()(u,c),children:t})}},67250:function(e,t,n){n.d(t,{H:()=>a});var i=n(84605),r=n(67140);function a(e){let{value:t,format:n,currency:a,currencyIsMinorUnits:l}=e,{userLocale:o}=(0,i.GO)();return(0,r.V)(t,n,a,l,o)}},25851:function(e,t,n){n.d(t,{Q:()=>u});var i=n(69277),r=n(32641),a=n(4006),l=n(32485),o=n.n(l),s=n(33727),c=n(10996);function u(e){var{className:t}=e,n=(0,r._)(e,["className"]);return(0,a.Y)(c.e$,{children:(0,a.Y)(s.Z,(0,i._)({className:o()("panel-JHzhUT",t),shadow:"md",radius:"sm",sizing:"border-box",outline:"none",border:"detail",gap:2,zIndex:1},n))})}},4257:function(e,t,n){n.d(t,{u:()=>C});var i=n(69277),r=n(70408),a=n(4006),l=n(32485),o=n.n(l),s=n(66803),c=n(418),u=n(32641),d=n(97731);let p=e=>{var{fill:t="#FF6719"}=e,n=(0,u._)(e,["fill"]);return(0,a.FD)(d.A,(0,r._)((0,i._)({},n),{fill:t,name:"BestsellerBadgeIcon",svgParams:{viewBox:"0 0 40 40",height:40,width:40},children:[(0,a.Y)("path",{d:"M17.4385 1.2681C19.3988 0.456149 21.6012 0.45615 23.5615 1.2681L31.5807 4.58976C33.5409 5.40172 35.0983 6.95911 35.9102 8.91933L39.2319 16.9385C40.0439 18.8988 40.0439 21.1012 39.2319 23.0615L35.9102 31.0807C35.0983 33.0409 33.5409 34.5983 31.5807 35.4102L23.5615 38.7319C21.6012 39.5439 19.3988 39.5439 17.4385 38.7319L9.41933 35.4102C7.45911 34.5983 5.90171 33.0409 5.08976 31.0807L1.7681 23.0615C0.956149 21.1012 0.95615 18.8988 1.7681 16.9385L5.08976 8.91933C5.90172 6.95911 7.45911 5.40171 9.41933 4.58976L17.4385 1.2681Z",fill:t,stroke:"transparent"}),(0,a.Y)("path",{d:"M27.1666 15L17.9999 24.1667L13.8333 20",stroke:"white",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"})]}))},h=e=>(0,a.FD)(d.A,(0,r._)((0,i._)({},e),{name:"BestsellerBadgeOutlineIcon",svgParams:{viewBox:"0 0 40 40",height:40,width:40},children:[(0,a.Y)("path",{d:"M17.8212 2.19198C19.5364 1.48152 21.4636 1.48152 23.1788 2.19198L31.198 5.51364C32.9132 6.2241 34.2759 7.58682 34.9864 9.30201L38.308 17.3212C39.0185 19.0364 39.0185 20.9636 38.308 22.6788L34.9864 30.698C34.2759 32.4132 32.9132 33.7759 31.198 34.4864L23.1788 37.808C21.4636 38.5185 19.5364 38.5185 17.8212 37.808L9.80201 34.4864C8.08682 33.7759 6.7241 32.4132 6.01364 30.698L2.69198 22.6788C1.98152 20.9636 1.98152 19.0364 2.69198 17.3212L6.01364 9.30201C6.7241 7.58682 8.08682 6.2241 9.80202 5.51364L17.8212 2.19198Z",stroke:"#FF6719",strokeWidth:"4",fill:"transparent"}),(0,a.Y)("path",{d:"M27.1666 15L17.9999 24.1667L13.8333 20",stroke:"#FF6719",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"})]}));function b(e){var{colorFg:t="var(--color-fg)",colorBg:n="var(--color-bg)"}=e,l=(0,u._)(e,["colorFg","colorBg"]);return(0,a.FD)("svg",(0,r._)((0,i._)({width:"130",height:"130",viewBox:"0 0 130 130",fill:"none",xmlns:"http://www.w3.org/2000/svg"},l),{children:[(0,a.Y)("circle",{cx:"65",cy:"65",r:"65",fill:n}),(0,a.Y)("path",{d:"M67.5321 67.2143C62.0162 68.2532 54.1338 68.2193 47.1778 64.9205M62.2892 67.2143C61.2169 61.5215 61.2875 53.3079 64.9106 46.1935M62.2892 62.5387C67.8295 61.4951 75.7573 61.534 82.7358 64.8765M67.6643 62.5635C68.7424 68.2874 68.6652 76.5598 64.9832 83.7008M64.9106 46.1935C66.0867 43.8841 67.6371 41.6906 69.6443 39.7368C77.6175 31.5462 89.5811 30.9614 97.1218 32.3817C98.5421 39.9224 97.9573 51.886 89.7667 59.8592C87.6515 62.032 85.2556 63.6696 82.7358 64.8765M64.9106 46.1935C63.7346 43.8841 62.1841 41.6906 60.177 39.7368C52.2038 31.5462 40.2401 30.9614 32.6995 32.3817C31.2791 39.9224 31.8639 51.886 40.0546 59.8592C42.1955 62.0585 44.6242 63.7095 47.1778 64.9205M82.7358 64.8765C85.2556 66.0834 87.6515 67.7209 89.7667 69.8938C97.9573 77.8669 98.5421 89.8306 97.1218 97.3712C89.5811 98.7916 77.6175 98.2068 69.6443 90.0162C67.6781 88.1022 66.1502 85.9583 64.9832 83.7008M64.9832 83.7008C63.8145 85.9674 62.2826 88.12 60.3092 90.041C52.3361 98.2316 40.3724 98.8164 32.8317 97.3961C31.4114 89.8554 31.9962 77.8918 40.1868 69.9186C42.2908 67.7572 44.6726 66.1255 47.1778 64.9205",stroke:t,strokeWidth:"8.125",strokeLinejoin:"round"})]}))}function g(e){var{colorFg:t="var(--color-fg)",colorBg:n="var(--color-bg)"}=e,l=(0,u._)(e,["colorFg","colorBg"]);return(0,a.FD)("svg",(0,r._)((0,i._)({width:"130",height:"130",viewBox:"0 0 130 130",fill:"none",xmlns:"http://www.w3.org/2000/svg"},l),{children:[(0,a.Y)("circle",{cx:"65",cy:"65",r:"65",fill:n}),(0,a.Y)("path",{d:"M65.6465 68.0823C64.755 67.4734 63.829 66.7729 62.8971 65.9868M64.2878 62.7891C71.3916 62.5823 82.0308 64.7055 88.6659 72.6185M67.0615 62.7891C67.4781 63.9548 67.8607 65.2444 68.1794 66.6255M51.7343 46.2144C51.1193 45.9643 50.4867 45.7372 49.8361 45.5355C39.1879 41.9166 28.4388 46.7479 22.4627 51.3612C24.5858 58.6061 30.4423 68.8328 41.184 72.1639C41.6837 72.3338 42.1837 72.485 42.6834 72.6185M51.7343 46.2144C51.6666 45.4392 51.6364 44.6504 51.6472 43.8489C51.4959 32.6036 59.4123 23.8735 65.6465 19.6155C71.8808 23.8735 79.7972 32.6036 79.646 43.8489C79.6568 44.6586 79.6259 45.4553 79.5568 46.2382M51.7343 46.2144C52.4801 54.7605 57.7774 61.6677 62.8971 65.9868M79.5568 46.2382C80.19 45.9786 80.842 45.7436 81.5131 45.5355C92.1613 41.9166 102.91 46.7479 108.887 51.3612C106.763 58.6061 100.907 68.8328 90.1652 72.1639C89.6655 72.3338 89.1656 72.485 88.6659 72.6185M79.5568 46.2382C70.2171 50.0661 64.9642 59.225 62.8971 65.9868M88.6659 72.6185C89.0793 73.1115 89.4771 73.6269 89.8576 74.1657C96.5898 83.1744 95.3167 94.8904 92.7758 102C85.2294 102.219 73.6935 99.8095 67.2061 90.6229C66.6404 89.866 66.1313 89.0899 65.6746 88.2991M65.6746 88.2991C65.218 89.0899 64.7089 89.866 64.1432 90.6229C57.6557 99.8095 46.1198 102.219 38.5734 102C36.0326 94.8904 34.7595 83.1744 41.4917 74.1657C41.8722 73.6269 42.27 73.1115 42.6834 72.6185M65.6746 88.2991C69.7614 81.2212 69.6413 72.9599 68.1794 66.6255M42.6834 72.6185C47.2593 73.8412 51.8116 73.5781 55.9533 72.5175C60.7962 71.2773 65.0778 68.9466 68.1794 66.6255",stroke:t,strokeWidth:"8.125",strokeLinejoin:"round"})]}))}function f(e){var{colorFg:t="var(--color-fg)",colorBg:n="var(--color-bg)"}=e,l=(0,u._)(e,["colorFg","colorBg"]);return(0,a.FD)("svg",(0,r._)((0,i._)({width:"130",height:"130",viewBox:"0 0 130 130",fill:"none",xmlns:"http://www.w3.org/2000/svg"},l),{children:[(0,a.Y)("circle",{cx:"65",cy:"65",r:"65",fill:n}),(0,a.Y)("path",{d:"M65.8178 64.6615C59.9506 60.6715 52.6124 52.4902 52.7548 41.9528C52.7384 40.736 52.8216 39.5508 52.9909 38.3997M66.0797 65.3154C66.0986 65.348 66.1175 65.3807 66.1364 65.4136M65.8178 64.9992C65.2916 57.9443 67.0684 47.0438 75.4306 40.5834C76.5227 39.6919 77.666 38.9317 78.8438 38.2886M65.8179 64.9714C59.0286 67.0571 47.9603 67.7662 39.7687 61.0927C38.7178 60.2825 37.7706 59.4023 36.9188 58.4683M78.8438 38.2886C86.4928 34.1121 95.5904 34.8762 101.476 36.6775C101.936 42.8428 100.637 51.9448 94.721 58.454M78.8438 38.2886C77.469 29.525 70.9858 22.7599 65.8178 19.2455C60.628 22.7748 54.2874 29.5822 52.9909 38.3997M94.721 58.454C102.977 61.7257 108.166 69.4216 110.455 75.2094C105.819 79.488 97.6558 84.2461 88.6667 83.497M94.721 58.454C93.5875 58.0047 92.3961 57.6389 91.1466 57.3729C80.8595 54.8929 71.1285 60.1901 65.9175 64.9992C63.3212 71.5843 56.9757 80.641 46.6277 82.8553C45.4029 83.1519 44.1868 83.3366 42.9859 83.4236M88.6667 83.497C91.263 91.9728 88.4537 100.827 85.333 106.224C79.3164 105.319 70.9133 102.147 65.8177 95.2545M88.6667 83.497C88.3139 82.3454 87.8614 81.2007 87.2962 80.0726C82.9565 70.7934 73.1343 66.6144 66.1364 65.4136M65.8177 95.2545C60.7294 102.153 52.3292 105.334 46.3133 106.246C43.1749 100.83 40.3466 91.9318 42.9859 83.4236M65.8177 95.2545C66.6706 94.0981 67.4304 92.8373 68.0704 91.4651C72.7599 82.0801 69.6643 71.5554 66.1364 65.4136M42.9859 83.4236C34.1027 84.0672 26.05 79.3694 21.4552 75.1378C23.7146 69.4071 28.8135 61.8041 36.9188 58.4683M36.9188 58.4683C30.987 51.9645 29.6766 42.8564 30.1303 36.6869C36.072 34.8616 45.2909 34.0906 52.9909 38.3997",stroke:t,strokeWidth:"8.125",strokeLinejoin:"round"})]}))}let m={xs:12,sm:16,md:18,lg:24,xl:40,"2xl":132};function C(e){let{size:t,isStatic:n,badge:l}=e,u=m[t];if("bestseller"===l.type){if(!l.tier)return null;let e={height:u,isStatic:n};if(100===l.tier)return(0,a.Y)(h,(0,i._)({},e));let t=1e4===l.tier?"var(--color-accent-fg-purple)":void 0;return(0,a.Y)(p,(0,r._)((0,i._)({},e),{fill:t}))}if("subscriber"===l.type){if(!l.tier)return null;let e={width:u,height:u,className:o()("subscriberBadge-Lpjxjx",l.accent_colors&&"isSubscriber-JdH2KX")};return 1===l.tier?(0,a.Y)(b,(0,i._)({},e)):5===l.tier?(0,a.Y)(g,(0,i._)({},e)):(0,a.Y)(f,(0,i._)({},e))}return"vip"===l.type?(0,a.Y)(s.A,{size:u,stroke:"var(--color-fg-primary)"}):(0,a.Y)(c.A,{size:u,stroke:"var(--color-fg-primary)"})}},79107:function(e,t,n){n.d(t,{w:()=>u});var i=n(4006),r=n(17028),a=n(81203),l=n(75303),o=n(24777),s=n(92636),c=n(57324);function u(e){let{subscription:t={},publicationUser:n={},publication:u,type:h,onVisibilityChange:b,visibility:g}=e,f=g?"public"===g:"writes"===h?n.public:"public"===t.visibility;return(0,i.FD)(d,{children:[(0,i.Y)(l.AE,{href:(0,s.yR)((0,s.$_)(u),{utm_source:c.VU.editProfileVisibility}),target:"_blank",rel:"noopener noreferrer",children:(0,i.FD)(p,{children:[(0,i.Y)(a.Nq,{size:32,pub:u}),u&&(0,i.Y)(r.EY.B4,{weight:"semibold",ellipsis:!0,children:u.name})]})}),(0,i.Y)(o.d,{checked:f,onChange:e=>{b({type:h,publicationUser:n,subscription:t,visibility:e?"public":"private"})}})]})}let d=(0,l.I4)({display:"flex",gap:12,padding:8,justifyContent:"start",alignItems:"center",minWidth:0}),p=(0,l.I4)({display:"flex",gap:12,justifyContent:"start",alignItems:"center",flex:"grow",minWidth:0})},60782:function(e,t,n){n.d(t,{a:()=>m});var i=n(69277),r=n(70408),a=n(4006),l=n(6498),o=n.n(l),s=n(17402),c=n(86500),u=n(94729),d=n(68349),p=n(17028),h=n(16074),b=n(67250),g=n(79107),f=n(32848);function m(e){let{result:t}=(0,f.n7)();return t?(0,a.Y)(C,(0,r._)((0,i._)({},e),{result:t})):null}function C(e){let{result:t,onChange:n}=e,{refetchPublication:l,updateSubscriptions:m}=(0,f.n7)(),[C,v]=(0,s.useState)(()=>{let{publicationMap:e,publicationUserMap:n}=t;return null==t?void 0:t.subscriptions.filter(e=>!n.get(e.publication_id)).map(t=>(0,r._)((0,i._)({},t),{pub:e.get(t.publication_id),publication:e.get(t.publication_id)})).sort((e,t)=>{var n,i,r,a;return(null!=(r=null==(n=e.publication)?void 0:n.name)?r:"").localeCompare(null!=(a=null==(i=t.publication)?void 0:i.name)?a:"")})}),[y,Y]=(0,s.useMemo)(()=>o()(C,e=>"subscribed"===e.membership_state),[C]),w=C.some(e=>"private"===e.visibility),F=C.some(e=>"public"===e.visibility),[_,D]=(0,s.useState)(6);(0,s.useEffect)(()=>{D(null)},[]);let I=async e=>{let t=C.map(t=>(0,r._)((0,i._)({},t),{visibility:e}));null==n||n(t);let a=C.map(t=>({id:t.id,visibility:e}));(0,c.u4)(c.qY.PROFILE_EDITED,{type:"visibility_toggled_all",for:"reads",count:a.length,newVisibility:e}),v(t);try{await (0,u.x6)("/api/v1/subscription/visibilities/all",{method:"POST",json:{visibility:e}})}catch(e){}let l=await caches.open("api-cache");await l.delete("/api/v1/subscriptions/page"),m(t)},B=async e=>{let{subscription:t,visibility:a}=e,o=C.map(e=>e.id===t.id?(0,r._)((0,i._)({},e),{visibility:a}):e);null==n||n(o),v(o),(0,c.u4)(c.qY.PROFILE_EDITED,{type:"read_visibility_toggled",visibility:a});try{await (0,u.x6)("/api/v1/subscription/".concat(t.id,"/visibility"),{method:"POST",json:{visibility:a}})}catch(e){alert((0,d.uX)(e))}let s=await caches.open("api-cache");await s.delete("/api/v1/subscriptions/page"),t.publication_id&&await l(t.publication_id)};return(0,a.FD)(p.VP,{gap:16,children:[C.length>1&&(0,a.FD)(p.fI,{gap:4,children:[(0,a.Y)(p.$n,{priority:"secondary",onClick:()=>I("private"),disabled:!F,flex:"grow",children:"Hide all"}),(0,a.Y)(p.$n,{priority:"secondary",onClick:()=>I("public"),disabled:!w,flex:"grow",children:"Make all public"})]}),(0,a.FD)(p.VP,{className:"subscriptionsStack-t2l8yv",overflowY:"auto",border:"detail",radius:"md",padding:8,gap:16,children:[y.length>0&&(0,a.FD)(p.VP,{gap:8,paddingTop:4,children:[(0,a.FD)(p.EY.Meta,{color:"secondary",paddingX:8,children:[(0,a.Y)(b.H,{format:"number",value:y.length})," ","paid subscriptions"]}),(null!=_?y.slice(0,_):y).map(e=>(0,a.Y)(g.w,{type:"reads",subscription:e,publication:e.publication,onVisibilityChange:B},e.id))]}),y.length>0&&Y.length>0&&(0,a.Y)(h.c,{}),Y.length>0&&(0,a.FD)(p.VP,{gap:8,paddingTop:4,children:[(0,a.Y)(p.EY.Meta,{color:"secondary",paddingX:8,children:"Free subscriptions"}),(null!=_?Y.slice(0,_):Y).map(e=>(0,a.Y)(g.w,{type:"reads",subscription:e,publication:e.publication,onVisibilityChange:B},e.id))]})]})]})}},62252:function(e,t,n){n.d(t,{q:()=>X});var i=n(69277),r=n(70408),a=n(79785),l=n(4006),o=n(38314),s=n(67535),c=n(60250),u=n(54718),d=n(87677),p=n(17402),h=n(84605),b=n(46271),g=n(86500),f=n(99662),m=n(31392),C=n(12501),v=n(17028),y=n(3443),Y=n(88774),w=n(67250),F=n(25851),_=n(81203),D=n(4257),I=n(67140),B=n(16993),k=n(60782);function M(e){let{isOpen:t,onClose:n}=e,{iString:i}=(0,h.GO)();return(0,l.FD)(B.aF,{isOpen:t,onClose:n,children:[(0,l.Y)(B.rQ,{title:i("Subscription visibility"),description:i("Control which of your subscriptions appear on your profile"),showClose:!0,onClose:n}),(0,l.Y)(B.cw,{children:(0,l.Y)(k.a,{})})]})}var N=n(76528),P=n(52801),x=n(55298),S=n(92636),E=n(28700),L=n(49807),V=n(98949);let A={userStatusPopoverContent:"userStatusPopoverContent-Dq9jUa",subscriptionItem:"subscriptionItem-Fianmj",subscriptionContext:"subscriptionContext-TxZ2tf",secondaryBadgeButton:"secondaryBadgeButton-ZKuuU3",currentPublicationBar:"currentPublicationBar-xMtV6t",moreButton:"moreButton-T3omhQ",badgeAnimation:"badgeAnimation-K_JAim",backButton:"backButton-B6X90Z"};function O(){let e=(0,a._)([""," has hundreds of paid subscriptions"]);return O=function(){return e},e}function z(){let e=(0,a._)([""," has thousands of paid subscriptions"]);return z=function(){return e},e}function T(){let e=(0,a._)([""," has tens of thousands of paid subscriptions"]);return T=function(){return e},e}function U(){let e=(0,a._)(["#"," Rising in ",""]);return U=function(){return e},e}function j(){let e=(0,a._)(["#"," in ",""]);return j=function(){return e},e}function R(){let e=(0,a._)([""," is a Substack Bestseller"]);return R=function(){return e},e}function K(){let e=(0,a._)([""," paid subscriptions"]);return K=function(){return e},e}function X(e){let{userId:t,badge:n,hideViewProfileButton:a=!1,children:c}=e,u=function(){let[e,t]=(0,p.useState)(!1);return{open:()=>t(!0),element:(0,l.Y)(M,{isOpen:e,onClose:()=>t(!1)})}}(),[d,h]=(0,p.useState)(()=>"subscriber"===n.type?(0,r._)((0,i._)({},n),{color:null}):n),[b,m]=(0,p.useState)(!1),[C,Y]=(0,p.useState)(!1),{refs:w,floatingStyles:_,context:D,update:I}=(0,o.we)({open:b,onOpenChange:m,middleware:[(0,s.RK)(),(0,s.BN)()]}),B=(0,o.Mk)(D,{mouseOnly:!0,delay:{open:500,close:250}}),{getReferenceProps:k,getFloatingProps:P}=(0,o.bv)([B,(0,o.s9)(D,{ancestorScroll:!0})]),{isMounted:x,styles:S}=(0,y.g)(D),{userStatus:E}=(e=>{let{userId:t,shouldFetch:n}=e,i=(0,N.OU)("/api/v1/user_status/".concat(t),{auto:!!(n&&t),deps:[n,t]});return t?{userStatus:i.data,isLoading:i.isLoading}:{userStatus:null,isLoading:!1}})({shouldFetch:!!(t&&b),userId:t});if(ec({badge:n,shouldPreload:C}),(0,p.useEffect)(()=>{b&&E&&(0,g.u4)(g.qY.USER_CREDENTIAL_DRAWER_OPENED,{userId:t})},[b,E]),(0,V.Fr)()||(0,f.y)())return(0,l.Y)(l.FK,{children:c});let L=k();return(0,l.FD)(v.fI,(0,r._)((0,i._)({ref:w.setReference,onClick:e=>{e.stopPropagation()}},L),{onMouseEnter:e=>{Y(!0),"function"==typeof(null==L?void 0:L.onMouseEnter)&&L.onMouseEnter(e)},children:[c,u.element,E&&x&&(0,l.Y)(o.XF,{children:(0,l.Y)(v.az,(0,r._)((0,i._)({style:(0,r._)((0,i._)({},_),{zIndex:v.iC}),ref:w.setFloating},P()),{children:(0,l.Y)(F.Q,{style:S,children:(0,l.Y)(W,{userId:t,badge:d,onChangeBadge:e=>{h(e),I()},hideViewProfileButton:a,userStatus:E,onEditSubscriptions:u.open})})}))})]}))}function W(e){let{userId:t,badge:n,hideViewProfileButton:i=!1,userStatus:r,onChangeBadge:a,onEditSubscriptions:o}=e;switch(n.type){case"bestseller":return(0,l.Y)(H,{badge:n,userId:t,hideViewProfileButton:i,userStatus:r,onChangeBadge:a});case"subscriber":return(0,l.Y)(G,{badge:n,userId:t,hideViewProfileButton:i,userStatus:r,onChangeBadge:a,onEditSubscriptions:o});case"unverified":return(0,l.Y)($,{badge:n,userId:t,hideViewProfileButton:i,userStatus:r});case"vip":return(0,l.Y)(Z,{badge:n,userId:t,hideViewProfileButton:i,userStatus:r,onChangeBadge:a});default:return(0,l.Y)(l.FK,{})}}function H(e){let{badge:t,userId:n,hideViewProfileButton:i=!1,userStatus:r,onChangeBadge:a}=e,{iString:o,iTemplate:s}=(0,h.GO)(),c=!!(null==r?void 0:r.leaderboardStatus),u=t.tier,d=r.leaderboardStatus?"trending"===r.leaderboardStatus.ranking?s(U(),null==r?void 0:r.leaderboardStatus.rank,null==r?void 0:r.leaderboardStatus.label):s(j(),null==r?void 0:r.leaderboardStatus.rank,null==r?void 0:r.leaderboardStatus.label):"",p=(()=>{switch(u){case 100:return c?o("with hundreds of paid subscribers"):r.userName?s(O(),r.userName):o("Hundreds of paid subscriptions");case 1e3:return c?o("with thousands of paid subscribers"):r.userName?s(z(),r.userName):o("Thousands of paid subscriptions");case 1e4:return c?o("with tens of thousands of paid subscribers"):r.userName?s(T(),r.userName):o("Tens of thousands of paid subscriptions");default:return""}})(),{subscriptionCount:b}=q(r),{userName:g}=r,f=g?s(R(),g):o("Substack Bestseller");return(0,l.FD)(J,{children:[(0,l.FD)(v.VP,{gap:4,children:[(0,l.Y)(ee,{badge:t,title:f}),(0,l.Y)(v.VP,{paddingX:16,children:(null==r?void 0:r.leaderboardStatus)?(0,l.FD)(v.EY.B4,{color:"secondary",textAlign:"center",translated:!0,children:[I18N.p(null==r?void 0:r.leaderboardStatus.publicationName)," is"," ",(0,l.Y)(v.Yq,{href:(0,L.Rtp)({categoryId:null==r?void 0:r.leaderboardStatus.categoryId,ranking:null==r?void 0:r.leaderboardStatus.ranking}),color:"accent",children:I18N.p(d)})," ",I18N.p(p)]}):(0,l.Y)(v.EY.B4,{color:"secondary",textAlign:"center",children:p})})]}),(0,l.FD)(Q,{children:[(null==r?void 0:r.secondaryBadge)&&(0,l.Y)(ei,{badge:r.secondaryBadge,count:b,onChangeBadge:a}),n&&!i&&(0,l.Y)(en,{userId:n,userName:null==r?void 0:r.userName})]})]})}function q(e){var t,n;let{currentPublicationSubscription:i}=e,r=(null==e?void 0:e.subscriptions.length)+ +!!i;return{subscriptionCount:r,hiddenSubscriptionsCount:null!=(t=null==e?void 0:e.subscriptions.filter(e=>"hidden"===e.visibility).length)?t:0,subscriptions:null!=(n=null==e?void 0:e.subscriptions.filter(e=>"public"===e.visibility))?n:[]}}function G(e){var t;let{badge:n,userId:i,hideViewProfileButton:r=!1,userStatus:a,onChangeBadge:o,onEditSubscriptions:s}=e,{primaryBadge:d,secondaryBadge:p,currentPublicationSubscription:g,userName:f}=a,{iString:m,iTemplate:C}=(0,h.GO)(),y=(0,b.Jd)(),{subscriptionCount:F,hiddenSubscriptionsCount:D,subscriptions:B}=q(a),k=function(e){let t=4,n=72,i=14,r="sm";for(let a=0;a<1e3;a++){let a=Math.ceil(e/t);if(a*n+i*(a-1)<300)return{columns:t,size:n,gap:i,radius:r};i>4&&(i-=2),(n=function(e){return ea.reduce((t,n)=>Math.abs(n-e)<Math.abs(t-e)?n:t)}(Math.floor((343-i*((t+=1)-1))/t)))<=28&&(r="xs")}throw Error("No possible size")}((null!=F?F:0)-D+ +(D>0));return(0,l.FD)(J,{children:[(0,l.FD)(v.VP,{gap:20,children:[(0,l.FD)(v.VP,{children:[(0,l.Y)(el,{badge:n}),p&&d&&(0,l.Y)(v.K0,{className:A.backButton,position:"absolute","aria-label":"back",priority:"secondary",onClick:()=>o(d),rounded:!0,size:"sm",children:(0,l.Y)(c.A,{})}),i===(null==y?void 0:y.id)&&(0,l.Y)(Y.W1,{trigger:(0,l.Y)(v.K0,{priority:"secondary",rounded:!0,size:"sm",position:"absolute",className:A.moreButton,children:(0,l.Y)(u.A,{})}),strategy:"absolute",children:(0,l.Y)(Y.Dr,{onClick:s,children:m("Edit subscription visibility")})})]}),(0,l.FD)(v.EY.H4,{textAlign:"center",paddingX:16,children:[null!=f?f:"User"," ",(0,l.Y)(v.az,{as:"span",fontStyle:"italic",children:"subscribes"}),"."]})]}),(0,l.Y)(Q,{children:(0,l.FD)(v.VP,{gap:8,children:[(0,l.FD)(v.VP,{gap:12,paddingY:8,children:[(0,l.Y)(v.EY.Meta,{alignSelf:"start",children:F?1===F?m("1 paid subscription"):C(K(),(0,I.V)(F,"number")):m("Paid subscriptions")}),g&&(0,l.Y)(er,{subscription:g}),(0,l.Y)(v.fI,{display:"grid",justifyContent:"space-between",style:{gridTemplateColumns:"repeat(".concat(k.columns,", ").concat(k.size,"px)"),rowGap:k.gap},children:(0,l.FD)(l.FK,{children:[B.map(e=>(0,l.FD)(v.VP,{className:A.subscriptionItem,alignItems:"center",gap:4,style:{width:k.size},children:[(0,l.Y)(_.wg,{size:k.size,logoUrl:e.logoUrl,publicationName:e.publicationName,radius:k.radius,href:e.primaryUserId?(0,E.dt)(e.primaryUserId):(0,S.$_)({subdomain:e.subdomain}),frame:e.isFounding&&k.size>40?"accent-fg-purple":void 0}),(0,l.Y)(v.EY.B4,{className:A.subscriptionContext,children:e.timeFrameString})]},e.publicationId)),D>0&&(0,l.FD)(v.VP,{className:A.subscriptionItem,alignItems:"center",gap:4,children:[(0,l.Y)(v.VP,{className:A.subscriptionItemPubAvatar,bg:"elevated-secondary",justifyContent:"center",alignItems:"center",sizing:"border-box",radius:k.radius,style:{width:k.size,height:k.size},children:(0,l.Y)(v.EY.B2,{weight:"semibold",color:"secondary",children:(0,l.Y)(w.H,{value:D,format:"number"})})}),(0,l.Y)(v.EY.B4,{className:A.subscriptionContext,children:m("Private")})]})]})})]}),i&&!r&&(0,l.Y)(v.$n,{href:(0,E.rf)(i,null!=(t=null==a?void 0:a.userName)?t:null),priority:"secondary",children:m("View profile")})]})})]})}function $(e){let{badge:t,userId:n,hideViewProfileButton:i=!1,userStatus:r}=e,{iString:a}=(0,h.GO)(),o=(0,b.Jd)(),s=(null==o?void 0:o.id)===n,{userName:c}=r,u=c?"".concat(c,"*"):a("Unverified user");return(0,l.FD)(J,{children:[(0,l.FD)(v.VP,{gap:4,children:[(0,l.Y)(ee,{badge:t,title:u}),(0,l.Y)(v.EY.B4,{textAlign:"center",paddingX:16,children:a("*This account has no verified phone number or paid subscriptions")})]}),(0,l.Y)(Q,{children:(0,l.FD)(v.VP,{gap:8,children:[s&&(0,l.Y)(v.$n,{priority:"secondary",href:(0,x.wH)(),children:a("Verify in the Substack app")}),!i&&(0,l.Y)(en,{userId:n,userName:null==r?void 0:r.userName,priority:s?"tertiary":"secondary"})]})})]})}function Z(e){let{badge:t,userId:n,hideViewProfileButton:i=!1,userStatus:r,onChangeBadge:a}=e,{iString:o}=(0,h.GO)(),{userName:s}=r,c=null!=s?s:o("Verified creator"),{subscriptionCount:u}=q(r);return(0,l.FD)(J,{children:[(0,l.FD)(v.VP,{gap:4,children:[(0,l.Y)(ee,{badge:t,title:c}),(0,l.FD)(v.EY.B4,{textAlign:"center",translated:!0,paddingX:16,children:[(0,l.Y)(v.Yq,{href:t.url,color:"accent",target:"_blank",rel:"noopener noreferrer",children:I18N.p(t.handle)})," ","on ",I18N.p(t.service)]})]}),(0,l.FD)(Q,{children:[r.secondaryBadge&&(0,l.Y)(ei,{badge:r.secondaryBadge,count:u,onChangeBadge:a}),n&&!i&&(0,l.Y)(en,{userId:n,userName:null==r?void 0:r.userName})]})]})}function J(e){let{children:t}=e;return(0,l.Y)(v.VP,{gap:20,paddingY:16,className:A.userStatusPopoverContent,children:t})}let Q=(0,v.I4)({display:"flex",direction:"column",gap:20,paddingX:16});function ee(e){let{badge:t,title:n}=e;return(0,l.FD)(v.VP,{gap:20,children:[(0,l.Y)(el,{badge:t}),(0,l.Y)(v.EY.H4,{textAlign:"center",paddingX:16,children:n})]})}function et(){let{auto:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{result:t}=(0,C.qK)(()=>n.e("66860").then(n.bind(n,91463)).then(e=>e.DotLottieReact),[],{auto:e});return t}function en(e){let{userId:t,userName:n,priority:i="secondary"}=e,{iString:r}=(0,h.GO)();return(0,l.Y)(v.$n,{href:(0,E.rf)(t,n),priority:i,children:r("View profile")})}function ei(e){let{badge:t,count:n,onChangeBadge:i}=e;return(0,l.FD)(l.FK,{children:[(0,l.Y)(v.cG,{}),(0,l.FD)(v.Nm,{resetCss:!0,className:A.secondaryBadgeButton,display:"flex",alignItems:"center",justifyContent:"space-between",onClick:()=>i(t),bg:"primary-hover",padding:8,pullX:8,pullY:8,radius:"md",children:[(0,l.FD)(v.fI,{gap:8,alignItems:"center",children:[(0,l.Y)(D.u,{size:"xl",badge:t}),(0,l.FD)(v.EY.B4,{weight:"semibold",textAlign:"center",translated:!0,children:[(0,l.Y)(w.H,{format:"number",value:n})," paid subscriptions"]})]}),(0,l.Y)(d.A,{size:24})]})]})}function er(e){let{subscription:t}=e,n=t.accentColors;return(0,l.FD)(v.fI,{className:A.currentPublicationBar,gap:12,padding:16,radius:"md",style:n?{"--bg":(0,P.O)(n.primary),"--bg-hover":(0,P.O)(n.primary_hover),"--fg":(0,P.O)(n.contrast)}:void 0,alignItems:"start",children:[(0,l.Y)(_.wg,{className:(0,v.iF)({shadow:"md"}),size:48,logoUrl:t.logoUrl,publicationName:t.publicationName,radius:"md",href:t.primaryUserId?(0,E.dt)(t.primaryUserId):(0,S.$_)({subdomain:t.subdomain})}),(0,l.FD)(v.VP,{gap:4,children:[t.isFounding?(0,l.FD)(v.EY.B2,{weight:"semibold",translated:!0,children:["Founding subscriber to ",I18N.p(t.publicationName)]}):(0,l.FD)(v.EY.B2,{weight:"semibold",translated:!0,children:["Paid subscriber to ",I18N.p(t.publicationName)]}),(0,l.Y)(v.EY.B3,{children:t.timeFrameString})]})]})}let ea=[20,24,28,32,36,40,44,48,56,64,72];function el(e){let{badge:t}=e,n=et(),i=eo(t),r=ec({badge:t,shouldPreload:!0}).result;return n&&i&&r?(0,l.Y)(v.fI,{justifyContent:"center",children:(0,l.Y)(n,{className:A.badgeAnimation,data:r,autoplay:!0,width:343,height:150,renderConfig:{devicePixelRatio:4}})}):(0,l.Y)(v.fI,{style:{height:150}})}function eo(e){var t;let n=(0,m.Ut)(),i=function(e){switch(e.type){case"vip":return"/vip";case"bestseller":return"/".concat(e.type,"/").concat(e.tier);case"subscriber":{let t;switch(e.tier){case 1:t=1;break;case 5:t=2;break;case 10:t=3}return"/".concat(e.type,"/").concat(t)}default:return null}}(e);return i?(t="/static/lottie/user_status_animation".concat(i,"/").concat(n,".lottie")).startsWith("//")||!t.startsWith("/")?(console.warn("cdnify called on non-path string ".concat(t)),t):"".concat(S.w4).concat(t):null}let es=new Map;function ec(e){let{badge:t,shouldPreload:n}=e;et({auto:n});let i=eo(t);return(0,C.qK)(async()=>{if(!i)return new ArrayBuffer;let e=es.get(i);if(e)return e;let t=await fetch(null!=i?i:"",{cache:"force-cache",credentials:"omit"}).then(e=>e.arrayBuffer());return es.set(i,t),t},[i,n],{auto:!!i&&n,initialResult:i?es.get(i):void 0})}}}]);