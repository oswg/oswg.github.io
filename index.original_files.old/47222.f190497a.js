!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};e.SENTRY_RELEASE={id:"substack@af5f699"};var n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="8f47adea-53e9-414a-a68c-376e85267ac5",e._sentryDebugIdIdentifier="sentry-dbid-8f47adea-53e9-414a-a68c-376e85267ac5")}catch(e){}}();"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["47222"],{5109:function(e,n,a){a.d(n,{dx:()=>A});var i=a(79785),t=a(4006),l=a(32485),r=a.n(l),o=a(69843),d=a.n(o),u=a(17402),s=a(75136),c=a(52820),h=a(84605),p=a(92905),m=a(86500),b=a(94729),f=a(12501),y=a(35369),g=a(33727),v=a(60322),Y=a(76977),k=a(20500),w=a(76171);a(16993);var _=a(81203),F=a(94996),S=a(63136),D=a(11587),I=a(65842),E=a(61554),C=a(96400);a(39318);var x=a(46058),T=a(16722);function N(){let e=(0,i._)([""," on Substack"]);return N=function(){return e},e}let A=(0,c.WR)((0,h.wr)(function(e){let{className:n,user:a,numVisibleSubscriptions:i,numSubscriptions:l,freeSignup:o,freeSignupEmail:c,needsPhoto:h,optionalPhoto:A,showHandle:B=!0,token:U,text:P,onSuccess:R,prepareData:j,pageTitle:q,primaryEligiblePublications:L,isPostInvite:W,complete:H,profileExists:J,onSkip:O,onEditReadVisibility:V,barebones:z,onEditRecommendations:$,numRecommendationsToMake:K,noSubscribeCta:Z,style:G,iString:M,iPlural:Q,iTemplate:X,showSocialHandle:ee,pub:en,autoSubmit:ea,onAutoSubmitFailed:ei}=e,[et,el]=(0,u.useState)(null),[er,eo]=(0,u.useState)(null),[ed,eu]=(0,u.useState)(null),[es,ec]=(0,u.useState)(a&&a.is_magic?a.email:null),[eh,ep]=(0,u.useState)("instagram"),[em,eb]=(0,u.useState)(!!W&&!(null==a?void 0:a.has_publication)),[ef,ey]=(0,u.useState)(void 0),[eg,ev]=(0,u.useState)(!1),[eY,ek]=(0,u.useState)(!1),[ew,e_]=(0,u.useState)(!1),[eF,eS]=(0,u.useState)(void 0),[eD,eI]=(0,u.useState)(!!W||!!J),[eE,eC]=(0,u.useState)(!0),[ex,eT]=(0,u.useState)(!1),eN=(0,u.useRef)(null),eA=(0,u.useRef)(!1),{isLoading:eB,error:eU,refetch:eP,clearError:eR}=(0,f.st)({pathname:"/api/v1/user/profile",method:"PUT",auto:!1,deps:[]}),{trackInputFilled:ej,trackSubmitPressed:eq,trackError:eL}=(0,p.a)("Signup Profile Form"),eW=ef||(0,x.w3)(a,{}),eH=et||a&&a.name||"",eJ=er||(null==a?void 0:a.handle)||"",eO="string"==typeof ed?ed:a&&a.bio||"",eV=()=>a&&!a.is_magic&&a.name&&(!h||a.photo_url),ez=async(e,n)=>{try{let a=await (0,b.x6)("/api/v1/publication/suggestion"),i=n||X(N(),e);await (0,b.x6)("/api/v1/publication",{method:"post",json:{name:e,subdomain:a.subdomain,hero_text:i,tos:!0}})}catch(e){(0,m.u4)(m.qY.DEFAULT_PUBLICATION_CREATION_FAILED),console.warn("couldn't set up a default publication",e)}},e$=async()=>{let e=es||c;if(!ex&&e){eT(!0);try{await (0,b.x6)("/api/v1/email-login",{method:"post",json:{email:e,redirect:document.location.href}}),ek(!0)}catch(e){console.error("Failed send login email:",e)}eT(!1)}},eK=async e=>{if(null==e||e.preventDefault(),eq(),eR(),!eN.current)return;let n=Object.fromEntries(new FormData(eN.current).entries());j&&j(n,e);let a=await eP({json:n});if(a instanceof Error){var i;eL(a),ea&&!eg&&(ev(!0),null==ei||ei()),ek(!1),a instanceof b.fk&&(null==(i=a.response)?void 0:i.status)===401&&e$()}else{if(a.emailConfirmationRequired)return void e_(!0);em&&await ez(eH,eO),R({body:a},n)}};(0,u.useEffect)(()=>{ea&&!eA.current&&(eA.current=!0,eV()?eK():null==ei||ei())},[]);let eZ="string"==typeof q||null===q?q:M(eV()?"Update your profile":"Create your profile"),eG=(!a||a.is_magic)&&!c&&!W,eM=!J&&!!$&&!d()(K)&&K>0,eQ=W&&L&&(null==a?void 0:a.has_publication)&&L.length>1,eX="number"==typeof i&&!d()(l)&&l>0&&V,e0=!Z&&!(a&&(a.is_subscribed||a.is_free_subscribed)||o),e1=W&&!(null==a?void 0:a.has_publication),e2=eB||ex;return(0,t.FD)("div",{className:r()("profile-updater",n),style:G,children:[eZ&&(0,t.Y)(S.EY.H4,{align:"left",paddingBottom:20,children:eZ}),(eW||h||A)&&(0,t.Y)(Y.fI,{flex:"grow",justifyContent:"center",alignItems:"center",children:(0,t.Y)(s.U,{user:{photo_url:ef||(null==a?void 0:a.photo_url)||null},onChangePhoto:e=>{let{photo_url:n}=e;return ey(n)}})}),(0,t.FD)("form",{ref:eN,className:"form",onSubmit:eK,noValidate:!0,children:[(0,t.FD)(Y.VP,{gap:20,children:[(0,t.FD)(I.A0,{children:[(0,t.Y)(w.sb,{htmlFor:"name",children:M("Name")}),en?(0,t.Y)("input",{type:"hidden",name:"pub_id",value:en.id}):null,(0,t.Y)(I.ks,{autoFocus:!0,type:"text",className:"profile-name",placeholder:M("Type your name..."),name:"name",id:"name",value:eH,disabled:e2,onInput:e=>{el(e.currentTarget.value)},onBlur:ej})]}),eG&&(0,t.FD)(I.A0,{children:[(0,t.Y)(w.sb,{htmlFor:"email",children:M("Email")}),(0,t.Y)(I.ks,{type:"email",placeholder:M("Enter your email address..."),name:"email",value:null!=es?es:void 0,disabled:e2,onInput:e=>{ec(e.currentTarget.value)}})]}),B&&(0,t.FD)(I.A0,{children:[(0,t.Y)(w.JU,{htmlFor:"handle",children:M("Handle")}),(0,t.Y)(I.ks,{type:"text",className:"profile-name",placeholder:M("Type your handle..."),name:"handle",id:"handle",value:eJ,disabled:e2,onInput:e=>{eo(e.currentTarget.value)}})]}),!z&&(0,t.FD)(I.A0,{children:[(0,t.Y)(w.JU,{htmlFor:"bio",children:M("Bio")}),(0,t.Y)(D.T,{placeholder:M("Say something about yourself..."),name:"bio",id:"bio",value:eO,disabled:e2,onInput:e=>{eu(e.currentTarget.value)}}),W&&(0,t.Y)(k.EE,{align:"left",children:M("Tip: this will be shown at the bottom of your guest post")})]}),W&&(0,t.Y)("input",{type:"hidden",name:"needs_bio",value:"true"}),ee&&(0,t.FD)(I.A0,{children:[(0,t.Y)(w.Sy,{htmlFor:"social",hint:M("Optional"),children:M("Where else can you be found?")}),(0,t.FD)(Y.fI,{gap:8,wrap:"wrap",children:[(0,t.Y)(Y.fI,{flex:"grow",minWidth:200,children:(0,t.FD)(F.I,{flex:"grow",name:"social",value:eh,disabled:e2,onChange:e=>{ep(e.currentTarget.value)},children:[(0,t.Y)(F.K,{children:M("Select a social network")}),(0,t.Y)("option",{value:"twitter",children:M("Twitter")}),(0,t.Y)("option",{value:"instagram",children:M("Instagram")}),(0,t.Y)("option",{value:"tiktok",children:M("Tiktok")}),(0,t.Y)("option",{value:"linkedin",children:M("LinkedIn")}),(0,t.Y)("option",{value:"youtube",children:M("Youtube")})]})}),(0,t.Y)(Y.fI,{flex:"grow",minWidth:200,children:(0,t.Y)(I.ks,{flex:"grow",type:"text",placeholder:M("@yourhandle"),name:"socialHandle",value:eF,disabled:e2,onInput:e=>{eS(e.currentTarget.value)}})})]})]}),eQ&&(0,t.FD)(I.A0,{children:[(0,t.Y)(w.JU,{children:M("Publication to display")}),(0,t.Y)(g.Z,{padding:12,gap:12,children:L.map((e,n)=>{var a,i;return(0,t.Y)(w.JU,{htmlFor:"primary-radio-".concat(e.id),children:(0,t.FD)(Y.fI,{gap:12,alignItems:"center",children:[(0,t.Y)("input",{id:"primary-radio-".concat(e.id),type:"radio",name:"primary_publication_user_id",value:e.id,defaultChecked:0===n,disabled:e2}),(0,t.Y)(_.Nq,{pub:e.publication,size:24}),(0,t.Y)(S.EY.B3,{as:"span",children:null!=(i=null==(a=e.publication)?void 0:a.name)?i:""})]})},e.id)})})]}),e0&&(0,t.FD)(Y.Ye,{as:"label",className:T.A.checkbox,gap:8,children:[(0,t.Y)(v.S,{size:"sm",name:"free_signup",defaultChecked:!0,checked:eE,onChange:e=>eC(e)}),(0,t.Y)(S.EY.B3,{as:"span",children:M("Subscribe to the newsletter")})]}),e1&&(0,t.FD)(Y.Ye,{as:"label",className:T.A.checkbox,gap:8,children:[(0,t.Y)(v.S,{name:"create_publication",id:"create-publication-checkbox",checked:em,onChange:e=>{eb(e)}}),(0,t.Y)(S.EY.B3,{as:"span",children:M("Create a Substack publication for me")})]}),(0,t.Y)("input",{type:"hidden",name:"confirmation_redirect_pathname",value:document.location.pathname}),(0,t.Y)("input",{type:"hidden",name:"photo_url",value:null!=eW?eW:void 0}),(0,t.Y)("input",{type:"hidden",name:"user_id",value:(null==a?void 0:a.id)||""}),(0,t.Y)("input",{type:"hidden",name:"needs_photo",value:!!h}),(0,t.Y)("input",{type:"hidden",name:"token",value:U}),H&&(0,t.Y)("input",{type:"hidden",name:"complete",value:!0}),(0,t.FD)("div",{children:[eU&&!eY&&(0,t.Y)("div",{className:"error other-error",children:(()=>{if(!eU)return null;if(eU instanceof b.fk){var e,n,a,i;return(null==(a=eU.body)||null==(n=a.errors)||null==(e=n[0])?void 0:e.msg)||(null==(i=eU.body)?void 0:i.error)||"Something went wrong"}return"Something went wrong"})()}),eY&&(0,t.FD)(S.EY,{as:"div",translated:!0,className:"error other-error",children:["If you have an account with us, we've sent an email to ",(0,t.Y)("b",{children:C.TH.p(null!=es?es:"")})," with a link that you can use to sign in."]}),ew&&(0,t.Y)("div",{className:"error other-error",children:M("We have sent you a confirmation email. Please check your inbox before continuing.")})]}),eX&&(0,t.FD)(S.EY.B3,{as:"span",children:[(0,t.Y)(S.Yq,{cursor:"pointer",decoration:"underline",onClick:V,children:Q("1 subscription","%1 subscriptions",i)})," ",M("will be displayed on your profile.")]}),eM&&(0,t.FD)(S.EY.B3,{as:"span",children:[(0,t.Y)(S.Yq,{cursor:"pointer",decoration:"underline",onClick:$,children:Q("1 recommendation","%1 recommendations",K)})," ",M("will be made on your publication.")]})]}),(0,t.FD)(Y.VP,{gap:8,children:[!a&&(0,t.Y)(Y.VP,{className:T.A.tosCheckboxContainer,paddingBottom:12,children:(0,t.Y)(E.U,{checked:eD,onCheckboxChange:e=>eI(e),style:{display:"flex"}})}),(0,t.Y)(y.$n,{priority:"primary",disabled:!a&&!eD||e2,loading:e2,type:"submit",children:P||M("Save")}),O&&(0,t.Y)(y.$n,{priority:"secondary",onClick:O||(()=>{}),disabled:e2,children:M("Skip")})]})]})]})}))}}]);